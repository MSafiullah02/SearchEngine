{
    "paper_id": "e5a6774846de80474db96ace30d593ad1b9dc83d",
    "metadata": {
        "title": "INBETWEENING AUTO-ANIMATION VIA FOKKER-PLANCK DYNAMICS AND THRESHOLDING",
        "authors": [
            {
                "first": "Yuan",
                "middle": [],
                "last": "Gao",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Guangzhen",
                "middle": [],
                "last": "Jin",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Jian-Guo",
                "middle": [],
                "last": "Liu",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "We propose an equilibrium-driven deformation algorithm (EDDA) to simulate the inbetweening transformations starting from an initial image to an equilibrium image, which covers images varying from a greyscale type to a colorful type on plane or manifold. The algorithm is based on Fokker-Planck dynamics on manifold, which automatically cooperates positivity, unconditional stability, mass conservation law, exponentially convergence and also the manifold structure suggested by dataset. The thresholding scheme is adapted for the sharp interface dynamics and is used to achieve the finite time convergence. Using EDDA, three challenging examples, (I) facial aging process, (II) coronavirus disease 2019 (COVID-19) invading/treatment process, and (III) continental evolution process are conducted efficiently.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Inbetweening auto-animation is to automatically generate animations (motions) given a starting and end images. The classical method for auto-animation use detailed kinematic equations for each object in the starting images, which is precise but time consuming due to case by case c.f. [CBE + 15, ZTG + 18].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Instead of analyzing the detailed kinematic equation for each object, we aim to propose an efficient and universal algorithm for inbetweening auto-animation based on Fokker-Planck dynamics on manifold and thresholding. We call this algorithm equilibrium-driven deformation algorithm (EDDA).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "EDDA regards the end image as an equilibrium state of a Fokker-Planck equation and the inbetweening motion is driven by an underlying potential force determined by the equilibrium. This viewpoint is especially useful when the detailed physical process is not clear or hard to describe. For instance, the inbetweening motion of aging process, tumor growth, pneumonia invading for coronavirus disease 2019 or the formation of current continents/oceans starting from pangaea.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We first consider a Fokker-Planck equation in a flat domain \u2126 \u2282 R with a unique equilibrium \u03c0 and no-flux boundary condition in Section 2 and then we propose an efficient solver for this Fokker-Planck equation in Section 3. The numerical solver for this part is based on structured grids and finite volume method [EGH00] . An unconditionally stable explicit time discretization is introduced, which automatically enjoys positivity, mass conservation law, exponentially convergence and also efficiency. For a Fokker-Planck equation on a closed manifold, we propose a similar efficient solver based on point clouds and the associated Voronoi tessellation in Section 4. The Voronoi tessellation automatically gives the manifold information and can be used to approximate surface gradient/divergence in the Fokker-Planck equation. Based on this, an analogue unconditionally stable explicit time discretization is introduced.",
            "cite_spans": [
                {
                    "start": 313,
                    "end": 320,
                    "text": "[EGH00]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "To realize the end image (the equilibrium) at finite time and the sharp dynamics of the inbetweening motion, we combine the explicit-time-discretization of the Fokker-Planck equation with the thresholding dynamics. When the equilibrium image has a sharp interface, the scheme adapting thresholding step converges faster than the purely Fokker-Planck iteration and the relative error reaches machine accuracy at finite time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In Section 5, we apply EDDA proposed for either structured grids on \u2126 \u2282 R , or for pointclouds which suggests an underlining manifold to conduct three challenging and important examples: (I) facial aging process, (II) COVID-19 invading/treatment process, and (III) continental evolution process. In Example (I), inbetweening facial aging process at each time is simulated and potentially reveals the detailed changes of different part of human face over time. In Example (II), the inbetweening evolution of COVID-19 pneumonia invading before treatment and the fading away after treatment are simulated, which shows a good agreement with computerized tomography (CT) scans and also reveals promising application in the studying of pathology for COVID-19. In Example (III), the Fokker-Planck dynamics and thresholding are combined together to simulate the continental drifting process, which may suggest a new explanation for the formation of the current five continents of the world. From those examples from quite different research fields, EDDA are shown to be a very efficient and universal method with enormous potential applications in other fields of science and industry.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Suppose \u2126 \u2282 R is a closed subset in R . Assume the end image on \u2126 is described by a equilibrium density \u03c0(x) : \u2126 \u2192 R. The value of \u03c1 indicates the gray level of the image for a grayscale image. In the case of Red-Green-Blue (RGB) image, we use three separate densities to indicate the RGB levels of the image separately. Then with \u03c0 \u221d e \u2212\u03c6 , the Fokker-Planck equation is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "We consider the following natural no-flux boundary condition",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "(2.1) can be recast as the relative entropy formulation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "See Section 4 for a Fokker-Planck equation on a d dimensional smooth closed submanifold of R . Now we state the ergodicity of Fokker-Planck equation (2.1). Assume",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "(2.5) \u03c0 > 0, \u03c0 \u2208 C 1 (\u03a9).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "Let L 2 (\u2126; 1 \u03c0 dx) be the weighted Sobolev space. Define the Fokker-Planck operator for (2.1) as L * : D(L * ) \u2282 L 2 (\u2126; 1 \u03c0 dx) \u2192 R with D(L * ) := {u \u2208 H 2 (\u2126; 1 \u03c0 dx); \u2202 n u \u03c0 = 0 on \u2202\u2126} (2.6)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "This can be regarded as the adjoint operator of the generator L = \u2212 1 \u03c0 \u2207 \u00b7 (\u03c0\u2207) of Fokker-Planck equation (2.1). One can see L * is self-adjoint operator in L 2 (\u2126; 1 \u03c0 dx) with compact resolvent (\u03bbI + L * ) \u22121 for \u03bb large enough. Thus L * has only discrete spectrum without finite accumulation points. Furthermore, since \u03c0 > 0, for \u03c1 \u2208 D(L),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "Therefore, we conclude 0 is the simple principal eigenvalue of L * with the corresponding eigenfunction \u03c0, which leads to the spectral gap of L * in L 2 (\u2126; 1 \u03c0 dx), i.e. (2.8)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "Thus due to (\u03c1 \u2212 \u03c0) dx = 0, we have the following Poincare's inequality",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "Therefore, multiplying (2.1) by \u03c1 \u03c0 \u2212 1, by (2.3) we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "which gives the ergodicity that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fokker-Planck equation and equilibrium"
        },
        {
            "text": "We present the numerical method based on structured grids for a Fokker-Planck equation on C ij = ((i \u2212 1)\u2206x, i\u2206x) \u00d7 ((j \u2212 1)\u2206y, j\u2206y), i = 1, \u00b7 \u00b7 \u00b7 , N, j = 1, \u00b7 \u00b7 \u00b7 , M.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Then the cell centers (x i , y i ) are",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": ")\u2206y, i = 1, \u00b7 \u00b7 \u00b7 , N, j = 1, \u00b7 \u00b7 \u00b7 , M.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "We use \u03c1 i,j to approximate the value of \u03c1(x i , y j ) and take \u03c0 i,j = \u03c0(x i , y j ). Then the continuoustime finite volume scheme is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "for i = 1, \u00b7 \u00b7 \u00b7 , N, j = 1, \u00b7 \u00b7 \u00b7 , M with the no-flux boundary condition (2.3). We assume the equilibrium \u03c0 satisfies (3.4) \u03c0 0,j = \u03c0 1,j , \u03c0 N +1,j = \u03c0 N,j j = 1, \u00b7 \u00b7 \u00b7 , M, \u03c0 i,0 = \u03c0 i,1 , \u03c0 i,M +1 = \u03c0 i,M i = 1, \u00b7 \u00b7 \u00b7 , N, then the no-flux boundary condition (2.3) is reduced to (3.5) \u03c1 0,j = \u03c1 1,j , \u03c1 N +1,j = \u03c1 N,j j = 1, \u00b7 \u00b7 \u00b7 , M,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Denote \u03c1 k i,j as the value of \u03c1 at t k = k\u2206t with time step size \u2206t. Now we introduce an unconditionally stable explicit time discretization for (3.3)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "for i = 1, \u00b7 \u00b7 \u00b7 , N, j = 1, \u00b7 \u00b7 \u00b7 , M with the no-flux boundary condition (3.5).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "We now further simplify (3.6) as (3.7)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Then (3.7) can be rewritten as (3.9)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Denote h := max{\u2206x, \u2206y}. From (3.9), we recast the scheme using a rescaled generator operator",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Now we state the the positivity, maximal principle, mass conservation law and ergodicity of the scheme (3.7) as follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Proposition 3.1. Let \u03c0 i,j = \u03c0(x i , y j ) > 0. Let \u2206t be the time step and consider the explicit scheme (3.6) for the numerical solution \u03c1 k i,j with (3.5). Assume the initial data \u03c1 0 > 0 satisfies",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Then we have (i) positivity preserving property",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "(iii) the unconditional maximal principle for",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "(v) the exponential convergence",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "where \u00b5 2 is the second eigenvalue of A defined in (3.26).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Proof. For (i), from (3.9), since \u03c0 > 0, we know \u03c1 k i,j > 0 implies \u03c1 k+1 i,j > 0. To prove (ii), taking summation in (3.9), we have the (3.17)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "The second term in the RHS of (3.17) is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "where we used the no-flux boundary condition (3.4). Similarly, the third term in the RHS of (3.17) is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "One can shift index for the last two terms in the RHS of (3.17) similarly. Therefore, using the no-flux boundary condition (3.5), we have the mass balance",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "To prove (iii), directly taking maximum in the RHS of (3.7) implies",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "which leads to (4.17).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "To prove (iv), subtract (1+\u2206t\u03bb i,j ) from both sides of (3.7) and then multiply by sgn \u03c1 k+1",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "i,j \u03c0 i,j \u2212 1 . Thus using same argument with (iii), we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "which implies (4.18). Now we prove (v). Recall (3.10), i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "(3.23)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "By shifting index and no-flux boundary condition (3.5) we have (3.24)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "From this, one know",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "By the Perron-Frobenius theorem, \u00b5 1 = 1 is the simple, principal eigenvalue of A with the ground state u * i,j \u2261 1 and other eigenvalues \u00b5 i of A satisfy |\u00b5 i | < \u00b5 1 . Notice also the mass conservation for initial data u 0 = \u03c1 0 \u03c0 satisfying (4.16), i.e., (3.27) u 0 \u2212 u * , u * (1+\u2206t\u03bb)\u03c0 = 0. Since also A is self-adjoint operator in the weighted space l 2 ((1 + \u2206t\u03bb)\u03c0), we can express u 0 using",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "c u , u is the eigenfunction corresponding to \u00b5 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Therefore, we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "3.1. Thresholding for sharp dynamics. In this section, we combine the thresholding scheme with the Fokker-Planck dynamics to generate the inbetween motions with sharp interface, i.e., the density is described by linear combinations of two characteristic functions. In the computations later, one will see that the thresholding scheme also helps to achieve the finite time convergence to the sharp equilibrium density. Notice the dynamics of the Fokker-Planck equation is invariant when replacing \u03c1 by c\u03c1. Therefore, the initial density shall be adjust based on the mass conservation law (3.11). After this initial adjustment, assume initial data \u03c1 0 i,j \u2208 {\u03c1 0 s , \u03c1 0 b }, which takes alternatively the value \u03c1 0 s , \u03c1 0 b . Assume the equilibrium is \u03c0 i,j \u2208 {\u03c0 s , \u03c0 b } which takes alternatively the value \u03c0 s , \u03c0 b . To combine the thresholding scheme with the Fokker-Planck dynamics, we need to choose the threshold \u03be k at each step to conserve (3.13) as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Step 1. Given \u03c1 k i,j \u2208 {\u03c0 s , \u03c0 b }, compute the explicit Fokker-Planck scheme (3.7) to updat\u1ebd \u03c1 k+1 i,j \u2208 [\u03c0 s , \u03c0 b ] for any i = 1, 2, \u00b7 \u00b7 \u00b7 , N and j = 1, 2, \u00b7 \u00b7 \u00b7 , M .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Step 2. Choose threshold \u03be k+1 and define (3.31) \u03c1 k+1 i,j := \u03c0 s \u03c7 {i,j;\u03c1 k+1 i,j \u2264\u03be k+1 } + \u03c0 b \u03c7 {i,j;\u03c1 k+1 i,j >\u03be k+1 } such that \u03c1 k+1 satisfies (3.13).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "In",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Step 2, \u03be k+1 can be found using bisection such that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "4. EDDA based on point-clouds: Fokker-Plank equation on N Suppose (N , d N ) is a d dimensional smooth closed submanifold of R 3 . Assume the end image on N is described by a equilibrium density \u03c1 \u221e (x) : N \u2192 R. Then the Fokker-Planck equation is given by",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 66,
                    "end": 76,
                    "text": "(N , d N )",
                    "ref_id": null
                }
            ],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "This can be recast as the relative entropy formulation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "4.1. Construction of Voronoi tessellation and the upwind scheme on manifold N .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "In this section, we construct an upwind scheme based on Voronoi tessellation for manifold N , which automatically gives a positive-preserving upwind scheme for the Fokker-Planck (4.1). Suppose (N , d N ) is a d dimensional smooth closed submanifold of R 3 and d N is induced by the Euclidean metric in R 3 . Q := {y i } n i=1 are sampled from the equilibrium density \u03c0 = \u03c1 N \u221e . Define the Voronoi cell as for any j = 1, \u00b7 \u00b7 \u00b7 , n. If \u0393 ij = \u2205 or i = j then we set |\u0393 ij | = 0. Let \u03c7 C i be the characteristic function such that \u03c7 C i = 1 for y \u2208 C i and 0 otherwise. For i = 1, \u00b7 \u00b7 \u00b7 , n,",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 193,
                    "end": 203,
                    "text": "(N , d N )",
                    "ref_id": null
                }
            ],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "is the piecewise constant probability distribution on N provided n i=1 \u03c1 i |C i | = 1 and \u03c1 i \u2265 0. Let \u03c0 i be the approximated equilibrium density at y i satisfying n i=1 \u03c0 i |C i | = 1. If \u03c1 approx (y) = i \u03c1 i \u03c7 C i (y) is an approximation of density \u03c1 N (y), then \u03c1 i is an approximation of the density \u03c1 N (y i ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Define the associated adjacent grids as Then using the finite volume method and the divergence theorem on manifold, we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "where n is the unit outward normal vector field on \u2202C i . Based on this, we introduce the following upwind scheme. For i = 1, \u00b7 \u00b7 \u00b7 , n,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "We now interpret the upwind scheme as the forward equation for a Markov process with transition probability P ij (from j to i) and jump rate \u03bb j",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "where (4.9)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "|\u0393 ij |, i = 1, 2, \u00b7 \u00b7 \u00b7 , n;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "One can see it satisfies i P ij = 1 and the detailed balance property (4.10) P ij \u03bb j \u03c0 j |C j | = P ji \u03bb i \u03c0 i |C i |.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "We refer to [GLW20] for the ergodicity of this Markov process.",
            "cite_spans": [
                {
                    "start": 12,
                    "end": 19,
                    "text": "[GLW20]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "In practice, instead of the |C i |, \u0393 ij in (4.8), one shall use the approximated coefficientsC i and \u0393 ij because we do not know the exact metric information of the manifold based only on point clouds. We omit the algorithm of finding the approximatedC i and\u0393 ij and refer to [GLW20] . 4.2. Unconditional stable explicit time stepping and exponential convergence. Now we propose an unconditionally stable explicit time discretization for the upwind scheme (4.7), which enjoys several good properties as the scheme (3.6), such as maximal principle, mass conservation law and exponential convergence.",
            "cite_spans": [
                {
                    "start": 277,
                    "end": 284,
                    "text": "[GLW20]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Let \u03c1 k i be the discrete density at discrete time k\u2206t. To achieve both stability and efficiency, we introduce the following unconditional stable explicit scheme We give the following proposition for several properties of scheme (4.11). The proof of this proposition is similar to Proposition 3.1 so we omit it.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Proposition 4.1. Let \u2206t be the time step and consider the explicit scheme (4.11). Assume the initial data satisfies",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Then we have (i) the conversational law for g k+1",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "(4.16)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "(iv) the exponential convergence",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "where \u00b5 2 is the second eigenvalue of I +\u2206tB (in terms of magnitude), i.e. \u00b5 2 = 1\u2212gapB\u2206t and gapB is the spectral gap ofB.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EDDA based on structured grids"
        },
        {
            "text": "Thresholding for sharp dynamics. Assume the initial density is adjusted based on the mass conservation law (4.15). We now give the sharp dynamics by combining the Fokker-Planck equation on manifold with the thresholding scheme. Assume initial data \u03c1 0 i \u2208 {\u03c1 0 s , \u03c1 0 b }, which takes alternatively the value \u03c1 0 s , \u03c1 0 b . Assume the equilibrium is \u03c0 i \u2208 {\u03c0 s , \u03c0 b } which takes alternatively the value \u03c0 s , \u03c0 b . Similar to Section 3.1, we choose the threshold \u03be k at each step to conserve (4.15) as follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4.3."
        },
        {
            "text": "Step 1. Given \u03c1 k i \u2208 {\u03c0 s , \u03c0 b }, compute the explicit scheme (4.11) to update\u03c1 k+1 i \u2208 [\u03c0 s , \u03c0 b ] for any i = 1, 2, \u00b7 \u00b7 \u00b7 , n.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4.3."
        },
        {
            "text": "Step 2. Choose threshold \u03be k+1 and define such that \u03c1 k+1 satisfies (4.15). Here \u03be k+1 can be found using bisection such that ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4.3."
        },
        {
            "text": "In this section, three numerical examples are carried out to examine the capability and efficiency of the equilibrium-driven deformation algorithm (EDDA), which are the RGB colored facial aging transformation, the pneumonia of COVID-19 invading and fading away on CT scan images and the continental evolution process. 5.1. Example I: RGB colored facial aging transformation. In this example, we have two images with the same size in the RGB color model showing a ladys face at two different age, and employ the model to simulate the transformation from one image (initial) to another image (equilibrium), which will illustrate the facial aging process with time. The strategy is to define each image as three matrices, each matrix containing the value of a color mode (R or G or B). Then the transformation between the two images is completed by applying the inbetweening auto-animation three times based on Fokker-Planck dynamics (2.1).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computations"
        },
        {
            "text": "The two images are extracted from [Posml] and are both 355 pixels in width and 575 pixels in height, which means a total of 204125 pixel points in each image. The initial image data is first adjusted to meet the mass conservation law (3.11). Time step \u2206t is set to 0.01 and the total number of iterations is set to 10000 thus the final iteration time T = 100. The horizontal resolution \u2206x and \u2206y are both 10 \u22124 . We use the unconditional stable explicit time stepping scheme (3.6) and the no-flux boundary condition (3.5) to the Fokker-Planck equation (2.1) in domain \u2126.",
            "cite_spans": [
                {
                    "start": 34,
                    "end": 41,
                    "text": "[Posml]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Computations"
        },
        {
            "text": "The relative root mean square errors (3.16) for the three color-modes are illustrated in Fig.  1 separately in semiology plot. Except for the different descend rates for the three colors, all simulated errors have the exponential convergence rates, which is consistent with the analysis in Proposition 3.1.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 89,
                    "end": 96,
                    "text": "Fig.  1",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Computations"
        },
        {
            "text": "In order to see the transformation process between the two images, the images after iteration step 40, 100, 200, 400, 1000, 2000, 4000 and 10000 are shown and compared with the initial and the equilibrium images in Fig. 2 . The transformation process between two images are fast in the beginning (e.g. before step 200) and relatively slow after then. The transformation process in Fig. 2 clearly reveals the potential changes in different parts of the ladys face and hair with time. After 10000 steps of iterations, the updated image is nearly the same with the equilibrium except for the hair color.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 215,
                    "end": 221,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 381,
                    "end": 387,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Computations"
        },
        {
            "text": "Example II: COVID-19 pneumonia invading and fading away on CT scan images. In this section we will focus on an example based on the COVID-19 pneumonia invading and fading away process in a patients lung reflected on CT scan images and try to show the possible COVID-19 pneumonia growth dynamics with time before and after the treatment. In order to fulfill the task, two parts of simulations are presented. In the first part, two CT scan images taken on a patients lungs in the beginning (January 23th) and severe state (February 2nd) of the disease [ZL20] are selected to be the initial and equilibrium state, respectively; see Fig. 3 (left) . In the second part, two scan images at the severe state (February 2nd) and after a few-days treatment (February 9th) are selected to be the initial and equilibrium state, respectively; see Fig. 3 (right) . Each CT scan image can be represented by a gray scale image matrix thus the same method in Example I can be applied. The CT scan images are all cropped to 461 pixels in width and 370 pixels in height, which means a total of 170570 pixel points in each image. The time step \u2206t is 0.01 and the total number of iterations is 6000 thus the final iteration time T = 60. The resolutions are \u2206x = \u2206y = 10 \u22124 .",
            "cite_spans": [
                {
                    "start": 550,
                    "end": 556,
                    "text": "[ZL20]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [
                {
                    "start": 629,
                    "end": 642,
                    "text": "Fig. 3 (left)",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 834,
                    "end": 848,
                    "text": "Fig. 3 (right)",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "5.2."
        },
        {
            "text": "After 6000 iterations, the relative root mean square errors from two parts of simulations both decrease with an exponential rate, as is shown in Fig. 4 . Moreover, the image evolution after step 20, 50, 100, 200, 500, 1000, 5000, 10000 (see Fig. 5 ) clearly demonstrate the pneumonia invading process into the patients lungs caused by COVID-19 in a few days (upper group of figures in Fig. 5 ) and the pneumonia fading away from the lungs after a stem cell treatment is applied to the patient (lower group of figures in Fig. 5 ), indicating a potential success of this treatment [ZL20] . We can further compare the evolution process with the real CT scan images taken on January 30th (see Fig. 3 ) and find satisfactory agreements, which indicates promising applications in this field. 5.3. Example III: Continental evolution process with thresholding for sharp dynamics. In this section, we try to reveal the evolution process of continentals in the world from Pangaea supercontinent (250 million years ago) to the current globe. In order to clearly distinguish the sharp dynamics evolving the continentals and the oceans, the thresholding scheme (4.20) and the Fokker-Planck dynamics (4.11) are combined to generate the inbetweening motions with the above sharp interfaces. The numerical experiment is carried out as follows.",
            "cite_spans": [
                {
                    "start": 579,
                    "end": 585,
                    "text": "[ZL20]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [
                {
                    "start": 145,
                    "end": 151,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 241,
                    "end": 247,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF9"
                },
                {
                    "start": 385,
                    "end": 391,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF9"
                },
                {
                    "start": 520,
                    "end": 526,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF9"
                },
                {
                    "start": 689,
                    "end": 695,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "5.2."
        },
        {
            "text": "Step (I). A group of points is selected on a unit sphere to be the dataset points. With the Centroidal Voronoi Tessellation (CVT) method on the unit sphere [Ren97, DGJ03] , the Voronoi cells on the unit sphere are generated and the locations of dataset points are adjusted accordingly to ensure the uniformity of these cells. Thus, the distributions of continentals and oceans derived from Pangaea period and current globes topography are described by two values (i.e. \u03c0 s and \u03c0 b ) on the Voronoi cells and are set to be the initial and equilibrium states, respectively. The Voronoi cell area C i , i = 1, \u00b7 \u00b7 \u00b7 , n, with the total number of dataset points n, is computed and the Voronoi face \u0393 ij is determined by the geodesic length of the neighboring arc between cell i and j.",
            "cite_spans": [
                {
                    "start": 156,
                    "end": 163,
                    "text": "[Ren97,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 164,
                    "end": 170,
                    "text": "DGJ03]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "5.2."
        },
        {
            "text": "Step (II). Update the density at each point using the explicit scheme (4.11) linear Fokker-Planck equation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "5.2."
        },
        {
            "text": "Step (III). After several linear iteration steps, the threshold is selected following the steps in Section 4.3 and the thresholding scheme is applied to update the data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "5.2."
        },
        {
            "text": "The computations for Step (II) and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "5.2."
        },
        {
            "text": "Step (III) will be looped until reaches the total iteration steps. Besides, a simulation case which only evolves the linear Fokker-Planck equation is carried out as the comparison.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "5.2."
        },
        {
            "text": "For example III, we select a total of 3000 dataset points and generate the Voronoi cells on the unit sphere via the CVT approximation algorithm; see Fig. 6 The standard deviation for all the cell areas is 3.2 \u00d7 10 \u22124 , which means the nearly uniform distributions of data points on the sphere. The values at continental cells and the ocean cells are set to 0.9 and 0.1, respectively. The time step \u2206t is set to 0.05 and the total number of linear iterations before the (k + 1)th thresholding adjustment is set to 2k, k = 1, \u00b7 \u00b7 \u00b7 , N t , where N t = 50 is the times of the thresholding adjustments. The threshold \u03be k is determined by bisection method such that (4.21) is satisfied. Here, the bisection domain limitation criterion is set to 10 \u22126 . The total number of iterations for the comparison simulation is set to be 10000. Table 1 . Comparison of the needed steps to reach the criterions between linear method and threshold method. Fig. 7 shows the temporal variations of the relative root mean square errors for the numerical example in the first 1200 time steps. The error from the thresholding method generally have a descend trend although with some abrupt increase due to the thresholding adjustments. The error decreases to nearly zero (less than the machine accuracy) after the 30th thresholding adjustment (a total of 960 time steps), which indicates the data is updated to the equilibrium. As a comparison, the error of the simulation via the linear method (red line in Fig. 7) , which leads an exponential convergence rate, is smaller than that from thresholding method before the 960th time step (black circle in Fig. 7) and is larger after then. In order to further compare the efficiency of the two methods, we calculated the total time steps needed for the error to reach the criterions and listed them in Table 1 . The comparisons clearly reveal the efficiency of the thresholding adjustment in the application of the sharp dynamics, especially when the criterion is small.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 149,
                    "end": 155,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF10"
                },
                {
                    "start": 829,
                    "end": 836,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 938,
                    "end": 944,
                    "text": "Fig. 7",
                    "ref_id": "FIGREF11"
                },
                {
                    "start": 1485,
                    "end": 1492,
                    "text": "Fig. 7)",
                    "ref_id": "FIGREF11"
                },
                {
                    "start": 1630,
                    "end": 1637,
                    "text": "Fig. 7)",
                    "ref_id": "FIGREF11"
                },
                {
                    "start": 1826,
                    "end": 1833,
                    "text": "Table 1",
                    "ref_id": null
                }
            ],
            "section": "5.2."
        },
        {
            "text": "The continental evolution on the sphere after the 2th, 5th, 10th, 30th thresholding adjustment is illustrated and compared with the initial and equilibrium states in Fig. 8 . After several steps of thresholding adjustment, the sharp shapes of continentals quickly move from the initial Pangaea supercontinent towards the equilibrium state of current continentals. The distributions of continentals and oceans reaches the equilibrium state after the 28th thresholding adjustment, Figure 8 . The evolutions of continental movements on the unit sphere with the parameter \u2206t = 0.05 and the total number of the thresholding adjustments is N t = 50. The continental evolution on the sphere after the 2th, 5th, 10th, 30th thresholding adjustment are illustrated and compared with the initial and equilibrium states. The black dots and polygons in each subplot illustrate the point clouds and the Voronoi cells, respectively. The orange and blue patch indicate the land and ocean, respectively. TH is short for thresholding step. The formation of the Antarctic is revealed at the bottom (southern part) of the globe (black arrow in TH 5). Note that the globes are shown in the same view angle so the Antarctic continental is out of view in the last two subplots. exactly the same as the current distributions. Although the evolution of the continental movements is simulated with the data-driven model, some potential dynamics of continental drifting such as the Antarctic formation can be noticed in the evolutions, which may contribute to the detailed explanation of the continental drifting theory.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 166,
                    "end": 172,
                    "text": "Fig. 8",
                    "ref_id": null
                },
                {
                    "start": 479,
                    "end": 487,
                    "text": "Figure 8",
                    "ref_id": null
                }
            ],
            "section": "5.2."
        },
        {
            "text": "We propose an efficient and universal equilibrium-driven deformation algorithm (EDDA) to simulate the inbetweening transformations given an initial and equilibrium. The algorithm automatically cooperates positivity, unconditional stability, mass conservation law, exponentially convergence and also the manifold structure suggested by dataset. Using EDDA, three challenging examples, (I) facial aging process, (II) COVID-19 invading/treatment process, and (III) continental evolution process are conducted efficiently. EDDA is shown to be a very efficient and universal method with enormous potential applications in other fields of science and industry.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Fully automatic generation of anatomical face simulation models",
            "authors": [
                {
                    "first": "Michael",
                    "middle": [],
                    "last": "Cbe + 15] Matthew Cong",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Bao",
                    "suffix": ""
                },
                {
                    "first": "L E",
                    "middle": [],
                    "last": "Jane",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Kiran",
                    "suffix": ""
                },
                {
                    "first": "Ronald",
                    "middle": [],
                    "last": "Bhat",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Fedkiw",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Proceedings of the 14th ACM SIGGRAPH/Eurographics Symposium on Computer Animation",
            "volume": "",
            "issn": "",
            "pages": "175--183",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Voronoi-based finite volume methods, optimal voronoi meshes, and pdes on the sphere",
            "authors": [
                {
                    "first": "Qiang",
                    "middle": [],
                    "last": "Du",
                    "suffix": ""
                },
                {
                    "first": "Max",
                    "middle": [
                        "D"
                    ],
                    "last": "Gunzburger",
                    "suffix": ""
                },
                {
                    "first": "Lili",
                    "middle": [],
                    "last": "Ju",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Computer Methods in Applied Mechanics and Engineering",
            "volume": "192",
            "issn": "3536",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Thierry Gallou\u00ebt, and Rapha\u00e8le Herbin. Finite volume methods. Handbook of numerical analysis",
            "authors": [
                {
                    "first": "Robert",
                    "middle": [],
                    "last": "Eymard",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "",
            "volume": "7",
            "issn": "",
            "pages": "713--1018",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Data-driven efficient solvers and predictions of conformational transitions for langevin dynamics on manifold in high dimensions",
            "authors": [
                {
                    "first": "Yuan",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "Jian-Guo",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "Nan",
                    "middle": [],
                    "last": "Wu",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Can your face reveal how long you'll live?",
            "authors": [
                {
                    "first": "Washington",
                    "middle": [],
                    "last": "Post",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Algorithm 772: Stripack: Delaunay triangulation and voronoi diagram on the surface of a sphere",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Robert",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Renka",
                    "suffix": ""
                }
            ],
            "year": 1997,
            "venue": "ACM Transactions on Mathematical Software (TOMS)",
            "volume": "23",
            "issn": "3",
            "pages": "416--434",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Transplantation of ace mesenchymal stem cells improves the outcome of patients with covid-19 pneumonia",
            "authors": [],
            "year": 2018,
            "venue": "Marc Stamminger, Matthias Nie\u00dfner, and Christian Theobalt",
            "volume": "11",
            "issn": "",
            "pages": "523--550",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "2D domain \u2126 := [a, b] \u00d7 [c, d]. Let the grid size be \u2206x = b\u2212a N , \u2206y = d\u2212c M . Define the cells as (3.1)",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "C i := {y \u2208 N ; d N (y, y i ) \u2264 d N (y, y j ) for all y j \u2208 Q}, with the volume |C i | = H d (C i ). Then N = \u222a n i=1 C i is a Voronoi tessellation of manifold N . One can see each C i is star shaped. Denote the Voronoi face for cell C i as (4.4) \u0393 ij := C i \u2229 C j , and its area as |\u0393 ij | = H d\u22121 (\u0393 ij )",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "(i) := {j; \u0393 ij = \u2205}.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": ".14)B := {b ij } = \u2212 \u03bb i 1+\u03bb i \u2206t , j = i; \u03bb i 1+\u03bb i \u2206t P ji , j = i., with jb ij = 0.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "k+1 } + \u03c0 b \u03c7 {i;\u03c1 k+1 i >\u03be k+1 } , i = 1, 2, \u00b7 \u00b7 \u00b7 , n",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "The semilog plot of temporal evolution of relative root mean square errors for the RGB facial aging transformation with parameters \u2206t = 0.01, T = 100 and \u2206x = \u2206y = 10 \u22124 . The red, green and blue lines represent the relative errors of the corresponding color modes.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Facial aging transformation from initial to equilibrium with parameters \u2206t = 0.01, T = 100 and \u2206x = \u2206y = 10 \u22124 . The updated results after time step 40, 100, 200, 400, 1000, 2000, 4000, 10000 are shown and compared to the initial and equilibrium images.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Chest CT images of the critically severe COVID-19 patient[ZL20]. The left column of figures illustrates the evading of pneumonia from January 23th to February 2nd and the right column illustrates the fading away of pneumonia from February 2nd to February 15th after treatment.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "The semilog plot of temporal evolution of the relative root mean square errors for COVID-19 pneumonia invading and fading away on CT scan images with the parameters \u2206t = 0.01, T = 100 and \u2206x = \u2206y = 10 \u22124 . (up) The error evolution for the pneumonia invading process simulation. (down) The error evolution for the pneumonia fading away process simulation.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "The simulated COVID-19 pneumonia invading and fading away process on CT scan images with the parameters \u2206t = 0.01, T = 100 and \u2206x = \u2206y = 10 \u22124 . Results after the step 20, 50, 100, 200, 500, 1000, 2000, 5000 are illustrated and compared to the initial and equilibrium scan images. The white part inside the lungs shown on images indicates the evidence of pneumonia. (up) The pneumonia invades into the patients lungs caused by COVID-19. (down) The pneumonia fades away from the lungs after a stem cell treatment is applied to the patient.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "The unit sphere and the Voronoi cells on it. There are totally 3000 cells on the sphere. The red dots indicate locations of the point clouds on the sphere. The polygons with red edges are the Voronoi polygons generated with CVT algorithm.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "The semilog plot of temporal evolution of relative root mean square errors for the continental evolution process with thresholding for sharp dynamics with \u2206t = 0.05 and the total number of the thresholding adjustments is N t = 50. The linear iterations before the (k + 1)th thresholding adjustment is 2k. The red line indicates the error of simulations with only the linear Fokker-Planck algorithm while the blue line is the error of the linear algorithm combined with the thresholding scheme. The black dotted lines indicate the time steps when the thresholding adjustments are applied.",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": []
}