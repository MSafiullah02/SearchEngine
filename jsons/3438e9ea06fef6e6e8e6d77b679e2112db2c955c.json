{
    "paper_id": "3438e9ea06fef6e6e8e6d77b679e2112db2c955c",
    "metadata": {
        "title": "Robust computational design and evaluation of 1 peptide vaccines for cellular immunity with 2 application to SARS-CoV-2 3",
        "authors": [
            {
                "first": "Ge",
                "middle": [],
                "last": "Liu",
                "suffix": "",
                "affiliation": {
                    "laboratory": "MIT Computer Science and Artificial Intelligence Laboratory",
                    "institution": "",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Brandon",
                "middle": [],
                "last": "Carter",
                "suffix": "",
                "affiliation": {
                    "laboratory": "MIT Computer Science and Artificial Intelligence Laboratory",
                    "institution": "",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Trenton",
                "middle": [],
                "last": "Bricken",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Duke University",
                    "location": {
                        "settlement": "Durham",
                        "region": "North Carolina",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Siddhartha",
                "middle": [],
                "last": "Jain",
                "suffix": "",
                "affiliation": {
                    "laboratory": "MIT Computer Science and Artificial Intelligence Laboratory",
                    "institution": "",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Mathias",
                "middle": [],
                "last": "Viard",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Duke University",
                    "location": {
                        "settlement": "Durham",
                        "region": "North Carolina",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Mary",
                "middle": [],
                "last": "Carrington",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Ragon Institute of MGH",
                    "location": {
                        "addrLine": "MIT, and Harvard",
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "David",
                "middle": [
                    "K"
                ],
                "last": "Gifford",
                "suffix": "",
                "affiliation": {
                    "laboratory": "MIT Computer Science and Artificial Intelligence Laboratory",
                    "institution": "",
                    "location": {
                        "settlement": "Cambridge",
                        "region": "MA",
                        "country": "USA"
                    }
                },
                "email": "11*gifford@mit.edu"
            }
        ]
    },
    "abstract": [
        {
            "text": "We present a combinatorial machine learning method to evaluate and optimize peptide vaccine formulations, and we find for SARS-CoV-2 that it provides superior predicted display of viral epitopes by MHC class I and MHC class II molecules over populations when compared to other candidate vaccines. Our method is robust to idiosyncratic errors in the prediction of MHC peptide display and considers target population HLA haplotype frequencies during optimization. To minimize clinical development time our methods validate vaccines with multiple peptide presentation algorithms to increase the probability that a vaccine will be effective. We optimize an objective function that is based on the presentation likelihood of a diverse set of vaccine peptides conditioned on a target population HLA haplotype distribution and expected epitope drift. We produce separate peptide formulations for MHC class I loci (HLA-A, HLA-B, and HLA-C) and class II loci (HLA-DP, HLA-DQ, and HLA-DR) to permit signal sequence based cell compartment targeting using nucleic acid based vaccine platforms. Our SARS-CoV-2 MHC class I vaccine formulations provide 93.21% predicted population coverage with at least five vaccine peptide-HLA hits on average in an individual (\u2265 1 peptide 99.91%) with all vaccine peptides perfectly conserved across 4,690 geographically sampled SARS-CoV-2 genomes. Our MHC class II vaccine formulations provide 90.17% predicted coverage with at least five vaccine peptide-HLA hits on average in an individual with all peptides having observed mutation probability \u2264 0.001. We evaluate 29 previously published peptide vaccine designs with our evaluation tool with the requirement of having at least five vaccine peptide-HLA hits per individual, and they have a predicted maximum of 58.51% MHC class I coverage and 71.65% MHC class II coverage given haplotype based analysis. We provide an open source implementation of our design methods (OptiVax), vaccine evaluation tool (EvalVax), as well as the data used in our design efforts. 17 1 Introduction 18",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Peptide vaccines elicit a protective adaptive immune response to either cancer or infectious agent antigens to immunize against 19 and combat ongoing disease [1, 2]. Their component peptides present undesired epitopes as 3D structural protein subunits or 20 MHC displayed peptides to train the adaptive immune system to mount a response to a threat. T and B cells use their respective 21 receptors to recognize vaccine presented epitopes to trigger activation and expansion of their response to the displayed epitopes.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "The activated and expanded T and B cells can then effectively mount a response against pathogens or tumor cells. Peptide 23 vaccines are presently in development for cancer [3] and viral diseases including HIV [4], HCV, and Malaria [2, 5]. An HPV 24 peptide vaccine is currently licensed for humans and encodes the sequence of two viral peptides that induce both CD4+ and 25 CD8+ T cell responses [6]",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": ".",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "The precise control of antigenic T cell recognized epitopes afforded by peptide vaccines has been proposed to reduce the 27 risks posed by conventional vaccine approaches. For example, the conventional vaccine tetravalent dengue vaccine (CYD-TDV) 28 increases the risk of hospitalization when an individual is infected with dengue for the first time. A study considered patients 29 from 2 to 16 years of age that had not been infected at the time of vaccination but were infected post vaccination. The increased 30 risk of hospitalization was thought to occur by antibody-dependent enhancement (ADE) by sub-neutralizing responses to the 31 infecting dengue serotype [7]. A peptide based dengue vaccine has been proposed to induce CD4+ and CD8+ T cell response 32 to dengue that would avoid ADE [8]. Given the multiple strains of coronavirus in circulation, considerations of ADE, immune 33 enhancement, and other deleterious effects of vaccination need to be considered [9].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Here we focus on eliciting immunity by the adaptive immune system that is mediated by cells (cellular immunity). Cellular 35 immunity can be induced with peptide vaccines that cause Major Histocompatibility Complex (MHC) molecules to display 36 undesired epitopes on cell surfaces. Class I MHC molecules typically display peptides from a cell's internal workings, while 37 class II MHC molecules display peptides from a cell's external environment that are taken up by professional antigen presenting 38 cells by phagocytosis, and then made available for loading onto MHC class II molecules for cell surface display for T cell 39 surveillance. CD8+ T cells recognize cells that are displaying non-self peptides on their class I MHC molecules and target 40 the cells for destruction, while CD4+ T cells recognize non-self peptides on class II MHC molecules on professional antigen 41 presenting cells and help prime the activation of CD8+ cells and antibody producing B cells. The production of a strong cellular 42 immunity response to either a tumor or viral infection is important for positive patient outcomes. Cellular immunity is durable, 43 and thus an important component of lasting immunity to viral infection. 44 There are multiple delivery platforms for peptide vaccines, including the direct injection of peptides in carriers and the 45 delivery of recombinant nucleic acid that is turned into peptides by a patient's cells. Recombinant nucleic acid delivery of 46 vaccine formulations as either DNA or RNA has the advantage that it harnesses a patient's own cells to transiently manufacture 47 vaccine peptides. Recombinant nucleic acid vectors can be quickly adapted to new payloads. DNA or RNA can be delivered to 48 cells via nanoparticles, non-pathogenic viruses, or other methods. DNA vaccines have the disadvantage that their DNA must 49 be transported to the nucleus for transcription in mRNA. RNA vaccines can be delivered encapsulated in lipid nanoparticles 50 that cells endocytose into the cytosol and translate into peptides [8, 10]. Peptides in a vaccine can be prepended with a signal 51",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "sequence to stay within a cell's cytosol for class I display, or be prepended with a different sequence to be transported the 52 outside of a cell for class II display [11, 12]. A single mRNA molecule can be used to express class I and class II peptides with 53 each class represented by an array of peptides separated by a 2A self-cleaving peptide site [13]. If desired, class II peptides can 54 be fused to a protein subunit that is designed to elicit B cell responses and expressed in the same single mRNA molecule. In 55 addition, class II peptides can be linked to Ii-Key peptides to enhance their presentation [14].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "A challenge for the design of peptide vaccines is the diversity of human MHC alleles that each have specific preferences 57 for the peptide sequences they will display. The Human Leukocyte Antigen (HLA) locus encodes the class I and class II 58 MHC genes. We consider three loci that encode for MHC class I molecules (HLA-A, HLA-B, and HLA-C) and three loci that 59 encode MHC class II molecules (HLA-DR, HLA-DQ, and HLA-DP). An individual's HLA type describes the MHC alleles 60 they contain at each of these loci. Peptides of length 8-10 residues can bind to MHC class I molecules whereas those of length 61 13-25 bind to MHC class II molecules [15, 16].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "To create effective vaccines it is necessary to consider the MHC allelic frequency in the target population, as well as linkage 63 disequilibrium between MHC genes to discover a set of peptides that is likely to be robustly displayed. Human populations 64 that originate from different geographies have differing frequencies of MHC alleles, and these populations exhibit linkage 65 disequilibrium between HLA loci that result in population specific haplotype frequencies. We utilize haplotype frequencies of 66 three populations in the design and evaluation of our vaccine candidates.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Recent advances in machine learning have produced models that can predict the presentation of peptides by hundreds 68 of allelic variants of both class I and class II MHC molecules [17, 18, 19, 20, 21]. These models are evaluated on their 69 ability to accurately predict data unobserved during their training on hundreds of MHC alleles. Each method has its strengths 70 and weaknesses. Given that different models may be more or less accurate for different sequence families and can make 71 idiosyncratic errors, we use an ensemble of models for vaccine design. We evaluate completed designs using eleven models to 72 provide a conservative evaluation of vaccine peptide presentation. 73 Previous peptide vaccine design and evaluation methods do not utilize the distribution of MHC haplotypes in a population, 74 and thus can not accurately assess the coverage provided by a vaccine. These methods include VaxRank [22] that considers 75 vaccine design for a single individual, and methods that do not take into account rare MHC allelic combinations including 76 iVax [23], and SARS-CoV-2 specific efforts [24]. The IEDB Population Coverage Tool [25] estimates peptide-MHC binding 77 coverage and the distribution of peptides displayed for a given population but assumes independence between different loci and 78 thus does not consider linkage disequilibrium.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "79",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "We consider methods for vaccine design within the following framework and assumptions. A method takes as input: the 80 target proteome, the target proteome's expected or observed conservation at amino acid resolution, and the target human 81 population for vaccination, expressed in terms of the frequencies of their HLA haplotypes. A method outputs: a candidate set 82 of MHC class I and a set of class II vaccine peptides. Target proteomes can be viral or oncogenes. Our methods eliminate 83 peptides that are expected to be glycosylated, peptides that are expected to drift in sequence and thus cause vaccine escape, and 84 peptides that are identical to peptides in the human proteome. Vaccine peptides can be drawn from the entire proteome or from 85 2 We provide two methods for peptide vaccine evaluation, one that does not consider haplotype frequencies, EvalVax-87 Unlinked, and one that considers haplotype frequencies and computes the number of peptides predicted to be associated with 88 population haplotypes, EvalVax-Robust. We employ these methods as objective functions for peptide vaccine formulation by 89 combinatorial optimization in OptiVax-Unlinked and OptiVax-Robust. Using conservative metrics of peptide-MHC binding we 90 find that our optimization methods provide both a higher likelihood of peptide display as well as a larger number of associated 91 peptides than other published SARS-CoV-2 peptide vaccine designs with less than 150 peptides. 92 2 Methods 93 2.1 Datasets 94 A proteome is converted into candidate vaccine peptides Given a target proteome as input, we identify all potential T cell 95 epitopes for inclusion in a vaccine. We extract peptides of length 8-10 inclusive for consideration of MHC class I [15] binding 96 and peptides of length 13-25 inclusive for class II [16] binding by using sliding windows of each size over the entire proteome.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "97",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "While peptides presented by MHC class I molecules can occasionally be longer than 10 residues [26], we conservatively limit 98 our search to length 8-10 since MHC class I presented peptides are predominately 8-10 residues in length [15].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Using this sliding window approach, we created peptide sets from the SARS-CoV-2 (COVID-19) and SARS-CoV (Human 100 SARS coronavirus) proteomes. SARS-CoV-2 was processed to discover relevant peptides for a vaccine, and SARS-CoV was 101 processed to reveal common peptides between the two viruses during evaluation. The SARS-CoV-2 proteome is comprised 102 of four structural proteins (E, M, N, and S) and at least six additional ORFs encoding nonstructural proteins, including 103 the SARS-CoV-2 protease [27, 28]. We obtained the SARS-CoV-2 viral proteome from the GISAID [29] sequence entry 104 Wuhan/IPBCAMS-WH-01/2019, the first documented case. We used Nextstrain [30] to identify open reading frames (ORFs) 105 and translate the sequence. Our sliding windows on SARS-CoV-2 resulted in 29,403 candidate peptides for MHC class I 106 and 125,593 candidate peptides for MHC class II. We obtained the SARS-CoV proteome from UniProt [31] under Proteome 107 ID UP000000354. For SARS-CoV, our procedure creates 29,661 and 126,711 unique peptides for MHC class I and class II, 108 respectively. 109 MHC population frequency computation When we compute the probability of vaccine coverage over a population we use 110 complementary methods that assume either independence or linkage between allele frequencies in genomically proximal HLA 111 loci. In EvalVax-Unlinked (Section 2.4.2) we assume independence and use MHC allelic frequencies for 2392 class I alleles and 112 280 class II alleles from the dbMHC database [32] obtained from the IEDB Population Coverage Tool [25]. In EvalVax-Robust 113 (Section 2.4.1) we assume linkage and use observed haplotype frequencies of HLA-A, HLA-B, and HLA-C loci for class I 114 computations, or observed haplotype frequencies of HLA-DP, HLA-DQ, and HLA-DR for class II computations. We observed 115 a total of 2138 distinct haplotypes for the HLA class I locus that include 230 different HLA-A, HLA-B, and HLA-C MHC 116 alleles. We observed a total of 1711 distinct haplotypes for the HLA class II locus that include 280 different HLA-DP, HLA-DQ, 117 and HLA-DR MHC alleles. We have independent haplotype frequency measurements for White, Black, and Asian populations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "118 380",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "precision over recall. To provide coverage for individuals with rare HLA types we use haplotype frequencies that include these 381 types in our evaluations. We provide an evaluation tool, EvalVax, to permit the flexible analysis of vaccine proposals on key 382 metrics, including population coverage and the expected number of peptides displayed. Not surprisingly, our OptiVax vaccine 383 designs that are optimized with respect to EvalVax objective functions do well on the same metrics. We also find that OptiVax 384 designs do well when evaluated on eleven computational models of peptide MHC binding, providing encouragement that their 385 component peptides will be displayed.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "EvalVax can be used for vaccine designs that are focused on the expression of viral proteins or their subunits to evaluate 387 the level of viral peptide MHC presentation that is predicted to result. We note for SARS-CoV-2 in Table 1 that S protein and 388 the S1 subunit both are limited in their predicted ability to provide robust population coverage for MHC class II display of 389 more than five viral epitopes. This suggests that vaccines that only employ the S protein or its subunits may require additional 390 peptide components for reliable CD4+ T cell activation across the entire population. 391 At present the World Health Organization lists 79 COVID-19 vaccine candidates in clinical or preclinical evaluation [70], 392 and the precise designs of most of these vaccines are not public. We encourage the early publication of vaccine designs to 393 enable collaboration and rapid progress towards safe and effective vaccines for COVID-19. 394 All of our software and data are freely available as open source to allow others to use and extend our methods. 395 Acknowledgements 396 Michael Birnbaum, Brooke Huisman, and Jonathan Krog provided helpful discussions. Viral sequences are from GISAID (see 397 acknowledgement spreadsheet).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 226,
                    "end": 233,
                    "text": "Table 1",
                    "ref_id": null
                }
            ],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "For each racial background, HLA class I and class II haplotypes were inferred using Hapferret [33] an implementation of the 129 Expectation-Maximization algorithm [34] . A total of 1200, 779, and 440 class I and 920, 537, and 502 class II haplotype 130 frequencies were derived in Black, White, and Asian populations, respectively. Computational models For a peptide vaccine to be effective, its constituent peptides need to be displayed, and thus a 133 computational vaccine design must be built upon a solid predictive foundation of what peptides will be displayed by each 134 MHC allele. Incorrect predictions could lead to failure of a pre-clinical or clinical trial at great human cost. To this end we are 135 concerned with the precision (true positives / all positives) of our predictions such that we maximize the chance that a peptide 136 predicted to be displayed will in fact be displayed. We are less concerned with our ability to recall all of the peptides that 137 will work as long as we have a set of suitable size that will work. We reduce the risk of false positives by employing multiple 138 computational methods to predict peptide-MHC binding. For design we use an ensemble of methods, and for evaluation we use 139 all methods separately. 140 For MHC class I design, we use an ensemble that outputs the mean predicted binding affinity of 141 and MHCflurry 1.6.0 [35, 19] . We find this ensemble increases the precision of binding affinity estimates over the individual 142 models on available SARS-CoV-2 experimental data (Table S1 ). For MHC class II design, we use . 143 For evaluation, we use our ensemble estimate of binding (MHC class I), as well as use binding predictions from a wide range PUFFIN [17] ) to ensure that all methods agree that we have a 146 good peptide vaccine. We validate these models on datasets containing experimentally-studied SARS-CoV-2 and SARS-CoV 147 peptides [38, 39, 40, 41] (see Section S1.2).",
            "cite_spans": [
                {
                    "start": 94,
                    "end": 98,
                    "text": "[33]",
                    "ref_id": null
                },
                {
                    "start": 163,
                    "end": 167,
                    "text": "[34]",
                    "ref_id": null
                },
                {
                    "start": 1261,
                    "end": 1264,
                    "text": "140",
                    "ref_id": null
                },
                {
                    "start": 1384,
                    "end": 1388,
                    "text": "[35,",
                    "ref_id": null
                },
                {
                    "start": 1389,
                    "end": 1392,
                    "text": "19]",
                    "ref_id": null
                },
                {
                    "start": 1591,
                    "end": 1594,
                    "text": "143",
                    "ref_id": null
                },
                {
                    "start": 1719,
                    "end": 1730,
                    "text": "PUFFIN [17]",
                    "ref_id": null
                },
                {
                    "start": 1915,
                    "end": 1919,
                    "text": "[38,",
                    "ref_id": null
                },
                {
                    "start": 1920,
                    "end": 1923,
                    "text": "39,",
                    "ref_id": null
                },
                {
                    "start": 1924,
                    "end": 1927,
                    "text": "40,",
                    "ref_id": null
                },
                {
                    "start": 1928,
                    "end": 1931,
                    "text": "41]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 1544,
                    "end": 1553,
                    "text": "(Table S1",
                    "ref_id": null
                }
            ],
            "section": "128"
        },
        {
            "text": "All models take as input a (MHC, peptide) pair and output predicted peptide-MHC binding affinity (IC50) on a nanomolar 149 scale. For both MHC class I and class II models, we consider peptides to be binders if the predicted MHC binding affinity 150 is \u2264 50nM [42] . This provides a conservative threshold to increase the probability of peptide display. Where our methods 151 require a probability of peptide-MHC binding (as in Equation 5), affinity predictions are capped at 50000nM and transformed 152 into [0, 1] using a logistic transformation, 1 \u2212 log 50000 (aff), where larger values correspond to greater likelihood of eliciting 153 an immunogenic response [42, 43, 44] . The \u2264 50nM binding affinity threshold corresponds to a threshold of \u2265 0.638 after 154 logistic transformation. We explored other criteria to classify peptides as binders and found using predicted binding affinity 155 with a 50nM threshold to meet these alternative criteria and maximize precision on available SARS-CoV-2 experimental data 156 (Table S1 ). 159 We eliminate peptides that are observed to mutate above an input threshold rate to improve coverage over all SARS-CoV-2 160 variants and reduce the chance that the virus will mutate and escape vaccine-induced immunity in the future. When possible, 161 we select peptides that are observed to be perfectly conserved across all observed SARS-CoV-2 viral genomes. Peptides that 162 are observed to be perfectly conserved in thousands of examples may be functionally constrained to evolve slowly or not at all.",
            "cite_spans": [
                {
                    "start": 259,
                    "end": 263,
                    "text": "[42]",
                    "ref_id": null
                },
                {
                    "start": 663,
                    "end": 667,
                    "text": "[42,",
                    "ref_id": null
                },
                {
                    "start": 668,
                    "end": 671,
                    "text": "43,",
                    "ref_id": null
                },
                {
                    "start": 672,
                    "end": 675,
                    "text": "44]",
                    "ref_id": null
                },
                {
                    "start": 1034,
                    "end": 1037,
                    "text": "159",
                    "ref_id": null
                },
                {
                    "start": 1286,
                    "end": 1289,
                    "text": "161",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 1021,
                    "end": 1030,
                    "text": "(Table S1",
                    "ref_id": null
                }
            ],
            "section": "148"
        },
        {
            "text": "If functional data are available, they can be used to supplement observed viral genome mutation rates by increasing mutation 164 rates over functionally non-constrained residues.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "163"
        },
        {
            "text": "For SARS-CoV-2, we obtained the most up to date version of the GISAID database [29] (as of 2:02pm EST May 13, 2020, ac-166 knowledgements in Section S4) and used Nextstrain [30] (from GitHub commit 639c63f25e0bf30c900f8d3d937de4063d96f791) 167 to remove genomes with sequencing errors, translate the genome into proteins, and perform multiple sequence alignments 168 (MSAs). We retrieved 24468 sequences from GISAID, and 19288 remained after Nextstrain quality processing. After quality 169 processing, Nextstrain randomly sampled 34 genomes from every geographic region and month to produce a representative set 170 of 5142 genomes for evolutionary analysis. Nextstrain definition of a \"region\" can vary from a city (e.g., \"Shanghai\") to a 171 larger geographical district. Spatial and temporal sampling in Nextstrain is designed to provide a representative sampling of 172 sequences around the world.",
            "cite_spans": [
                {
                    "start": 240,
                    "end": 243,
                    "text": "167",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "165"
        },
        {
            "text": "The 5142 genomes sampled by Nextstrain were then translated into protein sequences and aligned. We eliminated viral 174 genome sequences that had a stop codon, a gap, an unknown amino acid (because of an uncalled nucleotide in the codon), or 175 had a gene that lacked a starting methionine, except for ORF1b which does not begin with a methionine. This left a total of 176 4690 sequences that were used to compute peptide level mutation probabilities. For each peptide, the probability of mutation 177 was computed as the number of non-reference peptide sequences observed divided by the total number of peptide sequences 178 observed. for class I or endosomes for class II. Any peptide that spans any of these cleavage sites is removed from consideration. This 184 removes 3,739 peptides out of the 154,996 we consider across windows 8-10 (class I) and 13-25 (class II) (\u223c2.4%). 186 We eliminate all peptides that are predicted to have N-linked glycosylation as it inhibits both MHC loading and T cell recognition 187 of peptides [46] . Glycosylation is a post-translational modification that involves the covalent attachment of carbohydrates to 188 specific motifs on the surface of the protein. We identified peptides that may be glycosylated with the NetNGlyc N-glycosylation 189 prediction server [47] . We verified these predictions for the Spike protein using experimental data of Spike N-glycosylation 190 from Cryo-EM and tandem mass spectrometry [48, 49] . A majority of the potential N-glycosylation sites (16 out of 22) were 191 identified in both experimental studies, and further supported by homologous regions with glycosylation in SARS-CoV [50] . 192 We found that that for the Spike protein when NetNGlyc predicted a non-zero probability of a site being N-glycosylated it 193 was experimentally identified as a real or likely N-glycosylation site. Therefore, we eliminated all peptides where NetNGlyc 194 predicted a non-zero N-glycosylation probability in any residue. This resulted in the elimination of 18,957 of the 154,996 195 peptides considered (\u223c12%). ",
            "cite_spans": [
                {
                    "start": 881,
                    "end": 884,
                    "text": "186",
                    "ref_id": null
                },
                {
                    "start": 1032,
                    "end": 1036,
                    "text": "[46]",
                    "ref_id": null
                },
                {
                    "start": 1303,
                    "end": 1307,
                    "text": "[47]",
                    "ref_id": null
                },
                {
                    "start": 1457,
                    "end": 1461,
                    "text": "[48,",
                    "ref_id": null
                },
                {
                    "start": 1462,
                    "end": 1465,
                    "text": "49]",
                    "ref_id": null
                },
                {
                    "start": 1658,
                    "end": 1662,
                    "text": "[50]",
                    "ref_id": null
                },
                {
                    "start": 1665,
                    "end": 1668,
                    "text": "192",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "173"
        },
        {
            "text": "T cells are selected to ignore peptides derived from the normal human proteome, and thus we remove any self peptides from 198 consideration for a vaccine. In addition, it is possible that a vaccine might stimulate the adaptive immune system to react 199 to a self peptide that was presented at an abnormally high level, which could lead to an autoimmune disorder. All peptides 200 from SARS-CoV-2 were scanned against the entire human proteome downloaded from UniProt [31] under Proteome ID 201 UP000005640. A total of 48 exact peptide matches (46 8-mers, two 9-mers) were discovered and eliminated from consideration. EvalVax-Unlinked considers MHC allele frequencies at each HLA locus independently, and computes the likelihood that at 213 least one peptide from a vaccine set is displayed at any locus. Both methods take into consideration MHC allele frequency, 214 allelic zygosity, and for EvalVax-Robust, linkage disequilibrium (LD) among loci. We also take glycosylation and cleavage 215 sites into consideration when evaluating vaccines by setting binding affinity to zero for peptides with non-zero glycosylation 216 probability or on cleavage sites. thus EvalVax-Robust computes the probability of having at least N predicted peptide-HLA binding hits for each individual in 222 the population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "197"
        },
        {
            "text": "Assuming for each of the HLA-A,B,C loci there are M A , M B , M C alleles respectively, for a given haploid A i B j C k , the 224 haplotype frequency is defined as G(i, j, k) and \u2211",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "k=0 G(i, j, k) = 1. We assume independence of inherited haplotypes 225 and compute the frequency of a diploid genotype as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "For each allele A, e(A) denotes the number of peptides predicted to bind to the allele with \u2264 50nM affinity, which we call the 227 number of peptide-HLA hits. Then for each possible diploid genotype we compute the total number of peptide-HLA hits of the 228 genotype as the sum of e(A) of the unique alleles in the genotype (there can be 3-6 unique alleles depending on the zygosity of 229 each locus):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "We then compute the frequency of having exactly k peptide-HLA hits in the population as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "We define the population coverage objective function for EvalVax-Robust as the probability of having at least N peptide-HLA 232 hits in the population, where the cutoff N is set to the minimum number of displayed vaccine peptides desired:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "When we evaluate metrics on a world population, we equally weight population coverage estimations over three population When haplotype frequencies are not available for a population, we can evaluate a vaccine using MHC allele frequencies that 239 assume independence and compute the probability that at least one peptide binds to any of the alleles at any of the loci. To 240 encourage a diverse set of peptides to bind to a single MHC allele, we use the predicted binding probability of a peptide to an 241 allele instead of using a binary indicator of binding. This permits multiple peptides to contribute to the probability score at each 242 allele. Considering K loci {L 1 , ..., L K }, for each locus there are M k alleles A 1 , ..., A M k and the allele frequency is defined as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "Given a set of N peptides {P n=1:N }, for each allele (of locus L k ) the predicted binding probability 244 to peptide P n is e n k (A i ). Assuming no competition between peptides, the probability that allele A i ends up having at least one 245 peptide bound is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "We define the diploid frequency of alleles as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": ", and we conservatively assume that a homozygous 247 diploid locus does not improve the chance of peptide presentation over a single copy of the locus. Thus, the probability that a 248 diploid genotype has at least one peptide bound is defined as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "Therefore, the probability that a person in the given population displays at least one peptide in the set {P n } at a particular locus 250 L k is calculated by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "To combine different loci assuming no linkage disequilibrium, the probability that a person in the given population has at least 252 one locus that binds to at least one peptide from {P n } is defined as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "223"
        },
        {
            "text": "which is the evaluation metric for EvalVax-Unlinked. 254 We conservatively only consider peptides with predicted binding affinity \u2264 50nM. We set values of e n k (A i ) weaker than 255 50nM predicted binding affinity to zero. This constraint on peptide binding is in addition to all of the other peptide filters in 256 Section 2.3. When we evaluate on a world population, we equally weight population coverage estimates over 15 geographic 257 regions (see Results for list of regions) as the final objective function. 259 We use beam search over a set of candidate peptides to efficiently search for an optimal subset of peptides that maximizes a 260 desired EvalVax-Unlinked or EvalVal-Robust based objective function. Our beam search procedure is parallelizable across CPU 261 cores, and we typically use from 40 to 96 cores. We use a beam size of k = 10 for MHC class I and k = 5 for MHC class II. 287 We validate our computational models on datasets containing experimentally-studied SARS-CoV-2 and SARS-CoV peptides [38, 288 39, 40, 41] (details in Section S1.2). We find classifying peptides as binders by predicted binding affinity \u2264 50nM maximizes 289 AUROC and precision in classification of stable binders over alternative predictors and binding criteria (Table S1 ). Our Figure S1 . We observed that it is more difficult to optimize vaccines with S, N, and M proteins only. We expect this is 321 because we have fewer candidate peptides to cover all of our haplotype combinations.",
            "cite_spans": [
                {
                    "start": 53,
                    "end": 56,
                    "text": "254",
                    "ref_id": null
                },
                {
                    "start": 517,
                    "end": 520,
                    "text": "259",
                    "ref_id": null
                },
                {
                    "start": 900,
                    "end": 903,
                    "text": "287",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 1264,
                    "end": 1273,
                    "text": "(Table S1",
                    "ref_id": null
                },
                {
                    "start": 1281,
                    "end": 1290,
                    "text": "Figure S1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "223"
        },
        {
            "text": "We limited our candidates to peptides with length 8-10 and zero predicted probability of glycosylation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MHC class I results"
        },
        {
            "text": "We also excluded peptides that have been observed with any mutation. We use the mean predicted binding affinity values from Asian populations, percentage of peptides that are predicted to be glycosylated, peptides observed to mutate with greater than However, many fail to show a high probability of higher hit counts, indicating a lack of predicted redundancy if a single peptide 355 is not displayed. We also evaluate randomly selected peptide sets of size 19 from predicted binders of MHC class I and II, 356 where a binder is defined as a peptide that is predicted to bind with \u2264 50nM to more than 5 of the alleles in the MHC class. We 357 found that a random binder set can achieve coverage that outperforms some of the proposed vaccines that we use as baselines.",
            "cite_spans": [
                {
                    "start": 508,
                    "end": 511,
                    "text": "356",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "324"
        },
        {
            "text": "358 Table 1 summarizes EvalVax results for all baselines with a vaccine peptide count less than 150 peptides. We also included 359 evaluation on peptide sets derived from taking all sliding windows with proper size for MHC class I and II from the S protein or 360 S1 subunit, and evaluated an average of 500 random designs for MHC class I or class II that are comprised of 19 peptides that 361 are predicted to bind either MHC class I and II. We found that the baseline methods all provide less coverage than OptiVax 362 derived sets, and some contain peptides predicted to be glycosylated or have a high observed mutation probability (Table 1) . 363 We also observe some baselines contain peptides that sit on the cleavage sites or overlap with self-peptides. In addition, we 364 found that for class II MHC coverage the S protein alone is unable to achieve more than 88% coverage for n \u2265 0 and 75.9% 365 coverage n \u2265 5. 367 We evaluated all Table 1 vaccine designs using eleven independent peptide-MHC binding prediction methods to ensure 368 that the performance observed in Table 1 is not an artifact. For MHC class I prediction we validated using seven methods: 3 0.00% 0.00% 0.00% 0.00% 0.00% 0.000 0.000 0.000 66.67% 100.00% 0.00% S1 0.00% Table 1 . Comparison of existing baselines, S-protein peptides, and OptiVax designed peptide vaccines (using full set of proteins or S/M/N proteins only) on various population coverage evaluation metrics and vaccine quality metrics (percentage of peptides with larger than 0.1% probability of mutating or with non-zero probability of being glycosylated). The list is sorted by EvalVax-Robust p(n \u2265 1). Random subsets are generated 200 times.The binders used for generating random subsets are defined as peptides that is predicted to bind with \u2264 50nM to more than 5 of the alleles.",
            "cite_spans": [
                {
                    "start": 647,
                    "end": 650,
                    "text": "363",
                    "ref_id": null
                },
                {
                    "start": 922,
                    "end": 925,
                    "text": "367",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 4,
                    "end": 11,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 635,
                    "end": 644,
                    "text": "(Table 1)",
                    "ref_id": null
                },
                {
                    "start": 943,
                    "end": 950,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 1078,
                    "end": 1085,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 1247,
                    "end": 1254,
                    "text": "Table 1",
                    "ref_id": null
                }
            ],
            "section": "324"
        },
        {
            "text": "potential cytotoxic T cell epitopes. The Journal of Immunology, 153(12):5586-5592, 1994. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "EvalVax results are robust to different binding prediction models"
        },
        {
            "text": "We evaluate peptide-MHC binding predictions on a set of experimentally assessed SARS-CoV-2 peptides whose peptide-MHC (Table S1 ). AUROC and average precision are computed using raw predictions, and 621 the remaining metrics are computed using binarized predictions based on the respective binding criteria (using scikit-learn [71]).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 118,
                    "end": 127,
                    "text": "(Table S1",
                    "ref_id": null
                }
            ],
            "section": "614"
        },
        {
            "text": "We compare classification performance using different binding criteria (see Section S1.1) and find in general that classifying 623 binders using predicted binding affinity using a 50nM threshold maximizes AUROC and precision (Table S1 ). We find that our 624 mean ensemble of NetMHCpan-4.0 and MHCflurry further improves classification AUROC and precision over the individual 625 models for predicting MHC class I epitopes. On MHC class II data, we note NetMHCIIpan-4.0 achieves AUROC 0.848 and 626 precision 0.625 using a 500nM threshold (Table S1 ). While NetMHCIIpan-4.0 with a 50nM threshold does not identify any 627 peptides in this dataset as binders, we use this stricter threshold in our vaccine designs as it is more conservative and less likely 628 to admit false positive binders. In general, we find performance of PUFFIN with a 50nM binding threshold comparable to 629 alternative methods on both MHC class I and class II data and use PUFFIN as part of our vaccine design evaluation. 630 We additionally validate our computational models using previously reported SARS-CoV T cell epitopes from experimental protein. Table S2 shows the performance of our peptide-MHC binding prediction models on these SARS-CoV peptides. ",
            "cite_spans": [
                {
                    "start": 998,
                    "end": 1001,
                    "text": "630",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 225,
                    "end": 234,
                    "text": "(Table S1",
                    "ref_id": null
                },
                {
                    "start": 539,
                    "end": 548,
                    "text": "(Table S1",
                    "ref_id": null
                },
                {
                    "start": 1130,
                    "end": 1138,
                    "text": "Table S2",
                    "ref_id": null
                }
            ],
            "section": "622"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "See supplementary table in Supplementary_S3_evaluation_on_different_tools.xlsx. 638 S4 Detailed GISAID accessions",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "GISAID_Acknowledgements.xlsx for acknowledgements",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "The OptiVax and EvalVax machine learning system for combinatorial vaccine optimization and evaluation. specific proteins of interest. An overview of our system is shown inFigure 1.racial background. We estimated HLA class I haplotypes from HLA-A,-B, and -C genotypes of 2886 individuals of Black 120 ancestry (46 distinct HLA-A alleles, 70 distinct HLA-B alleles, 40 distinct HLA-C alleles), 2327 individuals of White ancestry 121 (38 distinct HLA-A alleles, 64 distinct HLA-B alleles, 34 distinct HLA-C alleles) and 1653 individuals of Asian ancestry 122 (25 distinct HLA-A alleles, 51 distinct HLA-B alleles, 25 distinct HLA-C alleles). HLA class II haplotypes were estimated 123 based on DR, DQ, DP genotypes of 2474 individuals of Black ancestry (10 distinct HLA-DPA1 alleles, 45 distinct HLA-DPB1 124 alleles, 14 distinct HLA-DQA1 alleles, 21 distinct HLA-DQB1 alleles, 38 distinct HLA-DRB1 alleles), 1857 individuals 125 of White ancestry (7 distinct HLA-DPA1 alleles, 29 distinct HLA-DPB1 alleles, 18 distinct HLA-DQA1 alleles, 21 distinct 126 HLA-DQB1 alleles, 41 distinct HLA-DRB1 alleles) and 1675 individuals of Asian ancestry (7 distinct HLA-DPA1 alleles, 28 127 distinct HLA-DPB1 alleles, 16 distinct HLA-DQA1 alleles, 16 distinct HLA-DQB1 alleles, 36 distinct HLA-DRB1 alleles).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "144 of prediction algorithms (MHC class I: NetMHCpan-4.0 [18], NetMHCpan-4.1 [37], MHCflurry 1.6.0 [35], PUFFIN [17]; 145 MHC class II: NetMHCIIpan-3.2 [20], NetMHCIIpan-4.0 [36],",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Removal of unfavorable peptides 158 2.3.1 Removal of highly mutable peptides",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "CoV-2 contains a number of post-translation cleavage sites in ORF1a and ORF1b that result in a number of nonstructural 181 protein products. Cleavage sites were obtained from UniProt [31] under entry P0DTD1. In addition, a furin-like cleavage site 182 has been identified in the Spike protein [45]. This cleavage occurs before peptides are loaded in the endoplasmic reticulum 183",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "design vaccines using peptides from specific viral or oncogene proteins of interest by removing peptides from 204 undesired proteins from the candidate pool. Grifoni et al. [51] tested T cell responses from COVID-19 convalescent patients 205 and found that peptides from the S, M, and N proteins of SARS-CoV-2 produce the dominant CD4+ and CD8+ responses when 206 compared to other SARS-CoV-2 proteins. We have used OptiVax to produce additional SARS-CoV-2 vaccines comprised of 207 peptides drawn from only S, M, and N as described in Section 3.2.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "EvalVax evaluates peptide vaccine population coverage 209 We introduce two evaluation methods for estimating the population coverage of a proposed peptide vaccine set. EvalVax-210 Robust utilizes HLA haplotype frequencies for MHC class I (HLA-A/B/C) and MHC class II (HLA-DP/DQ/DR) genes, and 211 evaluates population level likelihood of having larger than a certain number of peptide-HLA binding hits in each individual.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": ".4.1 EvalVax-Robust considers linkage disequilibrium of MHC genes 218 EvalVax-Robust computes the distribution of per individual peptide-HLA binding hits over a given population. It accounts for 219 the significant linkage disequilibrium (LD) between HLA loci and uses haplotype frequencies for population coverage estimates.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "groups (White, Black, and Asian) as the final objective function. In addition to the probability of having at least N peptide-HLA 235 hits per individual, we also evaluate the expected number of per individual peptide-HLA hits in the population, which provides 236 insight on how well the vaccine is displayed on average.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF12": {
            "text": "EvalVax-Unlinked computes population coverage by at least one peptide-HLA hit238",
            "latex": null,
            "type": "figure"
        },
        "FIGREF13": {
            "text": "OptiVax-Robust searches for a peptide set with high expected number of per-individual peptide-HLA hits263    OptiVax-Robust uses beam search to find a minimal set of peptides that reaches a desired population coverage probability 264 at a threshold of N predicted peptide-HLA hits for each individual. We start from an empty set of peptides and N = 0, and 265 iteratively expand the solution by one peptide at a time and retain the top k solutions until the population coverage probability 266 for the current N reaches the given population coverage probability threshold for that N. We then repeat the same process for267 N + 1. At the expense of increased computational cost, beam search improves upon greedy optimization by considering k 268 possible solutions at each step. During each iteration, the population coverage probability threshold at the present N controls 269 the robustness of coverage. Increasing the desired population coverage probability increases the difficulty of the optimization 270 task. The iterative process stops when a desired population coverage at a desired N is achieved. In early rounds of optimization, 271 OptiVax uses a high population coverage probability to provide better individual coverage. In subsequent rounds, the target 272 population coverage probability is reduced on a fixed schedule.273 2.5.2 OptiVax-Unlinked searches for a peptide set that covers a population 274 OptiVax-Unlinked uses beam search to find a minimal set of peptides that reaches a desired population coverage probability 275 that each individual on average displays at least one vaccine peptide. We iteratively expand solutions in the beam by adding one 276 peptide at a time to reach the population coverage objective, and keep the top k solutions over all possible expansions in the 277 beam.278 2.5.3 OptiVax improves vaccine sequence diversity 279 OptiVax reduces vaccine sequence redundancy by not selecting peptides with closely related sequences for a vaccine formulation. 280 This issue arises because sliding a window over a proteome produces overlapping sequences that are very similar in MHC 281 binding characteristics. When any version of OptiVax selects a peptide during optimization, it eliminates from further 282 consideration all unselected peptides that are within three (MHC class I) or five (MHC class II) edits on a sequence distance 283 metric from the selected peptide. The distance metric aligns two peptides without gaps within them and is the sum of the 284 lengths of their unaligned portions at their ends.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF14": {
            "text": "MHCflurry further increases AUROC and precision over individual predictors.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF15": {
            "text": "OptiVax-Robust optimization results on MHC class I and II292MHC class I resultsWe selected an optimized set of peptides from all SARS-CoV-2 proteins using the EvalVax-Robust 293 objective function. We limited our candidates to peptides with length 8-10 and excluded peptides that have been observed with 294 any mutation or are predicted to have non-zero probability of glycosylation. For computation of the objective function, we 295 use the mean predicted IC50 values from our NetMHCpan-4.0 and MHCflurry ensemble to obtain reliable binding affinity 296 predictions for evaluation and optimization. With OptiVax-Robust optimization, we design a vaccine with 19 peptides that 297 achieves 99.39% EvalVax-Unlinked coverage and 99.91% EvalVax-Robust coverage over three ethnic groups (Asian, Black, peptide-HLA hits and 67.75% coverage with at least 8 peptide-HLA hits(Table OptiVax-Robust selected peptide set for MHC class I. (a) EvalVax-Robust population coverage at different per-individual number of peptide-HLA hit cutoffs for Asian/Black/White populations and average value. (b) EvalVax-Unlinked population coverage on 15 geographic regions and averaged population coverage. (c) Binding of vaccine peptides to 230 HLA-A/B/C alleles. (d) Distribution of peptide origin. (e) Distribution of the number of per-individual peptide-HLA hits in White/Black/Asian populations. (f) Peptide presence in SARS-CoV. MHC class II results We limited our candidates to peptides with length 13-25 and excluded peptides that have been observed 303 with mutation probability greater than 0.001 or are predicted to have non-zero glycosylation probability. We use the predicted 304 binding affinity from NetMHCIIpan-4.0 for optimization and evaluation. With OptiVax-Robust optimization, we design a 305 vaccine with 20 peptides that achieves 90.59% EvalVax-Unlinked coverage and 93.21% EvalVax-Robust coverage over three 306 ethnic groups (Asian, Black, White) with at least one peptide-HLA hit per individual. This set of peptides also provides 90.17% 307 coverage with at least 5 peptide-HLA hits and 45.99% coverage with at least 8 peptide-HLA hits (Figure 3, Table 1). The 308 population level distribution of the number of peptide-HLA hits per individual in White, Black, and Asian populations is shown 309 in Figure 3, where the expected number of of peptide-HLA hits is 10.703, 9.405, and 7.509, respectively. OptiVax-Robust selected optimal peptide set for MHC class II. (a) EvalVax-Robust population coverage at different minimum number of peptide-HLA hit cutoffs. (b) EvalVax-Unlinked population coverage. (c) Binding of vaccine peptides to 280 HLA-DRB1/DP/DQ alleles. (d) Distribution of peptide origin. (e) Distribution of the number of per-individual peptide-HLA hits in White/Black/Asian populations. (f) Peptide presence in SARS-CoV. Designing vaccines with S, M, N proteins only We also used OptiVax-Robust to design vaccines for MHC class I and class 311 II based solely upon peptides from the S, M, and N proteins of SARS-CoV-2 and evaluated vaccine performance. Grifoni et al. 312 [51] found that peptides from the S, M, and N structural proteins of SARS-CoV-2 were dominant in producing responses from 313 CD4+ and CD8+ cells from convalescent COVID-19 patients. As shown in Table 1, the resulting MHC class I vaccine with 26 314 peptides achieves 98.15% coverage over three ethnic groups (Asian, Black, White) with at least one average peptide-HLA hit 315 per individual. There were an average of at least five peptide hits in 67.37% of the population, and the expected per-individual OptiVax-Unlinked selected optimal peptide set for MHC class I. (a) EvalVax-Robust population coverage at different per-individual number of peptide-HLA hits cutoffs for Asian/Black/White populations and average value. (b) EvalVax-Unlinked population coverage on 15 geographic regions and averaged population coverage. (c) Binding of vaccine peptides to 230 HLA-A/B/C alleles. (d) Distribution of peptide origin. (e) Distribution of the number of per-individual peptide-HLA hits in White/Black/Asian populations. (f) Peptide presence in SARS-CoV.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF16": {
            "text": "OptiVax-Unlinked selected optimal peptide set for MHC class II. (a) EvalVax-Robust population coverage at different minimum number of peptide-HLA hit cutoffs. (b) EvalVax-Unlinked population coverage. (c) Binding of vaccine peptides to 280 HLA-DRB1/DP/DQ alleles. (d) Distribution of peptide origin. (e) Distribution of the number of per-individual peptide-HLA hits in White/Black/Asian populations. (f) Peptide presence in SARS-CoV. number of hits for White, Black, and Asian populations are 5.313, 5.643, and 6.448, respectively. The OptiVax-Robust MHC 317 class II vaccine with 22 S, M, and N peptides achieves 91.79% coverage with an average of at least one peptide-HLA hit per 318 individual. There were an average of at least five peptide hits in 59.64% of the population, and the expected per-individual 319 number of hits in White, Black, and Asian populations are 7.659, 6.291, and 4.636, respectively. The detailed vaccine designs 320 are in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF17": {
            "text": "probability, or peptides that sit on known cleavage sites. We define vaccine efficiency as the mean expected per-individual 348 number of peptide-HLA hits for a vaccine divided by the number of peptides in the vaccine. This metric represents the mean 349 probability of display of each peptide in a vaccine, and normalizes vaccine performance by vaccine peptide count. EvalVax population coverage evaluation for MHC class I vaccines. (a) EvalVax population coverage for OptiVax-Unlinked and OptiVax-Robust proposed vaccine at different vaccine size (b) EvalVax-Robust population coverage with n \u2265 1 peptide-HLA hits per individual, OptiVax-Robust performance is shown by the blue curve and baseline performance is shown by red crosses (labeled by first author's name) (c) EvalVax-Robust population coverage with n \u2265 5 peptide-HLA hits. (d) EvalVax-Robust population coverage with n \u2265 8 peptide-HLA hits.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF18": {
            "text": "Expectation of per individual number of peptide-HLA hits and vaccine efficiency for MHC class I vaccines. (a) Expected number of peptide-HLA hits vs. peptide vaccine size for OptiVax-Robust and OptiVax-Unlinked, and efficiency (hits / vaccine size) at different vaccine size. (b) Comparison between OptiVax-Robust and baselines on expected number of peptide-HLA hits. OptiVax-Robust performance is shown by the blue curve and baseline performance is shown by red crosses (c) Comparison between OptiVax-Robust and baselines on efficiency. Figures 6 to 9 show the comparison between OptiVax-Robust designed MHC class I and class II vaccines at all vaccine 351 sizes (top solution in the beam up to the given vaccine size) from 1-35 peptides (blue curves) and baseline vaccines (red crosses) 352proposed by other publications. We observe superior performance of OptiVax-Robust designed vaccines on all evaluation 353 metrics at all vaccine sizes for both MHC class I and class II. Most baselines achieve reasonable coverage at n \u2265 1 peptide hits.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF20": {
            "text": "EvalVax population coverage evaluation for MHC class II vaccines. (a) EvalVax population coverage for OptiVax-Unlinked and OptiVax-Robust proposed vaccine at different vaccine sizes. (b) EvalVax-Robust population coverage with n \u2265 1 peptide-HLA hits per individual, OptiVax-Robust performance is shown by the blue curve and baseline performance is shown by red crosses (labeled by first author's name). (c) EvalVax-Robust population coverage with n \u2265 5 peptide-HLA hits. (d) EvalVax-Robust population coverage with n \u2265 8 peptide-HLA hits.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF21": {
            "text": "Expectation of per individual number of peptide-HLA hits and vaccine efficiency for MHC class II vaccines. (a) Expected number of peptide-HLA hits vs. peptide vaccine size for OptiVax-Robust and OptiVax-Unlinked, and efficiency (hits / vaccine size) at different vaccine size. (b) Comparison between OptiVax-Robust and baselines on expected number of peptide-HLA hits. OptiVax-Robust performance is shown by the blue curve and baseline performance is shown by red crosses. (c) Comparison between OptiVax-Robust and baselines on efficiency.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF22": {
            "text": "NetMHCpan-4.1; MHCflurry 1.6.0; PUFFIN; the mean of NetMHCpan-4.0 and MHCflurry 1.6.0 with a 370 50nM cutoff on predicted affinity; and NetMHCpan-4.0 and NetMHCpan-4.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF23": {
            "text": "S Buus, SL Lauem\u00f8ller, Peder Worning, Can Kesmir, T Frimurer, S Corbet, A Fomsgaard, J Hilden, A Holm, and S\u00f8ren 518 approach. Tissue antigens, Bruno Coutard, Coralie Valle, Xavier de Lamballerie, Bruno Canard, NG Seidah, and E Decroly. The spike glycoprotein of 524 the new coronavirus 2019-nCoV contains a furin-like cleavage site absent in CoV of the same clade. Antiviral research, Margreet A Wolfert and Geert-Jan Boons. Adaptive immune activation: glycosylation does matter. Nature Chemical 527 Biology, 9(12):776-784, 2013. doi: 10.1038/nchembio.1403. 528 47. R Gupta, E Jung, and S Brunak. Prediction of N-glycosylation sites in human proteins. In preparation, 2004. URL 529 http://www.cbs.dtu.dk/services/NetNGlyc/. 530 48. Daniel Wrapp, Nianshuang Wang, Kizzmekia S Corbett, Jory A Goldsmith, Ching-Lin Hsieh, Olubukola Abiona, Barney S 531 Graham, and Jason S McLellan. Cryo-EM structure of the 2019-nCoV spike in the prefusion conformation. Yong Zhang, Wanjun Zhao, Yonghong Mao, Shisheng Wang, Yi Zhong, Tao Su, Meng Gong, Xiaofeng Lu, Jingqiu 534 Cheng, and Hao Yang. Site-specific N-glycosylation characterization of recombinant SARS-CoV-2 spike proteins using 535 high-resolution mass spectrometry. bioRxiv, 2020. 536 50. Alexandra C Walls, Young-Jun Park, M Alejandra Tortorici, Abigail Wall, Andrew T McGuire, and David Veesler. 537 Structure, function, and antigenicity of the SARS-CoV-2 spike glycoprotein. Cell, 2020. 538 51. A. Grifoni, D. Weiskopf, S.I. Ramirez, J. Mateus, J.M. Dan, C.R. Moderbacher, S.A. Rawlings, A. Sutherland, L. Premku-539 mar, R.S. Jadi, D. Marrama, A.M. de Silva, A. Frazier, A. Carlin, J.A. Greenbaum, B. Peters, F. Krammer, D.M. Smith, 540 S. Crotty, and A. Sette. Targets of T cell responses to SARS-CoV-2 coronavirus in humans with COVID-19 disease and 541 unexposed individuals. Cell, 2020. doi: 10.1016/j.cell.2020.05.015. 542 52. Chloe Hyun-Jung Lee and Hashem Koohy. In silico identification of vaccine targets for 2019-nCoV. F1000Research, Asaf Poran, Dewi Harjanto, Matthew Malloy, Michael S Rooney, Lakshmi Srinivasan, and Richard B Gaynor. Sequence-545 based prediction of vaccine targets for inducing T cell responses to SARS-CoV-2 utilizing the bioinformatics predictor 546 RECON. bioRxiv, 2020. 547 54. Manojit Bhattacharya, Ashish R Sharma, Prasanta Patra, Pratik Ghosh, Garima Sharma, Bidhan C Patra, Sang-Soo Lee, 548 and Chiranjib Chakraborty. Development of epitope-based peptide vaccine against novel coronavirus 2019 (SARS-COV-2): 549 Immunoinformatics approach. Journal of medical virology, 92(6):618-631, 2020. 550 55. Vargab Baruah and Sujoy Bose. Immunoinformatics-aided identification of T cell and B cell epitopes in the surface 551 glycoprotein of 2019-nCoV. Journal of Medical Virology, 2020. 552 56. Miysaa I Abdelmageed, Abdelrahman Hamza Abdelmoneim, Mujahed I Mustafa, Nafisa M Elfadol, Naseem S Murshed, 553 Shaza W Shantier, and Abdelrafie M Makhawi. Design of multi epitope-based peptide vaccine against E protein of human 554 2019-nCoV: An immunoinformatics approach. bioRxiv, 2020. 555 57. Syed Faraz Ahmed, Ahmed A Quadeer, and Matthew R McKay. Preliminary identification of potential vaccine targets for 556 the COVID-19 coronavirus (SARS-CoV-2) based on SARS-CoV immunological studies. Viruses, 12(3):254, 2020.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF24": {
            "text": "studies[39, 40, 41]  as provided by Fast et al.[24]. For MHC class I, this dataset contains 17 experimentally-determined 632 HLA-A*02:01 associated CD8 T cell epitopes and 1236 non-epitope 9-mer peptides from the rest of the SARS-CoV Spike (S) 633",
            "latex": null,
            "type": "figure"
        },
        "FIGREF25": {
            "text": "Classification performance of computational methods for predicting peptide-MHC binding evaluated on 17 experimentally determined HLA-A*02:01 associated CD8 T-cell epitopes from SARS-CoV vs. rest of SARS-CoV Spike (S) protein. Ensemble outputs the mean predicted binding affinity of NetMHCpan-4.0 and MHCflurry (see Section 2.2). (BA = binding affinity, EL = eluted ligand) OptiVax-Robust designed vaccine using peptides from S, M, and N proteins only. (A) Results for MHC class I. (B) Results for MHC class II. (a) EvalVax-Robust population coverage at different minimum number of peptide-HLA hit cutoffs. (b) EvalVax-Unlinked population coverage. (c) Binding of vaccine peptides to each of the available alleles in MHC I and II. (d) Distribution of peptide origin. (e) Distribution of the number of per-individual peptide-HLA hits in White/Black/Asian populations. (f) Peptide presence in SARS-CoV.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "bind to a diverse range of alleles across the HLA-DRB/DP/DQ loci. Even though less effective than OptiVax-Robust on providing a high predicted number of average peptide-HLA hits in the population, the OptiVax-Unlinked peptide set still",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "1 with a 99.5% cutoff on EL ranking. For MHC each with either a 50nM cutoff on predicted affinity or a 98% cutoff on EL ranking. The result of all eleven EvalVax evaluation metrics for allTable 1designs are shown in Supplement Section S3. We find that all of the eleven methods we use for evaluationThe computational design of peptide vaccines for eliciting cellular immunity is built upon the imperfect science of predicting peptide presentation by MHC molecules. Peptide vaccine designs also need to ensure that individuals with rare MHC alleles display vaccine peptides to ensure a high rate of vaccine efficacy over the entire population.To mitigate computational model uncertainty we have taken a very conservative view of peptide presentation, emphasizing",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "Coronavirus (SARS-COV-2). bioRxiv, 2020.68. Muhammad Tahir ul Qamar, Abdur Rehman, Usman Ali Ashfaq, Muhammad Qasim Awan, Israr Fatima, Farah Shahid, and Ling-Ling Chen. Designing of a next generation multiepitope based vaccine (MEV) against SARS-COV-2: Immunoinformatics and in silico approaches. bioRxiv, 2020.69.Abhishek Singh, Mukesh Thakur, Lalit Kumar Sharma, and Kailash Chandra. Designing a multi-epitope peptide-based vaccine against SARS-CoV-2. bioRxiv, 2020. https://www.who.int/blueprint/priority-diseases/key-action/ novel-coronavirus-landscape-ncov.pdf.71. F. Pedregosa, G. Varoquaux, A. Gramfort, V. Michel, B. Thirion, O. Grisel, M. Blondel, P. Prettenhofer, R. Weiss, V. Dubourg, J. Vanderplas, A. Passos, D. Cournapeau, M. Brucher, M. Perrot, and E. Duchesnay. Scikit-learn: Machine learning in Python. Journal of Machine Learning Research, 12:2825-2830, 2011.Robust computational design and evaluation of peptide vaccines for cellular immunity with application to SARS-CoV-2S1 Validation of Computational Peptide-MHC Prediction ModelsS1.1 Criteria for Predicted BindingNetMHCpan-4.0 [18] and NetMHCIIpan-4.0 [36] output predicted binding affinity (BA), percentile rank of predicted BA compared to a set of random natural peptides, and percentile rank of an eluted ligand (EL) score compared to a set of random natural peptides. Default parameters for these methods suggest EL percentile rank thresholds of 0.5% and 2% rank for classifying peptides as strong and weak binders, respectively, for MHC class I and thresholds of 2% and 10% for strong and weak binders, respectively, for MHC class II.To identify binders for our vaccine designs, we use a 50nM predicted binding affinity threshold (Section 2.2). We find binders selected with this criterion are also considered binders under alternative criteria based on percentile rank. Across our set of all candidate SARS-CoV-2 MHC class I peptides (Section 2.1), we find that 91.0% of peptide-MHC hits with \u2264 50nM predicted binding affinity by NetMHCpan-4.0 are also considered binders using BA percentile rank \u2264 0.5% (100.0% have BA percentile rank \u2264 2%). Using percentile rank for EL scores, 67.6% of peptide-MHC hits with \u2264 50nM predicted binding affinity have EL percentile rank \u2264 0.5% (92.6% have EL percentile rank \u2264 2%). Across all candidate SARS-CoV-2 MHC class II peptides, we find that 86.1% of peptide-MHC hits with \u2264 50nM predicted binding affinity by NetMHCIIpan-4.0 are also considered binders using BA percentile rank \u2264 2% (100.0% have BA percentile rank \u2264 10%). Using percentile rank for EL scores, 26.1% of peptide-MHC hits with \u2264 50nM predicted binding affinity have EL percentile rank \u2264 2% (63.1% have EL percentile rank \u2264 10%).",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "complex stability was assessed in vitro across 11 MHC allotypes (5 HLA-A, 1 HLA-B, 4 HLA-C, 1 HLA-DRB1)[38]. Prachar et al.[38]  suggest that peptides with low (< 60%) stability are unlikely to elicit an immune response and are unsuitable for vaccine development. For MHC class I alleles, the dataset contains 912 unique peptides-MHC pairs, of which 185 peptides are considered stable (\u2265 60% stability). For MHC class II, the dataset contains 93 total peptides, of which 22 are stable. We use our computational models to predict peptide-MHC binding and evaluate them using various binding criteria against the",
            "latex": null,
            "type": "table"
        },
        "TABREF4": {
            "text": "634 Binding Criterion AUROC Precision Sensitivity Specificity Avg. PrecisionTable S1. Classification performance of computational methods for predicting peptide-MHC binding evaluated on experimental SARS-CoV-2 peptide stability data across 11 MHC allotypes (5 HLA-A, 1 HLA-B, 4 HLA-C, 1 HLA-DRB1). Ensemble outputs the mean predicted binding affinity of NetMHCpan-4.0 and MHCflurry (see Section 2.2). (BA = binding affinity, EL = eluted ligand)ModelBinding Criterion AUROC Precision Sensitivity Specificity Avg. Precision",
            "latex": null,
            "type": "table"
        },
        "TABREF5": {
            "text": "",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}