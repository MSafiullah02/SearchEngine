{
    "paper_id": "395923079f8125f16d4ab5cf78dcb5f2c1097b3e",
    "metadata": {
        "title": "Approaching Arithmetic Theories with Finite-State Automata",
        "authors": [
            {
                "first": "Christoph",
                "middle": [],
                "last": "Haase",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University College London",
                    "location": {
                        "settlement": "London",
                        "country": "UK"
                    }
                },
                "email": "c.haase@ucl.ac.uk"
            }
        ]
    },
    "abstract": [
        {
            "text": "The automata-theoretic approach provides an elegant method for deciding linear arithmetic theories. This approach has recently been instrumental for settling long-standing open problems about the complexity of deciding the existential fragments of B\u00fcchi arithmetic and linear arithmetic over p-adic fields. In this article, which accompanies an invited talk, we give a high-level exposition of the NP upper bound for existential B\u00fcchi arithmetic, obtain some derived results, and further discuss some open problems.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Finite-state automata over finite and infinite words provide an elegant method for deciding linear arithmetic theories such as Presburger arithmetic or linear real arithmetic. Automata-based decision procedures for arithmetic theories have also been of remarkable practical use and have been implemented in tools such as LASH [16] or TaPAS [10] . However, understanding the algorithmic properties of automata-based decision procedures turned out to be surprisingly difficult and tedious, see e.g. [3, 6, 9, 19] . It took, for instance, 50 years to show that B\u00fcchi's seminal approach for deciding Presburger arithmetic using finite-state automata runs in triply-exponential time and thus matches the upper bound of quantifierelimination algorithms [5, 6] . Given this history, it is not surprising that, until recently, the author was of the opinion that automata should better be avoided when attempting to prove complexity upper bounds for arithmetic theories.",
            "cite_spans": [
                {
                    "start": 326,
                    "end": 330,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 340,
                    "end": 344,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 497,
                    "end": 500,
                    "text": "[3,",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 501,
                    "end": 503,
                    "text": "6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 504,
                    "end": 506,
                    "text": "9,",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 507,
                    "end": 510,
                    "text": "19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 747,
                    "end": 750,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 751,
                    "end": 753,
                    "text": "6]",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The author's opinion drastically changed when appealing to automata-based approaches recently allowed for settling long-standing open problems about the complexity of the existential fragments of B\u00fcchi arithmetic and linear arithmetic over p-adic fields, which were both shown NP-complete [8] . The NP upper bounds are the non-trivial part in those results, since, unlike, for instance, in existential Presburger arithmetic, the encoding of smallest solutions can grow super-polynomially. The key result underlying both NP upper bounds is that given two states of a finite-state automaton encoding the set of solutions of a system of linear Diophantine equations, one can decide whether one state reaches the other in NP in the size of the encoding of the system (and without explicitly constructing the automaton).",
            "cite_spans": [
                {
                    "start": 289,
                    "end": 292,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "This article gives a high-level yet sufficiently detailed outline of how the NP upper bound for existential B\u00fcchi arithmetic can be obtained. We subsequently show how the techniques used for the NP upper bound can be applied in order to show decidability and complexity results for an extension of Presburger arithmetic with valuation constraints. Those results are somewhat implicit in [8] but seem worthwhile being explicated in written. We conclude with some observations and discussion of open problems.",
            "cite_spans": [
                {
                    "start": 387,
                    "end": 390,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We denote by R the real numbers, by R + the non-negative reals, by Q the rational numbers, by Z the integers, by N the non-negative integers, and by N + the positive integers. For integers a < b, we write [a, b] for the set {a, a+1, . . . , b}. All numbers in this article are assumed to be encoded in binary. Given a matrix A \u2208 Z m\u00d7n with components a ij \u2208 Z,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Preliminaries"
        },
        {
            "text": "For v \u2208 R n , we just write v \u221e .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Preliminaries"
        },
        {
            "text": "Throughout this article, let p \u2265 2 be a base. Recall that Presburger arithmetic is the first-order theory of the structure N, 0, 1, + . B\u00fcchi arithmetic is the firstorder theory of the structure N, 0, 1, +, V p obtained from endowing Presburger arithmetic with a functional binary predicate V p \u2286 N \u00d7 N such that V p (x, u) evaluates to true if and only if u is the largest power of p dividing x without remainder. This definition leaves the case x = 0 ambiguous. A sensible approach would be to introduce a special value \u221e and to assert V p (0, \u221e) to hold, many authors choose to assert V p (0, 1), see e.g. [4] . However, the particular choice has no impact on the sets of naturals definable in B\u00fcchi arithmetic.",
            "cite_spans": [
                {
                    "start": 609,
                    "end": 612,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "B\u00fcchi Arithmetic"
        },
        {
            "text": "Atomic formulas of B\u00fcchi arithmetic are either linear equations a \u00b7 x = c or B\u00fcchi predicates V p (x, u). Note that the negation of a \u00b7 x = c is equivalent to a \u00b7 x < c \u2228 a \u00b7 x > c. Since we interpret variables over the non-negative integers, we have a \u00b7 x > c \u2261 \u2203y a \u00b7 x \u2212 y = c + 1. Consequently, we can, with no loss of generality, assume that negation symbols only occur in front of V p predicates. Now if we consider a negated literal \u00acV p (x, u), we have that \u00acV p (x, u) evaluates to true if and only if either (i) u is a power of p but not the largest power of p dividing x; or (ii) u is not a power of p.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B\u00fcchi Arithmetic"
        },
        {
            "text": "The case (i) can easily be dealt with, as it is definable by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B\u00fcchi Arithmetic"
        },
        {
            "text": "Moreover, \u00acV p (u, u) asserts that u is not a power of p. Thus, we may, without loss of generality, assume that quantifier-free formulas of B\u00fcchi arithmetic are positive Boolean combinations of atomic formulas a\u00b7x = c, V p (x, u) and V p (u, u).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B\u00fcchi Arithmetic"
        },
        {
            "text": "It is well known that B\u00fcchi arithmetic can elegantly be decided using finite-state automata, see [2] for a detailed overview over this approach. In this section, we give a generic definition of deterministic automata and then define p-automata which are used for deciding B\u00fcchi arithmetic.",
            "cite_spans": [
                {
                    "start": 97,
                    "end": 100,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Finite-State Automata and p-automata"
        },
        {
            "text": "Note that this definition allows automata to have infinitely many states and to have partially defined transition functions (due to the presence of \u22a5 in the codomain of \u03b4).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "For states q, r \u2208 Q and u \u2208 \u03a3, we write q u \u2212 \u2192 r if \u03b4(q, u) = r, and extend \u2212 \u2192 inductively to finite words such that for w \u2208 \u03a3 * and u \u2208 \u03a3, q",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "Whenever q w \u2212 \u2192 r, we say that A has a run on w from q to r. We write q * \u2212 \u2192 r if there is some w \u2208 \u03a3 * such that q w \u2212 \u2192 r. A finite-state automaton A is a deterministic automaton with a finite set of states that accepts finite words. The language of A is defined as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "We now introduce p-automata, which are deterministic automata whose language encodes a set of non-negative integers in base p. Furthermore, we recall the construction of the key gadget underlying the automata-based decision procedures for B\u00fcchi arithmetic which provides a representation of the set of nonnegative integer solutions of a system of linear equations as the language of a finite-state p-automaton.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "Formally, a p-automaton is a deterministic automaton over an alphabet \u03a3 n p := {0, 1, . . . , p \u2212 1} n for some nonnegative integer n. A finite word over the alphabet \u03a3 n p can naturally be seen as encoding an n-tuple of nonnegative integers in base p. There are two possible encodings: least significant digit first and most-significant digit first. We only consider the latter msd-first encoding, in which the most significant digit appears on the left. Formally, given a word",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "Note that for w = \u03b5, the empty word, we have w = 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "A system S of linear Diophantine equations has the form S : A \u00b7 x = c, where A is an m \u00d7 n matrix with integer coefficients, c \u2208 Z m , and x = (x 1 , . . . , x n ) is a vector of variables taking values in the nonnegative integers. We write S := {u \u2208 N n : A \u00b7 u = c} for the set of all nonnegative integer solutions of S. We denote by S the size of the encoding of S, i.e., the number of symbols required to represent S assuming binary encoding of all numbers.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "Following Wolper and Boigelot [19] , we define a p-automaton whose language is the msd-first encoding all nonnegative integer solutions of systems of linear equations.",
            "cite_spans": [
                {
                    "start": 30,
                    "end": 34,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [],
            "section": "Definition 1. A deterministic automaton is a tuple"
        },
        {
            "text": "Although the automaton A(S) has infinitely many states, it defines a regular language since there are only finitely many live states, i.e., states that can reach the set F of accepting states. The reason is that no state q \u2208 Q such that q \u221e > A 1,\u221e and q \u221e > c \u221e can reach an accepting state [1, 8] , and hence Q can be restricted to a finite number of states. A rough upper bound on the number #Q of states of A(S) is",
            "cite_spans": [
                {
                    "start": 292,
                    "end": 295,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 296,
                    "end": 298,
                    "text": "8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Definition 2. Let S : A \u00b7 x = c be a system of linear equations with integer coefficients such that"
        },
        {
            "text": "where m is the number of equations in the system S [8, 19] .",
            "cite_spans": [
                {
                    "start": 51,
                    "end": 54,
                    "text": "[8,",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 55,
                    "end": 58,
                    "text": "19]",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [],
            "section": "Definition 2. Let S : A \u00b7 x = c be a system of linear equations with integer coefficients such that"
        },
        {
            "text": "A key reachability property of the automaton A(S) is the following: Let q, r \u2208 Z m be states of A(S). Then for all k \u2208 N and words w \u2208 (\u03a3 n p ) k we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 2. Let S : A \u00b7 x = c be a system of linear equations with integer coefficients such that"
        },
        {
            "text": "From this characterization, it follows that the language of A(S) is an msd-first encoding of the set of solutions of the system A \u00b7 x = c. Indeed, choosing q as 0 and the final state c as r, we have that 0 w \u2212 \u2192 c if and only if A \u00b7 w m = c. If we wish to emphasize the underlying system S of linear Diophantine equations of a p-automaton A(S) we annotate the transition relation with the subscript S and, e.g., write q * \u2212 \u2192 S r.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 2. Let S : A \u00b7 x = c be a system of linear equations with integer coefficients such that"
        },
        {
            "text": "Given a base vector b \u2208 N n and a finite set of period vectors P = {p 1 , . . . , p m } \u2286 N n , define",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-linear Sets"
        },
        {
            "text": "We call L(b, P ) a linear set and we say that a subset of N n is semi-linear if it can be written as a finite union of linear sets. It is well-known that the set of nonnegative integer solutions of a system of linear Diophantine equations is a semi-linear set [7] . Also note that a linear set is definable by a formula of existential Presburger arithmetic of linear size.",
            "cite_spans": [
                {
                    "start": 260,
                    "end": 263,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Semi-linear Sets"
        },
        {
            "text": "A special subclass of semi-linear sets are ultimately periodic sets, which are an equivalent presentation of semi-linear sets in dimension one.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Semi-linear Sets"
        },
        {
            "text": "One of the main results of [8] is that deciding existential formulas of B\u00fcchi arithmetic is NP-complete. A main obstacle is that the magnitude of satisfying variable assignments may grow super-polynomially. It is known that for infinitely many primes q the multiplicative order ord q (2) of 2 modulo q is at least \u221a q [13] .",
            "cite_spans": [
                {
                    "start": 27,
                    "end": 30,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 318,
                    "end": 322,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "Existential B\u00fcchi Arithmetic"
        },
        {
            "text": "For such a prime the predicate x is a strictly positive power of 2 that is congruent to 1 modulo q can easily be expressed as a formula of existential B\u00fcchi arithmetic of base 2:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Existential B\u00fcchi Arithmetic"
        },
        {
            "text": "Observe that \u03a6(x) has a constant number of literals and that its length linear in the bit-length of q, while the smallest satisfying assignment is x = 2 ordq(2) . Thus satisfying assignments in existential B\u00fcchi arithmetic may have superpolynomial bit-length in the formula size, even for a fixed base and a fixed number of literals. This rules out the possibility of showing NP membership by a non-deterministic guess-and-check algorithm. We nevertheless have the following theorem:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Existential B\u00fcchi Arithmetic"
        },
        {
            "text": "Existential B\u00fcchi arithmetic inherits the NP lower bound from integer programming when the number of variables is not fixed. While existential Presburger arithmetic can be decided in polynomial time when the number of variables is fixed [15] , showing such a result for B\u00fcchi arithmetic would likely require major breakthroughs in number theory, even when fixing the number of literals. Given a, b, c \u2208 N, we can express discrete logarithm problems of the kind, does there exist x \u2208 N such that a x \u2261 b mod c, in a similar way as above:",
            "cite_spans": [
                {
                    "start": 237,
                    "end": 241,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "Such discrete logarithm problems are believed to possibly be even more difficult than those underlying the Diffie-Hellman key exchange [14] . Of course, it may well be that existential B\u00fcchi arithmetic with a fixed number of variables (and even literals) is NP-hard. For instance, existential Presburger arithmetic with a full divisibility predicate is NP-hard already for a fixed number of variables and literals [11] , shown via a reduction from a certain NP-complete problem involving a special class of quadratic congruences [12] . We now give an exposition of the NP upper bound of Theorem 1 developed in [8] . It clearly suffices to only consider quantifier-free formulas. Let \u03a6(x) be a quantifier-free formula of B\u00fcchi arithmetic, and let us first consider the special case of a system of linear Diophantine equations together with a single V p assertion",
            "cite_spans": [
                {
                    "start": 135,
                    "end": 139,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 414,
                    "end": 418,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 529,
                    "end": 533,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 610,
                    "end": 613,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "where x and u are variables occurring in x. From Sect. 2.2, we know that we can construct a p-automaton A(S) whose language encodes all solutions of S : A\u00b7x = c. A key insight enabling showing decidability of B\u00fcchi arithmetic is that the set of solutions of V p (x, u) for x > 0 can be encoded by a regular language over the alphabet \u03a3 p \u00d7 \u03a3 p :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "Thus, in order to decide whether \u03a6(x) is satisfiable, we can check whether we can find a run through the automaton A(S) that can be partitioned into three parts. In the first part, x can have any digit and u has only zeros as digits. The second part is a single transition in which x can have any non-zero digit and u has digit one, and in the third part both x and u have digits zero.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "To make this argument more formal, it will be useful to introduce a mild generalization of the reachability relation for p-automata. Suppose we are ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "where S \u2227 T is the system of equations",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "With the new notation at hand, the observations made above now enable us to reduce satisfiability of \u03a6(x) to three reachability queries in p-automata: \u03a6(x) is satisfiable if and only if there are states d and e of A(S), and a \u2208 \u03a3 p \\ {0} such that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "Note that by (1), the encoding of the binary representation of the states d and e of A(S) is polynomial in the encoding of S, and hence both states can be guessed in NP. The reduction to reachability queries in p-automata is easily seen to generalize to the case where we have an arbitrary number k of constraints V p (x i , u i ) in \u03a6(x). To check satisfiability, all we have to do is to guess a relative order between the u i , a i \u2208 \u03a3 p \\ {0}, states d i and e i of A(S), resulting in O(k) reachability queries in p-automata. We illustrate the reachability queries for the case in which u i > u i+1 for all 1 \u2264 i \u2264 k, the remaining cases follow analogously:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "Finally, we observe that the set of solutions of a literal \u00acV p (u, u), stating that u is not a power of p, is encoded by the regular language given by the following regular expression:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "Observe that this regular expression induces a decomposition similar to (3) . Hence, we can non-deterministically polynomially reduce deciding conjunctions of the form",
            "cite_spans": [
                {
                    "start": 72,
                    "end": 75,
                    "text": "(3)",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "for finite index sets I, J to a linear number of state-to-state reachability queries in p-automata implicitly given by systems of linear Diophantine equations. We now invoke the following theorem:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 1 ([8]). Existential B\u00fcchi arithmetic is NP-complete."
        },
        {
            "text": "In particular, the NP upper bound does not require the explicit construction of A(S). By application of this result and the arguments above, the NP upper bound for existential B\u00fcchi arithmetic follows. Given a quantifier-free formula \u03a6(x), as discussed in Sect. 2.1, we can assume that \u03a6 is a positive Boolean combination of literals a \u00b7 x = c, V p (x, u) and \u00acV p (u, u). Hence we can guess in NP a clause of the disjunctive normal form of \u03a6, which is of the form (5), and in turn check in NP a series of guessed reachability queries in p-automata induced by the guessed clause. We close this section with a brief discussion of the main ideas behind the NP upper bound of Theorem 2. The first observation is that reachability in p-automata reduces to satisfiability in a certain class of systems of linearexponential Diophantine equations. From (2), we can deduce that for a word w \u2208 (\u03a3 n p ) k ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 2 ([8]). Deciding state-to-state reachability in a p-automaton A(S) given by a system of linear Diophantine equations S is in NP (with respect to the encoding of S)."
        },
        {
            "text": "Let x = (x 1 , . . . , x n ) , replacing p k by a fresh variable y, it follows that q * \u2212 \u2192 r if and only if the following system of linear Diophantine inequalities has a solution in which y is a power of p:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 2 ([8]). Deciding state-to-state reachability in a p-automaton A(S) given by a system of linear Diophantine equations S is in NP (with respect to the encoding of S)."
        },
        {
            "text": "This is now a problem that is not difficult to decide, since we can guess in NP a linear set L(b, P ) \u2286 N m with a small description that generates a subset of the set of solutions of this system. Checking whether L(b, P ) contains a point in which the y-coordinate is a power of p can easily be done in NP, we refer the reader to [8] for further details.",
            "cite_spans": [
                {
                    "start": 331,
                    "end": 334,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Theorem 2 ([8]). Deciding state-to-state reachability in a p-automaton A(S) given by a system of linear Diophantine equations S is in NP (with respect to the encoding of S)."
        },
        {
            "text": "The definition of V p ensures that p-recognizable sets are equivalent to those definable in B\u00fcchi arithmetic. Note that it is possible to enrich Presburger arithmetic with an even more general predicate which does, however, not change the definable sets of natural numbers, see e.g. [4, p. 209 ]. But the predicate V p also has a close connection to the valuation function v p : Q \u2192 Z underlying the definition of the p-adic numbers. Given a prime p and a non-zero rational number x, the p-adic valuation v p (x) is defined to be the unique integer e \u2208 Z such that x = p e \u00b7 a b with a, b \u2208 Z and p a, b. Intuitively v p (x) is the exponent of the greatest power of p that divides x. Now the p-adic valuation v p and the V p predicate of B\u00fcchi arithmetic (viewing V p as a function) are related as follows: for a natural number n \u2208 N we have V p (n) = p vp(n) . Thus, we could view v p (n) as a succinct representation of V p (n).",
            "cite_spans": [
                {
                    "start": 283,
                    "end": 293,
                    "text": "[4, p. 209",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "In arithmetic theories over p-adic numbers, it is common to consider twosorted logics with one sort for the p-adic numbers and another sort for the valuation ring Z, together with additional (restricted) arithmetic over the valuation ring, see e.g. [18] . One can naturally transfer this concept to arithmetic theories over numerical domains other than the p-adic numbers. The decompositions established in the previous section together with classical results on finite-state automata then give decidability and complexity results.",
            "cite_spans": [
                {
                    "start": 249,
                    "end": 253,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "As a concrete illustrating example, we introduce in this section Presburger arithmetic with valuation constraints. Since v p (n) \u2208 N for all n \u2208 N + , technically we are not dealing with a multi-sorted logic. 1 We use the following notational convention: a variable x is interpreted as a natural number, and x def = v p (x) is interpreted as the valuation of x. A formula \u03a6 of Presburger arithmetic with valuation constraints is then given by a tuple",
            "cite_spans": [
                {
                    "start": 209,
                    "end": 210,
                    "text": "1",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "where both \u03a8 and \u0393 are formulas of Presburger arithmetic. We say that \u03a6 is existential if both \u03a8 and \u0393 are formulas of existential Presburger arithmetic.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "Moreover, \u03a6 is satisfiable with respect to a fixed p > 1 given as input whenever we can find a variable assignment \u03c3 : {x 1 , . . . , x n } \u2192 N such that both \u03a8 (\u03c3(x 1 ), . . . , \u03c3(x n )) and \u0393 (v p (\u03c3(x 1 )), . . . , v p (\u03c3(x n ))) evaluate to true.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "It is not surprising and easy to see that satisfying assignments are not semilinear since, e.g.,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "has the set of all positive integers n with v p (n) even and greater than zero as its set of satisfying assignments, i.e., \u03a6 defines the set {p 2k \u00b7 n : k, n \u2208 N + , p n} which, for any base p > 1, is obviously not ultimately periodic and hence not semi-linear. We now show NP-completeness of existential formulas of Presburger arithmetic with valuation constraints from which we can then conclude decidability of the general case. Given \u03a6 = (\u03a8, \u0393 ), let us first consider the case in which \u03a8 is a system of linear Diophantine equations S : A \u00b7 x = c with x = (x 1 , . . . , x n ), and \u0393 is existential. A solution of S is encoded by a path in A(S) from 0 to c, and if we assume without loss of generality that x i > x i+1 for all 1 \u2264 i < n then similarly as in (4) we can decompose this path as (6) for some w i \u2208 (\u03a3 n p ) * and with all a i = 0. Note that this decomposition implies that v p (x n ) = |w n | + 1, v p (x n\u22121 ) = |w n | + |w n\u22121 | + 2, etc. In particular, each |w i | is the length of a path between the states e i and d i+1 . It is well-known that the set of lengths of paths between two states in a non-deterministic finite-state automaton is semi-linear and that the encoding of each linear set in such a semilinear set is logarithmic in the number states, see e.g. [17] . Moreover, semi-linear sets are closed under taking finite sums. Recall that by the estimation in Eq. (1) the number of states of a p-automaton A(S) is exponentially bounded and that each state has an encoding linear in the encoding of S. It follows that given a decomposition as in (6), we can for each x i guess in NP a linear set L(b, P ) \u2286 N such that v p (x i ) \u2208 L(b, P ). Also recall from Sect. 2.3 that a linear set is definable by a formula of existential Presburger arithmetic of linear size. Consequently, we obtain the following non-deterministic polynomial-time algorithm deciding satisfiability of \u03a6 above:",
            "cite_spans": [
                {
                    "start": 796,
                    "end": 799,
                    "text": "(6)",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 1286,
                    "end": 1290,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "-guess the states occurring in a decomposition of a run from 0 to c in A(S) of the form (6) (again note that this does not require constructing A(S)); -from this decomposition, guess linear sets",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "If \u03a6 = (\u03a8, \u0393 ) is an arbitrary existential formula of Presburger arithmetic with valuation constraints, an NP upper bound also follows: we only need to guess a clause of the disjunctive normal form of \u03a8 and then proceed as before. The case where \u03a6 is arbitrary obviously reduces to the existential case since Presburger arithmetic has quantifier elimination.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Presburger Arithmetic with Valuation Constraints"
        },
        {
            "text": "This article provided an exposition of the results of [8] together with some results that follow but are not explicated in [8] . We described the proof of NPcompleteness of existential B\u00fcchi arithmetic and showed how this proof can be applied to obtain decidability of Presburger arithmetic with valuation constraints and NP-completeness of its existential fragment. We close this article with a couple of remarks and open questions for future work: -There is an analogue of B\u00fcchi arithmetic for the reals that was studied by Boigelot, Rassart and Wolper [1] . This analogue builds upon a predicate X p \u2286 R + \u00d7 Q \u00d7 [0, p \u2212 1] such that X p (x, u, k) is true if and only if u is a (possibly negative) integer power of p, and there is an encoding of x such that the digit at the position specified by u is k:",
            "cite_spans": [
                {
                    "start": 54,
                    "end": 57,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 123,
                    "end": 126,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 555,
                    "end": 558,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Conclusion"
        },
        {
            "text": "and there is q \u2208 Z s.t. q \u2264 , u = p q and a q = k.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        },
        {
            "text": "The real analogue of B\u00fcchi arithmetic is the first-order theory of the structure R + , 0, 1, +, X p (BRW arithmetic after the authors of [1] for short). 2 Looking at the similarities of the definitions of X p (x, u, k) and V p , it seems conceivable that existential BRW arithmetic is also NP-complete, though this is likely more tedious to prove mainly because some real numbers have multiple encodings (e.g., 1.0000 \u00b7 \u00b7 \u00b7 = 0.9999 \u00b7 \u00b7 \u00b7 ). -Presburger arithmetic with valuation constraints is a powerful logic which can be used to reason about sets of integers which are not semi-linear. Decidability in such contexts is rare, and NP-completeness of its existential fragment means that this logic could potentially find practical applications in areas such as formal verification, as we seemingly can, for instance, express some problems typically arising in bit-vector arithmetic. Generally speaking, what are natural applications of Presburger arithmetic with valuation constraints? -Is B\u00fcchi arithmetic with valuation constraints decidable? It can be derived from the approach presented in Sect. 4 that this is the case for existential B\u00fcchi arithmetic. However, the author is not aware of a quantifier-elimination procedure for B\u00fcchi arithmetic that given a formula of B\u00fcchi arithmetic allows for obtaining an equivalent formula of existential B\u00fcchi arithmetic. -Is existential B\u00fcchi arithmetic with a fixed number of variables (and possibly even a fixed number of literals) NP-complete? As discussed in Sect. 3, showing membership in P would require breakthroughs that currently (and likely over the next decades) seem out of reach, and would moreover break some public key cryptographic systems.",
            "cite_spans": [
                {
                    "start": 153,
                    "end": 154,
                    "text": "2",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "On the expressiveness of real and integer arithmetic automata (extended abstract)",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Boigelot",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Rassart",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Wolper",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "Automata, Languages and Programming",
            "volume": "1443",
            "issn": "",
            "pages": "152--163",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Representing arithmetic constraints with finite automata: An overview",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Boigelot",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Wolper",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Logic Programming",
            "volume": "2401",
            "issn": "",
            "pages": "1--19",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Diophantine equations, presburger arithmetic and finite automata",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Boudet",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Comon",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "Trees in Algebra and Programming -CAAP. Lect. Notes Comp. Sci",
            "volume": "1059",
            "issn": "",
            "pages": "30--43",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Logic and p-recognizable sets of integers",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Bruy\u00e8re",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Hansel",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Michaux",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Villemaire",
                    "suffix": ""
                }
            ],
            "year": 1994,
            "venue": "Bull. Belg. Math. Soc. Simon Stevin",
            "volume": "1",
            "issn": "2",
            "pages": "191--238",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "On the use of non-deterministic automata for presburger arithmetic",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Durand-Gasselin",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Habermehl",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Concurrency Theory -CONCUR",
            "volume": "6269",
            "issn": "",
            "pages": "373--387",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Ehrenfeucht-fra\u00efss\u00e9 goes elementarily automatic for structures of bounded degree",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Durand-Gasselin",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Habermehl",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Symposium on Theoretical Aspects of Computer Science, STACS. LIPIcs",
            "volume": "14",
            "issn": "",
            "pages": "242--253",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Bounded ALGOL-like languages",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ginsburg",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "H"
                    ],
                    "last": "Spanier",
                    "suffix": ""
                }
            ],
            "year": 1964,
            "venue": "T. Am. Math. Soc. pp",
            "volume": "",
            "issn": "",
            "pages": "333--368",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "On the existential theories of B\u00fcchi arithmetic and linear p-adic fields",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Gu\u00e9pin",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Haase",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Worrell",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Logic in Computer Science, LICS",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Bounds on the automata size for presburger arithmetic",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Klaedtke",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "ACM Trans. Comput. Log",
            "volume": "9",
            "issn": "2",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Tapas: The talence presburger arithmetic suite",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Leroux",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Point",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Tools and Algorithms for the Construction and Analysis of Systems",
            "volume": "5505",
            "issn": "",
            "pages": "182--185",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Some remarks on the Diophantine problem for addition and divisibility",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "M"
                    ],
                    "last": "Lipshitz",
                    "suffix": ""
                }
            ],
            "year": 1981,
            "venue": "Proc. Model Theory Meeting",
            "volume": "33",
            "issn": "",
            "pages": "41--52",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "NP-complete decision problems for binary quadratics",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "L"
                    ],
                    "last": "Manders",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "M"
                    ],
                    "last": "Adleman",
                    "suffix": ""
                }
            ],
            "year": 1978,
            "venue": "J. Comput. Syst. Sci",
            "volume": "16",
            "issn": "2",
            "pages": "168--184",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Counting Points Modulo p for some Finitely Generated Subgroups of Algebraic Groups",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "R"
                    ],
                    "last": "Matthews",
                    "suffix": ""
                }
            ],
            "year": 1982,
            "venue": "Bull. Lond. Math. Soc",
            "volume": "14",
            "issn": "2",
            "pages": "149--154",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "The discrete logarithm problem",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "S"
                    ],
                    "last": "Mccurley",
                    "suffix": ""
                }
            ],
            "year": 1990,
            "venue": "Proc. of Symp. in Applied Math",
            "volume": "42",
            "issn": "",
            "pages": "49--74",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Complexity of subcases of Presburger arithmetic",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Scarpellini",
                    "suffix": ""
                }
            ],
            "year": 1984,
            "venue": "T. Am. Math. Soc",
            "volume": "284",
            "issn": "",
            "pages": "203--218",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "The Li\u00e8ge automata-based symbolic handler (LASH",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Unary finite automata vs. arithmetic progressions",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "W"
                    ],
                    "last": "To",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Inf. Process. Lett",
            "volume": "109",
            "issn": "17",
            "pages": "1010--1014",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "The complexity of linear problems in fields",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Weispfenning",
                    "suffix": ""
                }
            ],
            "year": 1988,
            "venue": "J. Symb. Comput",
            "volume": "5",
            "issn": "1/2",
            "pages": "3--27",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "On the construction of automata from linear arithmetic constraints",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Wolper",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Boigelot",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "Tools and Algorithms for the Construction and Analysis of Systems",
            "volume": "1785",
            "issn": "",
            "pages": "1--19",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "given a system of linear equations S : A\u00b7x = c and an additional system of constraints T : B \u00b7 x = d. For all pairs of states q, r of the automaton A(S), write q w \u2212 \u2192 S[T ] r if q w \u2212 \u2192 S r and B \u00b7 w = d. Plainly q w \u2212 \u2192 S[T ] r if and only if q 0",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": []
}