{
    "paper_id": "5bc6c031927d7866b49dd599d65f4e38e5d9a6d5",
    "metadata": {
        "title": "Online Supplement -Dose-optimal vaccine allocation over multiple populations",
        "authors": [
            {
                "first": "Evelot",
                "middle": [],
                "last": "Duijzer",
                "suffix": "",
                "affiliation": {},
                "email": "duijzer@ese.eur.nl"
            }
        ]
    },
    "abstract": [],
    "body_text": [
        {
            "text": "Appendix S1 The herd effect function",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "In this paper we study the herd effect of vaccination, denoted by the function G j (f j ). In Section 3.2 we have defined G j (f j ) as the final fraction of people susceptible in population j after vaccinating a fraction f j of the susceptible people at time \u03c4 . More precisely, for f j \u2208 [0, s j (\u03c4 )]",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "with s j (t) evolving according to the differential equations of the SIR model (1) for t > \u03c4 . In this appendix we present and analyze an alternative formulation of the herd effect G j (f j ), which forms the basis of the structural analysis of the herd effect.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Based on the differential equations of the SIR model we derive an implicit expression for the herd effect. From (1) the following equation follows, which presents the relation between i j (t) and s j (t) at any time t (Hethcote 1976 ):",
            "cite_spans": [
                {
                    "start": 218,
                    "end": 232,
                    "text": "(Hethcote 1976",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "S1.1 Implicit formulation of the herd effect"
        },
        {
            "text": "i j (t) = \u2212s j (t) + log(s j (t)) \u03c3 j + s 0,j + i 0,j \u2212 log(s 0,j ) \u03c3 j",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Implicit formulation of the herd effect"
        },
        {
            "text": "Above relation characterizes the state of the system at any point in time, but prior to vaccination. Upon vaccination at time \u03c4 the state of the system changes from state (s j (\u03c4 ), i j (\u03c4 )) to state (s j (\u03c4 )\u2212 f j , i j (\u03c4 )). Hence, the state (s j (\u03c4 ) \u2212 f j , i j (\u03c4 )) directly after vaccination can be seen as a new initial state, where i j (\u03c4 ) can be obtained from (2). G j (f j ) is then obtained from (2) by setting i j (t) = 0 and thus is the unique solution to:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Implicit formulation of the herd effect"
        },
        {
            "text": "Above equation holds for all i 0,j > 0. The value of G j (f j ) in the limit i 0,j \u2193 0 can be determined by substituting i 0,j = 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Implicit formulation of the herd effect"
        },
        {
            "text": "(3) extends the final size equation to any initial state. The original final size equation can be recovered for f j = 0, s 0,j \u2192 1 and i 0,j \u2192 0 (see e.g., Kermack and McKendrick (1927) , Ma and Earn (2006) , Diekmann et al. (2012) and Keeling and Shattock (2012) ). We refer to Appendix S5 for an alternative expression of G j (f j ) using the Lambert W function denoted by W (x) (cf. Corless et al. 1996, Ma and Earn 2006) .",
            "cite_spans": [
                {
                    "start": 156,
                    "end": 185,
                    "text": "Kermack and McKendrick (1927)",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 188,
                    "end": 206,
                    "text": "Ma and Earn (2006)",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 209,
                    "end": 231,
                    "text": "Diekmann et al. (2012)",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 236,
                    "end": 263,
                    "text": "Keeling and Shattock (2012)",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 386,
                    "end": 413,
                    "text": "Corless et al. 1996, Ma and",
                    "ref_id": null
                },
                {
                    "start": 414,
                    "end": 424,
                    "text": "Earn 2006)",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "S1.1 Implicit formulation of the herd effect"
        },
        {
            "text": "We present implicit equations for the first and second order derivative of the function G(f ) with respect to f (we drop the subscript j for convenience). These derivatives will appear in the next sections to prove the structural characteristics of the herd effect G(f ). Denote by G (f ) and G (f ) respectively the first and second order derivative of the function G(f ) with respect to f which can be derived from (3):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.2 Derivatives of the herd effect"
        },
        {
            "text": "This appendix consists of theorems that describe the characteristics of the function G(f ). The proofs for Theorem 1, Theorem 2 and Theorem 3 are presented as well as other results required for these proofs. This appendix is structured as follows. We start with deriving bounds on the herd effect in Section S2.1. Section S2.2 focuses on the structure of the function G(f ). In Section S2.3 we formally derive and study the dose-optimal vaccination fraction. We need that the differential equations (1) have a solution s(t), i(t) and r(t) for all t which conforms to intuition: all fractions are between 0 and 1, s(t) is non-increasing over time and r(t) non-decreasing over time. We omit this technical result for brevity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix S2 Analysis of the herd effect -Lemmas and theorems"
        },
        {
            "text": "In the following three theorems we formally proof which values are feasible for G(f ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.1 Bounds on the herd effect"
        },
        {
            "text": "Proof. The differential equations in (1) show that i(t) is maximized when s(t) = 1/\u03c3. Note that G(f ) describes the fraction of people susceptible, when the pandemic has died out. Therefore, if G(f ) = 1/\u03c3, the function i(t) is maximal when the pandemic has died out, so i(t) is at most equal to 0. This contradicts our assumption that i 0 > 0. Using the same argument, it can be noted that it is not possible for G(f ) to be greater than 1/\u03c3. As long as s(t) > 1/\u03c3, the number of infectives is increasing, thereby reducing s(t). In a final state, when i(+\u221e) = 0, it must always hold that the fraction of susceptible people is below 1/\u03c3, which completes the proof.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.1 Bounds on the herd effect"
        },
        {
            "text": "Theorem S2.3. It holds that G(f ) < s(\u03c4 ) \u2212 f for all f \u2208 [0, s(\u03c4 )) for vaccination in an infected population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.1 Bounds on the herd effect"
        },
        {
            "text": "Proof. Upon vaccination the system changes from state (s(\u03c4 ), i(\u03c4 )) to state (s(\u03c4 ) \u2212 f, i(\u03c4 )). By assumption we have that s(\u03c4 ) > 0 and i(\u03c4 ) > 0 for vaccination in an infected population. By the differential equations in (1) this implies that the derivative of s(t) directly after vaccination is negative. As G(f ) = lim t\u2192+\u221e s(t) (2) and s(t) is non-increasing over time, we have that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.1 Bounds on the herd effect"
        },
        {
            "text": "This section is dedicated to deriving structural results on the herd effect G(f ). This is done by analyzing the derivatives of this function as presented in Section S1.2.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Lemma S2.1. The function G(f ) is twice differentiable for all f \u2208 [0, s(\u03c4 )) in case of vaccination in an infected population (i 0 > 0) and twice differentiable for all f \u2208 [0, s(\u03c4 )) with f = s(\u03c4 ) \u2212 1 \u03c3 in case of vaccination in a completely susceptible population (the limit i 0 \u2193 0).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Proof. We prove the following four statements consecutively:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(i). The function G(f ) is differentiable for all f \u2208 [0, s(\u03c4 )) for vaccination in an infected population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(ii). In case of vaccination in a completely susceptible population (i.e., s 0 > 0, i 0 = 0 and s(\u03c4 ) =",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": ") in case of vaccination in an infected population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(iv). The function G(f ) is twice differentiable for all f \u2208 [0, s(\u03c4 )) except for f = f * = s(\u03c4 ) \u2212 1 \u03c3 in case of vaccination in a completely susceptible population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "We start the proof:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(i). Note that vaccination in an infected population means i(\u03c4 ) > 0 and i 0 > 0 which implies G(f ) < 1 \u03c3 by Theorem S2.2. For G(f ) = 1 \u03c3 the function G (f ) is not defined as can be seen in (4). However, this does not occur for vaccination in an infected population (Theorem S2.2). The function G(f ) : [0, s(\u03c4 )] \u2192 R. We therefore also analyze the existence of the derivative at the boundaries f = 0 and f = s(\u03c4 ). Because G(0) < 1 \u03c3 by Theorem S2.2:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "By Theorem S2.1 we have lim f \u2191s(\u03c4 ) G(f ) = 0 < 1 \u03c3 and thus lim f \u2191s(\u03c4 ) G (f ) < 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(ii). First we will prove that the given vaccination fractions indeed render G(f ) to be indifferentiable. Consider the explicit expression for G(f ) in (22) and insert the parameter settings for vaccination in a completely susceptible population and the value for f * :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": ". Now we will also prove that for vaccination in a completely susceptible population G(f ) is differentiable for all f \u2208 [0, 1) for which f = f * . By definition of the Lambert W function, W (y(f )), this function is differentiable for all y(f ) / \u2208 {0, \u22121/e} (Corless et al. 1996) . (22). Clearly y(f ) < 0, since f < s(\u03c4 ). Thus, we only need to investigate for which f the function y(f ) = \u2212 exp{\u22121}. Note that this only holds for:",
            "cite_spans": [
                {
                    "start": 260,
                    "end": 281,
                    "text": "(Corless et al. 1996)",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": ". By (4) and (5) G(f ) is twice differentiable unless one of the following conditions holds:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": ", G(f ) = 0. In Theorem S2.1 we showed that G(f ) > 0 for all f \u2208 [0, 1). By Theorem S2.2 we know that G(f ) < 1 \u03c3 for vaccination in an infected population and since lim f \u2191s(\u03c4 ) G(f ) = 0, part (iii) follows directly.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(iv). For vaccination in a completely susceptible population we showed that G(f ) = 1 \u03c3 \u21d4 f = f * in part (ii), which proves part (iv).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Theorem 1. There is a unique vaccination fraction f * = max s(\u03c4 ) \u2212 1 \u03c3 , 0 that maximizes the herd effect: the herd effect G(f ) is increasing in f for all f < f * , maximized for f = f * and decreasing for f > f * .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "It is increasing for f < f * and decreasing for f > f * . Note that for s(\u03c4 ) \u2264 1 \u03c3 we get f * \u2264 0 and thus the function G(f ) is only decreasing in that case.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Lemma S2.2. Let G (f ) be the second derivative of the function G(f ) with respect to f . Then for i 0 > 0 the following holds:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Proof. We analyze G (f ) which is presented in (5). Because lim f \u2191s(\u03c4 ) G(f ) = 0 (Theorem S2.1), the function G (f ) is not defined for f = s(\u03c4 ). We prove the three statements of the lemma:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(i). We analyze G (f ) = 0 and consider that G(f ) < 1 \u03c3 (Theorem S2.2):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "In the second step we use that (\u03c3G(f ) \u2212 1)G(f )(s(\u03c4 ) \u2212 f ) 2 = 0, which holds for all f < s(\u03c4 ) by Theorems S2.1 and S2.2. In the third step we substitute (4). Thus G (f ) = 0 if and only if one of the following two relations holds: ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "(ii). Consider the second expression in (5), by Theorems S2.1 and S2.2 we have: (7) we derive:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Thus G (f ) > 0 if and only if one of the following two relations hold: (iii). Analogous to the previous proof we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Thus, G (f ) < 0 if and only if one of the following two relations hold:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Analysis of the structure of the herd effect"
        },
        {
            "text": "Proof. From (4) we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "From Lemma S2.2 we note that G (f ) has an extreme under the following condition:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "By contradiction we assume that there exists a vaccination fractionf for which G (f ) \u2265 1 and assume thatf meets condition (9), then:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "We arrive at a contradiction, because by Theorem 1 we have that G (f ) < 0 for all f > s(\u03c4 ) \u2212 1 \u03c3 . Thus, G (f ) < 1 for all f that are an extreme for G (f ). This completes the proof that G (f ) < 1 for all f \u2208 (0, s(\u03c4 )). We consider the two boundary cases: f = 0 and f = s(\u03c4 ). From Lemma S2.1 we know that lim f \u2191s(\u03c4 ) G (f ) < 0 and thus the lemma is satisfied for f = s(\u03c4 ). For lim f \u21930 G (f ), we distinguish between three cases: (i). if G (0) = 0: then f = 0 is an extreme of the function G (f ) for which the derivative is strictly smaller than 1. (6):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "Theorem 2. There exists a unique vaccination fractionf with",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "This implies that M (f ) = 0 has only one solution and thus there is only onef for which G (f ) = 0. As G (f ) is a continuous function this implies that on either side off the function G(f ) is either convex or concave.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "By Lemma S2.2 we have G (f ) < 0 for f \u2265 s(\u03c4 ) \u2212 1 \u03c3 and thus G(f ) is concave for f >f . Since M (f ) < 0 and M (f ) = 0 it holds that M (f ) > 0 for f <f . By Lemma S2.2 this implies that G(f ) is convex for all f <f , which proves the convex-concave shape of the function G(f ). Note that this prove only holds for i 0 > 0. In case i 0 = 0 we refer to Lemma S2.3. By Lemma S2.2 G(f ) is concave for f \u2265 f * , such thatf \u2264 f * . This completes the proof of this theorem. Lemma S2.3. In case of vaccination in a completely susceptible population, the function G(f ) is convex for all f < f * and concave for all",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "Proof. By Lemma S2.1(ii) we have that G(f * ) = 1 \u03c3 for vaccination in a completely susceptible population. Since the vaccination fraction f * also maximizes the function G(f ) (Theorem 1), it holds that G(f ) < 1 \u03c3 for all f = f * . In Lemma S2.2 we derived conditions for G(f ) to be convex or concave where we needed that G(f ) < 1 \u03c3 . These conditions can still be used if we apply them only to f = f * .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "is increasing for f < f * , just as the expression on the right hand side in the conditions for convexity and concavity. By Theorem S2.4 the expression",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "Theorem 3. For the structure of G(f ) we can distinguish three cases based on s(\u03c4 ), the proportion of susceptibles at the moment of vaccination \u03c4 :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "(i) C < s(\u03c4 ) < 1: We have f * >f > 0. Thus G(f ) is increasing and convex between 0 andf , increasing and concave betweenf and f * , and decreasing and concave above f * .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "Thus G(f ) is increasing and concave between 0 and f * , and decreasing and concave above f * .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "Thus G(f ) is decreasing and concave everywhere.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "Proof. From Theorem 2 it follows thatf \u2264 f * . It therefore suffices to proof the following two steps:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "(a) f * > 0 if s(\u03c4 ) > 1/\u03c3 and f * = 0 otherwise.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "The proof is given below:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "(a) This follows directly from Theorem 1:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "(b) We start from deriving the value C. By Theorem 2 the function G(f ) has a convex and a concave part for certain parameter settings. By Lemma S2.2 the following condition must hold for G(f ) to be convex:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "for all values f below a certain threshold, the following condition requires that the function G(f ) has a convex part:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "We solve above inequality with equality to obtain the value C. By substituting in (3) this results in the following, where H(x) = \u2212x + 1 \u03c3 log(x):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "We know that \u22121 < W [\u2212\u03c3 exp{k\u03c3}] < 0 (cf. Appendix S5) and thus 1 \u03c3 < C < 2 \u03c3 . Note that for s(\u03c4 ) \u2264 1 \u03c3 condition (10) is never met by Theorem S2.2. By Theorem S2.1 the condition is always met for s(\u03c4 ) \u2265 2 \u03c3 . Thus only for s(\u03c4 ) > C the function G(f ) has a convex part and for s(\u03c4 ) = C we havef = 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "This completes the proof of this theorem.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "By Theorem S2.3 the second relation is satisfied and thus"
        },
        {
            "text": "We present the dose-optimal vaccination fractionf and relate it to the vaccination fractions f * and f as defined in Theorem 1 and Theorem 2 respectively. Proof. The function D(f ) is defined as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.3 The dose-optimal vaccination fraction"
        },
        {
            "text": "By ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.3 The dose-optimal vaccination fraction"
        },
        {
            "text": "This clearly holds by Theorem S2.2 and thusf \u2264 f * , due to Theorem 2. The optimal vaccination fractionf is defined as the fraction that maximizes the function D(f ) and meets the condition G (f ) = D(f ). Observe that D(f ) \u2265 0, because lim f \u21930 D(f ) = 0 andf maximizes D(f ). This implies that G (f ) \u2265 0 and thusf \u2264 f * by Theorem 1. By argument we showed in Corollary 1 thatf cannot be in the convex domain of the function G(f ), such that f \u2264f . This completes the proof of this lemma. Proof. This result follows directly from Lemma 1 and Lemma S2.3.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.3 The dose-optimal vaccination fraction"
        },
        {
            "text": "In Section 4.5 we state that it is optimal to vaccinate as early as possible in an ideal world. We prove this in the following lemma.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.4 The best vaccination moment"
        },
        {
            "text": "Lemma S2.6. The herd effect G(f ) is increasing in s(\u03c4 ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.4 The best vaccination moment"
        },
        {
            "text": "Proof. Let G s(\u03c4 ) (f, s(\u03c4 )) be the derivative of G(f, s(\u03c4 )) with respect to s(\u03c4 ):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.4 The best vaccination moment"
        },
        {
            "text": "Observe that the objective function is increasing in s(\u03c4 ), because G(f, s(\u03c4 )) < 1 \u03c3 by Theorem S2.2. Therefore, to maximize the herd effect one should vaccinate as soon as possible, i.e., when s(\u03c4 ) is as high as possible.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.4 The best vaccination moment"
        },
        {
            "text": "One of the extensions to the standard SIR compartmental model, is the SI n R model with n different consecutive infectious stages. Let s(t) and r(t) denote the fraction of people respectively susceptible and removed at time t. The fractions of people susceptible in every state are given by i k (t) for k = 1, ..., n. Interpretation dictates that s(t) + n k=1 i k (t) + r(t) = 1 for all t. Let \u03b2 k and \u03b3 k denote respectively the transmission rate and recovery rate in infectious stage k. The differential equations for the SI n R model are: Hyman et al. (1999) prove that R 0 = n k=1 \u03b2 k \u03b3 k for this model, with R 0 denoting the basic reproduction ratio.",
            "cite_spans": [
                {
                    "start": 542,
                    "end": 561,
                    "text": "Hyman et al. (1999)",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "Theorem S3.1. Up to a constant, the expression for G(f ) given in (3) also applies to the SI n R model with \u03c3 = n k=1 \u03b2 k \u03b3 k . Proof. The following relation can be derived from (11), using \u03c3 = n k=1 \u03b2 k \u03b3 k . Analogous to Ma and Earn (2006) ",
            "cite_spans": [
                {
                    "start": 223,
                    "end": 241,
                    "text": "Ma and Earn (2006)",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "We let t \u2192 \u221e and use that i k (\u221e) = 0 for k = 1, ..., n. This results in the following expression, which is equal to the expression for the SIR (3) model up to a constant:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "We vaccinate a fraction f of the population at time \u03c4 . Analogous to the analysis of the SIR model, we let (s(\u03c4 ) \u2212 f, i 1 (\u03c4 ), ..., i n (\u03c4 )) be a new initial state and define the value s(\u221e) according to (13) . The values for i k (\u03c4 ) for k = 1, ..., n can be calculated according to (12). We define G(f ) = lim t\u2192\u221e s(t), where s(t) follows (11) for t > \u03c4 . This results in the following:",
            "cite_spans": [
                {
                    "start": 206,
                    "end": 210,
                    "text": "(13)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "Above expression equals the expression for the SIR model (3) up to the final term, which is a constant.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "Lemma 2. The results of Theorem 1, Theorem 2, Theorem 3 and Corollary 1 also apply to the SI n R model with \u03c3 = n k=1 \u03b2 k \u03b3 k . In particular, for each SI n R model with given initial conditions there exist vaccination fractionsf ,f and f * that together characterize the convex-concave and increasing-decreasing shape of the herd effect.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "Proof. By Theorem S3.1 the expression for G(f ) in the SI n R model is equal to the expression in the SIR model up to a constant. This constant disappears after taking the derivative, implying that the first and second order derivative do not change. The structural properties of the function G(f ) thus carry over.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix S3 Generality of the function G(f )"
        },
        {
            "text": "In this appendix we characterize the optimal solution to the vaccine allocation problem of Section 3.3. We first derive a basic result in Section S4.1: that it is suboptimal to leave vaccines unused. The main derivation of the optimality conditions is presented in Section S4.2.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix S4 Optimal vaccine allocation -Theorems and proofs"
        },
        {
            "text": "We formally show that it is optimal to use the entire available vaccine stockpile. Thereto we define the function F j (f j ) as the total effect of vaccinating with a fraction f j in population j:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "Observe that the dose-optimal vaccination fractionf as defined by Corollary 1 does not only result in the highest additional herd effect per dose of vaccine, but also in the highest additional total effect per dose of vaccine. Formally,f also maximizes the average slope of the total effect F (f ) on the interval [0, f ], calculated as [F (f ) \u2212 F (0)]/f . As vaccinating with the fractionf is very efficient per dose of vaccine, the optimal allocation tries to allocate as close as possible tof in a subset of all the populations as can be seen in Theorem 5.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "Theorem S4.1. The fraction of people not infected during the epidemic, F j (f j ) = G j (f j ) + f j , is increasing in f j for all f j \u2208 [0, s j (\u03c4 )).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "Proof. We prove this theorem for a single population and therefore drop the subscript j in the proof. Let F (f ) denote the derivative of F (f ) with respect to f :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "is increasing under the following condition: Because the functions F j (f j ) are all non-decreasing there always exists an optimal solution for which all available vaccines are used:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "Lemma S4.1. The vaccine allocation problem always has an optimal solution for which j\u2208J f j N j = V .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "Proof. Let x j for all j \u2208 J be a solution of the vaccine allocation problem and assume that j\u2208J x j N j < V . Let y j for all j \u2208 J be the solution for which y j \u2265 x j for all j \u2208 J, such that j\u2208J y j N j = V . By Lemma S4.1 the functions F j (f ) are non-decreasing and thus F i (y i ) \u2265 F j (x j ) for all j \u2208 J. This implies that: j\u2208J N j F j (y j ) \u2265 j\u2208J N j F j (x j ). Hence, the proposed solution y j for all j \u2208 J for which j\u2208J y j N j = V is also an optimal solution.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.1 The total effect of vaccination"
        },
        {
            "text": "Theorem 2 establishes that resource allocation Problem (3) is a knapsack problem with S-shaped return functions: non-decreasing and convex for all x smaller than some valuex and concave for all x >x (cf. Ginsberg (1974) and Agral\u0131 and Geunes (2009) ). As the vaccine allocation problem is a maximization problem with inequality constraints, necessary conditions for the optimum are given by the Karush-Kuhn-Tucker (KKT) conditions. Let \u03b4 be the KKT multiplier for the capacity constraint, \u03bb j for the non-negativity constraint f j \u2265 0 for all j \u2208 J and \u00b5 j for the constraint f j \u2264 s j (\u03c4 ) for all j \u2208 J. Denote by f , \u03bb, \u00b5 the vectors with the variables f j , \u03bb j and \u00b5 j respectively. Let L(f , \u03bb, \u00b5, \u03b4) denote the Lagrange function of the maximization problem. The KKT conditions for this problem are given in (16). Observe that the marginal efficiency \u03c9 as introduced in Section 5.1 follows from the KKT condition that the partial derivative of L(f , \u03bb, \u00b5, \u03b4) with respect to f j equals 0 for all j \u2208 J.",
            "cite_spans": [
                {
                    "start": 204,
                    "end": 219,
                    "text": "Ginsberg (1974)",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 224,
                    "end": 248,
                    "text": "Agral\u0131 and Geunes (2009)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "We analyze the solution to (3) using the KKT conditions. We first present the solution to the general problem in Theorem S4.2. In Lemma S4.2 and Lemma S4.3 we discuss two simplifications. These enable us to proof the Central Insight in Theorem 4.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Theorem S4.2. For every optimal solution to (3) there exist J \u2286 J, k \u2208 J and \u03c9 \u2265 0 such that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(i). For all j \u2208 J \\ {k}, f j is the unique solution to G j (f j ) = \u03c9 for which f j \u2265f j .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(ii). G k (f k ) = \u03c9, and either f k is the unique solution to this equation for which f k \u2265f k or f k is the unique solution for which f k <f k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(iii). Either f j = 0 or f j = s j (\u03c4 ) for every j \u2208 J \\ J .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Proof. The proof of this theorem consists of the following steps:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(a). Let J \u2286 J such that 0 < f j < s j (\u03c4 ) for all j \u2208 J . We prove that G j (f j ) = \u03c9 for all j \u2208 J .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(b). We prove that for at most one population there is a strictly positive vaccination fraction in the strictly convex domain, i.e. 0 < f k <f k for at most one k \u2208 J .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "We proof the two steps consecutively:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(a). This result follows from the KKT conditions. Note that for any population j for which 0 < f j < s j (\u03c4 ) the KKT conditions require that \u00b5 j = 0 and \u03bb j = 0. This gives the following:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(b). By contradiction assume there is an optimal solution with at least two strictly positive variables in the convex domain. W.l.o.g. let 0 < f j <f j for j = 1, 2, i.e. the functions F 1 (f ) and F 2 (f ) are convex at respectively f 1 and f 2 . Choose an 0",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "N 2 such that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "By the KKT conditions F 1 (f 1 ) = F 2 (f 2 ) and by convexity of F 1 (f 1 ) and F 2 (f 2 ) the following can be derived:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Above relation shows that the objective function can be improved by a small change in the allocation. Thus, a solution with more than one strictly positive variable in the convex domain can never be optimal.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Lemma S4.2. If s j (\u03c4 ) > 1 \u03c3 j for all j \u2208 J, then there is no optimal solution to (3) for which f j = 0 and f k = s k (\u03c4 ) for two populations j, k \u2208 J. This implies that (iii) of Theorem S4.2 changes into:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Proof. By contradiction assume that f 1 = 0 and f 2 = s 2 (\u03c4 ) w.l.o.g. Let > 0 and \u03b4 = N 1 N 2 < 1 such that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The following holds:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "For s j (\u03c4 ) > 1 \u03c3 j the function G j (f ) is initially increasing by Theorem 1, implying that G 1 ( ) > G 1 (0). Furthermore, by Theorem S2.1 G j (f j ) > 0 for all 0 \u2264 f j < s j (\u03c4 ) and lim f j \u2191s j (\u03c4 ) G j (f j ) = 0. This implies that G 2 (s 2 (\u03c4 )\u2212\u03b4) > G 2 (s 2 (\u03c4 )). Thus, a small change in allocation can improve the solution. We arrive at a contradiction which completes the proof of this lemma. Lemma S4.3. If s j (\u03c4 ) > 1 \u03c3 j for all j \u2208 J and V \u2264 j\u2208J N j f * j then there is no optimal solution to (3) with f j = s j (\u03c4 ) for some j \u2208 J. This implies that (iii) of Theorem S4.2 changes into: f j = 0 for all j \u2208 J \\ {J \u222a {k}}.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Proof. By contradiction assume that there is a population k \u2208 J for which f k = s k (\u03c4 ) in the optimal solution. Since s k (\u03c4 ) > 1 \u03c3 k this implies that f k > f * k = s k (\u03c4 ) \u2212 1 \u03c3 k . Because V \u2264 j\u2208J N j f * j there must also be a population l for which f l < f * l in the optimal allocation. Let > 0 be sufficiently small such that f l + < f * l and f k \u2212 N l N k > f * k . Then the following holds, where the inequality follows from Theorem 1:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "A small change in allocation can improve the solution. Hence, there cannot be an optimal solution with f j = s j (\u03c4 ) for some j \u2208 J. We arrive at a contradiction which proves the first part of this lemma. The implication then directly follows from Lemma S4.2.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Theorem 4. Every optimal solution to (3) can be characterized as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(i). A subset of populations J \u2286 J is vaccinated with the regular fraction that corresponds to marginal efficiency \u03c9.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(ii). Possibly another population k is also vaccinated with marginal efficiency \u03c9, but with the exceptional fraction for which f k <f k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(iii). The remaining populations are not vaccinated at all.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Proof. This theorem can be reformulated more analytically as follows: For every optimal solution to (3) there exist J \u2286 J, k \u2208 J and \u03c9 \u2265 0 such that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(i). For all j \u2208 J \\ {k}, f j is the unique solution to G j (f j ) = \u03c9 for which f j \u2265f j .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(ii). G k (f k ) = \u03c9, and either f k is the unique solution to this equation for which f k \u2265f k or f k is the unique solution for which f k <f k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(iii). f j = 0 for all j \u2208 J \\ J .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The proof then follows directly from Theorem S4.2, Lemma S4.2 and Lemma S4.3.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Theorem 5. Consider a set of populations J with \u2200j: G j (f ) = G(f ) and a total available amount of resources equal to V . Let |J| = n and order the populations such that N 1 \u2264 ... \u2264 N n . The optimal allocation for particular cases is as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(a). if V <f N 1 , then allocate only to the smallest population. Set f 1 = V /N 1 and f j = 0 for j = 2, ..., n.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(b). if V = j\u2208Kf N j for a subset K \u2286 J, then set f j =f for j \u2208 K and f j = 0 for j / \u2208 K.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(c). if V > j\u2208Jf N j , then allocate pro rata over all the populations: f j = V j\u2208J N j for all j \u2208 J. Proof. This proof uses ideas that are also used in the proof of Proposition 1 of Ginsberg (1974) .",
            "cite_spans": [
                {
                    "start": 184,
                    "end": 199,
                    "text": "Ginsberg (1974)",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(a).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Step (b) in the proof of Theorem S4.2 shows that an optimal allocation results in at most one strictly positive vaccination fraction in the convex domain. By this result, the proposed allocation follows directly from convexity of the function G(\u00b7) for all f <f <f .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(b). The proposed allocation results in the maximum attainable value for the objective function for V available vaccines and is thus optimal.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(c). We prove the optimality of the proposed allocation using the items of Theorem S4.2. More precisely, regarding item (iii) we show that f j = s(\u03c4 ) cannot occur for any j \u2208 J and we analyze the two types of strategies that remain. Consider item (iii): for the special case of identical parameters it holds that s j (\u03c4 ) := s(\u03c4 ) for all j \u2208 J. We can show that an allocation with f j = s(\u03c4 ) and f k < s(\u03c4 ) for arbitrary populations j, k \u2208 J cannot be optimal:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The inequality follows because of the structure of the function F (\u00b7). Thus, it is not optimal to set f j = s(\u03c4 ) for some j \u2208 J. Using this result, there are two possible allocations remaining by Theorem S4.2:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(i) Either the amount V is allocated pro rata over the populations in K \u2286 J. i.e., f j = V j\u2208K N j =x and f j = 0 for all j / \u2208 K.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "(ii) Or an amount \u03be is allocated to one population k and the remaining (V \u2212 \u03be) is allocated pro rata over all populations in I \u2286 J\\{k}. i.e., f k = \u03be/N k , f j = V \u2212\u03be j\u2208I N j =\u0177 for j \u2208 I and f j = 0 for all j / \u2208 I \u222a {k}.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "First we consider scheme (i) and prove that it is optimal to allocate pro rata over all populations, i.e., we show that it is optimal to let K equal J. Let z j and x j respectively denote the pro rata allocation over K \u2282 J and over J, such that z j =\u1e91 = V j\u2208K N j for all j \u2208 K and x j =x = V j\u2208J N j for all j \u2208 J. Note that\u1e91 >x >f , because V > j\u2208J N jf by assumption. This implies the following inequality by Corollary 1:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The first equivalence follows by substituting the definitions ofx and\u1e91 and the second equivalence follows by rearranging terms. The last inequality shows precisely that allocating pro rata over all populations gives a higher objective value than allocating pro rata over K \u2282 J.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Second, we now consider allocation scheme (ii), in which an amount of \u03be is allocated to population k and the remaining V \u2212 \u03be is allocated pro rata over I \u2286 J\\{k} to reach a vaccination fraction\u0177. We will show that allocation scheme (ii) will never be superior to allocation scheme (i), in which the latter allocates pro rata over all populations to reach a vaccination fractionx. By contradiction we assume that allocation (ii) is optimal and thus better than allocation (i).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "We first show that the vaccination fractionx in allocation (i) is smaller than the vaccination fraction\u0177 in allocation (ii). By Theorem S4.2 \u03be/N k lies in the convex domain of F (\u00b7), which implies \u03be/N k <f <f . We also know thatf <x \u2264 1 N k ( j\u2208J N j \u2212 j\u2208I N j )x, where the first inequality follows becausex >f by V > j\u2208J N jf and the second inequality because I \u2286 J\\{k}. By combining the inequalities, we have that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The first equivalence follows fromx = V j\u2208J N j and in the second equivalence we rewrite terms. Note that the last inequality is preciselyx <\u0177.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "We now compare allocation (i) and (ii). Under the assumption that (ii) is better than (i), the following must hold:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The equivalence above follows from the fact that both allocations allocate the same amount of vaccines, i.e., the direct effect is the same. Hence, it suffices to consider the herd effect instead of the total effect. (17) implies the following:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The equivalences above follow from rearranging, cancelling and recombining terms. By Lemma 1f is in the concave domain, which also holds for all f >f . Since\u0177 >x >f it holds that G (\u0177) < 0 and G (x) < 0. This implies that (\u0177 \u2212x)G (x) > \u0177 x G (f )df . We thus have the following:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The second inequality follows from (18) and in the last inequality we use that [G(f ) \u2212 G(0)]/f > G (f ) for all f >f by Corollary 1. The three inequalities in (19) together establish that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "The first equivalence follows from rearranging terms and the second by definition ofx and\u0177.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "the equitable allocation. Note that the additional herd effect becomes negative for large vaccine stockpiles, because vaccinating many people leaves very few people susceptible. This implies that herd effect can be lower for large vaccine stockpiles than for no vaccination, resulting in a negative additional herd effect. Figure 1 : The left figure illustrates the relative performance of the optimal allocation for the non-interacting case (Figure 7 ) and the equitable pro rata allocation evaluated in the model as described in Section 5.4 with interactionfactor c = 0.01. We evaluate the additional herd effect for vaccine stockpiles up to size 550, because the right figure shows that for larger vaccine stockpiles the additional herd effect becomes negative.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 323,
                    "end": 331,
                    "text": "Figure 1",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 442,
                    "end": 451,
                    "text": "(Figure 7",
                    "ref_id": null
                }
            ],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "We also study the optimal allocation for increasing levels of interaction. Figures 2, 3 , 4 and 5 display the optimal allocation in case interaction between populations is respectively 0.01, 0.02, 0.05 and 0.1 times the interaction within a population. This corresponds to interaction between populations being a factor 100, 50, 20 or 10 times weaker than interaction within a population. The figures are discussed in Section 5.4.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 75,
                    "end": 87,
                    "text": "Figures 2, 3",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "S4.2 Optimality conditions"
        },
        {
            "text": "Each of the graphs present the optimal vaccine allocation (the solid lines) over three interacting populations for different sizes of vaccine stockpile. The dashed and dotted lines indicate the important vaccination fractions: the dashed line in the middle equals\u1e7c j =f j N j , the upper dotted line equals V * j = f * j N j and the lower dotted line equalsV j =f j N j . ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4.2 Optimality conditions"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Solving knapsack problems with S-curve return functions",
            "authors": [
                {
                    "first": "Semra",
                    "middle": [],
                    "last": "Agral\u0131",
                    "suffix": ""
                },
                {
                    "first": "Joseph",
                    "middle": [],
                    "last": "Geunes",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "European Journal of Operational Research",
            "volume": "193",
            "issn": "2",
            "pages": "605--615",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "On the Lambert W function",
            "authors": [
                {
                    "first": "Robert",
                    "middle": [
                        "M"
                    ],
                    "last": "Corless",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Gaston",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Gonnet",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "G"
                    ],
                    "last": "David",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Hare",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "David",
                    "suffix": ""
                },
                {
                    "first": "Donald",
                    "middle": [
                        "E"
                    ],
                    "last": "Jeffrey",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Knuth",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "Advances in Computational Mathematics",
            "volume": "5",
            "issn": "1",
            "pages": "329--359",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Mathematical tools for understanding infectious disease dynamics",
            "authors": [
                {
                    "first": "Odo",
                    "middle": [],
                    "last": "Diekmann",
                    "suffix": ""
                },
                {
                    "first": "Hans",
                    "middle": [],
                    "last": "Heesterbeek",
                    "suffix": ""
                },
                {
                    "first": "Tom",
                    "middle": [],
                    "last": "Britton",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "The multiplant firm with increasing returns to scale",
            "authors": [
                {
                    "first": "William",
                    "middle": [],
                    "last": "Ginsberg",
                    "suffix": ""
                }
            ],
            "year": 1974,
            "venue": "Journal of Economic Theory",
            "volume": "9",
            "issn": "3",
            "pages": "283--292",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Qualitative analyses of communicable disease models",
            "authors": [
                {
                    "first": "Herbert",
                    "middle": [
                        "W"
                    ],
                    "last": "Hethcote",
                    "suffix": ""
                }
            ],
            "year": 1976,
            "venue": "Mathematical Biosciences",
            "volume": "28",
            "issn": "3",
            "pages": "335--356",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "The differential infectivity and staged progression models for the transmission of HIV",
            "authors": [
                {
                    "first": "James",
                    "middle": [
                        "M"
                    ],
                    "last": "Hyman",
                    "suffix": ""
                },
                {
                    "first": "Jia",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "Ann",
                    "middle": [],
                    "last": "Stanley",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "Mathematical Biosciences",
            "volume": "155",
            "issn": "2",
            "pages": "77--109",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Optimal but unequitable prophylactic distribution of vaccine",
            "authors": [
                {
                    "first": "Matt",
                    "middle": [
                        "J"
                    ],
                    "last": "Keeling",
                    "suffix": ""
                },
                {
                    "first": "Andrew",
                    "middle": [],
                    "last": "Shattock",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Epidemics",
            "volume": "4",
            "issn": "2",
            "pages": "78--85",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "A contribution to the mathematical theory of epidemics",
            "authors": [
                {
                    "first": "W",
                    "middle": [
                        "O"
                    ],
                    "last": "Kermack",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Mckendrick",
                    "suffix": ""
                }
            ],
            "year": 1927,
            "venue": "Proceedings of the Royal Society of London. Series A",
            "volume": "115",
            "issn": "772",
            "pages": "700--721",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Generality of the final size formula for an epidemic of a newly invading infectious disease",
            "authors": [
                {
                    "first": "Junling",
                    "middle": [],
                    "last": "Ma",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "David",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Earn",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Bulletin of Mathematical Biology",
            "volume": "68",
            "issn": "3",
            "pages": "679--702",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "which implies that the second relation cannot hold. Thus, G (f ) = 0 if and only if the first relation holds. The function G",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Theorem S2.3 the second relation cannot hold and thus G (f ) > 0 if and only if G(f ) > 2 \u03c3 \u2212 (s(\u03c4 ) \u2212 f ), which can only hold for f < s(\u03c4 ) \u2212 1 \u03c3 .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "The function D(f ) as defined by (4) is maximized by the unique vaccination fractio\u00f1 f for which G (f ) = D(f ). The function D(f ) is increasing for f <f and decreasing for f >f .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "the first derivative of D(f ),f is clearly an extreme of the function D(f ). Observe that in the limit f \u2193 0 is always a solution of the condition G (f ) = D(f ), by limit definition of the one-sided derivative. For parameter settings for which the function G(f ) does not have a convex part, the function D(f ) is maximized for f = 0. Namely, in that case G(f ) is concave, meaning that the slope of G(f ) is decreasing in f . The average slope on the interval [0, f ], measured by D(f ), is then also decreasing. Analogously, D(f ) is increasing as long as G(f ) is convex. This implies that f = 0 cannot maximize the function D(f ) if G(f ) has a convex domain and thatf is in the concave domain of G(f ).Assume thatf is the first value in the concave domain for which G (f ) = D(f ). Because of concavity it holds that G(f ) for all f >f is below the line through G(0) and G(f ). For all f >f this implies:1 f [G(f ) \u2212 G(0)] < 1 f G(f ) \u2212 G(0)Let f 1 be an arbitrarily selected value greater thanf . Because of concavity the function G(f ) for all f > f 1 is below the line through G(0) and G(f 1 ). This implies that D(f ) is decreasing for f >f . Thus, there is only one strictly positive solution for the condition G (f ) = D(f ), which is in the concave and increasing domain of G(f ). By the second derivative of D(f ),f gives a maximum.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "For increasing \u03c3 the dose-optimal vaccine fractionf converges to f * .Proof. The basic reproduction ratio is denoted by \u03c3. By Lemma 1 it suffices to show that lim \u03c3\u2191+\u221e f * \u2212f = 0. By definition we have lim \u03c3\u2191+\u221e f * = lim \u03c3\u2191+\u221e s(\u03c4 ) \u2212 1 \u03c3 = s(\u03c4 ). Clearly, for \u03c3 \u2191 +\u221e andf = s(\u03c4 ) the condition G(f ) = 2 \u03c3 \u2212 (s(\u03c4 ) \u2212f ) is satisfied, as lim f \u2191s(\u03c4 ) G(f ) = 0 by Theorem S2.1. This completes the proof.Lemma S2.5. In case of vaccination in a completely susceptible populationf =f = f * .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Theorem S2.2 F (f ) > 0 if and only if G(f ) < (s(\u03c4 ) \u2212 f ), which holds by Theorem S2.3 for all f \u2208 [0, s(\u03c4 )). Thus the function F (f ) is increasing for all f \u2208 [0, s(\u03c4 )).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "The graphs present the optimal vaccine allocation (the solid lines) over three interacting populations for different sizes of vaccine stockpile. The dashed and dotted lines indicate the important vaccination fractions: the dashed line in the middle equals\u1e7c j =f j N j , the upper dotted line equals V * j = f * j N j and the lower dotted line equalsV j =f j N j .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "The optimal allocation in case interaction between populations is 0.02 times the interaction within a population.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "The optimal allocation in case interaction between populations is 0.05 times the interaction within a population.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "The optimal allocation in case interaction between populations is 0.1 times the interaction within a population.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Lemma 1. Consider the following three vaccination fractions: f * as defined in Theorem 1,f as defined in Theorem 2 andf as defined in Corollary 1. The following relation holds:f \u2264f \u2264 f * Proof. By Lemma S2.2 we know that",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The third equivalence follows from multiplying both sides of the inequality with \u22121/\u03be.We will now show that the last inequality in (20) will lead to a contradiction. Because the function G(\u00b7) is convex at \u03be/N k we have that [G(\u03be/N k Thus, under the assumption that (ii) is optimal it must hold that G (x) < G (\u03be/N k ) by the last inequality of (20). If allocation (ii) is optimal we also have that G (\u03be/N k ) = G (\u0177) by Theorem S4.2, and thus that G (x) < G (\u0177). However, becausex <\u0177 and both fractions are in the concave domain of the function G(\u00b7) it holds that G (x) > G (\u0177). We thus arrive at a contradiction, which implies that allocation scheme (ii) can never be better than allocation scheme (i) for V > j\u2208J N jf . Thus, the optimal allocation for V > j\u2208J N jf is allocation (i): i.e., the pro rata allocation over all populations in J. This completes the proof of part (c) of this theorem.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "acknowledgement"
        },
        {
            "text": "This appendix considers the Lambert W function, or product log function (cf. Corless et al. (1996) ). This function is denoted by W (x) and solves:The herd effect G(f ) can be expressed using the Lambert W function:which can be verified by substituting (22) into (21), which leads to (3). In this study we consider only real valued x and the function W (x) is then defined only for x \u2265 \u2212 1 e . For x \u2208 [\u2212 1 e , 0] the function W (x) has two values, but two branches of W (x) can be defined that are both single valued. The constraint W (x) \u2264 \u22121 can be added to construct the branch W \u22121 (x) defined only for. The other branch W 0 (x) holds for all x \u2265 \u2212 1 e and meets the constraint W (x) \u2265 \u22121. This branch is also referred to as the principal branch, denoted by W p (x).Let. We will study y(f ) in more detail to determine which branch of the Lambert W function is needed for the calculation of G(f ).Proof. We can easily see that y(f ) \u2264 0, because \u03c3 > 0, s 0 > 0 and f \u2264 s(\u03c4 ). Analyze the extreme values of y(f ):By (2) above relation holds, because i(\u03c4 ) \u2265 0.By Theorem S2.2 we know that G(f ) < 1 \u03c3 and thus \u22121 < W (\u2212\u03c3 exp{\u2212\u03c3B(f, \u03c3)}) < 0. By Theorem S5.1 only the principal branch W 0 (x) is needed when using the Lambert W function for G(f ) in (22).",
            "cite_spans": [
                {
                    "start": 77,
                    "end": 98,
                    "text": "Corless et al. (1996)",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Appendix S5 The Lambert W function"
        },
        {
            "text": "In Section 5.4 the optimal allocation is analyzed for geographically distant populations that interact with each other. We use the same initial states and population sizes as in Section 5.3.In this appendix we study the relative performance of ignoring interaction by either using the optimal allocation for non-interacting populations or by using the equitable allocation, which allocates pro rata over all populations. In Figure 1 we illustrate the performance of these two solutions relative to the optimal allocation for the interacting case. We evaluate the additional herd effect and observe that the non-interacting solution performs close to optimal and outperforms",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 424,
                    "end": 432,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Appendix S6 Interacting populations"
        }
    ]
}