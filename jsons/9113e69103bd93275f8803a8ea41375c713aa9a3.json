{
    "paper_id": "9113e69103bd93275f8803a8ea41375c713aa9a3",
    "metadata": {
        "title": "Anisotropic osmosis filtering for shadow removal in images",
        "authors": [
            {
                "first": "Simone",
                "middle": [],
                "last": "Parisotto",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Cambridge Centre for Analysis",
                    "location": {
                        "addrLine": "Wilberforce Road",
                        "postCode": "CB3 0WA",
                        "settlement": "Cambridge",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Luca",
                "middle": [],
                "last": "Calatroni",
                "suffix": "",
                "affiliation": {
                    "laboratory": "CMAP",
                    "institution": "\u00c9cole Polytechnique",
                    "location": {
                        "postCode": "91128",
                        "settlement": "Palaiseau Cedex",
                        "country": "France"
                    }
                },
                "email": "luca.calatroni@polytechnique.edu"
            },
            {
                "first": "Marco",
                "middle": [],
                "last": "Caliari",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Verona",
                    "location": {
                        "addrLine": "Strada Le Grazie 15",
                        "postCode": "37134",
                        "settlement": "Verona",
                        "country": "Italy"
                    }
                },
                "email": "marco.caliari@univr.it"
            },
            {
                "first": "Carola-Bibiane",
                "middle": [],
                "last": "Sch\u00f6nlieb",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Cambridge",
                    "location": {
                        "addrLine": "Wilberforce Road",
                        "postCode": "CB3 0WA",
                        "settlement": "Cambridge",
                        "country": "UK"
                    }
                },
                "email": ""
            },
            {
                "first": "Joachim",
                "middle": [],
                "last": "Weickert",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Saarland University",
                    "location": {
                        "addrLine": "Campus E1.7",
                        "postCode": "66041",
                        "settlement": "Saarbr\u00fccken",
                        "country": "Germany"
                    }
                },
                "email": "weickert@mia.uni-saarland.de"
            }
        ]
    },
    "abstract": [
        {
            "text": "We present an anisotropic extension of the isotropic osmosis model that has been introduced by Weickert et al. [38] for visual computing applications, and we adapt it specifically to shadow removal applications. We show that in the integrable setting, linear anisotropic osmosis minimises an energy that involves a suitable quadratic form which models local directional structures. In our shadow removal applications we estimate the local structure via a modified tensor voting approach [24] and use this information within an anisotropic diffusion inpainting that resembles edge-enhancing anisotropic diffusion inpainting [39, 13] . Our numerical scheme combines the nonnegativity preserving stencil of Fehrenbach and Mirebeau [10] with an exact time stepping based on highly accurate polynomial approximations of the matrix exponential. The resulting anisotropic model is tested on several synthetic and natural images corrupted by constant shadows. We show that it outperforms isotropic osmosis, since it does not suffer from blurring artefacts at the shadow boundaries.",
            "cite_spans": [
                {
                    "start": 111,
                    "end": 115,
                    "text": "[38]",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 623,
                    "end": 627,
                    "text": "[39,",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 628,
                    "end": 631,
                    "text": "13]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "The use of partial differential equations (PDEs) has a long tradition in mathematical image processing. In particular, PDEs based on transport and diffusion mechanisms have been considered to model several image reconstruction models suitable for image enhancement, denoising, deblurring, inpainting and segmentation. We refer the reader to the review [15] and the monographs [3, 7, 32, 34, 37] for further references.",
            "cite_spans": [
                {
                    "start": 352,
                    "end": 356,
                    "text": "[15]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 376,
                    "end": 379,
                    "text": "[3,",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 380,
                    "end": 382,
                    "text": "7,",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 383,
                    "end": 386,
                    "text": "32,",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 387,
                    "end": 390,
                    "text": "34,",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 391,
                    "end": 394,
                    "text": "37]",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Among these models, a very special place is occupied by diffusive PDEs encoding anisotropy, i.e. favouring diffusion along some specific directions only. In [37] nonlinear arXiv:1809.06298v1 [math.AP] 17 Sep 2018 diffusion PDEs with space-variant diffusion tensors are studied. For a regular image domain \u2126 \u2282 R 2 and a stopping time T > 0, given a degraded image f \u2208 L \u221e (\u2126; R) and two smoothing parameters \u03c1, \u03c3 > 0, the anisotropic diffusion model in [37] looks for a solution u in a suitable function space satisfying the following initial value problem:",
            "cite_spans": [
                {
                    "start": 157,
                    "end": 161,
                    "text": "[37]",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 452,
                    "end": 456,
                    "text": "[37]",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "Anisotropic diffusion"
        },
        {
            "text": "on \u2126 \u00d7 (0, T ],",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Anisotropic diffusion"
        },
        {
            "text": "on \u2126,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Anisotropic diffusion"
        },
        {
            "text": "where n is the outward normal unitary vector on \u2202\u2126 and D is a non-constant diffusion tensor satisfying suitable regularity conditions, with eigenvectors inherited from the socalled structure tensor J \u03c1 (\u2207u \u03c3 ). It encodes local directional information of u \u03c3 (that is, the image u convolved with a Gaussian kernel of standard deviation \u03c3). More precisely, its eigenvectors point in the directions of largest and smallest contrast averaged over a Gaussian smoothing scale \u03c1, and the corresponding eigenvalues measure this contrast. The diffusion tensor uses the same eigenvectors, and its eigenvalues are functions of the eigenvalues of the structure tensor. Depending on the application, different models such as edge-enhancing anisotropic diffusion or coherence-enhancing anisotropic diffusion have been proposed [37] Edge-enhancing anisotropic diffusion has been adapted to inpainting problems in [39] . It is particularly useful for sparse inpainting problems encoutered e.g. in inpainting-based compression applications where it outperforms other PDE approaches [13, 33] . Beyond anisotropic PDEs, non-smooth anisotropic regularisers for variational imaging models are also considered. In [14, 21, 22, 29, 28] , for instance, directionality is used to define the anisotropic Total-Variation and Total-Generalised-Variation functionals. This is classically done by considering a re-parametrised version of the gradient operator depending on the local orientation of the image, which allows to enforce diffusion along certain directions only. In terms of variational models, one replaces the squared norm \u2207 u\u2207u by a quadratic form of type \u2207 uD\u2207u. This has a very long tradition in image analysis [26] .",
            "cite_spans": [
                {
                    "start": 814,
                    "end": 818,
                    "text": "[37]",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 899,
                    "end": 903,
                    "text": "[39]",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 1066,
                    "end": 1070,
                    "text": "[13,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1071,
                    "end": 1074,
                    "text": "33]",
                    "ref_id": "BIBREF34"
                },
                {
                    "start": 1193,
                    "end": 1197,
                    "text": "[14,",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1198,
                    "end": 1201,
                    "text": "21,",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 1202,
                    "end": 1205,
                    "text": "22,",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 1206,
                    "end": 1209,
                    "text": "29,",
                    "ref_id": "BIBREF30"
                },
                {
                    "start": 1210,
                    "end": 1213,
                    "text": "28]",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 1698,
                    "end": 1702,
                    "text": "[26]",
                    "ref_id": "BIBREF27"
                }
            ],
            "ref_spans": [],
            "section": "Anisotropic diffusion"
        },
        {
            "text": "The explicit dependence of these anisotropic models on local terms such as position and local directions of the image makes the analysis of these models more challenging [37, 14, 22, 29] . Also from a numerical point of view, the design of suitable schemes enforcing anisotropy is a non-trivial task since it requires the use of appropriate stencils that perfectly adapt to the local image structure. Many methods have been proposed; see e.g. the unifying framework in [40] and the references therein. While most stencils lead to L 2 -stable schemes, only a few of them allow to preserve nonnegativity and L \u221e stabilty [37, 25, 10] . A rather sophisticated representative among them is the stencil of Fehrenbach and Mirebeau [10] which relies on lattice basis reduction ideas.",
            "cite_spans": [
                {
                    "start": 170,
                    "end": 174,
                    "text": "[37,",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 175,
                    "end": 178,
                    "text": "14,",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 179,
                    "end": 182,
                    "text": "22,",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 183,
                    "end": 186,
                    "text": "29]",
                    "ref_id": "BIBREF30"
                },
                {
                    "start": 469,
                    "end": 473,
                    "text": "[40]",
                    "ref_id": "BIBREF41"
                },
                {
                    "start": 619,
                    "end": 623,
                    "text": "[37,",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 624,
                    "end": 627,
                    "text": "25,",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 628,
                    "end": 631,
                    "text": "10]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 725,
                    "end": 729,
                    "text": "[10]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Anisotropic diffusion"
        },
        {
            "text": "In this work we consider a transport-diffusion PDE describing the physical phenomenon of osmosis for imaging applications. Compared to standard plain diffusion models, the model considered therein considers an additional drift term, making the process not symmetric (see [17] for the physical interpretation). For a regular domain \u2126 \u2282 R 2 , a given vector field d : \u2126 \u2192 R 2 and a given image f \u2208 L \u221e (\u2126; R), the isotropic osmosis model reads [38] \uf8f1 \uf8f4 \uf8f2 \uf8f4 \uf8f3 u t = \u2206u \u2212 div(du) on \u2126 \u00d7 (0, T ],",
            "cite_spans": [
                {
                    "start": 271,
                    "end": 275,
                    "text": "[17]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 442,
                    "end": 446,
                    "text": "[38]",
                    "ref_id": "BIBREF39"
                }
            ],
            "ref_spans": [],
            "section": "Osmosis filtering"
        },
        {
            "text": "Differently from plain diffusion models, osmosis steady states are non-constant. In particular, if d is defined in terms of a given image v > 0 as d := \u2207 log v, convergence to a rescaled version of v can be proven [38] . This is called the integrable or compatible case. In [38, 36] several imaging applications based on (2) or a slight modification thereof are studied. One of them is the shadow removal problem, see [38, Section 4.2] , as considered in this paper.",
            "cite_spans": [
                {
                    "start": 214,
                    "end": 218,
                    "text": "[38]",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 274,
                    "end": 278,
                    "text": "[38,",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 279,
                    "end": 282,
                    "text": "36]",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 418,
                    "end": 422,
                    "text": "[38,",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 423,
                    "end": 435,
                    "text": "Section 4.2]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Osmosis filtering"
        },
        {
            "text": "Shadow removal. The problem of shadow removal from a given image f : \u2126 \u2192 R + consists in removing the shadow appearing in f while preserving the image geometry and texture underneath. We will assume in the following constant shadows, i.e. where image intensity values inside and outside the shadow region are in relation with each other up to an (unknown) multiplicative constant. This problem is of great interest in computer vision as it often represents a preprocessing step in several segmentation, tracking and face recognition tasks where shadows are removed to avoid false detections/artefacts in the subsequent image processing. We refer the reader to [8] for a review on the existing models for shadow removal in images.",
            "cite_spans": [
                {
                    "start": 660,
                    "end": 663,
                    "text": "[8]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Osmosis filtering"
        },
        {
            "text": "For our purposes, a mathematical formulation of the shadow removal problem can be obtained decomposing the image domain \u2126 as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Osmosis filtering"
        },
        {
            "text": "where \u2126 out , \u2126 sb and \u2126 in are the unshadowed region, the shadow boundaries and the shadowed region of the image, respectively, see Figure 1 for an example.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 133,
                    "end": 141,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Osmosis filtering"
        },
        {
            "text": "Provided that a decomposition as in (3) is given, which for real images may a challenging problem on its own regard [8] , the osmosis model (2) can be easily adapted to solve the shadow removal problem by simply defining the vector field d in (2) in terms of a shadowed image f as d := \u2207 log f on \u2126 in \u222a \u2126 out and d = 0 on \u2126 sb . The continuous Figure 1 : Decomposition of \u2126 as in (3) into (b) unshadowed region, (c) shadow boundaries and (d) shadowed region for a discrete shadowed image f . osmosis model adapted to shadow removal then reads",
            "cite_spans": [
                {
                    "start": 116,
                    "end": 119,
                    "text": "[8]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 140,
                    "end": 143,
                    "text": "(2)",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 243,
                    "end": 246,
                    "text": "(2)",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 345,
                    "end": 353,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Osmosis filtering"
        },
        {
            "text": "The evolution on the shadow boundary \u2126 sb can be interpreted as an inpainting step where information is propagated from \u2126 out to \u2126 in over \u2126 sb . Due to the action of the Laplace operator on \u2126 sb , image structures in \u2126 in \u222a \u2126 out are isotropically diffused on \u2126 sb , resulting in a shadowless, but blurred inpainting result on \u2126 sb . To overcome this a post-processing inpainting step is commonly applied, as for instance in Figure 2 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 426,
                    "end": 434,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Osmosis filtering"
        },
        {
            "text": "(a) Isotropic osmosis [38] (b) Post-processing inpainting step [2] (c) Zoom of Figure 2a Figure 2b to remove the blurring artefacts due to Laplace inpainting on \u2126 sb in (4).",
            "cite_spans": [
                {
                    "start": 22,
                    "end": 26,
                    "text": "[38]",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 63,
                    "end": 66,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 79,
                    "end": 88,
                    "text": "Figure 2a",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 89,
                    "end": 98,
                    "text": "Figure 2b",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Osmosis filtering"
        },
        {
            "text": "Note that in natural images several acquisition and/or compression artefacts may render the automatic segmentation of the shadow boundary very challenging. On the other hand, its accurate manual selection may be very tedious. In many practical examples, a rough selection of \u2126 sb is therefore performed manually by using a brush whose possibly large thickness may badly affect the result of the model (4) (see Figure  4 ) due to the Laplace blurring artefacts discussed above.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 410,
                    "end": 419,
                    "text": "Figure  4",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Osmosis filtering"
        },
        {
            "text": "Vogel et al. [36] have presented a discrete osmosis theory and have proven that explicit and implicit finite difference discretisations satisfy its requirements. Different splitting schemes have been considered in [5, 27] and have been applied to imagery for cultural heritage conservation.",
            "cite_spans": [
                {
                    "start": 13,
                    "end": 17,
                    "text": "[36]",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 214,
                    "end": 217,
                    "text": "[5,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 218,
                    "end": 221,
                    "text": "27]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "Osmosis filtering"
        },
        {
            "text": "In this paper we extend the isotropic osmosis model (2) and its shadow removal application (4) to a model that features anisotropic diffusion in the flavour of (1) and adapts concepts from anisotropic diffusion inpainting [39, 13] . This will be implemented by incorporating local directionality depending on image orientations. We show that with this modification we can improve the solution of the shadow removal problem, in particular overcoming blurring artefacts in the region around the shadow boundary, without additional post-processing steps. In the integrable case, the resulting driftdiffusion PDE can be derived as the gradient flow of a suitable energy depending on local gradient information. To estimate such local directionality, we adapt the tensor voting framework proposed in [16] . For the numerical solution we combine a numerical time-stepping method based on exponential integrator techniques with the nonnegative space discretisation of Fehrenbach and Mirebeau [10] . Our model is validated on several synthetic and natural images affected by constant shadows. Results show good lightbalance properties and, compared to plain isotropic osmosis models, avoid the smoothing artefacts on the shadow boundary. An illustrative example of the performance of our model is reported in Figure 3 . [38, 36] and our anisotropic one to solve the shadow removal problem.",
            "cite_spans": [
                {
                    "start": 222,
                    "end": 226,
                    "text": "[39,",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 227,
                    "end": 230,
                    "text": "13]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 795,
                    "end": 799,
                    "text": "[16]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 985,
                    "end": 989,
                    "text": "[10]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 1312,
                    "end": 1316,
                    "text": "[38,",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 1317,
                    "end": 1320,
                    "text": "36]",
                    "ref_id": "BIBREF37"
                }
            ],
            "ref_spans": [
                {
                    "start": 1301,
                    "end": 1309,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Scope of the paper"
        },
        {
            "text": "Organisation of the paper. In Section 2 we introduce the anisotropic osmosis model and study analytically its properties. Then, in Section 3 we study space and time discretisation schemes for the anisotropic model. Finally, in Section 4 we show the application of the anisotropic model to solve the shadow removal problem.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Scope of the paper"
        },
        {
            "text": "We present in this section a variation of the classical osmosis model (2) encoding local directional information of the image in the diffusion term, propagating geometric structures dominantly along locally preferred directions. For this reason we call our model anisotropic osmosis model in contrast to the model (2) which we refer to as isotropic osmosis model. In what follows we introduce the general form of our anisotropic osmosis model and state some properties of solutions that are inherited from the isotropic model. For specific choices of anisotropy we also show connections of the anisotropic osmosis model to anisotropic diffusion-based inpainting methods such as edge-enhancing anisotropic diffusion [39] . Out of these specific instances we derive our proposed anisotropic osmosisinpainting model for shadow removal.",
            "cite_spans": [
                {
                    "start": 715,
                    "end": 719,
                    "text": "[39]",
                    "ref_id": "BIBREF40"
                }
            ],
            "ref_spans": [],
            "section": "Anisotropic osmosis"
        },
        {
            "text": "Let us define an anisotropic osmosis energy as follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Definition 2.1 (Anisotropic osmosis energy). Let \u2126 \u2282 R 2 , u, v \u2208 H 1 (\u2126; R + ) be two positive images and let W : \u2126 \u2192 R 2 be a positive semi-definite symmetric matrix field. We define the anisotropic osmosis energy of u with respect to W and the reference image v as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "We will also use the following alternative notation for E:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "where e W := e, We .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Remark 2.2 (Isotropic case). If W is the identity matrix, then (5) corresponds to the isotropic osmosis energy considered in [38] .",
            "cite_spans": [
                {
                    "start": 125,
                    "end": 129,
                    "text": "[38]",
                    "ref_id": "BIBREF39"
                }
            ],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Next we define an anisotropic osmosis evolution whose steady state minimises our anisotropic osmosis energy. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Proof. For any test function \u03d5 \u2208 C \u221e c (\u2126), we compute the optimality condition holding for any critical point u of E. We get:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "where we have applied the divergence theorem and the Neumann boundary conditions in (7) . Due to the positivity of v and since \u03d5 is compactly supported in \u2126, we have that for any x \u2208 \u2126:",
            "cite_spans": [
                {
                    "start": 84,
                    "end": 87,
                    "text": "(7)",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "By definition of d = \u2207v v , we note that the above corresponds to the following PDE: div (W (\u2207u \u2212 du)) = 0, which is the steady state of (7).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Similar to the isotropic osmosis PDE (2), the anisotropic model (7) enjoys some properties which makes it amenable for imaging applications.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Theorem 2.4. The solution u : \u2126 \u2192 R of the anisotropic osmosis model (7) satisfies the following properties:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "(i) conservation of the average grey value:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "(ii) preservation of non-negativity:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "u(x, t) \u2265 0, for all x \u2208 \u2126 and t > 0;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "(iii) non-constant steady states: The steady state of (7) is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Proof. We follow [38] and prove statements (i)-(iii) in turn.",
            "cite_spans": [
                {
                    "start": 17,
                    "end": 21,
                    "text": "[38]",
                    "ref_id": "BIBREF39"
                }
            ],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "(i) Let \u00b5 u (t) := 1 |\u2126| \u2126 u(x, t) dx be the average grey value of the image u at time t \u2265 0. Applying the divergence theorem and the homogeneous Neumann boundary conditions in (7) we obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "and the statement follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "(ii) Assume that T > 0 is the smallest time such that min x,t u(x, t) = 0, and that this minimum is attained in some inner point \u00b5 \u2208 \u2126. Since we have \u2207u(\u00b5, T ) = u(\u00b5, T ) = 0, we deduce:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "that is in correspondence to the point (\u00b5, T ), the anisotropic osmosis equation behaves like the diffusion equation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "with non-constant positive semidefinite diffusivity matrix W. For such equations a generalisation of the weak minimum/maximum principle (which holds in its classical form only for positive definite, i.e. elliptic, operators) holds true, see, e.g. [30] . Therefore, for any t \u2265 T the solution of the anisotropic model remains non-negative and since the solution has been further assumed to be strictly positive for all t < T , including t = 0 due to the positivity of f , we have that it stays actually non-negative for any t \u2265 0.",
            "cite_spans": [
                {
                    "start": 247,
                    "end": 251,
                    "text": "[30]",
                    "ref_id": "BIBREF31"
                }
            ],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "(iii) For any c \u2208 R, the function w := cv endowed with the Neumann-type boundary conditions in (7) solves the steady state equation of the system anisotropic PDE, since there trivially holds:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Due to mass and non-negativity conservation, the process is then forced to a nonnegative steady state solution w of such a form. Furthermore, the constant c \u2208 R can be easily found by noticing",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definitions and modelling"
        },
        {
            "text": "Anisotropic diffusion inpainting with a diffusion tensor has been introduced in [39] and applied successfully for inpainting-based compression [13, 33] . It exploits the edgeenhancing anisotropic diffusion filter that has been proposed for image denoising [37] . In order to propagate structures from specified image regions into inpainting regions, one uses the differential operator div(D(\u2207u \u03c3 )\u2207u), where u \u03c3 denotes the convolution of u with a Gaussian of standard deviation \u03c3. The diffusion tensor D has eigenvectors perpendicular and parallel to \u2207u \u03c3 . Its corresponding eigenvalues are given by",
            "cite_spans": [
                {
                    "start": 80,
                    "end": 84,
                    "text": "[39]",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 143,
                    "end": 147,
                    "text": "[13,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 148,
                    "end": 151,
                    "text": "33]",
                    "ref_id": "BIBREF34"
                },
                {
                    "start": 256,
                    "end": 260,
                    "text": "[37]",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "Anisotropic diffusion inpainting"
        },
        {
            "text": "with some contrast parameter \u03bb > 0. Thus, the goal is to inpaint fully in the direction of an oriented structure, and to reduce the inpainting perpendicular to a structures, if its contrast is large. Processes of this type can inpaint edge-like structures even when the specified data are sparse and the gaps to be bridged are large [33] . However, they are not well-suited to shadow removal problems, since the shadow boundaries create unphysical edges. Therefore, we will have to modify these ideas such that the local structure directions become more robust w.r.t. shadow boundaries. To this end, we will consider and modify more refined structure descriptors such as tensor voting. This will be done next.",
            "cite_spans": [
                {
                    "start": 333,
                    "end": 337,
                    "text": "[33]",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Anisotropic diffusion inpainting"
        },
        {
            "text": "In this section we present a work-flow which is locally insensitive to the light jump produced by the shadow. This will serve us to force anisotropy on \u2126 sb along suitable directions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "A standard way to provide an estimate of the local structure orientation in an image u consists in computing the eigenvector e 1 associated to the leading eigenvalue \u03bb 1 of the structure tensor J \u03c1 (u) [37] associated to u. By fixing \u03c3, \u03c1 > 0 to be the pre-and post-smoothing parameters, we recall that the structure tensor J \u03c1 (u) of an image u is defined as:",
            "cite_spans": [
                {
                    "start": 202,
                    "end": 206,
                    "text": "[37]",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "where u \u03c3 := K \u03c3 * u is a smoothed version of the image u and K \u03c3 , K \u03c1 are Gaussian convolution kernels. Usually, \u03c3 and \u03c1 are chosen so that \u03c3 \u03c1, where \u03c3 is associated to the noise scale and \u03c1 integrates the orientation information. Denoting by \u03bb 1 \u2265 \u03bb 2 the eigenvalues of J \u03c1 (u) and by e 1 , e 2 the associated eigenvectors, a classification of the different structural image information in terms of the size of \u03bb 1 and \u03bb 2 can be made following, e.g., [18, 11, 20] . For any x \u2208 \u2126 we thus have:",
            "cite_spans": [
                {
                    "start": 457,
                    "end": 461,
                    "text": "[18,",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 462,
                    "end": 465,
                    "text": "11,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 466,
                    "end": 469,
                    "text": "20]",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": ", then x is likely to belong to a homogeneous region;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": ", then x is likely to lie on an edge;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": ", then x is likely to be a corner point.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "Tensor Voting has been originally introduced in [16] for extracting curves in noisy images by means of the grouping of local features consistent in a neighbourhood of the measurements. Such framework improves the robustness of structure tensor estimation in presence of noise and image artefacts [24] . Assuming that a generic 2-tensor B in R 2 has the following matrix representation:",
            "cite_spans": [
                {
                    "start": 48,
                    "end": 52,
                    "text": "[16]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 296,
                    "end": 300,
                    "text": "[24]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "where \u03bb 1 , \u03bb 2 are the eigenvalues associated to the eigenvectors e 1 and e 2 , respectively, we have that (12) can be equivalently rewritten as",
            "cite_spans": [
                {
                    "start": 108,
                    "end": 112,
                    "text": "(12)",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "We can now distinguish the two following quantities:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "is called saliency or stickness. It provides an estimation of the confidence on the direction e 1 and it is also called orientation certainty or anisotropy measure;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "\u2022 \u03bb 2 is called ballness and it measures the size of the minor-axis of the anisotropy ellipse. Since it is in some sense a measure of how the estimation of the main estimated direction is contradicted, it is often called orientation uncertainty or junctionness.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "The tensor voting operation consists in adding, at each iteration, the contribution of neighbourhood tensors for each point in the domain, resulting in an enhanced tensor field due to the presence of saliency parameter. In [12] the authors show that the complexity of the original approach may be time-consuming, even for small images. Thus, they propose an efficient computation of the tensor voting framework based on steerable filters theory, i.e. complex-valued convolutions.",
            "cite_spans": [
                {
                    "start": 223,
                    "end": 227,
                    "text": "[12]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "For the shadow removal application we are considering, the estimation of the structure direction e 1 may be affected by the shadow edges, which do not correspond to the actual underlying image structures. The presence of such edges make the use of either the structure tensor or the tensor voting very challenging for estimating the local directions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "To circumvent this problem, we propose a modification of the tensor voting framework by means of interpreting shadow edges as bias in the estimation of the structure. From the given initial blurred image u \u03c3 , we firstly compute the local orientation \u03b8 of the gradient from the eigenvector e 2 . Secondly, we compute the saliency of the given shadowed image. Finally we apply the tensor voting framework with a modified saliency and orientation on \u2126 sb so as to mark the shadow boundaries as bias: there, the saliency is zeroed and the orientation is initialised at random. Details on the algorithm and results are presented in Section 4.2.1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computation of structure directions via tensor voting"
        },
        {
            "text": "Let f : \u2126 \u2192 R + be a positive greyscale image with a constant shadow and let \u2126 be decomposed as in (3) . We propose the following structure-preserving osmosis model for solving the shadow removal problem:",
            "cite_spans": [
                {
                    "start": 99,
                    "end": 102,
                    "text": "(3)",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "An anisotropic osmosis-inpainting model for shadow removal"
        },
        {
            "text": "on \u2126,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "An anisotropic osmosis-inpainting model for shadow removal"
        },
        {
            "text": "Here we define the discontinuous vector field d and the discontinuous matrix field W as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "An anisotropic osmosis-inpainting model for shadow removal"
        },
        {
            "text": "where I denotes the 2 \u00d7 2 identity matrix, and e 1 and e 2 are the directions from our modified tensor voting applied to the initial image f . This means, an isotropic osmosis evolution is performed in \u2126 c sb , while an anisotropic inpainting is performed on \u2126 sb . In other words, classical osmosis balances image intensity in the shadowed region with respect to the unshadowed regions, while the nonlinear interpolation preserves structures and avoids blurring on the shadow boundary. The proposed model performs the osmosis and the inpainting step jointly and avoids any post-processing step.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "An anisotropic osmosis-inpainting model for shadow removal"
        },
        {
            "text": "We now discuss appropriate discretisations of the anisotropic osmosis model that are consistent with the continuous model (7) and preserve some of its properties as stated in Theorem 2.4. To do so, we consider a discrete rectangular image domain with M \u00d7 N pixels. Let S := M N . The given positive initial image f is then defined as a vector in R S + . For a given grid step size h > 0, we denote by u = (u i,j ) i,j the approximation of the function u and with u i,j its approximated value in suitable discretisation nodes ((i \u2212 1 2 )h, (j \u2212 1 2 )h) with i = 1, . . . , M and j = 1, . . . , N . Similarly, for k \u2265 0 we denote by u k i,j the value of u i,j at the time node t k = k\u03c4 , where \u03c4 is the time step size. Also, for x \u2208 \u2126, we denote by \u03bb 1 , \u03bb 2 \u2208 R S + the discretised eigenvalues \u03bb 1 (x) and \u03bb 2 (x), while by \u03b8 \u2208 [0, 2\u03c0) S the discretised orientation \u03b8(x).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space and time discretisation"
        },
        {
            "text": "A discrete theory for osmosis models has been established in [36] . Since it is also applicable to the anisotropic setting, we report here the general result [36, Proposition 1] and list in the following some discrete solvers fulfilling its assumptions. . For a given f \u2208 R S + , consider the fully-discretised problem:",
            "cite_spans": [
                {
                    "start": 61,
                    "end": 65,
                    "text": "[36]",
                    "ref_id": "BIBREF37"
                }
            ],
            "ref_spans": [],
            "section": "Discrete osmosis theory"
        },
        {
            "text": "where the (unsymmetric) matrix P \u2208 R S\u00d7S is an irreducible, non-negative matrix with strictly positive diagonal entries and unitary column sum . Then the following properties hold true:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete osmosis theory"
        },
        {
            "text": "(i) The evolution preserves positivity and the average grey value of f ;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete osmosis theory"
        },
        {
            "text": "(ii) The eigenvector of P associated to eigenvalue 1 is the unique steady state for k \u2192 \u221e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discrete osmosis theory"
        },
        {
            "text": "As shown in [36] for the isotropic osmosis model, standard explicit and implicit time finite difference schemes fit this framework, the former being subject to time step size restrictions, the latter being unconditionally stable. Furthermore, both schemes converge to the space discretisation of the elliptic steady state for every stable time step size. For the implicit scheme with a BiCGStab solver, Vogel et al. [36] report speed-ups of two orders of magnitude compared to the explicit method. In [5] a Peaceman-Rachford splitting is shown to satisfy Theorem 3.1 under a time step size restriction, while the additive operator splitting (AOS) considered in [27] fulfils Theorem 3.1 for all time step sizes. Splitting schemes such as the AOS method, however, do not converge to the space-discrete elliptic steady state solution unless the time step size goes to zero. In practice, keeping this time splitting error under control imposes bounds on the time step size.",
            "cite_spans": [
                {
                    "start": 12,
                    "end": 16,
                    "text": "[36]",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 416,
                    "end": 420,
                    "text": "[36]",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 501,
                    "end": 504,
                    "text": "[5]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 661,
                    "end": 665,
                    "text": "[27]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "Discrete osmosis theory"
        },
        {
            "text": "Note that in contrast to the theory for fully discrete diffusion filters [37] , the discrete osmosis theory in Theorem 3.1 does not require a symmetric matrix. Since it does also not involve any isotropy assumption, it is basically also applicable to anisotropic osmosis processes, if suitable space discretisations are employed. This, however, is not straightforward and will be discussed in the sequel.",
            "cite_spans": [
                {
                    "start": 73,
                    "end": 77,
                    "text": "[37]",
                    "ref_id": "BIBREF38"
                }
            ],
            "ref_spans": [],
            "section": "Discrete osmosis theory"
        },
        {
            "text": "In what follows, we describe the discretisation of the weighting matrix W and the differential operators div and \u2207 for a grey-scale image of height M and width N unrolled as u \u2208 R S , with S = M N , that defines the spatial discretisation matrix A for the semi-discrete osmosis problem u (t) = Au(t), for t \u2208 (0, T ],",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "where T > 0 is a positive final time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "While diffusion processes are stable in many aspects, e.g. in terms of decreasing L 2 norms and decreasing L \u221e norms, the stability of osmosis processes is restricted to essentially one key property: the preservation of nonnegativity. Thus, any suitable space discretisation for osmosis filters should guarantee that it is nonnegativity preserving. For the matrix A this implies that all off-diagonal elements must be nonnegative. While this is easily satisfied for standard discretisations of isotropic processes [36] , it becomes much more challenging for anisotropic approaches: The drift term is fairly unproblematic and can be handled e.g. with classical upwind discretisations. However, most discretisations of the diffusion term div(W\u2207u) are only stable in the L 2 norm [40] . Thus, they cannot guarantee preservation of nonnegativity. Nonnegativity-preserving discretisations can be found in [37, 25, 10] . In our paper, we use the stencil of Fehrenbach and Mirebeau [10] , since it is a fairly sophisticated nonnegativity-preserving method that has been reported to give good results. This anisotropic diffusion discretisation relies on lattice basis reduction ideas and is called AD-LBR. Let us sketch its underlying ideas.",
            "cite_spans": [
                {
                    "start": 514,
                    "end": 518,
                    "text": "[36]",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 777,
                    "end": 781,
                    "text": "[40]",
                    "ref_id": "BIBREF41"
                },
                {
                    "start": 900,
                    "end": 904,
                    "text": "[37,",
                    "ref_id": "BIBREF38"
                },
                {
                    "start": 905,
                    "end": 908,
                    "text": "25,",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 909,
                    "end": 912,
                    "text": "10]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 975,
                    "end": 979,
                    "text": "[10]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "In [10] , the authors tackle the minimisation of an anisotropic energy which in our notation reads:",
            "cite_spans": [
                {
                    "start": 3,
                    "end": 7,
                    "text": "[10]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "where e W := e, We , for any e \u2208 R d and W is symmetric and positive definite. The idea is to introduce a discretisation E h of the energy above on the discretised domain \u2126 h , h > 0 via a sum of weighted squared differences of u \u2208 L 2 (\u2126 h ; R), i.e.:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "where V (x) \u2282 Z d is the stencil and \u03b3 x (e) \u2265 0 are the associated weights. The key step is the linearisation of u(x + he) as u(x) + \u2207u(x), he , which shows that for each x \u2208 \u2126 h and smooth u one can write:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "which turns out to be equivalent to require the condition W = e\u2208V (x) \u03b3 x (e)ee T . via the following Lemma [10, Lemma 1].",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "Lemma 3.2. Let e 0 , e 1 , e 2 \u2208 R 2 be such that e 0 + e 1 + e 2 = 0 and |det(e 1 , e 2 )| = 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "Then for any symmetric positive definite matrix W, there holds:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "under the convention e 3+i := e i Actually, for any dimension d \u2264 3 and any symmetric positive definite d \u00d7 d matrix M, there always exists a family (e i ) i\u2208I of vectors in R d such that e i , Me j \u2264 0 for any i = j. Such a family is called M-obtuse [9] . Thus, by taking (e 0 , e 1 , e 2 ) as a W-obtuse superbase of Z 2 (i.e. a basis of Z 2 with |det(e 0 , e 1 , e 2 )| = 1 such that e 0 + e 1 + e 2 = 0), a stencil V (x) := {e 0 , e 1 , e 2 , \u2212e 0 , \u2212e 1 , e 2 } can be used to write explicitly the coefficients \u03b3 x in (18) for 0 \u2264 i \u2264 2 as done in [10, Equation (11)]:",
            "cite_spans": [
                {
                    "start": 251,
                    "end": 254,
                    "text": "[9]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "The resulting stencil is shown to be independent of the choice of the superbase [10, Lemma 11] and it is orientated along the preferred diffusion direction given by W.",
            "cite_spans": [
                {
                    "start": 85,
                    "end": 94,
                    "text": "Lemma 11]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "Also, the AD-LBR scheme is sparse, i.e. it has a limited support of 6 points for twodimensional images.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "In the AD-LBR discretisation, an important role is played by the anisotropic ratio \u03ba \u2208 [1, \u221e), which measures the geometrical shape of the ellipse associated to the eigendecomposition of the anisotropic matrix W: the closer \u03ba is to 1, the more W is similar to the identity matrix I. The computation of the stencil has a logarithmic cost in the anisotropy ratio \u03ba of the diffusion tensor, making AD-LBR appealing for applications. Also, by fixing a direction \u03b8 all over the domain \u2126 for W, the anisotropy ratio \u03ba can be related to the eigenvalues of W; see [10, Equation 60 ]. For instance, if W has eigenvalues \u03b5 and 1 with 0 < \u03b5 1, then \u03b5 = 1/\u03ba 2 . For completeness, we report in Table 1 the AD-LBR stencil for different choices of \u03b5 and a fixed angle \u03b8 = 2\u03c0/3 that characterises the second eigenvector e 2 = (cos \u03b8, sin \u03b8) of W; cf. also [10, Table 1 , Table 2 ]. Table 1 : AD-LBR stencil for the discretisation of div(W\u2207( \u00b7 )): Different choices of \u03b5 are presented with fixed angle \u03b8 = 2\u03c0/3 for the first eigenvector. In bold we denote the (i, j) entry. As expected, we observe that in the case of strong anisotropy, the stencil becomes aligned in \u03b8 direction. Remark 3.3. By construction, the AD-LBR space discretisation matrix A has 0 column sum and non-negative off-diagonal entries. Moreover, our numerical experiments give strong evidence that A is also irreducible \u2020. However, a formal proof of the irreducibility of A is left for future research.",
            "cite_spans": [
                {
                    "start": 556,
                    "end": 560,
                    "text": "[10,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 561,
                    "end": 572,
                    "text": "Equation 60",
                    "ref_id": null
                },
                {
                    "start": 840,
                    "end": 844,
                    "text": "[10,",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 681,
                    "end": 688,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 845,
                    "end": 852,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 855,
                    "end": 862,
                    "text": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 866,
                    "end": 873,
                    "text": "Table 1",
                    "ref_id": null
                }
            ],
            "section": "Space discretisation with the AD-LBR stencil"
        },
        {
            "text": "In this section we see how it is possible to solve the dynamical system (17), through a highly accurate approximation of the exact solution",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "First of all, we notice that it is not necessary to compute the large and dense matrix exp(T A) explicitly. It is sufficient to compute only its action on the initial solution f . Polynomial methods (see, for instance, [31, 6, 1] , approximate the action of the exponential by a polynomial of a certain degree applied to the initial vector. They do not require to solve a linear system of equations: usually they scale the matrix and approximate the solution by an iterative procedure like u k+1 = p m k (\u03b1 k \u03c4 A)u k , k = 0, 1, . . . , K \u2212 1, u 0 = f \u2020We applied the Tarjan's algorithm finding the strongly connected components of a directed graph [35] . Code is freely available at MATLAB central: mathworks.com/matlabcentral/fileexchange/50707. where p m k is a polynomial of degree m k which approximates the exponential function and",
            "cite_spans": [
                {
                    "start": 219,
                    "end": 223,
                    "text": "[31,",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 224,
                    "end": 226,
                    "text": "6,",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 227,
                    "end": 229,
                    "text": "1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 649,
                    "end": 653,
                    "text": "[35]",
                    "ref_id": "BIBREF36"
                }
            ],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "After the last iteration, u K \u2248 u(T ). Such an iterative scheme is usually needed in order to achieve a sufficiently accurate result. For Krylov methods (like [31] ), it is also necessary in order to keep the computational cost as low as possible, since the cost to produce p m k requires O(m 2 k ) scalar products with vectors of the size of f . Among the polynomial methods, the truncated Taylor series [1] and the interpolation in the Newton form at Leja points [6] are able to bound the relative backward error. This means that they construct an approximation in K iterations with time step size \u03c4 = T /K:",
            "cite_spans": [
                {
                    "start": 159,
                    "end": 163,
                    "text": "[31]",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 405,
                    "end": 408,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 465,
                    "end": 468,
                    "text": "[6]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "The tolerance tol can be chosen as small as desidered. The typical value for double precision arithmetic is 2 \u221253 and in this sense the time integration is said \"exact\". The polynomial p m (z) is either the truncated Taylor series of e z about a point which depends on the spectrum of the matrix or the interpolation polynomial of e z at real Leja points on an interval related to the spectrum of the matrix.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "The choice of the parameters K and m can be done by simply considering the 1norm of T A, or estimates of (T A) q 1/q 1 for small values of q, or, only for interpolation at Leja points, estimates on the -pseudospectra of T A. From the implementation point of view, both algorithms simply require one matrix-vector product and one vector update at each degree elevation, and therefore the cost is O(m). When the spectrum of T A has a skinny shape, either horizontal or vertical, usually interpolation at Leja points performs better (see [6] ).",
            "cite_spans": [
                {
                    "start": 535,
                    "end": 538,
                    "text": "[6]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "Since this method can be configured to be exact in time up to machine precision, it is basically possible to reach the final time T in a single time step of size \u03c4 = T . However, we prefer to use multiple time steps, since the steady state T is in general not known a priori. On the other hand, there is no restriction on the time step \u03c4 and it is therefore possible to implement any desired strategy for steady state detection (based, for instance, on the comparison of the solutions at two successive time steps). In particular, also variable step size \u03c4 k implementations are possible without any restriction given by the stability or the computational cost.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "The approximation of the action of the matrix exponential to a vector can be used also in the so called exponential integrators (we refer to the survey paper [19] ) when solving general (non-linear) stiff ordinary differential equations.",
            "cite_spans": [
                {
                    "start": 158,
                    "end": 162,
                    "text": "[19]",
                    "ref_id": "BIBREF20"
                }
            ],
            "ref_spans": [],
            "section": "Exact time discretisation"
        },
        {
            "text": "A natural question in this context is whether the matrix P := exp(\u03c4 A) satisfies the properties of Theorem 3.1 for suitable matrices A. We answer this question with the following proposition, for which a simple lemma is required. Proof. For every i, j = 1, . . . , N , we write each element b i,j in terms of the elements of C and D. For every column j we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "Proposition 3.5. Let A be an irreducible matrix, with column sum 0 and non-negative off-diagonal entries. Then the (non-symmetric) matrix P := exp(\u03c4 A) is an irreducible positive matrix with column sum 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "Proof. We firstly show that P has column sum 1. To this end, we use the expansion",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "By hypothesis, A has column sum 0. Then the column sum of A k is 0 for every k \u2265 1 by Lemma 3.4. Thus, the matrix P = exp(\u03c4 A) has column sum 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "In order to show that all elements of P are positive, we rewrite A as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "where D = diag(A), I is the identity matrix, N = A \u2212 diag(A) is a non-negative matrix and \u03b1 := min i a i,i \u2212 \u03b3, for any \u03b3 > 0. We have that P can be expressed as the product",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "where \u03c4 (D \u2212 \u03b1I + N) is a non-negative matrix with positive diagonal and which is also irreducible. In fact, being that false, there would exist an extra-diagonal element in position (i, j) such that (D \u2212 \u03b1I + N) k i,j = 0 for all k > 0. But then, (A) k ij = (\u03b1I + (D \u2212 \u03b1I + N)) k i,j = 0 for all k > 0, meaning that A is reducible, which is false by hypothesis. So, for any pair (i, j) there exists a k such that (\u03c4 (D \u2212 \u03b1I + N)) k i,j > 0. Since all the powers of \u03c4 (D \u2212 \u03b1I + N) appear in the series which defines exp(\u03c4 (D \u2212 \u03b1I + N)), we conclude that all its entries are positive. Finally, exp(\u03c4 A) is obtained by scaling with positive scalars the rows of exp(\u03c4 (D \u2212 \u03b1I + N)). Therefore, exp(\u03c4 A) is a positive (and thus irreducible) matrix.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "Recalling Remark 3.3, Proposition 3.5 shows that the AD-LBR space discretisation in combination with our \"exact\" polynomial time discretisation leads to a fully discrete anisotropic osmosis scheme that satisfies all assumptions of the discrete theory (subject to the missing formal irreducibility proof).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coverage through the discrete osmosis theory"
        },
        {
            "text": "In this section we present several numerical examples showing the application of the isotropic and anisotropic osmosis model to solve the shadow removal problem in synthetic and real-world images. We apply the anisotropic model (13) to images affected by almost constant shadows, in order to perform jointly the shadow removal and the inpainting procedure on the shadow edges. Since in general the ground truth is not available for this problem, the quality of the reconstruction of the anisotropic model in comparison the isotropic approach is assessed by visual inspection.",
            "cite_spans": [
                {
                    "start": 228,
                    "end": 232,
                    "text": "(13)",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Numerical results"
        },
        {
            "text": "On the thickness of the shadow boundary. In the following numerical experiments we will assume for simplicity that a rough segmentation of the shadow boundary is provided beforehand. For natural real images, this may be a quite challenging task since, due to the possible presence of noise, blur and/or compression artefacts, such region may be not sharp and presents a blurred transition zone from the outside to the inside area of the shadow. As a consequence, standard segmentation methods based, for instance, on edge detection methods may fail. In fact, the task of shadow segmentation has been addressed on its own regard in previous works where brightness-based [4] or clustering [8] methods have been applied. However, in many practical situations, the shadow is often roughly detected manually by the user using a brush including pixels both from the inside and the outside of the shadowed area. Such region corresponds to \u2126 sb in (14) .",
            "cite_spans": [
                {
                    "start": 669,
                    "end": 672,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 687,
                    "end": 690,
                    "text": "[8]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 940,
                    "end": 944,
                    "text": "(14)",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [],
            "section": "Numerical results"
        },
        {
            "text": "In our experiments we have observed that if this region is chosen to be too small (i.e. smaller than the whole transition area between non-shadowed and shadowed area), then the shadow removal result is fairly poor. On the contrary, in general, selecting a thicker shadow boundary produces better results. Thick boundaries favour the use of the anisotropic model (13)-(14) over the isotropic one (4): as we seen above, the action of the homogeneous diffusion smoothing on a large region \u2126 sb is not able to preserve the underlying image structures. Figure 4 illustrates these findings. We compare the result obtained applying the isotropic model (4) on a real image where the thickness of the shadow boundary is chosen differently. We clearly observe that a thicker \u2126 sb corresponds to a better removal of the shadow for the same large final time T .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 548,
                    "end": 556,
                    "text": "Figure 4",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Numerical results"
        },
        {
            "text": "We will now show the numerical results obtained when the anisotropic model (13)- (14) was applied to a variety of both synthetic and natural images.",
            "cite_spans": [
                {
                    "start": 81,
                    "end": 85,
                    "text": "(14)",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [],
            "section": "Numerical results"
        },
        {
            "text": "Pseudocode. Algorithm 1 describes the main steps required to solve the joint anisotropic osmosis problem after the estimation of local structures in the given image. For the time integration we used the expleja solver \u2021, which is the companion software of [6] for computing the action of the exponential matrix on a vector. \u2021Freely available at: bitbucket.org/expleja/expleja ",
            "cite_spans": [
                {
                    "start": 256,
                    "end": 259,
                    "text": "[6]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Numerical results"
        },
        {
            "text": "Firts we apply the anisotropic osmosis model to noise-free synthetic images, where the direction of the gradient z is known a priori. The purpose of this synthetic experiment is to check if our approach is able to effectively remove constant shadows. In Figure 5 we show the results obtained for an image with parallel greyscale stripes with \u03b8 = 65 \u2022 orientation and for colour concentric circles, whose \u03b8 is chosen to be as the angle drawn with tangent to the circumferences. Both images are corrupted with an almost constant shadow but a transition zone on the shadow borders. We compare the anisotropic model described in Section 3.2 with the isotropic osmosis model (4) , which results in an homogenous diffusion inpainting at the shadow boundary. The time discretisation is performed as described in Section 3.3. In our visual comparison of both methods, we choose the final time T = 10000 and the time-step \u03c4 = 100, and we proceeded using Algorithm 1. In this experiment we also provide a visual representation of the local orientation angle \u03b8 inside the shadow boundary \u2126 sb . It becomes obvious that the anisotropic shadow removal method shows clear advantages at the shadow boundaries, since it does not suffer from blurring artefacts. ",
            "cite_spans": [
                {
                    "start": 670,
                    "end": 673,
                    "text": "(4)",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [
                {
                    "start": 254,
                    "end": 262,
                    "text": "Figure 5",
                    "ref_id": "FIGREF9"
                }
            ],
            "section": "Synthetic examples"
        },
        {
            "text": "In order to apply the anisotropic model to natural real-world images, the estimation of the discrete local orientation \u03b8(x) becomes crucial. Therefore, we show in Section 4. For the tensor voting, we used the MATLAB implementation of [12] from the companion software \u00a7 of [23] , a literature review on tensor voting. Also, since tensor voting depends on local neighbourhoods, we use a multi-resolution strategy as is described in Algorithm 2. // zeroing and randomizing the data on the shadow edges \u2126 sb saliency loc = saliency loc.*mask; orientation loc = orientation loc.*mask + 2\u03c0.* rand(size(f (:, :, c))).*(1-mask);",
            "cite_spans": [
                {
                    "start": 234,
                    "end": 238,
                    "text": "[12]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 272,
                    "end": 276,
                    "text": "[23]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "Real-world examples"
        },
        {
            "text": "foreach k in scales do",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Real-world examples"
        },
        {
            "text": "[ saliency, ballness, orientation ] = vote ( saliency loc, orientation loc, s k ); \u03bb 1 = saliency +ballness; \u03bb 2 = ballness; e 1 = ( cos(orientation), sin(orientation)); e 2 = (-sin(orientation), cos(orientation)); TVF = TVF + eigen to tensor ( e 1 , e 2 , \u03bb 1 , \u03bb 2 ); end end [ e 1 , e 2 , \u03bb 1 , \u03bb 2 ] = tensor to eigen ( TVF ); \u03b8 = xy2ij (e 2 ); // return the local orientation in (i, j) coordinates return \u03b8",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Real-world examples"
        },
        {
            "text": "In Figure 6 we compare the local direction estimation by means of the structure \u00a7Freely available at MATLAB central: mathworks.com/matlabcentral/fileexchange/47398 tensor and the tensor voting approach applied on the shadowed image in Figure 6a . We plot the magnitude of the leading eigenvalue of the structure tensor in Figure 6b and of the one computed for the tensor voting Algorithm 2 in Figure 6c . These images clearly show that the estimation via tensor voting is less sensitive to the false edges introduced by the shadow boundaries. This is reflected in the plot of the leading directions, too:",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 11,
                    "text": "Figure 6",
                    "ref_id": null
                },
                {
                    "start": 235,
                    "end": 244,
                    "text": "Figure 6a",
                    "ref_id": null
                },
                {
                    "start": 322,
                    "end": 331,
                    "text": "Figure 6b",
                    "ref_id": null
                },
                {
                    "start": 393,
                    "end": 402,
                    "text": "Figure 6c",
                    "ref_id": null
                }
            ],
            "section": "Real-world examples"
        },
        {
            "text": "The directions computed via the structure tensor in Figure 6d are visibly affected by the light jumps while the ones computed with tensor voting in Figure 6e can still connect the structures from outside to inside the shadow with no additional edges.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 52,
                    "end": 61,
                    "text": "Figure 6d",
                    "ref_id": null
                },
                {
                    "start": 148,
                    "end": 157,
                    "text": "Figure 6e",
                    "ref_id": null
                }
            ],
            "section": "Real-world examples"
        },
        {
            "text": "(a) Input f (b) STF, \u03bb 1 (c) TVF, \u03bb 1 (d) STF, e 1 (e) TVF, e 1 Figure 6 : Comparison: structure tensor framework (STF) with (\u03c3, \u03c1) = (0.5, 4) versus tensor voting framework (TVF) with multi-scales (5, 10, 15) and \u03c3 = 0.5. We plot the main direction e 1 and its associated eigenvalue \u03bb 1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 64,
                    "end": 72,
                    "text": "Figure 6",
                    "ref_id": null
                }
            ],
            "section": "Real-world examples"
        },
        {
            "text": "Results on real images. We now combine the proposed tensor voting framework with the anisotropic osmosis model to remove constant shadows by means of an anisotropic drift-diffusion model. In the following experiments we use the final time T = 100000 and the time step size \u03c4 = 1000. In practice the shadow removal is accomplished almost completely already for t T . However, for a better approximation of the steady state, we use the final time T for comparison.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4.2.2."
        },
        {
            "text": "In Figure 7 we show a zoom of the results from Figure 3 \u00b6, presented as motivation for this work. Note that in this case the shadow is artificially added as a multiplicative rescaling factor c \u2208 (0, 1). The estimation of the direction on the shadow boundary is computed via the proposed Algorithm 2.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 11,
                    "text": "Figure 7",
                    "ref_id": null
                },
                {
                    "start": 47,
                    "end": 55,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "4.2.2."
        },
        {
            "text": "(a) Shadowed f Orientation angle \u03b8 Isotropic Anisotropic Figure 7 : Zoom of the results for the shadowed image in Figure 3 . \u00b6Figure 3a (zoomed in Figure 7a ) courtesy of R. D. Kongskov. In Figure 8 we apply the isotropic and the anisotropic model to a several shadowed images affected by natural constant shadows . Zoomed details can be found in Figure 9 .",
            "cite_spans": [
                {
                    "start": 177,
                    "end": 186,
                    "text": "Kongskov.",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 57,
                    "end": 65,
                    "text": "Figure 7",
                    "ref_id": null
                },
                {
                    "start": 114,
                    "end": 122,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 147,
                    "end": 156,
                    "text": "Figure 7a",
                    "ref_id": null
                },
                {
                    "start": 190,
                    "end": 198,
                    "text": "Figure 8",
                    "ref_id": "FIGREF11"
                },
                {
                    "start": 347,
                    "end": 355,
                    "text": "Figure 9",
                    "ref_id": "FIGREF12"
                }
            ],
            "section": "4.2.2."
        },
        {
            "text": "Here the complexity of local image structures makes the application of the anisotropic osmosis model harder. Thus, we use the tensor voting algorithm 2 to estimate the local directions connecting the structures from inside to the outside of the shadow region. Also in these real-world scenarios, we observe the superiority of the anisotropic approach: structures are interpolated reliably across the light jump introduced by the shadow. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4.2.2."
        },
        {
            "text": "We note that our anisotropic approach removes shadows effectively both for synthetic and real-world images. Structures are propagated correctly over the shadow boundary.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comments on the results"
        },
        {
            "text": "Since the AD-LBR stencil requires a positive definite matrix W as input, we need to choose \u03b5 > 0, which may lead to some over-smoothing in the orthogonal direction. Also, we noticed some over-smoothing effect in \u2126 out and \u2126 in for the AD-LBR scheme, e.g. in Figure 9f , whose understanding is a matter of future research.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 258,
                    "end": 267,
                    "text": "Figure 9f",
                    "ref_id": "FIGREF12"
                }
            ],
            "section": "Comments on the results"
        },
        {
            "text": "In terms of efficiency, the computational time needed for computing the action of the exponential matrix onto a vector, that is the product exp(\u03c4 A)u 0 , largely depends on the choice of the time-step \u03c4 , the final time T and the size of the images. Although it is possible to directly choose \u03c4 = T and proceed in a single step, we prefer multiple steps. In this way, by comparing two successive solutions u k+1 and u k , it is possible to detect whether the evolution is sufficiently close to its steady state. Our solvers that are exact in time offer additional advantages over classical inexact methods such as explicit and implicit schemes when one is also interested in good approximations of intermediate results.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Comments on the results"
        },
        {
            "text": "In this work, we have generalised isotropic osmosis filtering introduced in [36, 38] to the anisotropic setting. This was achieved by introducing a weight matrix whose directional information was extracted from a modified tensor voting approach [24] . When applied to the shadow removal problem, the anisotropic model acts as an inpainting interpolator on the shadow boundary. It is close in spirit to inpainting with edge-enhancing anisotropic diffusion [39, 13, 33] .",
            "cite_spans": [
                {
                    "start": 76,
                    "end": 80,
                    "text": "[36,",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 81,
                    "end": 84,
                    "text": "38]",
                    "ref_id": "BIBREF39"
                },
                {
                    "start": 245,
                    "end": 249,
                    "text": "[24]",
                    "ref_id": "BIBREF25"
                },
                {
                    "start": 455,
                    "end": 459,
                    "text": "[39,",
                    "ref_id": "BIBREF40"
                },
                {
                    "start": 460,
                    "end": 463,
                    "text": "13,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 464,
                    "end": 467,
                    "text": "33]",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Conclusions and outlook"
        },
        {
            "text": "From a numerical point of view, we have combined the nonnegativity preserving anisotropic diffusion stencil of Fehrenbach and Mirebeau [10] with techniques based on exponential integration [6] : We argued that the fully discrete model satisfies the discrete properties studied in [36] in a general setting for osmosis. We tested the proposed model for synthetic and real examples, showing that the generalised model acts as a combined osmosis-inpainting model for shadow removal problems, thus avoiding any undesirable post-processing inpainting step.",
            "cite_spans": [
                {
                    "start": 135,
                    "end": 139,
                    "text": "[10]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 189,
                    "end": 192,
                    "text": "[6]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 280,
                    "end": 284,
                    "text": "[36]",
                    "ref_id": "BIBREF37"
                }
            ],
            "ref_spans": [],
            "section": "Conclusions and outlook"
        },
        {
            "text": "Future work will address the investigation on the applicability of the proposed anisotropic model to more general imaging applications.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions and outlook"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Computing the action of the matrix exponential with an application to exponential integrators",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "H"
                    ],
                    "last": "Al-Mohy",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "J"
                    ],
                    "last": "Higham",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "SIAM Journal on Scientific Computing",
            "volume": "33",
            "issn": "2",
            "pages": "488--511",
            "other_ids": {
                "DOI": [
                    "DOI10.1137/100788860"
                ]
            }
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "A variational framework for exemplar-based image inpainting",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Arias",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Facciolo",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Caselles",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Sapiro",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "International Journal of Computer Vision",
            "volume": "93",
            "issn": "3",
            "pages": "319--347",
            "other_ids": {
                "DOI": [
                    "DOI10.1007/s11263-010-0418-7"
                ]
            }
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Mathematical problems in image processing: Partial Differential Equations and the Calculus of Variations",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Aubert",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kornprobst",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "",
            "volume": "147",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1007/978-0-387-44588-5"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Shadow removal from a real picture",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Baba",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Asada",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "ACM SIGGRAPH",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Sketches & Applications, SIGGRAPH '03",
            "authors": [],
            "year": 2003,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "1--1",
            "other_ids": {
                "DOI": [
                    "10.1145/965400.965488"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Alternating direction implicit (ADI) schemes for a PDE-based image osmosis model",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Calatroni",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Estatico",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Garibaldi",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Parisotto",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Journal of Physics: Conference Series",
            "volume": "904",
            "issn": "1",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "DOI10.1088/1742-6596/904/1/012014"
                ]
            }
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "The Leja method revisited: Backward error analysis for the matrix exponential",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Caliari",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Kandolf",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Ostermann",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Rainer",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "SIAM Journal on Scientific Computing",
            "volume": "38",
            "issn": "3",
            "pages": "1639--1661",
            "other_ids": {
                "DOI": [
                    "10.1137/15M1027620"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Image Processing and Analysis: Variational, PDE, Wavelet, and Stochastic Methods",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Chan",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Shen",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "DOI10.1137/1.9780898717877"
                ]
            }
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Fast shadow removal using adaptive multi-scale illumination transfer",
            "authors": [
                {
                    "first": "X",
                    "middle": [],
                    "last": "Chunxia",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ruiyun",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Donglin",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kwan\u00e2-Liu",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Computer Graphics Forum",
            "volume": "32",
            "issn": "8",
            "pages": "207--218",
            "other_ids": {
                "DOI": [
                    "10.1111/cgf.12198"
                ]
            }
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Low-dimensional lattices. vi. Voronoi reduction of three-dimensional lattices",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "H"
                    ],
                    "last": "Conway",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "J A"
                    ],
                    "last": "Sloane",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Proceedings of the Royal Society of London A: Mathematical, Physical and Engineering Sciences",
            "volume": "436",
            "issn": "",
            "pages": "55--68",
            "other_ids": {
                "DOI": [
                    "10.1098/rspa.1992.0004"
                ]
            }
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Sparse non-negative stencils for anisotropic diffusion",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Fehrenbach",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Mirebeau",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Journal of Mathematical Imaging and Vision",
            "volume": "49",
            "issn": "1",
            "pages": "123--147",
            "other_ids": {
                "DOI": [
                    "DOI10.1007/s10851-013-0446-3"
                ]
            }
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "A Feature Based Correspondence Algorithm for Image Matching",
            "authors": [
                {
                    "first": "W",
                    "middle": [],
                    "last": "F\u00f6rstner",
                    "suffix": ""
                }
            ],
            "year": 1986,
            "venue": "Int. Arch. of Photogrammetry and Remote Sensing",
            "volume": "26",
            "issn": "3",
            "pages": "150--166",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "An efficient method for tensor voting using steerable filters",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Franken",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Van Almsick",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Rongen",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Florack",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Ter Haar Romeny",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Computer Vision -ECCV 2006",
            "volume": "",
            "issn": "",
            "pages": "228--240",
            "other_ids": {
                "DOI": [
                    "10.1007/1174408518"
                ]
            }
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Image compression with anisotropic diffusion",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Gali\u0107",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Welk",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Bruhn",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Belyaev",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "P"
                    ],
                    "last": "Seidel",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Journal of Mathematical Imaging and Vision",
            "volume": "31",
            "issn": "2-3",
            "pages": "255--269",
            "other_ids": {
                "DOI": [
                    "10.1007/s10851-008-0087-0"
                ]
            }
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Anisotropic total variation filtering",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Grasmair",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Lenzen",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Applied Mathematics and Optmization",
            "volume": "62",
            "issn": "",
            "pages": "323--339",
            "other_ids": {
                "DOI": [
                    "10.1007/s00245-010-9105-x"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "A review of PDE models in image processing and image analysis",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Guichard",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Moisan",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "M"
                    ],
                    "last": "Morel",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Journal de Physique IV",
            "volume": "",
            "issn": "",
            "pages": "137--154",
            "other_ids": {
                "DOI": [
                    "DOI10.1051/jp42002006"
                ]
            }
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Inferring global perceptual contours from local features",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Guy",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Medioni",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "International Journal of Computer Vision",
            "volume": "20",
            "issn": "1",
            "pages": "113--133",
            "other_ids": {
                "DOI": [
                    "DOI10.1007/BF00144119"
                ]
            }
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Novel schemes for hyperbolic pdes using osmosis filters from visual computing",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Hagenburg",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Breu\u00df",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Vogel",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Scale Space and Variational Methods in Computer Vision",
            "volume": "",
            "issn": "",
            "pages": "532--543",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "A combined corner and edge detector",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Harris",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Stephens",
                    "suffix": ""
                }
            ],
            "year": 1988,
            "venue": "Proceedings of the Alvey Vision Conference",
            "volume": "6",
            "issn": "",
            "pages": "23--24",
            "other_ids": {
                "DOI": [
                    "10.5244/C.2.23"
                ]
            }
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Exponential integrators",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hochbruck",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Ostermann",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Acta Numerica",
            "volume": "19",
            "issn": "",
            "pages": "209--286",
            "other_ids": {
                "DOI": [
                    "DOI10.1017/S0962492910000048"
                ]
            }
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Analyzing oriented patterns",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kass",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Witkin",
                    "suffix": ""
                }
            ],
            "year": 1987,
            "venue": "Computer Vision, Graphics, and Image Processing",
            "volume": "37",
            "issn": "3",
            "pages": "362--385",
            "other_ids": {
                "DOI": [
                    "10.1016/0734-189X(87)90043-0"
                ]
            }
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Directional total generalized variation regularization for impulse noise removal",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "D"
                    ],
                    "last": "Kongskov",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Dong",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "221--231",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-319-58771-418"
                ]
            }
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Directional total generalized variation regularization",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "D"
                    ],
                    "last": "Kongskov",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Dong",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Knudsen",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Perceptual grouping by tensor voting: a comparative survey of recent approaches",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Maggiori",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "L"
                    ],
                    "last": "Manterola",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Del Fresno",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "IET Computer Vision",
            "volume": "9",
            "issn": "2",
            "pages": "259--277",
            "other_ids": {
                "DOI": [
                    "DOI10.1049/iet-cvi.2014.0103"
                ]
            }
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Adaptation of tensor voting to image structure estimation",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Moreno",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Pizarro",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Burgeth",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "A"
                    ],
                    "last": "Garcia",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Puig",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "New Developments in the Visualization and Processing of Tensor Fields",
            "volume": "",
            "issn": "",
            "pages": "29--50",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Consistent positive directional splitting of anisotropic diffusion",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Mr\u00e1zek",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Navara",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "Proc. Sixth Computer Vision Winter Workshop",
            "volume": "",
            "issn": "",
            "pages": "37--48",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "An investigation of smoothness constraints for the estimation of displacement vector fields from image sequences",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "H"
                    ],
                    "last": "Nagel",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Enkelmann",
                    "suffix": ""
                }
            ],
            "year": 1986,
            "venue": "IEEE Trans. Pattern Anal. Mach. Intell",
            "volume": "8",
            "issn": "5",
            "pages": "565--593",
            "other_ids": {
                "DOI": [
                    "10.1109/TPAMI.1986.4767833"
                ]
            }
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Digital cultural heritage imaging via osmosis filtering",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Parisotto",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Calatroni",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Daffara",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Image and Signal Processing LNCS 10884",
            "volume": "",
            "issn": "",
            "pages": "407--415",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "Higher order total directional variation. Part I: Imaging applications (forthcoming)",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Parisotto",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Masnou",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "B"
                    ],
                    "last": "Sch\u00f6nlieb",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "Higher order total directional variation",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Parisotto",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Masnou",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "B"
                    ],
                    "last": "Sch\u00f6nlieb",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Maximum Principles in Differential Equations",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "H"
                    ],
                    "last": "Protter",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "F"
                    ],
                    "last": "Weinberger",
                    "suffix": ""
                }
            ],
            "year": 1984,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "DOI10.1007/978-1-4612-5282-5"
                ]
            }
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Analysis of some Krylov subspace approximations to the matrix exponential operator",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Saad",
                    "suffix": ""
                }
            ],
            "year": 1992,
            "venue": "SIAM Journal on Numerical Analysis",
            "volume": "29",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1137/0729014"
                ]
            }
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "Geometric Partial Differential Equations and Image Analysis",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Sapiro",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "DOI10.1017/CBO9780511626319"
                ]
            }
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Understanding, optimising, and extending data compression with anisotropic diffusion",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Schmaltz",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Peter",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Mainberger",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Ebel",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Bruhn",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "International Journal of Computer Vision",
            "volume": "108",
            "issn": "3",
            "pages": "222--240",
            "other_ids": {
                "DOI": [
                    "DOI10.1007/s11263-014-0702-z"
                ]
            }
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "Partial Differential Equation Methods for Image Inpainting. Cambridge Monographs on Applied and Computational Mathematics",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "B"
                    ],
                    "last": "Sch\u00f6nlieb",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "DOI10.1017/CBO9780511734304"
                ]
            }
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "Depth-first search and linear graph algorithms",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Tarjan",
                    "suffix": ""
                }
            ],
            "year": 1972,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1137/0201010"
                ]
            }
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "Scale Space and Variational Methods in Computer Vision",
            "authors": [
                {
                    "first": "O",
                    "middle": [],
                    "last": "Vogel",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Hagenburg",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Setzer",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "368--379",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-642-38267-331"
                ]
            }
        },
        "BIBREF38": {
            "ref_id": "b38",
            "title": "Anisotropic Diffusion in Image Processing",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "Linear osmosis models for visual computing",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Hagenburg",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Breu\u00df",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [],
                    "last": "Vogel",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Energy Minimization Methods in Computer Vision and Pattern Recognition",
            "volume": "",
            "issn": "",
            "pages": "26--39",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-642-40395-83"
                ]
            }
        },
        "BIBREF40": {
            "ref_id": "b40",
            "title": "Tensor field interpolation with PDEs",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Welk",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Visualization and Processing of Tensor Fields",
            "volume": "",
            "issn": "",
            "pages": "315--325",
            "other_ids": {
                "DOI": [
                    "10.1007/3-540-31272-219"
                ]
            }
        },
        "BIBREF41": {
            "ref_id": "b41",
            "title": "L2-stable nonstandard finite differences for anisotropic diffusion",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Weickert",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Welk",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Wickert",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "380--391",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-540-72823-8"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF1": {
            "text": "Shadow removal for Figure 1a via (4) in Figure 2a and with post-processing inpainting correction in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Comparison of solutions obtained by solving the isotropic model considered in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Let v : \u2126 \u2192 R + be a positive image, d \u2208 R 2 the vector field defined as d := \u2207 log v and W : \u2126 \u2192 R 2 be a positive semi-definite symmetric matrix field. Then, for a given positive image f \u2208 L \u221e (\u2126; R + ) the solution of the Euler-Lagrange equation of the functional E defined in (2.1) is the steady state of the anisotropic image osmosis model",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Let C = (c i,j ), D = (d i,j ) \u2208 R S\u00d7S be matrices with column sums c and d, respectively. Then the matrix B := CD has column sum cd.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Comparison between different thicknesses of the shadow boundary for the solution of the isotropic model (4). Final time T = 100000. Algorithm 1: Shadow Removal Input : a shadowed image f of dimension M \u00d7 N \u00d7 C (with C colour channels); a mask with value 1 on shadow boundary and 0 elsewhere; a stack of scales = [s 1 , . . . , s S ]; the parameters \u03b5, \u03c3, \u03c4 and K. Package: expjeja.m from bitbucket.org/expleja/expleja Function shadow removal: \u03b8 = estimate direction (f , mask, scales, \u03c3); // see Algorithm 2 W = compute matrix field(\u03b8, \u03b5, mask) ; // from Equation (15) u 0 = f ; // initialisation for c = 1, . . . , C do A c = discretize matrix(u 0 (:, :, c), W, mask); // via AD-LBR stencil for k = 0, . . . , K \u2212 1 do u k+1 (:, :, c) = expleja(\u03c4 , A c , u k (:, :, c)); end end return u K .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "Shadow removal via osmosis on synthetic images. Comparison between isotropic and aniotropic osmosis. Parameters: time step size \u03c4 = 100, final time T = 10000, and smaller eigenvalue \u03b5 = 0.05.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "(Multi-scale) Eigen-directions via tensor voting in shadowed image Input : a shadowed image f of dimension M \u00d7 N \u00d7 C (with C colour channels); a mask with value 1 on shadow boundary and 0 elsewhere; a stack of scales = [s 1 , . . . , s S ]; the parameter \u03c3 > 0. Package: encode and vote from mathworks.com/matlabcentral/fileexchange/47398 modified to return orientation loc and orientation in (x, y) coordinates Function estimate directions: TVF = zeros(size(f ,1),size(f ,2),2,2); for c = 1, . . . , C do [ saliency loc, ballness loc, orientation loc ] = encode (K \u03c3 * f (:, :, c));",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "Shadow removal via osmosis on real images. Comparison between isotropic and anisotropic osmosis. Parameters: \u03c4 = 1000, T = 100000, \u03b5 = 0.05, and \u03c3 = 0.5.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF12": {
            "text": "Zoom into the results from Figure 8.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF13": {
            "text": "from http://www.cs.huji.ac.il/ \u223c danix/ShadowRemoval/index.html; Figure 8b from http://aqua.cs.uiuc.edu/site/projects/shadow.html; Figure 8c from http://www.cs.haifa.ac.il/hagit/ papers/ShadowRemoval/;",
            "latex": null,
            "type": "figure"
        },
        "TABREF1": {
            "text": "2.1the results of the proposed approach discussed in Section 2.3. Once the directions are estimated, we present in Section 4.2.2 the results of the anisotropic osmosis filter on real shadowed images.4.2.1. Estimation of the local orientation. Following Section 2.3, here we present the algorithm and the results for estimating the vector field that closes the interrupted lines onto the shadow boundary domain \u2126 sb , via the modified tensor voting framework.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The authors thank J.M. Mirebeau for the insightful discussions and comments on the adaptation of the code from [10] to our problem and the Isaac Newton Institute for Mathematical Sciences for support and hospitality during the program \"Variational Methods and Effective Algorithms for Imaging and Vision\" when work on this paper was undertaken. This work was supported by EPSRC grant number EP/K032208/1.",
            "cite_spans": [
                {
                    "start": 111,
                    "end": 115,
                    "text": "[10]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "acknowledgement"
        }
    ]
}