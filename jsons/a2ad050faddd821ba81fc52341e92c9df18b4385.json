{
    "paper_id": "a2ad050faddd821ba81fc52341e92c9df18b4385",
    "metadata": {
        "title": "",
        "authors": []
    },
    "abstract": [
        {
            "text": "This work presents a novel methodology for systematically processing the time series that report the number of positive, recovered and deceased cases from a viral epidemic, such as Covid-19. The main objective is to unveil the evolution of the number of real infected people, and consequently to predict the peak of the epidemic and subsequent evolution. For this purpose, an original nonlinear model relating the raw data with the timevarying geometric ratio of infected people is elaborated, and a Kalman Filter is used to estimate the involved state variables. A hypothetical simulated case is used to show the adequacy and limitations of the proposed method. Then, several countries, including China, South Korea, Italy, Spain, UK and the USA, are tested to illustrate its behavior when real-life data are processed. The results obtained clearly show the beneficial effect of the social distancing measures adopted worldwide, confirming that the Covid-19 epidemic peak is left behind in those countries where the outbreak started earlier, and anticipating when the peak will take place in the remaining countries.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "espite the spectacular medical advances of the 20th century, and the practical eradication of viral diseases that in the past caused great mortality (e.g., smallpox), modern societies are still very vulnerable to the sudden appearance of new viruses, such as the SARS-CoV-2 (Covid-19), for which there is still no vaccine. In addition, once a viral outbreak originates in a region of a country (in the case of the Covid-19, the Chinese region of Hubei), the globalization of the economy and mass tourism spread it almost inevitably and quickly to the rest of the world.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "In the absence of effective treatment, once a certain threshold has been passed, the main and almost sole remedy against the spread of the disease to the entire population is lockdown, the objective of which is to minimize the contact between people, and therefore morbidity. This forces a large part of the economic activity to be paralyzed, with the consequent Manuscript submitted for review on May 11, 2020. The third author thanks the financial support of the Spanish Ministry of Education and Professional Training (grant FPU17/06380). damages for the affected people and companies.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "For this reason, all the agents involved (governments, international organizations, institutions, companies and individuals) have the greatest interest in knowing how the number of affected and deceased people will evolve over time, with a view, on the one hand, to verifying the beneficial effects of social distancing, and on the other to scheduling the already saturated health resources and taking the economic measures intended to mitigate as far as possible the devastating effects of an epidemic like that of Covid-19.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "Scientists, engineers, economists, etc. are acquainted with several mathematical and statistical toolkits (recently renamed collectively as \"data analytics\") for the treatment and filtering of time series, with a view to extracting useful information from the available data, uncertain by definition, such as trends, patterns, average values, expected variances, etc. In the specific case of a viral epidemic, such as that of Covid-19, there are basically two categories of models for processing the information:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "1. Models that try to characterize the \"physical\" reality explaining the observed data. In the case of a viral epidemic, these models [1] , [2] consider, for example, what fraction of people are at work, in teaching or travelling, how long it takes for an infected person to manifest symptoms, what is the mortality rate according to age groups, etc. This type of modeling is widely used in engineering, because the dynamics of the underlying systems or devices are generally well characterized, through mathematical relationships obtained from the physical laws that govern them (such is the case, for example, of electrical networks or an artificial satellite).",
            "cite_spans": [
                {
                    "start": 134,
                    "end": 137,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 140,
                    "end": 143,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "2. Models that try to determine explanatory parameters or variables from a purely mathematical point of view (\"black box\" approach), without going into the causes or interactions between components that explain the resulting data. Given uncertain data, which enter the system regularly (in our case, every day), the aim is to characterize its temporal evolution by All 2.a) Mathematical models that do not assume a priori what the shape of the temporal evolution of the involved magnitudes will be, but rather use a state transition equation, which tries to capture the dynamics of the problem in question by relating the variables in an instant of time to the variables in the previous instant. In this case, it is a matter of determining how the coefficients that define this equation evolve over time. In the case of epidemics, among the most popular models are those derived from the SIR (Susceptible-Infected-Recovered) model, [3] , such as the one used for example in [4] to analyze the evolution of Covid-19 in Italy.",
            "cite_spans": [
                {
                    "start": 365,
                    "end": 368,
                    "text": "All",
                    "ref_id": null
                },
                {
                    "start": 932,
                    "end": 935,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 974,
                    "end": 977,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "Mathematical models based on the assumption that the evolution of infected people, deceased, etc. obeys a predetermined curve (based on the experience of previous epidemics), whose coefficients are estimated based on the time series of reported data. For example, the evolution of the accumulated number of infected people can be satisfactorily approximated by means of a sigmoid curve, as assumed in [5] , where the curve proposed by Gompertz [6] is used.",
            "cite_spans": [
                {
                    "start": 401,
                    "end": 404,
                    "text": "[5]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 444,
                    "end": 447,
                    "text": "[6]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "2.b)"
        },
        {
            "text": "The methodology proposed in this work belongs to the second category. As explained in the next section, we depart from the SIR model, by considering that the number of susceptible people, being large enough and changing relatively slowly, does not have to be explicitly considered in the model, but can be rather embedded in other more significant parameters, such as the time-varying ratio of the geometric series characterizing the progression of affected people. Moreover, the proposed model explicitly distinguishes between people who have proved positive in a test, and people actually infectious, who are many more and for whom there is no reliable information.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2.b)"
        },
        {
            "text": "Another major difference of this work with respect to others, is the use of a Kalman Filter (KF) to process both the assumed dynamic model and the information available throughout the outbreak. The KF, proposed for linear dynamic systems in the early 1960s, is considered one of the fundamental tools that allowed man to walk on the moon, as it was successfully used in guiding the Apollo program space missions [7] . This filter, which constitutes a generalization of the technique known as \"recursive least squares\", estimates the maximum likelihood evolution (that is, the most statistically probable, according to the assumed uncertainties and the observed samples) of the state of a dynamic system, and can be generalized to the non-linear case, including situations where the model parameters are also to be estimated. References [8] and [9] are among the very few applications of KF in epidemiology, dealing respectively with the estimation of the Covid-19 reproductive number, and the evolution of AIDS.",
            "cite_spans": [
                {
                    "start": 412,
                    "end": 415,
                    "text": "[7]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 836,
                    "end": 839,
                    "text": "[8]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 844,
                    "end": 847,
                    "text": "[9]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [],
            "section": "2.b)"
        },
        {
            "text": "We start from the well-known and simple SIR model [3] , mathematically described by:",
            "cite_spans": [
                {
                    "start": 50,
                    "end": 53,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "where # ( ) and # ( ) are, respectively, the cumulative or total susceptible and recovered people, ( ) represents the active infectious (not to be confused with cumulative infectious), \u03b2 and \u03b3 are the transmission and recovery rates, and is the total population of the studied region, satisfying = ( ) + ( ) + ( ). Note that, in this compact model, the deceased cases are paradoxically included in # ( ) (alternatively, they could be subtracted from ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "For practical purposes, the discrete counterparts obtained by numerical integration (forward Euler) are rather of interest. Moreover, as dead are separately reported, they can be explicitly modeled, leading to a discrete-time extended SIR (ESIR) model:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "where is the elapsed time (in days) from a given origin, # ( ) is the cumulative dead and is a mortality ratio.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "The data publicly reported (available in references such as [10],[11]), typically comprise the following three items:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "\u2022 Fraction of infectious people who, subject to a test, yield a positive outcome. This considers the fact that there may be many more infected than those reported positives, as happens with a large number of asymptomatic population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "The cumulative positives will be denoted # ( ). \u2022 Fraction of recovered people who have been previously identified as positive. For simplicity of notation, the same symbol as in (3) will be used in the sequel, namely # ( ), even though we are referring here to a subset of # in (3). \u2022 Cumulative number of deceased, ( ), which is assumed to be the same as in the ESIR model, even though the actual number of dead by the virus may differ from the reported figures.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "Some sources directly provide the active positive cases, ( ), defined as: ( ) = # ( ) \u2212 # ( ) \u2212 # ( ). Note that both ( ) and ( ) tend to zero as increases sufficiently (end of the viral outbreak), while the remaining cumulative magnitudes asymptotically reach a maximum or steady-state value.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "Epidemiologists use the so-called basic reproductive number, . CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. PROPOSED MODEL"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 14, 2020. . https://doi.org/10.1101/2020.05.11.20098087 doi: medRxiv preprint : (average number of people infected by a single infectious person during the infective period at the onset of the outbreak) to characterize whether and how fast an epidemic spreads at the very beginning. If : >1, then the epidemic will progress exponentially. As time elapses, though, the number of susceptible people decreases, either by the virus evolution itself or as a consequence of social distancing measures, and : is replaced by the effective reproductive number, ; . In terms of ESIR coefficients, : and ; are given by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "However, as thoroughly discussed in [12] , the basic reproductive number : is not free from ambiguity and controversy. For instance, it is stated in [12] that \"using : as a threshold parameter for a population-level model could produce misleading estimates of the infectiousness of the pathogen, the severity of an outbreak, and the strength of the medical and/or behavioral interventions necessary for control\". Moreover, if : is estimated from time series of reported data, as in [8] , then there is no way, at least for a new virus such as Covid-19, to subsequently check or contrast the accuracy of the estimates. This probably explains the wide confidence intervals so far reported for : values [13] . Similar arguments apply to ; .",
            "cite_spans": [
                {
                    "start": 36,
                    "end": 40,
                    "text": "[12]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 149,
                    "end": 153,
                    "text": "[12]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 482,
                    "end": 485,
                    "text": "[8]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 700,
                    "end": 704,
                    "text": "[13]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "For this reason, instead of or in addition to : , we postulate in this work the use of a more intuitive and measurable index, related with the growth rate of the infected class, to duly and unambiguously characterize a viral epidemic. Let the daily evolution of the active infectious be expressed as a geometric time series:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where ( ) is the time-varying ratio of the series. Then the daily growth rate is obtained from:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Clearly, as long as ( )>1, the viral outbreak will continue its expansion, whereas the disease extinguishes when ( )<1. There is no ambiguity in using ( ) as a threshold, when referred to a whole population. Note however that, if (5) were expressed in terms of cumulative magnitudes, rather than daily or active cases, then ( ) would tend asymptotically to 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "By direct comparison of (5) with (2), the following relation is obtained,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "or, in terms of ; :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Given ( ), one still would have to guess the values of the parameters involved in the ESIR model (1)-(3), to obtain : . We contend that there is no need to worry in the short term about : , as ( ) suffices to duly track the epidemic evolution on a daily basis.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "This work is aimed at estimating, from the daily reported data, the evolution of ( ) and, as a consequence, the evolution (growth rate) of the infectious people. Note that, if ( ) can be somehow estimated, then equation (1) becomes unnecessary. In our approach, the impact of susceptible people, a factor which varies smoothly, is also embedded into ( ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "In order to take advantage of the reported numbers of positive, deceased, and recovered cases, the following relationships are considered, taking into account (3)-(4): ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where N ( ) = ( + 1)/ ( ) is the ratio of consecutive daily deaths and P ( ) = ( + 1)/ ( ) is in turn a ratio of consecutive mortality ratios.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Similarly, from (6) and (5):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "and dividing:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where Q ( ) = ( + 1)/ ( ) is the ratio of consecutive daily positives and ; ( ) = ( + 1)/ ( ) is a ratio of consecutive ( ) coefficients.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Finally, from (8) and (5):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 14, 2020. . https://doi.org/10.1101/2020.05.11.20098087 doi: medRxiv preprint and dividing:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where R ( ) = ( + 1)/ ( ) is the ratio of daily recovered cases and S ( ) = ( + 1)/ ( ) is a ratio of consecutive ; ( ) coefficients.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "From the above simple model, given by (9)-(11), a system of state equations can be formulated allowing the sequence ( ) to be estimated by means of a non-linear KF, such as the Extended KF (EKF), Unscented KF (UKF) or Ensemble KF (EnKF) [7] , [14] . This type of filter is capable of estimating the dynamic evolution of both parameters and state variables. Even though its maximum likelihood has only been proven for linear problems, it is applied successfully in nonlinear problems, such as the one in hand.",
            "cite_spans": [
                {
                    "start": 237,
                    "end": 240,
                    "text": "[7]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 243,
                    "end": 247,
                    "text": "[14]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "In our proposal, the state vector is composed of the infectious geometric ratio, ( ), not directly measured, and the gains P ( ), ; ( ) and S ( ), all of them initially assumed to evolve with a random walk. Therefore, the state vector is The state is to be estimated with the help of a measurement vector, composed of N ( ), Q ( ) and R ( ), along with the pseudo-measurements of P ( ), ; ( ) and S ( ). Thus, assuming that the coefficients ( ), ( ) and ; ( ) change slowly, their variation ratios can be considered to lie around the unity. Therefore, the measurement vector is, With this formulation, the EKF is able to deal properly with the non-linearity arising in the measurement equation, performing at each iteration a linear prediction step, followed by the non-linear correction step. So, the KF provides the sequence of states estimates Z( ), whose last component, the estimate of ( ), will be denoted as [ ( ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "The sequence [ ( ) incorporates, in a statistically optimal fashion, the noisy information provided by raw data ratios, such as N ( ), Q ( ) or R ( ), which results in a more reliable estimation than the raw data ratios themselves.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "After several initial trials, an enhanced model has been finally implemented, considering two improvements: 2) The information available at instant can be used to improve previous estimations. For this purpose, the Rauch-Tung-Striebel (RTS) smoother [7] , is implemented in two steps:",
            "cite_spans": [
                {
                    "start": 250,
                    "end": 253,
                    "text": "[7]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "\u2022 Forward pass performed with EKF.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "\u2022 Backward recursion smoother based on the linear state transition equation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "Regarding the tuning of the filter, the diagonal elements of ( ) related to N , Q and R are proposed to be self-tuned according to the respective sample variances of the last available days of N ( ), Q ( ) and R ( ). The terms related to the pseudo-measurements are set to 10 _g to increase their weights. is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. KALMAN FILTER APPLICATION AND IMPLEMENTATION"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 14, 2020. . https://doi.org/10.1101/2020.05.11.20098087 doi: medRxiv preprint the mean of the raw ratios, m gains initialized to 1, and P(0) initialized to an identity matrix.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Additionally, the results of the KF allow the estimation or prediction of two magnitudes of great interest:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "1) The day in the future when the infection peak will be reached, o , which will occur when p q o r = 1. For this purpose, the sequence [ ( ) can be fitted to a predetermined evolution in order to predict its future behavior from the past history. According to what can be observed empirically, we have fitted the sequence [ ( ) to a decreasing exponential, characteristic of first-order systems. It is worth stressing that, at this point, we are talking about the peak of infected, the peak of positives being a proxy for it.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "2) The estimated number of active infectious people, [ ( ). This magnitude can be computed from those infected at a given reference day, : , as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "This means that, besides the errors of the sequence [ ( ), the uncertainty of [ ( ) inherits that of the initial guess ( : ). Therefore, as happens also with the SIR model, and in fact with any other model based on differential equations, precisely estimating [ ( ) based on the above expression requires that an accurate number of infectious people be known on a given day, which can be very challenging. For our results, we will obtain the initial guess from [ ( : ) = ( : )/ ( : ), for an assumed value of ( : ). For instance, ( : ) = 0.2 if we believe the first day there were 5 infectious people per reported positive.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "In this section, the performance of the proposed implementation of the KF is tested on a set of simulated scenarios, where the SIR model described in Section II is considered for the propagation of a virtual virus.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. SIMULATION RESULTS"
        },
        {
            "text": "While the total simulation time is 90 days, a lockdown is assumed to take place at day 15, resulting in an exponential decrease of the transmission rate, \u03b2, from an initial value of 0.5 to 0.09. The remaining simulation parameters are given in Table  I . In all simulated cases presented in the sequel, artificial noise has been added to the measurements used by the KF algorithm.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 244,
                    "end": 252,
                    "text": "Table  I",
                    "ref_id": "TABREF1"
                }
            ],
            "section": "IV. SIMULATION RESULTS"
        },
        {
            "text": "In the base case, the testing ratio, ( ), is assumed to remain constant (except for the noise). The time evolution of the estimated geometric ratio, ( ), is represented in Fig. 1 along with the raw noisy measurements provided by the simulation and the actual value of ( ). Note that the estimation provided by the KF is very close to the simulated value, giving evidence of the good performance of the proposed method. Fig. 2 shows the benefit attained from the incorporation of the smoothing filter mentioned above to the basic EKF algorithm, in terms of more damped oscillations. To compare the proposed KF implementation with other methods customarily employed as filters in these cases, Fig. 3 shows the estimated value of ( ) along with the results provided by three moving-average filters respectively applied to each of the noisy measurements, Q , N and R . As can be seen, the KF more closely tracks the evolution of ( ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 172,
                    "end": 178,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 419,
                    "end": 425,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 691,
                    "end": 697,
                    "text": "Fig. 3",
                    "ref_id": null
                }
            ],
            "section": "A. Base case"
        },
        {
            "text": ". CC-BY-NC 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Base case"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 14, 2020. . https://doi.org/10.1101/2020.05.11.20098087 doi: medRxiv preprint Fig. 3 . Comparison of the proposed method with moving average filters From the estimated ( ) sequence, and the initial testing ratio, (0), an estimation is obtained for the evolution of infectious people, which is compared in Fig. 4 with the simulated value of ( ) and the reported positives. The maximum estimation error (around 4.5%) takes place, as expected, at the peak of the epidemic. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 141,
                    "end": 147,
                    "text": "Fig. 3",
                    "ref_id": null
                },
                {
                    "start": 368,
                    "end": 374,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF7"
                }
            ],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Once the proposed estimation technique is validated in the base case, the effect of different errors is studied in the following scenarios.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. Error assessment"
        },
        {
            "text": "An abrupt change is simulated in the testing ratio from ( ) =0.2 to 0.3 at day 25, representing an increase in the availability of the tests (this has been observed in practice in several countries). Fig. 5 shows the estimation of ( ), jointly with the simulated value and the measurements of the geometric ratios Q , N and R . Note that the step in ( ) is observed as an impulse in the ratio Q , which is quite effectively filtered out by the proposed KF implementation. The estimation of ( ) is represented in Fig. 6 where the actual simulated value is again very close to the estimated one, giving evidence of the good performance of the method in the presence of a step in the testing ratio. Finally, the last scenario considered in this section includes errors in the initial guess of the testing ratio, ( 0), for a simulated value of (0) = 0.2. Given that the errors in this factor only affect the estimation of the infectious people, ( ), the representation of the estimated ( ) is not repeated. Fig. 7 shows the estimation of ( ) for ( 0) = 0.15 and ( 0) = 0.25 (\u00b125% error).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 200,
                    "end": 206,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF8"
                },
                {
                    "start": 512,
                    "end": 518,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF9"
                },
                {
                    "start": 1003,
                    "end": 1009,
                    "text": "Fig. 7",
                    "ref_id": "FIGREF10"
                }
            ],
            "section": "\u2022 Step in ( )"
        },
        {
            "text": "Step on ( ) seen as an impulse on ( )",
            "cite_spans": [],
            "ref_spans": [],
            "section": "\u2022 Step in ( )"
        },
        {
            "text": "Step on ( ) day 25 The results in Fig. 7 clearly show the importance of having an accurate guess of the number of infectious at the onset of the outbreak, as this initial error propagates proportionally up to the peak. Note, however, that any epidemiological model, such as SIR, faces the same challenge.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 34,
                    "end": 40,
                    "text": "Fig. 7",
                    "ref_id": "FIGREF10"
                }
            ],
            "section": "\u2022 Step in ( )"
        },
        {
            "text": "In this section, the proposed KF-based estimation technique is applied to six countries at different stages of the pandemic: China, South Korea, Italy, Spain, UK and USA.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "V. CASE STUDIES"
        },
        {
            "text": "Figs. 8-19 represent the estimated sequence of the geometric ratio, ( ), and the number of infected people, ( ), for the six countries. The KF implementation is tuned as described in Section III. In all cases, the value of ( 0) considered for the estimation of ( ) is 0.2. The points for which ( ) = 1 (peak of the epidemic) are highlighted with a dot. o A rather accurate early forecasting of the epidemic evolution can be made, around 10 to 14 days before the peak, by fitting a decreasing exponential to a window of past estimated data. For the four countries where the peak of the epidemic is left behind ( ( ) < 1), this prediction is shown with green dotted lines.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "V. CASE STUDIES"
        },
        {
            "text": "o Regarding the countries where the peak of the infectious curve has not yet been reached ( ( ) > 1), USA and UK, two exponential fittings (around mid April and early May) and their corresponding extrapolations are considered for each case. Whereas the data up to April suggested that the peak was going to take place in mid or late May, the latest results show that the situation in those countries is worsening (the trend in ( ) is currently uncertain), which may lead to additional actions taken in the future by those governments.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "V. CASE STUDIES"
        },
        {
            "text": "In order to compare the evolution of the geometric ratio in the six considered countries, Fig. 20 jointly represents all the estimated ratios on the same time axis, along with an exponential fitting for those countries where already ( ) < 1.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 90,
                    "end": 97,
                    "text": "Fig. 20",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "V. CASE STUDIES"
        },
        {
            "text": "Finally, Fig. 21 shows the evolution of the above-mentioned fitted exponential curves, all of them represented from a common threshold ( ) = 1.2, so that the corresponding time constants can be easily compared. In light of this representation, it can be noticed that the reduction of the geometric ratio is faster in China (just 13 days from ( ) = 1.2 to ( ) = 1), possibly as a consequence of a more severe lockdown, followed by Spain and South Korea (between 25 and 27 days to reach ( ) = 1), showing similar trends, and finally Italy (40 days to reach ( ) = 1). Although not represented owing to space limitations, France and other European countries show similar trends to that of Italy.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 9,
                    "end": 16,
                    "text": "Fig. 21",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "V. CASE STUDIES"
        },
        {
            "text": "This work has addressed the problem of monitoring and tracking the evolution of a viral epidemic, such as Covid-19, through the application of signal processing techniques to the time series of data reported by governments and health agencies. Three main contributions can be pointed out: 1) the exclusive use of time-varying geometric ratios of daily data to track the disease, rather than the customary virus reproductive number ( : ); 2) the development of a simple algebraic model relating the geometric ratio of infectious people, ( ), with those of positives, reported and dead; 3) the application of a nonlinear KF, along with a smoothing technique, to estimate the evolution of ( ). By properly fitting the estimated values of ( ) to a decreasing exponential, an accurate prediction of the epidemic peak can be made, as early as two weeks before the peak actually takes place.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        },
        {
            "text": "The proposed methodology has been satisfactorily tested on a simulated case, in the presence of Gaussian noise and other sources of uncertainty, the main one being the number of infectious people at the onset of the outbreak. It has also been applied to a pool of countries, six of which are reported in this paper, namely: China, South Korea, Italy, Spain, UK and the USA. The evolution of ( ) reflects in all cases the severity of the lockdown, allowing the peak of the epidemic to be forecasted well in advance. For UK and the USA, a noticeable change in the trend of ( ) can be observed over the last two weeks, suggesting that the peak may be further away than expected in April. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Coronavirus: Why you must act now",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Pueyo",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Impact of nonpharmaceutical interventions (NPIs) to reduce COVID19 mortality and healthcare demand",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "A contribution to the mathematical theory of epidemics",
            "authors": [
                {
                    "first": "W",
                    "middle": [
                        "O"
                    ],
                    "last": "Kermack",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Mckendrick",
                    "suffix": ""
                }
            ],
            "year": 1927,
            "venue": "Proc Royal Soc Math Phys Eng Sci",
            "volume": "115",
            "issn": "772",
            "pages": "700--721",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Modelling the COVID-19 epidemic and implementation of population-wide interventions in Italy",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Giordano",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Blanchini",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Bruno",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nat Med",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Analysis and prediction of COVID-19 for different regions and countries",
            "authors": [],
            "year": null,
            "venue": "Computational biology and complex systems (BIOCOMSC), UPC",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Quantification of disease progression",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "V"
                    ],
                    "last": "Madden",
                    "suffix": ""
                }
            ],
            "year": 1980,
            "venue": "Protection Ecology",
            "volume": "2",
            "issn": "",
            "pages": "159--176",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Optimal State Estimation: Kalman, H Infinity, and Nonlinear Approaches",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Simon",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Dynamics of Transmission and Control of COVID-19: A Real-time Estimation Using the Kalman Filter",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Rondon-Moreno",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Arroyo Marioli",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Bullano",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1101/2020.04.19.20071886"
                ]
            }
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Using the Kalman filter and dynamic models to assess the changing HIV/AIDS epidemic",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Cazelles",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "P"
                    ],
                    "last": "Chau",
                    "suffix": ""
                }
            ],
            "year": 1997,
            "venue": "Mathematical Biosciences",
            "volume": "140",
            "issn": "",
            "pages": "131--154",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "The Failure of R0",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Blakeley",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "J"
                    ],
                    "last": "Smith",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Computational and Mathematical Methods in Medicine",
            "volume": "2011",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1155/2011/527610"
                ]
            }
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "High contagiousness and rapid spread of severe acute respiratory syndrome coronavirus 2\". Emerg Infect Dis",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Sanche",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [
                        "T"
                    ],
                    "last": "Lin",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Xu",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Romero-Severson",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Hengartner",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Ke",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.3201/eid2607.200282"
                ]
            }
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Sequential data assimilation with nonlinear quasigeostrophic model using Monte Carlo methods to forecast error statistics",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Evensen",
                    "suffix": ""
                }
            ],
            "year": 1994,
            "venue": "Journal of Geophysical Research",
            "volume": "99",
            "issn": "C5",
            "pages": "143--162",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "where ( ) is a testing or reporting ratio that models thefraction of those infectious who are subject to tests and yield positive, ( ) = # ( ) \u2212 # ( \u2212 1) is the daily increase in the number of deaths, and ( ) = # ( ) \u2212 # ( \u2212 1) is the daily variation in the number of recovered cases. From (7) at two consecutive instants, keeping (5) in mind:",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "; is a Gaussian noise vector that accounts for the model error with a covariance matrix Q(n).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "is a Gaussian noise vector that models the measurement error with a covariance matrix R(n), and the nonlinear measurement function is\u210e( ) = [In countries or regions where less data are available, such as only deceased and positive cases, the model for",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "The random walk in ( ) can be advantageously replaced, while keeping the linearity of the state equation, by a linear prediction based on the recent past history, e.g., based on ( \u2212 1), ( \u2212 2) and ( \u2212 3). In this case,",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "The diagonal elements of ( ) are proposed to have constant values m,m = 10 _b , according to the observed variance of [ ( ) \u2212 [ ( \u2212 1), except in the case of history variables, where m,m = 0. The initial values of (0) and P(0), required by the filter, are not relevant as their effect quickly vanishes. The proposed values are: [ (0) and history variables initialized to",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Estimation of r(n) in the base case",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Estimation of r(n) with and without the smoother",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Estimation of the infectious people in the base case",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Estimation of r(n) with a step in the testing ratio",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "Estimation of the infectious people with a step in the testing ratio \u2022 Deviations in (0)",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "Estimation of the infectious people with deviations in t(0)",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "Estimation of r(n) in China Fig. 9. Estimation of r(n) in South-Korea Fig. 10. Estimation of r(n) in Italy Fig. 11. Estimation of infectious people in China Fig. 12. Estimation of infectious people in South-Korea Fig. 13. Estimation of infectious people in Italy Fig. 14. Estimation of r(n) in Spain Fig. 15. Estimation of r(n) in USA Fig. 16. Estimation of r(n) in UK Fig. 17. Estimation of infectious people in Spain Fig. 18. Estimation of infectious people in USA Fig. 19. Estimation of infectious people in UK Fig 20. Estimated and fitted geometric ratios for different countries Fig 21. Fitted geometric ratios from common threshold",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "authors are with the Department of Electrical Engineering, University of Seville, Spain (e-mails: age@us.es, rosendo@us.es, mgcagigal@us.es)..",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "OF THE PARAMETERS IN THE SIMULATION",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "The following remarks can be made from those results:o A different evolution of ( ) can be observed for the Asian countries (China and South Korea), where the effects of Covid-19 started earlier. Once the geometric ratio ( ) < 1, the trend for South Korea is to remain roughly constant, whereas for China a certain rebound can be noticed after March 10. o The estimation results obtained for Italy and Spain are similar, being the asymptotic value for Italy closer to 1. In the case of Spain, a slight increase is observed in ( ) between April 10 and 15.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}