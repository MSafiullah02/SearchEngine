{
    "paper_id": "393370b4ecc8a512cd673b64b3040d12ce30eb0a",
    "metadata": {
        "title": "Drug-Disease Graph: Predicting Adverse Drug Reaction Signals via Graph Neural Network with Clinical Data",
        "authors": [
            {
                "first": "Heeyoung",
                "middle": [],
                "last": "Kwak",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Seoul National University",
                    "location": {
                        "settlement": "Seoul",
                        "country": "Korea"
                    }
                },
                "email": "hykwak88@snu.ac.kr"
            },
            {
                "first": "Minwoo",
                "middle": [],
                "last": "Lee",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Seoul National University",
                    "location": {
                        "settlement": "Seoul",
                        "country": "Korea"
                    }
                },
                "email": "minwoolee@snu.ac.kr"
            },
            {
                "first": "Seunghyun",
                "middle": [],
                "last": "Yoon",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Seoul National University",
                    "location": {
                        "settlement": "Seoul",
                        "country": "Korea"
                    }
                },
                "email": ""
            },
            {
                "first": "Jooyoung",
                "middle": [],
                "last": "Chang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Seoul National University",
                    "location": {
                        "settlement": "Seoul",
                        "country": "Korea"
                    }
                },
                "email": ""
            },
            {
                "first": "Sangmin",
                "middle": [],
                "last": "Park",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Seoul National University",
                    "location": {
                        "settlement": "Seoul",
                        "country": "Korea"
                    }
                },
                "email": ""
            },
            {
                "first": "Kyomin",
                "middle": [],
                "last": "Jung",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Seoul National University",
                    "location": {
                        "settlement": "Seoul",
                        "country": "Korea"
                    }
                },
                "email": "kjung@snu.ac.kr"
            }
        ]
    },
    "abstract": [
        {
            "text": "Adverse Drug Reaction (ADR) is a significant public health concern world-wide. Numerous graph-based methods have been applied to biomedical graphs for predicting ADRs in pre-marketing phases. ADR detection in post-market surveillance is no less important than premarketing assessment, and ADR detection with large-scale clinical data have attracted much attention in recent years. However, there are not many studies considering graph structures from clinical data for detecting an ADR signal, which is a pair of a prescription and a diagnosis that might be a potential ADR. In this study, we develop a novel graphbased framework for ADR signal detection using healthcare claims data. We construct a Drug-disease graph with nodes representing the medical codes. The edges are given as the relationships between two codes, computed using the data. We apply Graph Neural Network to predict ADR signals, using labels from the Side Effect Resource database. The model shows improved AUROC and AUPRC performance of 0.795 and 0.775, compared to other algorithms, showing that it successfully learns node representations expressive of those relationships. Furthermore, our model predicts ADR pairs that do not exist in the established ADR database, showing its capability to supplement the ADR database.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "An adverse drug reaction (ADR) is considered to be one of the significant causes of morbidity and mortality, estimated to be the fourth to sixth highest cause of death in the United States [8] . Most ADR detection research has been aimed to predict ADRs in pre-marketing phases, using biomedical information sources such as chemical structures, protein targets, and therapeutic indications. Especially, studies using graph-structured data have demonstrated the superiority of modeling biomedical interactions as graphs. Nevertheless, capturing potential ADRs from the entire population in post-marketing phases is also essential to fully establish the ADR profiles [5] . The potential causal relationship between an adverse event and a drug is called a 'signal' when the relation is previously unknown or incompletely documented. Traditional ADR signal detection research in post-marketing phases mainly counts on a spontaneous and voluntary reporting system that collects spontaneous reports of suspected drug-related events, such as the WHO Uppsala Monitoring Center [1, 2, 4] . However, the spontaneous reporting system has inherent limitations such as underreporting [3, 16] , selective reporting [4] , and the lack of drug usage data. Therefore, recent studies have attempted algorithmic approaches to detect ADR signals on large clinical databases such as electronic health records (EHR) and healthcare claims data [5, 14] . Many of these studies apply basic machine learning techniques such as random forest, support vector machines, and neural networks. However, fewer studies are using graph-based approaches on the clinical databases in the field of post-marketing ADR signal detection. Due to the complex polypharmacy and multiple relations among drugs and diseases, we expect that graph structure can provide insights to potential ADRs, which may not otherwise be apparent using disconnected structures.",
            "cite_spans": [
                {
                    "start": 189,
                    "end": 192,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 665,
                    "end": 668,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 1069,
                    "end": 1072,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 1073,
                    "end": 1075,
                    "text": "2,",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 1076,
                    "end": 1078,
                    "text": "4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 1171,
                    "end": 1174,
                    "text": "[3,",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 1175,
                    "end": 1178,
                    "text": "16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 1201,
                    "end": 1204,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 1421,
                    "end": 1424,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 1425,
                    "end": 1428,
                    "text": "14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In this study, we develop a novel graph-based framework for ADR signal detection using healthcare claims data to construct a Drug-disease graph. Specifically, we use National Health Insurance Service-National Sample Cohort (NHIS-NSC), the 12-year healthcare claims data that covers medical histories for one million population [10] . The constructed graph is a heterogeneous graph with drug and disease nodes, as it is depicted in Fig. 1 . The nodes represent the medicine prescription codes and disease diagnosis codes derived from the healthcare claims data. To represent the relations among these codes, we define edge weights using information from the data. For example, l2 -distance between two node embeddings, which are learned from the data, is used to define the drugdrug and disease-disease edge weights. Also, the conditional probability computed on the data is used for the drug-disease relationship. As Graph Neural Network (GNN) models have been demonstrated [7, 19] their power to solve many tasks with graph-structured data, showing state-of-the-art performances, we use GNN-based approach for ADR detection. We verify that GNNs can learn node representations that are indicative of various relations between drugs and diseases. Then our model makes a prediction on whether a drug node and a disease node will have an ADR relation based on the learned node representations.",
            "cite_spans": [
                {
                    "start": 327,
                    "end": 331,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 974,
                    "end": 977,
                    "text": "[7,",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 978,
                    "end": 981,
                    "text": "19]",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [
                {
                    "start": 431,
                    "end": 437,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "To evaluate the performance of the proposed approaches, we conduct experiments with the newly generated dataset using the side effect resource database (SIDER). The empirical results demonstrate the superiority of our proposed model, which outperforms other alternative machine learning algorithms with a significant margin in terms of the area under the receiver operating characteristic (AUROC) score and the area under the precision-recall curve (AUPRC) score. Furthermore, our method unveils ADR candidates that are examined to be very useful information to the medical community. Our model uses only simple data processing and well-established medical terminologies. Therefore, our work does not demand case-by-case feature engineering that requires expertise.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "There have been numerous studies on ADR prediction in pre-marketing phases, attempting graph-based approaches on biomedical information sources [12, 15, 18, 22] . These studies predicted potential side-effects of drug candidate molecules based on their chemical structures [15] and additional biological properties [12] . Although such studies may play important roles in preventing ADRs in premarketing phases, capturing potential ADRs in real-world use cases has been considered very important.",
            "cite_spans": [
                {
                    "start": 144,
                    "end": 148,
                    "text": "[12,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 149,
                    "end": 152,
                    "text": "15,",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 153,
                    "end": 156,
                    "text": "18,",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 157,
                    "end": 160,
                    "text": "22]",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 273,
                    "end": 277,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 315,
                    "end": 319,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "A spontaneous and voluntary reporting system has been an important data source of the real world drug usages. Most of the traditional ADR signal detection research used voluntary reporting systems with disproportionality analysis (DA), which measures disproportionality of observed drug-adverse event pairs existing in data and the null expectations [1, 2, 4] . Recently, large-scale clinical databases such as EHR (Electronic Health Records) or healthcare claims data have gained popularity as an alternative or additive data source in ADR signal detection research. Much of the studies applied machine learning techniques such as support vector machine (SVM), random forest (RF), logistic regression (LR) and other statistical machine learning methods to model the decision boundary to detect ADR in post-marketing phases [5, 6, 11, 14, 21] .",
            "cite_spans": [
                {
                    "start": 350,
                    "end": 353,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 354,
                    "end": 356,
                    "text": "2,",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 357,
                    "end": 359,
                    "text": "4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 824,
                    "end": 827,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 828,
                    "end": 830,
                    "text": "6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 831,
                    "end": 834,
                    "text": "11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 835,
                    "end": 838,
                    "text": "14,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 839,
                    "end": 842,
                    "text": "21]",
                    "ref_id": "BIBREF20"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "More recently, researchers explored neural network-based models over clinical databases. Shang et al. [17] combined graph structure with the memory network to recommend a personalized medication. The longitudinal electronic health records and drug-drug interaction information were embedded as a separate graph to be jointly considered for the recommendation. There also exists research for the recommendation, but the architectures are limited to the single use of instance symptoms [20, 23] , or patient history [9] . However, none of these research explored graph neural network model for predicting the ADR reactions in the post-marketing phase.",
            "cite_spans": [
                {
                    "start": 102,
                    "end": 106,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 484,
                    "end": 488,
                    "text": "[20,",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 489,
                    "end": 492,
                    "text": "23]",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 514,
                    "end": 517,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "In this section, we formulate our problem and describe how we apply graph structures for the task. We also present the process of training and prediction.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Proposed Framework"
        },
        {
            "text": "The task is to predict the potential causal relationship between a given drug and a disease pair, which represents the prescription code and the diagnosis code in clinical data. To consider the various relationships between drugs and diseases, we convert our clinical data into a novel graph structure that consists of drug and disease nodes. The node representations and the edge weights are given according to the information retrieved from the clinical data NHIS-NSC in this study. We first learn a node embedding that reflects the temporal proximity between homogeneous nodes, i.e., drug-drug and disease-disease node pairs. In order to model the proximity between two codes, we form drug/disease sequences from patients' records.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Problem Formulation"
        },
        {
            "text": "After the drug-disease graph is constructed, we build a GNN model that predicts the signal of side effects between any pairs of drug and disease. The side effect labels, which are taken from the SIDER database, are given to a subset of drug-disease pairs in graph G. We define the label function l :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Problem Formulation"
        },
        {
            "text": "where V SIDER drug and V SIDER dis are the subsets of V drug and V dis registered in the SIDER database respectively, and E SIDER is the set of drug-disease pairs that are known to have side effect relation according to the SIDER database.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Problem Formulation"
        },
        {
            "text": "Most large-scale clinical databases including NHIS-NSC, are collected in the form of longitudinal visit records of the patients. In this section, we explain how we process the patient's longitudinal records as sequential data and apply skipgram model to learn the code embeddings.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Code Embedding Learning with Skip-Gram Model"
        },
        {
            "text": "In the patient's longitudinal records, each patient can be treated as a sequence of hospital visits {v",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1 (Drug/Disease Sequence)."
        },
        {
            "text": "Tn } where n represents each patient in the data, and T n is the total number of visits of the patient. The i th visit can be denoted as v",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1 (Drug/Disease Sequence)."
        },
        {
            "text": "is the set of prescribed codes and D i (n) is the set of diagnosed codes in the i th visit. Within a set of codes, codes are listed in arbitrary order. The size of each set is variable since the number of prescribed/diagnosed codes varies from visit to visit. With these sets of codes, we form a drug sequence Seq drug (n) and a disease sequence Seq disease (n) of n th patient by listing each of the codes in a temporal order, as it is described below (Here, we leave out the symbol n):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1 (Drug/Disease Sequence)."
        },
        {
            "text": "where p x \u2208 R Vp and d y \u2208 R V d are the one-hot vectors representing each of the medical codes in the sequences. V p and V d are the vocabulary size of the whole prescription and diagnosis codes within the data, respectively. T p and T d represent the total number of prescription/diagnosis codes of the patient's record. In this way, we can build a corpus consisting of Seq drug or Seq disease , in which the proximity-based code embedding learning can be implemented. We use Skip-gram [13] model to learn the latent representation of medical codes in our data, in a way that captures the temporal proximity between them. With Seq drug or Seq disease , we use the context window size of 16, meaning 16 codes behind and 16 codes ahead, and apply the Skip-gram learning with negative sampling scheme. As a result, we project both diagnosis codes and prescription codes into the separate lower-dimensional spaces, where codes are embedded close to one another that are in close proximity to them. The trained Skip-gram vectors are then used as the proximity-based code embeddings.",
            "cite_spans": [
                {
                    "start": 488,
                    "end": 492,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "Definition 1 (Drug/Disease Sequence)."
        },
        {
            "text": "Here, we describe how we construct our unique Drug-disease graph from NHIS-NSC. In Definition 2, we explain the concept of the Drug-disease graph. Then, we explain the node representations and edge connections.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug-Disease Graph Construction"
        },
        {
            "text": "We construct a single heterogeneous graph G = (V, E) consisting of drug and disease nodes, where V = V drug \u222a V dis is the union of drug and disease nodes, and E = E drug \u222a E dis \u222a E inter is the union of homogeneous edges E drug and E dis (i.e. consisting of same type of nodes) and heterogeneous edges E inter (i.e. consisting of different types of nodes).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 2 (Drug-disease Graph)."
        },
        {
            "text": "To represent v drug \u2208 V drug and v dis \u2208 V dis , we jointly use proximity-based node representation along with category-based node representation. Proximitybased node representation is obtained by initial Skip-gram code embedding as in Sect. 3.2. We denote a proximity-based drug node as v drug and a disease node as v dis . Category-based node representation is designed to represent the categorical information of medical codes. We utilize the hierarchical structure of categorical codes (i.e. ATC and ICD-10 codes) by adopting the one-hot vector format. Since there are multiple categories for each code, the category-based node representation is shown as a concatenation of one-hot vectors, thus, a multi-hot vector. Finally, the initial node representation of the Drug-disease graph are represented as the concatenation of the proximity-based node embeddings and the categorybased node embeddings. Following are the definitions for the drug and disease node representations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 2 (Drug-disease Graph)."
        },
        {
            "text": "where v drug is a category-based drug node, v dis is a category-based disease node, v drug is an initial drug node, v dis is an initial disease node, and || is a vector concatenation function. Each v i drug represents the each level in the ATC code structure and v drug \u2208 R 104 . Because the ATC code structure is represented in 5 levels, a drug node vector is also represented as the concatenation of 5 one-hot vectors. Similarly, each v i dis represents each of the first two levels in the ICD-10 code structure and v dis \u2208 R 126 . We only use two classification levels of the ICD-10 code structure, therefore, the disease node vector is represented as the concatenation of 2 one-hot vectors.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 3 (Node Representations"
        },
        {
            "text": "For homogeneous edges like E drug and E dis , we view the relationships between homogeneous nodes as the temporal proximity of two entities, meaning that two nodes are likely to be close together in the records. Therefore, using the proximity-based node embeddings, we compute l2 -distance between two node embeddings to estimate the temporal proximity. For heterogeneous edges, which are the edges connecting drug nodes and disease nodes, are given as the conditional probability of drug prescription given the diagnosed disease. The definitions of the two types of edges are given as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 3 (Node Representations"
        },
        {
            "text": "For any node i, j \u2208 V drug (or V dis ), the edge weight w ij between two nodes are defined using Gaussian weighting function as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 4 (Homogeneous Edges)."
        },
        {
            "text": "for some parameters threshold and \u03b8. v i and v j are the proximity-based node embeddings of two nodes i and j. Later, we additionally use edge-forming thresholds to control the sparsity of the graph.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 4 (Homogeneous Edges)."
        },
        {
            "text": "For any drug node i \u2208 V drug and any disease node j \u2208 V dis , the edge weight w ij between two nodes are given as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 5 (Heterogeneous Edges)."
        },
        {
            "text": "where n ij is number of patients' histories in the NHIS-NSC database that is recorded with a diagnosis j and a prescription i in tandem. n j is the number of patients' histories with the diagnosis j.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 5 (Heterogeneous Edges)."
        },
        {
            "text": "We aggregate neighborhood information of each drug/disease node from the constructed graph using the Graph Neural Network (GNN) framework. In each layer of GNN, the weighted sum of neighboring node features in the previous layer is computed to serve as the node features (after applying a RELU nonlinearity \u03c3) as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "where N (i) denotes the set of neighbors of i th node, z i (l) denotes feature vector of i th node at l th layer, W denotes a learnable weight matrix and \u03b1 (l) ij denotes the normalized edge weight between i th and j th nodes at the l th layer. In the first layer, the initial drug/disease node representations are each passed through a nonlinear projection function to match their dimensions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "We use two weighting schemes for \u03b1 (l) ij . The first variant follows the definition in [7] , and the weight is defined as follows:",
            "cite_spans": [
                {
                    "start": 35,
                    "end": 38,
                    "text": "(l)",
                    "ref_id": null
                },
                {
                    "start": 88,
                    "end": 91,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "where d i and d j are the degree of nodes i and j respectively, and w ij are the edge weights defined in Sect. 3.3. The weights are fixed for all layers. The second weighting scheme instead learns the weighting scheme using attention mechanism [19] as follows:",
            "cite_spans": [
                {
                    "start": 244,
                    "end": 248,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "where g is a single fully-connected layer with LeakyReLU nonlinearity that takes a pair of node features as input. In the rest of this paper, we call the network with the first weighting scheme as GCN and the network with the second scheme as GAT. We predict the ADR signal of a drug-disease pair using the learned embeddings from the GNN model with a single bilinear layer as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "where W p , b are the learnable weights, and v",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "are the node features of drug node i and disease node j at the last GNN layer. The whole model is trained by minimizing the cross-entropy loss.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A GNN-Based Method for Learning Graph Structure"
        },
        {
            "text": "As we get the labels from the SIDER database and the edge weight from the NHIS-NSC database, we retrieve the drug and disease nodes over the joint set of two databases. The resulting dataset is composed of 607 drugs and 556 diseases, and the number of positive samples, indicating the drug-side effect relationships, are 28,746 pairs. A negative sample is defined as a combination of drugs and diseases over the dataset, where the known 28,746 positive samples are excluded. We randomly select negative samples, setting the size of negative samples same as the size of positive samples.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data Preprocessing"
        },
        {
            "text": "Since we extract those combinations from the SIDER database, it is plausible to believe that they have not been reported as ADRs. Although the labels are only given to the drug-disease pairs over the joint set of two databases, we make use of all the drugs and diseases in NHIS-NSC as graph nodes to utilize the relations among the drugs and diseases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimental Settings"
        },
        {
            "text": "To predict the link between the drugs and diseases, we split drug-disease pairs from the ADR dataset into training, validation, and test sets, ensuring that the classes of diseases included in each set do not overlap. The reason we split the data without overlapping disease classes is to increase the usability of the ADR signal detection model. It is also because only a few classes of diseases exist in our dataset, and therefore there could be a data leakage if the same disease class exists in both training and validation. The class of disease means the classification up to the third digit of ICD-10 codes. Note that we make the inference very difficult by not letting the model know which classes of diseases are linked with drugs as ADRs. We use 80% of data for training, 10% for validation, and the remaining 10% for testing.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimental Settings"
        },
        {
            "text": "To control the sparsity of a graph, we build two types of graphs where the edge-forming threshold is either low or high. When the edge-forming threshold is low, the graph has more edges, having more information as a result. We examine whether it is beneficial or detrimental to have more edge information. We distinguish two graphs by setting the thresholds for E drug differently. The summary statistics of the constructed graphs and datasets are provided in Table 1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 460,
                    "end": 467,
                    "text": "Table 1",
                    "ref_id": "TABREF0"
                }
            ],
            "section": "Experimental Settings"
        },
        {
            "text": "To verify the performance of the GCN-based approach, we compare GCN-based models with non-graph-based ML techniques. We apply vanilla GCN and its variants to examine the effect of considering the edge types. The followings are the models used for the graph embedding learnings. All the neural-network based models use two layers with a hidden dimension of 300.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Evaluations"
        },
        {
            "text": "-LR is a logistic regression (LR) approach with information of the graph topology. The vector composed of initial node representations of the node itself and its neighbor nodes are input to the LR model. The number of neighbors is limited to 10. -NN is a 2-layer fully-connected neural network which is solely based on the initial node representations. -GCN low is a graph convolution network, a representative GNN model that uses graph convolutions [7] .",
            "cite_spans": [
                {
                    "start": 450,
                    "end": 453,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Evaluations"
        },
        {
            "text": "-GAT low is a GNN that applies the attention mechanism on the node embeddings. Here we use GAT with two layers, where the number of heads are (4, 4) for each layer. -adrGCN low is an adapted version of GCN, that uses separate GCN layers according to the edge types and then aggregate them. -GCN high , GAT high , adrGCN high are the graph-based models applied to the sparser graph, i.e. the edge-forming threshold is high.",
            "cite_spans": [
                {
                    "start": 142,
                    "end": 145,
                    "text": "(4,",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 146,
                    "end": 148,
                    "text": "4)",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "Evaluations"
        },
        {
            "text": "As shown in Table 2 , the proposed graph-based approaches surpass all the non-graph-based approaches. The best AUROC performance is achieved when GCN is applied with the low edge-forming threshold. The results show that the GCN model efficiently leverages the information from sufficiently selected edges. To see the robustness of the proposed method, we also examine whether our model works well for the infrequent drug-ADR pairs. We evaluate model performance for the infrequent drug-ADR pairs, which are labeled as 'rare' or 'post-marketing' in SIDER. As a result, the best average test accuracy in infrequent drug-ADR pairs is achieved with adrGCN high (0.746), demonstrating that using multiple GCNs according to the edge types is useful to detect rare symptoms. According to the SIDER database, the ADRs with 'rare' or 'postmarketing' labels are reported with frequencies under 0.01.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 12,
                    "end": 19,
                    "text": "Table 2",
                    "ref_id": "TABREF1"
                }
            ],
            "section": "Evaluations"
        },
        {
            "text": "To verify the power of the graph-based approach to discover ADR candidates which are unseen in the dataset, we extract the drug-disease pairs which are predicted to be positive with high probability-over 0.97 but labeled as negative (false positive). To demonstrate the genuine power of graph-based methods, we exclude the candidates that are also positively predicted by the baseline neural network, which does not use relational information. As a result, clinical experts (M.D.) confirm that there exist pairs that are clearly considered to be real ADRs. The pairs are listed in Table 3 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 581,
                    "end": 588,
                    "text": "Table 3",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Newly-Described ADR Candidates"
        },
        {
            "text": "Many of the discovered pairs, including umbrella terms like edema, are rather symptoms and signs than diseases. This can be explained by the fact that the SIDER database is less comprehensive to cover all the specific symptoms, that can be induced by taking medicine. Especially, cardiac murmur and abnormal reflex are frequent symptoms, but it is reasonable to say that the suggested pairs are ADRs. For example, Dasatinib is used to treat leukemia and can have significant cardiotoxicity, which can lead to cardiac murmurs. Hydroxycarbamide is a cytotoxic drug used for certain types of cancer, and it is known that cytotoxic medications can cause electrolyte imbalance leading to abnormal reflex.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Newly-Described ADR Candidates"
        },
        {
            "text": "There are also significant pairs such as alendronic acid and tetany in the third row. Severe and transient hypocalcemia is a well-known side-effect of bisphosphonates, which can lead to symptoms of tetany. Alendronic acid is classified as bisphosphonates, and therefore, tetany can be described as ADR of alendronic acid. Ibandronic acid and etidronic acidin the last two rows are also bisphosphonates, and the paired symptoms are relevant to the usage of bisphosphonates. Unspecified edema may signify bone marrow edema caused by bisphosphonate use, and electrolyte imbalance, which can lead to abnormal reflex, can be caused by etidronic acid use. All these explanations show that the ADR pairs we extract are based on various relations among drugs and diseases. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Newly-Described ADR Candidates"
        },
        {
            "text": "In this study, we propose a novel graph-based approach for ADR detection by constructing a graph from the large-scale healthcare claims data. Our model can capture various relations among drugs and diseases, showing improved performance in predicting drug-ADR pairs. Furthermore, our model even predicts drug-ADR pairs that do not exist in the established ADR database, showing that it is capable of supplementing the ADR database. The explanation by clinical experts verifies that the graph-based method is valid for ADR detection. In this study, we only make inferences within the labeled dataset, yet we plan to make inferences on unlabeled data to discover unknown ADR pairs, which will be a huge breakthrough in ADR detection.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "A data mining approach for signal detection and analysis",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Bate",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Lindquist",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [
                        "R"
                    ],
                    "last": "Edwards",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Orre",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "Drug Saf",
            "volume": "25",
            "issn": "6",
            "pages": "393--397",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Decision support methods for the detection of adverse events in post-marketing data",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hauben",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Bate",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Drug Discov. Today",
            "volume": "14",
            "issn": "7-8",
            "pages": "343--357",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Under-reporting of adverse drug reactions",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Hazell",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "A"
                    ],
                    "last": "Shakir",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Drug Saf",
            "volume": "29",
            "issn": "5",
            "pages": "385--396",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Time-to-signal comparison for drug safety data-mining algorithms vs. traditional signaling criteria",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Hochberg",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hauben",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Clin. Pharmacol. Ther",
            "volume": "85",
            "issn": "6",
            "pages": "600--606",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Machine learning model combining features from algorithms with different analytical methodologies to detect laboratory-event-related adverse drug reaction signals",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Jeong",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Choi",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "W"
                    ],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Yoon",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "PloS One",
            "volume": "13",
            "issn": "11",
            "pages": "1--15",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Predicting adverse drug events by analyzing electronic patient records",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Karlsson",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Asker",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Bostr\u00f6m",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "AIME 2013",
            "volume": "7885",
            "issn": "",
            "pages": "125--129",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-642-38326-7_19"
                ]
            }
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Semi-supervised classification with graph convolutional networks",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "N"
                    ],
                    "last": "Kipf",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Welling",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1609.02907"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Incidence of adverse drug reactions in hospitalized patients: a meta-analysis of prospective studies",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lazarou",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "H"
                    ],
                    "last": "Pomeranz",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "N"
                    ],
                    "last": "Corey",
                    "suffix": ""
                }
            ],
            "year": 1998,
            "venue": "JAMA",
            "volume": "279",
            "issn": "15",
            "pages": "1200--1205",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Dual memory neural computer for asynchronous two-view sequential learning",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Le",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Tran",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Venkatesh",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Proceedings of the 24th ACM SIGKDD",
            "volume": "",
            "issn": "",
            "pages": "1637--1645",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Cohort profile: the national health insurance service-national sample Cohort (NHIS-NSC), South Korea",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "S"
                    ],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "H"
                    ],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "A"
                    ],
                    "last": "Shin",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Kim",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Int. J. Epidemiol",
            "volume": "46",
            "issn": "2",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Comparative analysis of pharmacovigilance methods in the detection of adverse drug reactions using electronic medical records",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "JAMIA",
            "volume": "20",
            "issn": "3",
            "pages": "420--426",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Large-scale prediction of adverse drug reactions using chemical, biological, and phenotypic properties of drugs",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "J. Am. Med. Inform. Assoc",
            "volume": "19",
            "issn": "e1",
            "pages": "28--35",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Distributed representations of words and phrases and their compositionality",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Mikolov",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Sutskever",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "S"
                    ],
                    "last": "Corrado",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Dean",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "3111--3119",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "A novel algorithm for detection of adverse drug reaction signals using a hospital electronic medical record database",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "Y"
                    ],
                    "last": "Park",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Pharmacoepidemiol. Drug Saf",
            "volume": "20",
            "issn": "6",
            "pages": "598--607",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Predicting drug side-effect profiles: a chemical fragment-based approach",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Pauwels",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Stoven",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Yamanishi",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "BMC Bioinform",
            "volume": "12",
            "issn": "1",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1186/1471-2105-12-169"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Utilizing social media data for pharmacovigilance: a review",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Sarker",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "J. Biomed. Inform",
            "volume": "54",
            "issn": "",
            "pages": "202--212",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "GAMENet: graph augmented memory networks for recommending medication combination",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Shang",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Xiao",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Ma",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Proceedings of the AAAI",
            "volume": "33",
            "issn": "",
            "pages": "1126--1133",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Network embedding in biomedical data science",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Su",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Tong",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Zhu",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Cui",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Brief. Bioinform",
            "volume": "21",
            "issn": "",
            "pages": "1--16",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "Graph attention networks",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Veli\u010dkovi\u0107",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Cucurull",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Casanova",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Romero",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Lio",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bengio",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Safe medicine recommendation via medical knowledge graph embedding",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Long",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Qian",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1710.05980"
                ]
            }
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Detection of adverse drug reaction signals using an electronic health records database: comparison of the laboratory extreme abnormality ratio (clear) algorithm",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Yoon",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Choi",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "H"
                    ],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Park",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Clin. Pharmacol. Ther",
            "volume": "91",
            "issn": "3",
            "pages": "467--474",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Graph embedding on biomedical networks: methods, applications, and evaluations",
            "authors": [
                {
                    "first": "X",
                    "middle": [],
                    "last": "Yue",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1906.05017"
                ]
            }
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "LEAP: learning to prescribe effective and safe treatment combinations for multimorbidity",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Tang",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "F"
                    ],
                    "last": "Stewart",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Proceedings of the 23rd ACM SIGKDD",
            "volume": "",
            "issn": "",
            "pages": "1315--1324",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Overview of the proposed ADR detection task pipeline. Drug and disease embeddings are learned using Skip-gram model on clinical data. Categorical embedding is extracted from the identifier codes of drug and diseases. Skip-gram and categorical embeddings are jointly used as input of node feature in the heterogeneous graph, and the graph is passed through GNN for ADR prediction.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Summary statistics of the constructed graph and datasets",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "Model AUROC and AUPRC performances (including 95% CI)",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "Newly-described drug-ADR pairs which are predicted, by the proposed method, to be positive with high probability.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}