{
    "paper_id": "6c5b344c8c8dc0176d07aeeb9cf70a103ccd8240",
    "metadata": {
        "title": "Complexity of Automatic Sequences",
        "authors": [
            {
                "first": "Hans",
                "middle": [],
                "last": "Zantema",
                "suffix": "",
                "affiliation": {},
                "email": "h.zantema@tue.nl"
            }
        ]
    },
    "abstract": [
        {
            "text": "Automatic sequences can be defined by DFAs with output (DFAO) in two natural ways. We propose to consider the minimal size of a corresponding DFAO as the complexity measure of the automatic sequence, for both variants. This paper compares these complexity measures and investigates their properties like the relationships with kernel and morphic sequences. There exist automatic sequences for which the one complexity is exponentially greater than the other one, in both directions. For both complexity measures we investigate the effect of taking basic operations on sequences like removing or adding an element in front, and observe that these operations may increase the complexity by at most a quadratic factor.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Automatic sequences form an important class of infinite sequences over a finite alphabet; roughly speaking it is a first regular class going beyond ultimately periodic sequences. They have been extensively studied, in particular in the book [1] that serves as the main reference for research in this area. More recent references on the topic include [5, 9] .",
            "cite_spans": [
                {
                    "start": 241,
                    "end": 244,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 350,
                    "end": 353,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 354,
                    "end": 356,
                    "text": "9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Automatic sequences depend on a base k > 1, with special interest for k = 2. Two well-known 2-automatic sequences are the Thue-Morse sequence and the regular paper folding sequence, to be defined in Sect. 2. Automatic sequences admit several equivalent characterizations, many of which are closely related to the following two. In the first one the ith element a i of the sequence a is the output of a DFAO when taking as input the k-ary notation of i. The second one is similar, but then the reverse of the k-ary notation of i is taken as input. It is natural to consider the minimal size of a corresponding DFAO as the complexity measure of the automatic sequence, for both variants, and we denote them by a k and a R k . These complexity measures are the main topic of this paper. We show how they relate to other characterizations; in particular, a R k is closely related to the size of the kernel of a, and a k is closely related to the size of the smallest alphabet needed to describe a as a morphic sequence with respect to a k-uniform morphism. In doing so, we follow constructions as presented in [1] for which we investigate the precise effect on the measures a k and a R k .",
            "cite_spans": [
                {
                    "start": 1106,
                    "end": 1109,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "A first result states that there is an exponential gap between both measures: there exist sequences of automatic sequences a, b for which a R k is exponential in a k , and b k is exponential in b R k . A next natural question is about the effect of taking basic operations on sequences. For instance, for any sequence a its tail tail(a) is obtained by removing its first element. We show that tail(a) R k \u2264 2 a R k and tail(a) k \u2264 ( a k ) 2 for all k-automatic sequences, and that the last inequality is sharp. Similar results hold for adding an element in front rather than removing. Also other operations are considered, like pointwise combining two sequences and taking particular subsequences. About all of these basic operations f the main observation is that their sizes do not increase more than quadratically: f (a) k \u2264 ( a k ) 2 and f (a) R k \u2264 ( a R k ) 2 for all a. Another interesting question is what happens for periodic sequences. In the current paper we only derive a quadratic upper bound for \u00b7 R k and a linear upper bound for \u00b7 k , so opposite to the effect of tail. Whether and when these upper bounds are reached is a much more involved question that is investigated in [2] . The research project on this topic is a joined project of Wieb Bosma and the current author; as this analysis for periodic sequences requires arguments of a completely different combinatorial flavor than the automata based arguments in this paper, we decided to present the current paper and [2] separately.",
            "cite_spans": [
                {
                    "start": 836,
                    "end": 837,
                    "text": "2",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 1191,
                    "end": 1194,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 1489,
                    "end": 1492,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Throughout the paper we make several claims about the exact values of a k and a R k for particular sequences a. To compute these values we wrote a program to search for a DFAO of minimal size n having the corresponding property for a i for all i < N for N being typically around 2 10 . This was done by expressing the requirements as a satisfiability problem and then call a SAT solver. The smallest n for which the formula is satisfiable then is given. As only the requirements for i < N are checked, this only yields a lower bound, but for N large enough it gives the exact value. According to [6] , corollary 3.1 (page 59) two states in a DFAO of n states are equivalent are equivalent if and only if for every string of length \u2264 n \u2212 1 they produce the same output. This can be improved to \u2264 n \u2212 2. Applying this for the union of the found automaton and the real automaton with bounds derived in this paper, this shows that for N = 2 n\u22122 the exact value is obtained. This paper is organized as follows. In Sect. 2 we give the basic definitions and a general lemma for proving lower bounds. In Sect. 3 we investigate the exponential gap between \u00b7 k and \u00b7 R k . In Sect. 4 we define the kernel of an automatic sequence and investigate its relationship with \u00b7 R k . In Sect. 5 we present how to define automatic sequences as morphic sequences with respect to uniform morphisms, and investigate the relationship with \u00b7 k . In Sect. 6 we investigate the effect of basic operations like tail on \u00b7 k and \u00b7 R k . In Sect. 7 we give the upper bounds of \u00b7 k and \u00b7 R k for periodic sequences. We conclude in Sect. 8.",
            "cite_spans": [
                {
                    "start": 596,
                    "end": 599,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Let k \u2265 2 and \u03a3 k = {0, 1, . . . , k \u2212 1}. The set of infinite sequences a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 over a finite alphabet \u0393 is denoted by \u0393 N .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "A DFA M with output (DFAO) is defined to be a tuple M = (Q, \u03a3, \u03b4, q 0 , \u0393, \u03c4), where -Q is the finite set of states, -\u03a3 is the finite input alphabet, -\u03b4 : Q \u00d7 \u03a3 \u2192 Q is the transition function, -q 0 \u2208 Q is the initial state, -\u0393 is the finite output alphabet, -\u03c4 : Q \u2192 \u0393 is the output function.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "DFAOs are denoted by states and arrows just as is usual for DFAs; the extra information that \u03c4 (q) = x is denoted by writing q/x in the state q.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "As in DFAs, \u03b4 extends to \u03b4 : ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "Every natural number n has a unique representation (n) k \u2208 \u03a3 * k , where (0) k = and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "for n > 0. So (0) 2 = and (11) 2 = 1011. Note that non-empty strings of which the leftmost symbol is 0 do not occur as (n) k for some number n.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "Conversely, every u \u2208 \u03a3 * k represents a number [u] k :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "For any \u03a3 and any string u \u2208 \u03a3 * the reverse u R of u is defined by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "According to Theorem 5.2.3 from [1] a is k-automatic if and only if a k-DFAO M = (Q M , \u03a3 k , \u03b4 M , q 0 , \u0393, \u03c4 M ) exists such that \u03c4 M (\u03b4 M (q 0 , (i) R k )) = a i for all i \u2208 N. Now we are ready to define the two natural measures . k , . R k for k-automatic sequences that we investigate in this paper.",
            "cite_spans": [
                {
                    "start": 32,
                    "end": 35,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Basic Definitions"
        },
        {
            "text": "For any k-automatic sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 its size a k is defined to be the size of a smallest k-",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1."
        },
        {
            "text": "For any k-automatic sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 its reversed size a R k is defined to be the size of a smallest k-",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1."
        },
        {
            "text": "The Thue-Morse sequence thue = 0110100110010110 \u00b7 \u00b7 \u00b7 is defined by thue i = 0 if the number of 1s in (i) 2 is even, and thue i = 1 if the number of 1s in (i) 2 is odd, see, e.g., [1] Section 1.6, or OEIS A010060. We have thue 2 = thue R 2 = 2, both justified by the DFAO on the right.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1."
        },
        {
            "text": "The regular paper-folding sequence paper = 001001100011011 \u00b7 \u00b7 \u00b7 (or dragon curve sequence is defined by paper i = m mod 2 for every i \u2265 0 for the unique representation i = (2m + 1)2 j \u2212 1, see, e.g., [1] Example 5.16., or OEIS A014577. We have paper 2 = paper R 2 = 4, respectively justified by the following two DFAOs.",
            "cite_spans": [
                {
                    "start": 201,
                    "end": 204,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Definition 1."
        },
        {
            "text": "The following lemma is the basic tool for lower bounds on a k and a R k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Definition 1."
        },
        {
            "text": "Let a be a k-automatic sequence, and m 1 , . . . , m n \u2208 N such that for",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Lemma 1."
        },
        {
            "text": "Let a be a k-automatic sequence, and m 1 , . . . , m n \u2208 N such that for every",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Lemma 1."
        },
        {
            "text": "The proof of the second claim is similar.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Lemma 1."
        },
        {
            "text": "The following theorem shows that there can be an exponential gap between a k and a R k , in both directions. Its proof is inspired by the folklore result that the language (0 + 1) * 1(0 + 1) n\u22121 has an NFA of size n + 1, and its reverse has a DFA of size n + 1, but its smallest DFA has size at least 2 n . We found it in [8] , Sect. 3.2, page 67, exercise 3. Many similar results on state complexity are known, e.g., in [7] , it is proved that all values until 2 n can be reached as sizes.",
            "cite_spans": [
                {
                    "start": 322,
                    "end": 325,
                    "text": "[8]",
                    "ref_id": null
                },
                {
                    "start": 421,
                    "end": 424,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "The Exponential Gap"
        },
        {
            "text": "Proof. Define a by a i = 0 for i < k n , and a i = j if and only if the nth digit of (i) k is j, for j = 0, 1, . . . , k \u2212 1, i \u2265 k n . The following DFAO satisfies \u03c4 M (\u03b4 M (q 0 , (i) k )) = a i by construction:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Exponential Gap"
        },
        {
            "text": "in which all unlabeled arrows are assumed to be labeled by all symbols 0, 1, . . . , k \u2212 1. Since this DFAO has n + k states we obtain a k \u2264 n + k.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Exponential Gap"
        },
        {
            "text": "For proving a R k \u2265 (k \u2212 1)k n\u22121 we apply Lemma 1. For i = 1, 2, . . . , (k \u2212 1)k n\u22121 define m i = k n + i \u2212 1, so the numbers m i are exactly the numbers of k-ary length n, starting in a digit = 0. For any two distinct such numbers m i and m j there is a position p on which they differ, so by choosing v = 1 n\u2212p , the strings v(m i ) k and v(m j ) k differ in their n-th position. So the condition of Lemma 1 holds and we conclude",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Exponential Gap"
        },
        {
            "text": "A similar argument using the same automaton proves the claim for b.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Exponential Gap"
        },
        {
            "text": "For j \u2208 \u03a3 k we define p j (a) = a j a k+j a 2k+j a 3k+j \u00b7 \u00b7 \u00b7 by (p j (a)) i = a ik+j for all i \u2208 N. So for k = 2 we have p 0 (a) = even(a) = a 0 a 2 a 4 \u00b7 \u00b7 \u00b7 and p 1 (a) = odd(a) = a 1 a 3 a 5 \u00b7 \u00b7 \u00b7 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "For an infinite sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 over \u0393 we define its k-kernel K k (a) to be the smallest set K k (a) \u2286 \u0393 N such that -a \u2208 K k (a), -for every b \u2208 K k (a) and every j \u2208 \u03a3 k we have p j (b) \u2208 K k (a).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "We recall from [4] , Prop. V.3.3, or [1] , Theorem 6.6.2, that a is k-automatic if and only if K k (a) is finite.",
            "cite_spans": [
                {
                    "start": 15,
                    "end": 18,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 37,
                    "end": 40,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "For a k-automatic sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 over the alphabet \u0393 its k-kernel K k (a) has a natural DFAO structure:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "Recall that for k = 2 we have p 0 = even and p 1 = odd, so in K 2 (a) the 0-steps describe even and the 1-steps describe odd. For thue the 2-kernel exactly coincides with the DFAO M thue given in Sect. 2, in which q 0 coincides with thue and q 1 coincides with the sequence obtained from thue by swapping symbols 0 and 1. For paper the 2-kernel exactly coincides with the given DFAO M paper R , in which q 0 coincides with paper, q 1 with (01) \u03c9 = 010101 \u00b7 \u00b7 \u00b7 , q 2 with 0 \u03c9 = 000 \u00b7 \u00b7 \u00b7 and q 3 with 1 \u03c9 = 111 \u00b7 \u00b7 \u00b7 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "The following theorem is straightforwardly proved by induction on i:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "For every k-automatic sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 and every i \u2208 N we have \u03c4 (\u03b4(a, (i) R k )) = a i where \u03c4, \u03b4 refer to K k (a) = (K k (a), \u03a3 k , \u03b4, a, \u0393, \u03c4).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "As a consequence, by only giving the DFAO K k (a) the sequence a is fully defined.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "Theorem 3. The DFAO K k (a) is the unique DFAO of minimal size such that \u03c4 (\u03b4(a, (i) R k 0 j )) = a i for every i, j \u2208 N.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "Proof. Let K k (a) = (K k (a), \u03a3 k , \u03b4, a, \u0393, \u03c4). Combining Theorem 2 with the fact that \u03c4 (q) = \u03c4 (\u03b4(q, 0)) for all q \u2208 K k (a) yields \u03c4 (\u03b4(a, (i) R k 0 j )) = a i for every i, j \u2208 N. Assume it is not of minimal size with this property. Then there are two distinct states q, q such that \u03c4 (\u03b4(q, u)) = \u03c4 (\u03b4(q , u)) for all u \u2208 \u03a3 * k . Since q, q are sequences over \u03a3 k , applying Theorem 2 to K k (q) and K k (q ) yield q i = q i for all i \u2208 N. But then q, q are equal as sequences, contradicting that they are distinct.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "Recall that a R k is the minimal size |Q| for which a DFAO M = (Q, \u03a3, \u03b4, q 0 , \u0393, \u03c4) exists such that \u03c4 (\u03b4(q 0 , (i) R k )) = a i for every i \u2208 N. We observe that a DFAO with this property does not need to be unique. For instance, for a = 01 \u03c9 the DFAO K k (a) is a minimal DFAO with this property, having two states a and b = 1 \u03c9 , and \u03b4(a, 0) = a, \u03b4(a, 1) = \u03b4(b, 0) = \u03b4(b, 1) = b, \u03c4 (a) = 0, \u03c4 (b) = 1. But the DFAO with the same two states a, b and \u03b4(b, 0) = a, \u03b4(a, 0) = \u03b4(a, 1) = \u03b4(b, 1) = b, \u03c4 (a) = 0, \u03c4 (b) = 1 produces the same sequence a = 01 \u03c9 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 310,
                    "end": 377,
                    "text": "states a and b = 1 \u03c9 , and \u03b4(a, 0) = a, \u03b4(a, 1) = \u03b4(b, 0) = \u03b4(b, 1)",
                    "ref_id": null
                }
            ],
            "section": "The k-kernel"
        },
        {
            "text": "Next we observe that a R k can be strictly smaller than |K k (a)|, the size of the state space of K k (a). Define a i = 1 if the number of zeros in (i) 2 is odd, and a i = 0 if this number is even. Clearly it admits the following DFAO, in which as usual \u03c4 (q) = x is denoted by q/x in the state q:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "we obtain a R k = 2 since the sequence contains both 0 and 1. However, |K k (a)| = 4, since K k (a) is the following DFAO:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "The sequences a, b, c, d are as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "Observe that a and d differ only at the first position, and similarly for b and c. The next lemma states that this always occurs if |K k (a)| is greater then a R k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The k-kernel"
        },
        {
            "text": "Proof. Let i > 0. For any w \u2208 \u03a3 * k define the numbers m w by (m w ) k = (i) k w R ; this is possible since (i) k w R does not start in 0 since i > 0. For any b \u2208 K k (a) we obtain b i = \u03c4 (\u03b4(b, (i) R k )) by considering K k (b). Hence",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Lemma 2. Let a be an infinite sequence over"
        },
        {
            "text": "We obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Lemma 2. Let a be an infinite sequence over"
        },
        {
            "text": "Moreover, if a is periodic then a R k = |K k (a)|.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 4. Let a be a k-automatic sequence over an alphabet \u0393 . Then"
        },
        {
            "text": "Proof. The inequality a R k \u2264 |K k (a)| holds since the automaton K k (a) satisfies \u03c4 (\u03b4(a, (i) R k )) = a i for every i \u2208 N. For the other inequality let M = (Q, \u03a3, \u03b4, q 0 , \u0393, \u03c4) be a DFAO of minimal size a R k such that \u03c4 (\u03b4(q 0 , (i) R k )) = a i",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 4. Let a be a k-automatic sequence over an alphabet \u0393 . Then"
        },
        {
            "text": "According to Lemma 2 b \u223c c implies that b i = c i for all i > 0, so the difference between b and c may only be caused by b 0 = c 0 . Hence every equivalence class of \u223c has at most |\u0393 | elements, while the number of equivalence classes is |Q| = a R k . This proves |K k (a)| \u2264 |\u0393 | * a R k . In case a is periodic then all elements of K k (a) are periodic too, and b i = c i for all i > 0 implies b = c. Hence in that case all equivalence classes consist of a single element, proving a R k = |K k (a)|.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 4. Let a be a k-automatic sequence over an alphabet \u0393 . Then"
        },
        {
            "text": "Recall that a k = |Q M | for the smallest Q M being the set of states of a DFAO",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Morphic Sequences"
        },
        {
            "text": "Again this DFAO of minimal size is not unique: for a = 01 \u03c9 the DFAO K k (a) as given above also satisfies \u03c4 M (\u03b4 M (q 0 , (i) k )) = a i for all i \u2208 N, but after changing \u03b4(a, 0) = a to \u03b4(a, 0) = b this property still holds, since (i) k never starts by 0. Just like a R k is strongly related to the kernel of a as described in Theorem 4, a k is strongly related to the number of symbols needed to describe a as a morphic sequence with respect to a k-uniform morphism. A sequence a over an alphabet \u0393 is called morphic with respect to a morphism h : \u0394 \u2192 \u0394 * and a coding \u03c4 :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Morphic Sequences"
        },
        {
            "text": "The morphism h : \u0394 \u2192 \u0394 * is called k-uniform if the string h(y) \u2208 \u0394 * has length k for every y \u2208 \u0394. It is well-known (Cobham [3] , see also [1] Theorem 6.3.2) that a is kautomatic if and only if it is morphic with respect to a k-uniform morphism. For instance, thue = h \u03c9 (0) for h(0) = 01, h(1) = 10, and paper = \u03c4 (g \u03c9 (0)) for g(0) = 02, g(1) = 31, g(2) = 32, g(3) = 01, \u03c4 (0) = \u03c4 (2) = 0, \u03c4 (1) = \u03c4 (3) = 1.",
            "cite_spans": [
                {
                    "start": 125,
                    "end": 128,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Morphic Sequences"
        },
        {
            "text": "Let a be a k-automatic sequence. Let d(a) be the minimal size of the alphabet \u0394 such that a = \u03c4 (h \u03c9 (x)) for a k-uniform morphism h : \u0394 \u2192 \u0394 * and a coding \u03c4 : \u0394 \u2192 \u0393 . Then a k \u2264 d(a) \u2264 a k + 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 5."
        },
        {
            "text": "as is showed in the proof of Theorem 6.3.2 of [1] . As a k is the smallest size of a k-DFAO with this property we obtain a k \u2264 d(a) .",
            "cite_spans": [
                {
                    "start": 46,
                    "end": 49,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [
                {
                    "start": 123,
                    "end": 131,
                    "text": "k \u2264 d(a)",
                    "ref_id": null
                }
            ],
            "section": "Theorem 5."
        },
        {
            "text": "for all i \u2265 0, then by choosing a fresh state q 0 and defining Q = Q M \u222a{q 0 }, \u03b4(q, y) = \u03b4 M (q, y) for q \u2208 Q M , \u03b4(q 0 , 0) = q 0 , \u03b4(q 0 , y) = \u03b4 M (q 0 , y) for y = 0, \u03c4 (q 0 ) = \u03c4 M (q 0 ), \u03c4 (q) = \u03c4 M (q) for q \u2208 Q M , we obtain the k-DFAO (Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4) of size a k + 1 with \u03c4 (\u03b4(q 0 , (i) k )) = a i for all i \u2265 0. Using the fact that \u03b4(q 0 , 0) = q 0 we obtain a = \u03c4 (h \u03c9 (q 0 )) for h defined by h(q) = \u03b4(q, 0)\u03b4(q, 1) \u00b7 \u00b7 \u00b7 \u03b4(q, k \u2212 1) as is shown in the proof of Theorem 6.3.2 of [1] . Hence d(a) \u2264 a k + 1.",
            "cite_spans": [
                {
                    "start": 501,
                    "end": 504,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Theorem 5."
        },
        {
            "text": "For any sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 we define its tail tail(a) = a 1 a 2 a 3 a 4 \u00b7 \u00b7 \u00b7 by (tail(a)) i = a i+1 for all i \u2208 N. Theorem 6. For any k-automatic sequence a we have tail(a) R k \u2264 2 a R k and tail(a) k \u2264 ( a k ) 2 . For every n > 1 there exists a k-automatic sequence a such that a k = n and tail(a) k = n 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "Proof. For the first claim take a DFAO M = (Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4) of size a R k with \u03c4 (\u03b4(q 0 , (i) R k )) = a i for all i \u2265 0. Let m \u2264 a R k be the smallest number m > 0 such that j < m exists with \u03b4(q 0 , 0 m ) = \u03b4(q 0 , 0 j ). Introduce fresh states r 0 , . . . , r m\u22121 and define the DFAO M = (Q \u222a {r 0 , . . . , r m\u22121 }, \u03a3 k , \u03b4 , r 0 , \u0393, \u03c4 ) by",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 43,
                    "end": 67,
                    "text": "(Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4)",
                    "ref_id": null
                },
                {
                    "start": 299,
                    "end": 350,
                    "text": "(Q \u222a {r 0 , . . . , r m\u22121 }, \u03a3 k , \u03b4 , r 0 , \u0393, \u03c4 )",
                    "ref_id": null
                }
            ],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "and every number in N is either of the shape [vx(k \u2212 1) i ] k or [(k \u2212 1) i ] k , this proves that M is a DFAO for tail(a). Since |Q \u222a {r 0 , . . . , r m\u22121 }| \u2264 2|Q| this yields tail(a) R k \u2264 2 a R k . For the second claim take a DFAO M = (Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4) of size a k with \u03c4 (\u03b4(q 0 , (i) k )) = a i for all i \u2265 0. Define the DFAO M = (Q \u00d7 Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4 ) of size ( a k ) 2 by q 0 = (q 0 , \u03b4(q 0 , 1)), \u03c4 (q, q ) = \u03c4 (q ),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "In the first case we have (i + 1) k = 10 m , in the second case (i + 1) k = v(x + 1)0 m . The DFAO M has been constructed in such a way that \u03c4 (\u03b4(q 0 , (k \u2212 1) m ) = \u03c4 (\u03b4(q 0 , 10 m ) and \u03c4 (\u03b4(q 0 , vx(k \u2212 1) m ) = \u03c4 (\u03b4(q 0 , v(x + 1)0 m ). Hence for all i \u2208 N we have \u03c4 (\u03b4(q 0 , (i) k ) = \u03c4 (\u03b4(q 0 , (i + 1) k )) = a i+1 = tail(a) i , proving the second claim.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "As tail(a) k \u2264 n 2 , for the last claim it suffices to prove tail(a) k \u2265 n 2 . We define a by a i = 1 if the number of zeros in (i) k is divisible by n, and a i = 0 otherwise. A DFAO consisting of a single n-cycle easily produces a, so a k \u2264 n, and since a smaller one is not possible we obtain a k = n. Let b = tail(a), so b i = a i+1 for all i \u2208 N. We prove tail(a) k \u2265 n 2 by Lemma 1. Choose m 1 , m 2 , . . . , m n 2 to be the numbers [10 p (k \u2212 1) q ] k for p, q = 1, . . . , n. Let m i = [10 p (k \u2212 1) q ] k and m j = [10 p (k \u2212 1) q ] k for i = j, then (p, q) = (p , q ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "First we consider the case where p + q and p + q are distinct modulo n, choose r such that p + q + r \u2212 1 is divisible by n and p + q + r \u2212 1 is not.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "In the remaining case p + q and p + q are equal modulo n, and since (p, q) = (p , q ) we obtain that p and p are distinct modulo n. Choose r such that p + r is divisible by n and p + r is not.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "So the conditions of Lemma 1 hold, and tail(a) k \u2265 n 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "For our examples thue and paper we have tail(thue) 2 = 4, tail(thue) R 2 = 3, tail(paper) 2 = 8 and tail(paper) R 2 = 6. For any sequence a = a 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 over \u0393 , and x \u2208 \u0393 the sequence x \u00b7 a = xa 0 a 1 a 2 a 3 \u00b7 \u00b7 \u00b7 is defined by (x \u00b7 a) 0 = x and (x \u00b7 a) i = a i\u22121 for all i > 0. The next theorem states that the effect of x\u00b7 is similar to tail.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The Effect of Basic Operations"
        },
        {
            "text": "For any k-automatic sequence a over \u0393 , and x \u2208 \u0393 we have x \u00b7 a R k \u2264 2 a R k and x \u00b7 a k \u2264 ( a k ) 2 . For every n > 1 there exists a kautomatic sequence a such that a k = n and x \u00b7 a k \u2265 n 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 7."
        },
        {
            "text": "Proof. Similar to the proof of Theorem 6, with the roles of the symbols 0 and k \u2212 1 swapped, exploiting the property [vx0 i ] k \u2212 1 = [v(x \u2212 1)(k \u2212 1) i ] k for any string v and any x > 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 7."
        },
        {
            "text": "For our examples thue and paper we have 0 \u00b7 thue 2 = 4, 0 \u00b7 thue R 2 = 4, 0 \u00b7 paper 2 = 4 and 0 \u00b7 paper R 2 = 4. Recall that for j \u2208 \u03a3 k the operator p j on sequences a is defined by (p j (a)) i = a ik+j for all i \u2208 N. Theorem 8. For any k-automatic sequence a and j \u2208 \u03a3 k we have p j (a) k \u2264 a k and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 7."
        },
        {
            "text": "For the other claim let M = (Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4) be a DFAO of size a R k with \u03c4 (\u03b4(q 0 , (i) R k )) = a i for all i \u2265 0. Define M = (Q, \u03a3 k , \u03b4, \u03b4(q 0 , j), \u0393, \u03c4). Then (p j (a)) i = a ki+j = \u03c4 (\u03b4(q 0 , j(i) k ) R ) = \u03c4 (\u03b4(\u03b4(q 0 , j), (i) k ) R ) for all i \u2208 N, so M is a DFAO of size a R k producing p j (a), so p j (a) k \u2264 a k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 7."
        },
        {
            "text": "For our examples thue and paper we have even(thue) 2 = 2, odd(thue) R 2 = 2, even(paper) 2 = 2 and odd(paper) R 2 = 4. When applying an operator f :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 7."
        },
        {
            "text": "For instance, \u2227 applied on boolean sequences denotes the elementwise conjunction of the two boolean sequences. Theorem 9. For any two k-automatic sequences a \u2208 \u0393 N 1 , b \u2208 \u0393 N 2 and every function f : f (a, b) k \u2264 a k b k and f (a, b) ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 201,
                    "end": 234,
                    "text": "f (a, b) k \u2264 a k b k and f (a, b)",
                    "ref_id": null
                }
            ],
            "section": "Theorem 7."
        },
        {
            "text": "Proof. Let (Q 1 , \u03a3 k , \u03b4 1 , q 10 , \u0393 1 , \u03c4 1 ) be a DFAO of size a k with \u03c4 1 (\u03b4(q 10 , (i) k )) = a i for all i \u2265 0. Let (Q 2 , \u03a3 k , \u03b4 2 , q 20 , \u0393 2 , \u03c4 2 ) be a DFAO of size b k with \u03c4 2 (\u03b4(q 20 , (i) k )) = b i for all i \u2265 0. Then (Q 1 \u00d7 Q 2 , \u03a3 k , \u03b4, (q 10 , q 20 ), \u0393 3 , \u03c4) for \u03b4, \u03c4 defined by \u03b4 ((q 1 , q 2 ), x) = (\u03b4 1 (q 1 , x), \u03b4 2 (q 2 , x)) and \u03c4 (q 1 , q 2 ) = f (\u03c4 1 (q 1 ), \u03c4 2 (q 2 )) for all q 1 \u2208 Q 1 , q 2 \u2208 Q 2 , x \u2208 \u03a3 k , is a DFAO of size a k b k for f (a, b). The proof for the reversed version is similar.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 307,
                    "end": 318,
                    "text": "((q 1 , q 2",
                    "ref_id": null
                }
            ],
            "section": "Theorem 7."
        },
        {
            "text": "Combining our examples thue and paper we have thue \u2227 paper 2 = 8 and thue \u2227 paper R 2 = 7.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Theorem 7."
        },
        {
            "text": "Theorem 10. Let a = v \u03c9 be a periodic sequence with |v| = n. Then a k \u2264 n and a R k \u2264 n(n \u2212 1).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Periodic Sequences"
        },
        {
            "text": "Writing v = v 0 v 1 \u00b7 \u00b7 \u00b7 v n\u22121 we obtain a i = v i mod n for all i \u2208 N. Define (Q, \u03a3 k , \u03b4, q 0 , \u0393, \u03c4) by Q = {0, 1, . . . , n \u2212 1}, q 0 = 0, \u03b4(q, x) = (kq + x) mod n, \u03c4 (q) = v q , for all q \u2208 Q, x \u2208 \u03a3 k . Then by induction on the length of (i) k one proves that \u03b4(q 0 , (i) k ) = (i mod n) for every i \u2208 N. Hence \u03c4 (\u03b4(q 0 , (i) k )) = \u03c4 (i mod n) = v i mod n = a i for all i \u2208 N, proving that a k \u2264 n.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Proof."
        },
        {
            "text": "For the other claim we prove that |K k (a)| \u2264 n(n \u2212 1), then the result follows from Theorem 4. The states of K k (a) are sequences b for which there are numbers q, j such that b i = a ik q +j = v (ik q +j) mod n for all i \u2208 N. We have to show that there are at most n(n \u2212 1) such sequences b. This follows from the fact that this only i depends on the n values for (j mod n) and the at most n \u2212 1 values for (k q mod n). The latter follows since if k, n are relatively prime, then the values of (k q mod n) are among the n \u2212 1 values 1, . . . , n \u2212 1, and otherwise there is some p > 1 dividing both n and k, and the values are among the n/p multiples of p modulo n.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Proof."
        },
        {
            "text": "A natural question is for which cases the bounds of Theorem 10 can be reached, in particular the quadratic bound for a R k . This question is beyond the scope of this paper, but has been addressed in [2] . A main result of [2] is that if n > 5 is prime and 2 is a primitive root modulo n (on which Artin's conjecture states that this holds for infinitely many primes), then v \u03c9 R k = n(n \u2212 1) for v = 10110 n\u22124 .",
            "cite_spans": [
                {
                    "start": 200,
                    "end": 203,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 223,
                    "end": 226,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Proof."
        },
        {
            "text": "We investigated two natural complexity measures for a k-automatic sequence a: a k closely related to the alphabet size required to present a as a morphic sequence with respect to a k-uniform morphism, and a R k closely related to the size of the kernel of a. We saw how there can be an exponential gap between a k and a R k , but basic operations like tail, adding an element in front, or applying a binary operator elementwise, never increases \u00b7 k or \u00b7 R k by more than a quadratic factor. Many other operations, like changing the tenth element of a sequence, can be obtained by combining such basic operations, and hence yield a polynomial upper bound too. Probably these polynomial bounds can be improved strongly. Other open questions include a further investigation of when these upper bounds can be reached. Conversely, our SAT based tool provides values that are likely to be exact, but formally are only lower bounds. It would make sense to further investigate how to be sure to have the exact value, either depending on particular ways to define automatic sequences, or by giving general criteria for exactness depending on known upper bounds.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "On periodic sequences this paper only contains some very basic observations; more involved observations are given in [2] .",
            "cite_spans": [
                {
                    "start": 117,
                    "end": 120,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "We want to thank Wieb Bosma for fruitful collaboration on this topic and careful proof reading. We want to thank Jeffrey Shallit for giving pointers to state complexity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Automatic Sequences: Theory, Applications, Generalizations",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Allouche",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Shallit",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Complexity of periodic sequences",
            "authors": [
                {
                    "first": "W",
                    "middle": [],
                    "last": "Bosma",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Uniform tag sequences",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Cobham",
                    "suffix": ""
                }
            ],
            "year": 1972,
            "venue": "Math. Systems Theory",
            "volume": "6",
            "issn": "",
            "pages": "164--192",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Automata, Languages and Machines",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Eilenberg",
                    "suffix": ""
                }
            ],
            "year": 1974,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Mix-automatic sequences",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Endrullis",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Grabmayer",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Hendriks",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "LATA 2013",
            "volume": "7810",
            "issn": "",
            "pages": "262--274",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-642-37064-9_24"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Introduction to the Theory of Finite-State Machines",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Gill",
                    "suffix": ""
                }
            ],
            "year": 1962,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "The ranges of state complexities for complement, star and reversal of regular languages",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Jiraskova",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Int. J. Found. Comput. Sci",
            "volume": "25",
            "issn": "1",
            "pages": "101--124",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Decidability and enumeration for automatic sequences: a survey",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Shallit",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "CSR 2013",
            "volume": "7913",
            "issn": "",
            "pages": "49--63",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-642-38536-0_5"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "called a finite state function if a DFAO M exists such that f = f M . For every finite state function f there exists a unique (up to renaming of states) DFAO M with a minimal number of states such that",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": []
}