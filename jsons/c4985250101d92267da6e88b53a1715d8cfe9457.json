{
    "paper_id": "c4985250101d92267da6e88b53a1715d8cfe9457",
    "metadata": {
        "title": "Stratified Test Alleviates Batch Effects in Single-Cell Data",
        "authors": [
            {
                "first": "Shaoheng",
                "middle": [],
                "last": "Liang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Rice University",
                    "location": {
                        "postCode": "77005",
                        "settlement": "Houston",
                        "region": "TX",
                        "country": "USA"
                    }
                },
                "email": "sliang3@mdanderson.org"
            },
            {
                "first": "Qingnan",
                "middle": [],
                "last": "Liang",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Rui",
                "middle": [],
                "last": "Chen",
                "suffix": "",
                "affiliation": {},
                "email": "kchen3@mdanderson.org"
            },
            {
                "first": "Ken",
                "middle": [],
                "last": "Chen",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "The University of Texas MD Anderson Cancer Center",
                    "location": {
                        "postCode": "77030",
                        "settlement": "Houston",
                        "region": "TX",
                        "country": "USA"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Analyzing single-cell sequencing data across batches is challenging. We find that the Van Elteren test, a stratified version of Wilcoxon rank-sum test, elegantly mitigates the problem. We also modified the common language effect size to supplement this test, further improving its utility. On both simulated and real patient data we show the ability of Van Elteren test to control for false positives and false negatives. The effect size also estimates the differences between cell types more accurately.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Large-scale studies such as the Human Cell Atlas [15] involve hundreds of laboratories, thousands of patients, and millions of cells, bringing about opportunities and challenges in analyses. When comparing cell types or groups, discrepancies across experiments and differences among participants lead to omissions and false discoveries in differentially expressed genes. Even the trend (upregulated or downregulated) can be reversed in a phenomenon called Simpson's paradox [1] . Although multiple methods have been proposed to tackle such batch effects, no such option for the widely used Wilcoxon rank-sum test [11, 18] has been applied to single-cell studies, to the best of our knowledge. Here, we show that the stratified rank-sum test (known as Van Elteren test [17] ) and our modified common language effect size may benefit single-cell studies.",
            "cite_spans": [
                {
                    "start": 49,
                    "end": 53,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 474,
                    "end": 477,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 613,
                    "end": 617,
                    "text": "[11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 618,
                    "end": 621,
                    "text": "18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 768,
                    "end": 772,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We briefly review and conceptually compare related works on correcting batch effect in Sect. 1.1. Then, in Sect. 2, we revisit Wilcoxon rank-sum test, and introduce the Van Elteren test supplemented by our direct extension of the common language effect size [5, 12] . Simulation studies and applications to real data in Sect. 3 show that the test controls for the batch effects and leads to more accurate biological discovers, compared with Wilcoxon rank-sum test. More discussions and explanations, are shown in Sect. 4.",
            "cite_spans": [
                {
                    "start": 258,
                    "end": 261,
                    "text": "[5,",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 262,
                    "end": 265,
                    "text": "12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 326,
                    "end": 327,
                    "text": "3",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Mainstream methods to mitigate batch effect fall into two categories, batch correction methods and batch-aware statistical tests. The former includes methods reducing batch effect in the data to facilitate downstream analysis, while the latter includes analyses that control for the batch effect.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "Batch Correction Methods. Batch correction methods eliminate the discrepancy among batches to create an integrated dataset. The most conspicuous manifestation of batch effect is splitting one cell type into multiple clusters. To solve this problem, many methods match and combine clusters across samples based on similarities. A commonly adopted one, Mutual nearest neighbor (MNN) [3] , uses similar cells across datasets as anchors, and based on them correct the gene expression of other cells. Scanorama [4] and Seurat [16] are both based on the MNN methodology. Another method, Harmony [7] , iteratively corrects the data by clustering the cells and moving neighboring clusters toward each other. These methods typically produce a unified data matrix, which can be conveniently used in visualization and downstream analysis. However, these empirical corrections usually lack negative control and raise uncertainty in the discovery [14] .",
            "cite_spans": [
                {
                    "start": 381,
                    "end": 384,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 506,
                    "end": 509,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 521,
                    "end": 525,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 589,
                    "end": 592,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 934,
                    "end": 938,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "Batch-Aware Statistical Tests. Instead of manipulating the data directly, statistical methods may handle batch effect by considering it as a covariate in the model. This is possible in Student's t-test, Poisson test, negative binomial test, etc. Notably, all these tests are parametric, meaning that a distribution must be given in advance. However, the debate of the true distribution of singlecell gene expression has never ceased, which is a reason why the nonparametric Wilcoxon rank-sum test is widely used. To allow modeling covariates, one may use a generalized version of rank-sum test, the proportional odds model [2] . However, modeling batches by using a covariate also makes unnecessary assumptions upon them. Stratification, which only combines statistics from batches, is the \"as simple as possible, but no simpler\" way to handle batches. The Van Elteren test we use, is the stratified version of Wilcoxon rank-sum test.",
            "cite_spans": [
                {
                    "start": 623,
                    "end": 626,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "It is worth noting that methods like scVI [9] have combined statistical modeling with batch effect correction. However, the effect of batches is modeled by a black-box neural network, making the interpretation elusive.",
            "cite_spans": [
                {
                    "start": 42,
                    "end": 45,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "We briefly revisit the Wilcoxon rank-sum test (also known as Mann-Whitney U test) [11, 18] . The test statistics U is defined as",
            "cite_spans": [
                {
                    "start": 82,
                    "end": 86,
                    "text": "[11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 87,
                    "end": 90,
                    "text": "18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Wilcoxon Rank-Sum Test"
        },
        {
            "text": "where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wilcoxon Rank-Sum Test"
        },
        {
            "text": "are the two samples to be compared (e.g., two cell types in one experiment), with sample sizes n 1 and n 2 , respectively. Function \"1\" takes value 1 when its condition holds true, and 0 otherwise. When n 1 and n 2 are both at least 10, which is common in single-cell studies, the distribution of U approximately follows a normal distribution N (\u03bc, \u03c3 2 ) where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wilcoxon Rank-Sum Test"
        },
        {
            "text": "and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wilcoxon Rank-Sum Test"
        },
        {
            "text": "in which t i stands for ties (corresponding to the second term in Eq. 1).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wilcoxon Rank-Sum Test"
        },
        {
            "text": "The Van Elteren test [17] is the stratified version of Wilcoxon rank-sum test. For example, if there are m patients, they maybe treated as strata. In that case, a U statistic may be obtained from each patient g \u2208 {1, \u00b7 \u00b7 \u00b7 , m}, denoted as",
            "cite_spans": [
                {
                    "start": 21,
                    "end": 25,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Van Elteren Test"
        },
        {
            "text": "where w g is a weight for each sample to be discussed later. When m = 1, the formula degenerates to V = (U g \u2212 \u03bc g ) 2 /\u03c3 2 g \u223c \u03c7 2 1 , which is consistent with the rank-sum test.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Van Elteren Test"
        },
        {
            "text": "As discussed by Van Elteren [17] , the weights w g can be assigned in different ways. It should be noted that the U g for a batch g ranges from 0 to n g1 n g2 , the product of two sample sizes in the batch. Should the weights all be equal, a patient with more cells available will dominate the test results. It is proven in [17] that weight",
            "cite_spans": [
                {
                    "start": 28,
                    "end": 32,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 324,
                    "end": 328,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Weights."
        },
        {
            "text": "eliminates such effect, and a test utilizing such weight is thus named as \"designfree test\". However, given that a batch with more instances available (e.g., a patient with more cells sequenced) may be more convincing, another weight",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Weights."
        },
        {
            "text": "is introduced, which gives more power to larger batches. It also effectively assigns larger weights to batches whose samples are more balanced, when the batch sizes are the same. It is shown in [17] that this choice yields largest statistical power against randomized alternatives, and is thus named as \"locally-best test\". The comparison of two weights are shown in Fig. 1 . Effect Sizes. For Wilcoxon rank-sum test, a simple definition of effect size is",
            "cite_spans": [
                {
                    "start": 194,
                    "end": 198,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [
                {
                    "start": 367,
                    "end": 373,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Weights."
        },
        {
            "text": "which is centered at 50%, meaning the probability P (a > b) when a and b are randomly drawn from sample A and sample B, respectively. An effect size greater than 50% generally means that A is higher, and vice versa. It may be easily extended for Van Elteren test by taking average using desired weights. For the design-free test, the effect size is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Weights."
        },
        {
            "text": "as all batches are treated equally regardless of the sample sizes. It may be interpreted as the probability of P (a g > b g ) for a g and b g randomly drawn from",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Weights."
        },
        {
            "text": "A g and B g , after randomly choosing a batch g. For the locally-best test, the effect size becomes",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Weights."
        },
        {
            "text": "which changes the probability of choosing a group g to be in proportion to ng1ng2 ng1+ng2+1 , giving higher weights to batches with higher and balanced sample sizes (Fig. 1) . Generally, any w g may be used to define f , as in",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 165,
                    "end": 173,
                    "text": "(Fig. 1)",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Weights."
        },
        {
            "text": "the two previous options being its special cases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Weights."
        },
        {
            "text": "We implemented the Van Elteren test with the effect size in R, available at our GitHub repository (https://github.com/KChen-lab/stratified-tests-for-seurat), based on Seurat 3.0 by utilizing its differential expression analysis part (but irrelevant to the data integration) [16] . When there are two groups of cells, A and B, denoted as type, and patient identity, denoted as batch, the Van Elteren Test can be called as follows. The genre may be set to either locally-best or design-free, as introduced in Sect. 2, based on which p-values and effect sizes are calculated. Typical results are shown in Table 2 . An effect size of larger than 0.5 indicates a higher expression in cell type A, and vice versa. The avg logFC, average logarithmic fold changes, are calculated automatically by Seurat, where a positive value indicates a higher expression. It may show different trends compared with the effect sizes. Generally, the effect sizes are more indicative after controlling for the batch effect.",
            "cite_spans": [
                {
                    "start": 274,
                    "end": 278,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [
                {
                    "start": 602,
                    "end": 609,
                    "text": "Table 2",
                    "ref_id": "TABREF1"
                }
            ],
            "section": "Results"
        },
        {
            "text": "We simulated datasets to illustrate the key utilities of Van Elteren test. The parameters are specified in Table 1 . Poisson distribution is used to model sequencing depth. Visualization is available in Fig. 2 for illustration. We assume that the library size of each sample is equalized by other genes beyond the simulated ones. Suppressing False Negatives. Batch effect may introduce false negatives, where a significantly differentially expressed gene is overshadowed. For gene 1, on which cell type B always have higher expression on both patients, the Wilcoxon rank-sum test did not pass the threshold of 0.05 to reject the null hypothesis, while Van Elteren test yields a significant p-value. The effect size, smaller than 0.5, also correctly suggests that the expression of gene 1 in cell type B is higher than that in cell type A, compared with the average logarithmic fold change, which wrongfully indicates otherwise. Suppressing False Positives. False discoveries are also possible outcome of batch effect. As is shown in gene 3, the distribution of both cell types are exactly the same in each patient. Nevertheless, Wilcoxon test yields a very significant p-value. The average logarithmic fold change also has a large magnitude. Van Elteren test returns a p-value of 0.7831, together with a effect size close to 0.5, suggesting that the difference is neither significant nor large.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 107,
                    "end": 114,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 203,
                    "end": 209,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Simulation Study"
        },
        {
            "text": "As a negative control, when the three issues above are not present, p-value from Van Elteren test is consistent with Wilcoxon rank-sum test, as is shown by gene 4. The effect size and the log fold change also both show that the cell type B has higher expression in gene 4.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Consistency."
        },
        {
            "text": "We have tested the Van Elteren test on real retina single-cell gene expression data gathered from three patients [8] . Two regions, macula (i.e., the center area) and peripheral, are labeled in the data. We question which genes differentially express for the same cell type between two regions. We run Wilcoxon rank-sum test and Van Elteren test on 2,295 rod cells and 203 cone cells. We compare the results in Fig. 3 , where genes with large differences in p-values between two tests are labeled with gene names.",
            "cite_spans": [
                {
                    "start": 113,
                    "end": 116,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [
                {
                    "start": 411,
                    "end": 417,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "Retina Data"
        },
        {
            "text": "The results of two tests are largely comparable, showing a diagonal pattern. Meanwhile, some exceptions are present (see Table 3 and effect sizes), among which we observed that p-values for gene GNGT1 and SYNE2 change the most. For GNGT1, the reversed conclusion effect is also observed, as the Van Elteren f effect size suggests that the peripheral region has a higher expression, while the log fold change indicates otherwise. We further inspected the distributions to validate and interpret the differences. In Fig. 4A , the left panel does show generally higher expression of GNGT1 in each individual patient, while the aggregated distribution on the right shows a reversed effect, which is an instance of the aforementioned Simpson's paradox. For SYNE2 (Fig. 4B) , conspicuous discrepancy among batches is also shown, which leads to a less precise rank-sum test result. Indeed, these two genes were found playing roles in macular degeneration diseases [6, 10] .",
            "cite_spans": [
                {
                    "start": 957,
                    "end": 960,
                    "text": "[6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 961,
                    "end": 964,
                    "text": "10]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [
                {
                    "start": 121,
                    "end": 128,
                    "text": "Table 3",
                    "ref_id": "TABREF2"
                },
                {
                    "start": 514,
                    "end": 521,
                    "text": "Fig. 4A",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 758,
                    "end": 767,
                    "text": "(Fig. 4B)",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Rod Cells."
        },
        {
            "text": "Cone Cells. For cone cells, we observed similar results. Some genes show changes while most genes are consistent across the tests. The p-values and effect sizes are shown in Table 4 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 174,
                    "end": 181,
                    "text": "Table 4",
                    "ref_id": null
                }
            ],
            "section": "Rod Cells."
        },
        {
            "text": "For gene PCBP4, Van Elteren test shows more significant p-value, and an effect size indicating smaller expression in macula, which is different from the log fold change. Decrease in PCBP4 has also been linked with age-related macular degeneration [13] . Figure 5 shows that batch effect in distribution of PCBP4 may have misled the rank-sum test and the logarithmic fold change. ",
            "cite_spans": [
                {
                    "start": 247,
                    "end": 251,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [
                {
                    "start": 254,
                    "end": 262,
                    "text": "Figure 5",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Rod Cells."
        },
        {
            "text": "The results have clearly shown that Van Elteren test benefits biological studies in precisely identifying differentially expressed genes. Although the results we show do not include multiple comparison correction, Seurat 3.0 will automatically give corrected p-value based on the raw p-value using Bonferroni correction. Generally, any correction based on p-values will also apply. The result also indicates that stratified test is a neat way to handle batch effect. Although covariate has the ability to control for explanatory variables, it is generally more suitable for continuous variables. It also casts more assumptions when modeling covariate. Stratified test, on the other hand, does not infer the influence of the discrete batches. Rather, it directly aggregates the statistical power of multiple samples.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Admittedly, for the rod cells, although changes in p-values are observed, the significance threshold was well passed by both. However, it should be noted that the retina data are collected from relatively healthy tissues and are considered clean, while Van Elteren test is expected to make a more meaningful difference on noisy pathological and tumor data. In addition, rod cell is the most populous cell in retina. For rare cell types that take smaller proportions, like the cone cells, the difference Van Elteren test makes can be crucial.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "The caveat of stratified test is that for it to work the strata shall not overlap with the variable of interest. For instance, it may not find the difference, meanwhile also control for the batch effect, between two patients. Nonetheless, neither is covariate applicable to such cases. As the batch effect and biological effect are convolved, more prior knowledge is generally needed to distinguish them.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "We have adopted Van Elteren test, an underappreciated statistical test, and our weighted common language effect size to single-cell sequencing data. When batch effect is severe, the test control for false positives. Otherwise, it is consistent with Wilcoxon rank-sum test. The modified common language effect size also faithfully depicts the trends. This work may increase the precision of differential expression analysis to help identify genes of interests.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Summary"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "On Simpson's paradox and the sure-thing principle",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "R"
                    ],
                    "last": "Blyth",
                    "suffix": ""
                }
            ],
            "year": 1972,
            "venue": "J. Am. Stat. Assoc",
            "volume": "67",
            "issn": "338",
            "pages": "364--366",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "The Cambridge Dictionary of Statistics. BusinessPro collection",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Everitt",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Skrondal",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Batch effects in single-cell RNA-sequencing data are corrected by matching mutual nearest neighbors",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Haghverdi",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "T"
                    ],
                    "last": "Lun",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "D"
                    ],
                    "last": "Morgan",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "C"
                    ],
                    "last": "Marioni",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Nat. Biotechnol",
            "volume": "36",
            "issn": "5",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Efficient integration of heterogeneous single-cell transcriptomes using Scanorama",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Hie",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Bryson",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Berger",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Nat. Biotechnol",
            "volume": "37",
            "issn": "6",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "The simple difference formula: an approach to teaching nonparametric correlation",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "S"
                    ],
                    "last": "Kerby",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Compr. Psychol",
            "volume": "3",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "G-protein \u03b2\u03b3-complex is crucial for efficient signal amplification in vision",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "V"
                    ],
                    "last": "Kolesnikov",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "J. Neurosci",
            "volume": "31",
            "issn": "22",
            "pages": "8067--8077",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Fast, sensitive and accurate integration of single-cell data with Harmony",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Korsunsky",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Nat. Methods",
            "volume": "16",
            "issn": "",
            "pages": "1--8",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Single-nuclei RNA-seq on human retinal tissue provides improved transcriptome profiling",
            "authors": [
                {
                    "first": "Q",
                    "middle": [],
                    "last": "Liang",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Nat. Commun",
            "volume": "10",
            "issn": "1",
            "pages": "1--12",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Deep generative modeling for single-cell transcriptomics",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Lopez",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Regier",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "B"
                    ],
                    "last": "Cole",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "I"
                    ],
                    "last": "Jordan",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Yosef",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Nat. Methods",
            "volume": "15",
            "issn": "12",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A mutation in Syne2 causes early retinal defects in photoreceptors, secondary neurons, and M\u00fcller glia",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Maddox",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Invest. Ophthalmol. Vis. Sci",
            "volume": "56",
            "issn": "6",
            "pages": "3776--3787",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "On a test of whether one of two random variables is stochastically larger than the other",
            "authors": [
                {
                    "first": "H",
                    "middle": [
                        "B"
                    ],
                    "last": "Mann",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "R"
                    ],
                    "last": "Whitney",
                    "suffix": ""
                }
            ],
            "year": 1947,
            "venue": "Ann. Math. Stat",
            "volume": "18",
            "issn": "",
            "pages": "50--60",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "A common language effect size statistic",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "O"
                    ],
                    "last": "Mcgraw",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Wong",
                    "suffix": ""
                }
            ],
            "year": 1992,
            "venue": "Psychol. Bull",
            "volume": "111",
            "issn": "2",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Proteome and secretome dynamics of human retinal pigment epithelium in response to reactive oxygen species",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "G"
                    ],
                    "last": "Meyer",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "Y"
                    ],
                    "last": "Garcia",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Schilling",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "W"
                    ],
                    "last": "Gibson",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Lamba",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Sci. Rep",
            "volume": "9",
            "issn": "1",
            "pages": "1--12",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Methods that remove batch effects while retaining group differences may lead to exaggerated confidence in downstream analyses",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Nygaard",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "A"
                    ],
                    "last": "R\u00f8dland",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Hovig",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Biostatistics",
            "volume": "17",
            "issn": "1",
            "pages": "29--39",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Science forum: the human cell atlas. Elife",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Regev",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "6",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Comprehensive integration of single-cell data",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Stuart",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Cell",
            "volume": "177",
            "issn": "",
            "pages": "1888--1902",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "On the combination of independent two-sample tests of Wilcoxon",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Van Elteren",
                    "suffix": ""
                }
            ],
            "year": 1960,
            "venue": "Bull. Inst. Int. Staist",
            "volume": "37",
            "issn": "",
            "pages": "351--361",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Individual comparisons by ranking methods",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Wilcoxon",
                    "suffix": ""
                }
            ],
            "year": 1992,
            "venue": "Breakthroughs in Statistics. Springer Series in Statistics (Perspectives in Statistics)",
            "volume": "",
            "issn": "",
            "pages": "196--202",
            "other_ids": {
                "DOI": [
                    "10.1007/978-1-4612-4380-9_16"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "The weight for each batch when using the (A) design-free test and (B) locallybest test. For design-free test all the batches have equal weights, while for locally-best test higher weights are given to batches with higher and balanced sample sizes.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "(obj, ident.1 = 'A', ident.2 = 'B', group.by = 'type', test.use = 'VE', logfc.threshold = 0, latent.vars = 'batch', genre = 'locally-best')",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Illustration of four simulated genes. Two shades correspond to two cell types (dark: cell type A; light: cell type B). For each gene, the left panel is stratified by patients and the right panel shows aggregated distribution.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Comparison of p-values returned from Wilcoxon rank-sum test and Van Elteren test on (A) rod cells and (B) cone cells.Each dot is a gene, whose p-value from Wilcoxon rank-sum test and Van Elteren test are shown by its x-coordinate and y-coordinate, respectively. Genes with largely changed p-values (10 2 for rod cells and 10 1 for cone cells) are labeled with gene names.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Distribution of counts of (A) GNGT1 and (B) SYNE2 in rod cells. Left panels are stratified by patients and right panels show aggregated distributions.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Distribution of counts of PCBP4 in rod cells. The left panel is stratified by patients and the right panel shows aggregated distributions.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "The testing result of Van Elteren test and Wilcoxon rank-sum test is shown inTable 2. Trend (A over B) are indicated by arrows and insignificant p-values are grayed out. For Van Elteren test, the locally-best version and the design-free version return very similar results.",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "Results of the two tests in simulation studies",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "Gene with large p-value change in rod cellsTable 4. Gene with large p-value change in cone cells P-value Effect size Wilcoxon Van Elteren Log10 ratio Log fold change Van Elteren f PCBP4 1.734E\u221202 1.285E\u221203 1.13",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}