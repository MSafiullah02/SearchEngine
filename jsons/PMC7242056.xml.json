{
    "paper_id": "PMC7242056",
    "metadata": {
        "title": "VisB: A Lightweight Tool to Visualize Formal Models with SVG Graphics",
        "authors": [
            {
                "first": "Alexander",
                "middle": [],
                "last": "Raschke",
                "suffix": "",
                "email": "alexander.raschke@uni-ulm.de",
                "affiliation": {}
            },
            {
                "first": "Dominique",
                "middle": [],
                "last": "M\u00e9ry",
                "suffix": "",
                "email": "dominique.mery@loria.fr",
                "affiliation": {}
            },
            {
                "first": "Frank",
                "middle": [],
                "last": "Houdek",
                "suffix": "",
                "email": "frank.houdek@daimler.com",
                "affiliation": {}
            },
            {
                "first": "Michelle",
                "middle": [],
                "last": "Werth",
                "suffix": "",
                "email": "michelle.werth@hhu.de",
                "affiliation": {}
            },
            {
                "first": "Michael",
                "middle": [],
                "last": "Leuschel",
                "suffix": "",
                "email": "michael.leuschel@hhu.de",
                "affiliation": {}
            }
        ]
    },
    "body_text": [
        {
            "text": "The animator and model checker ProB [3] supports both classical B and Event-B, as well as several other formalisms (Z, Alloy and TLA+) which are translated to B. Animation allows the user to experiment with a model, inspecting states, and interactively choose events or operations to execute. Animation is very useful to validate functional behaviour of a model, but also to uncover unexpected behaviour related to issues or requirements the modeller has not yet thought about. Here graphical visualization of the current state of a formal model is often essential so that a human can more quickly validate the behaviour or spot unexpected behaviour. To cite Bryan Cantrill:1\n\u201cThe visual cortex is unparalleled at detecting patterns.\u201d and \u201cThe value of visualization is not merely providing answers but especially provoking new questions.\u201d",
            "cite_spans": [
                {
                    "start": 37,
                    "end": 38,
                    "mention": "3",
                    "ref_id": "BIBREF2"
                }
            ],
            "section": "Introduction and Background",
            "ref_spans": []
        },
        {
            "text": "There are several visualization tools for formal models such as PVSio-Web [7] for PVS, various co-simulation tools for VDM such as [6], and JEB [8], AnimB2 or Brama [5] for Event-B. There have been several visualization based on ProB in the past, such as the animation functions of [4], BMotionStudio [2] or BMotionWeb [1]. The animation function feature is based on declaring a set of images and writing a B expression which generates a matrix of image numbers. It is still available in current versions of ProB, but it is hard to generate larger, visually appealing visualizations. BMotionStudio still exists within Rodin for Event-B, but is not available for other formalisms and it can be cumbersome to generate complex visualizations using its editor. BMotionWeb is based on web technologies, and allows to generate very refined visualizations. However, its learning curve is quite steep, and due to its heavy use of web technology and associated frameworks can no longer be maintained by the ProB team. This situation was the starting point for the development of the present VisB technology: it should be both easy to use and maintain, it should not be bound to an editor but allow a user to generate the images using off-the-shelf applications or even to re-use existing images.",
            "cite_spans": [
                {
                    "start": 75,
                    "end": 76,
                    "mention": "7",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 132,
                    "end": 133,
                    "mention": "6",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 145,
                    "end": 146,
                    "mention": "8",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 166,
                    "end": 167,
                    "mention": "5",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 283,
                    "end": 284,
                    "mention": "4",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 302,
                    "end": 303,
                    "mention": "2",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 320,
                    "end": 321,
                    "mention": "1",
                    "ref_id": "BIBREF0"
                }
            ],
            "section": "Introduction and Background",
            "ref_spans": []
        },
        {
            "text": "The core idea of VisB is to use SVG files as the basis of the visualization. An SVG file is shown in Listing 1.1. Such files can be produced by most off-the-shelf editors and their textual XML representation can be programmatically generated.\n\n",
            "cite_spans": [],
            "section": "VisB Principles and Architecture",
            "ref_spans": []
        },
        {
            "text": "Moreover, SVG files can contain object identifiers (such as button for the circle in Listing 1.1) and it is possible (e.g. using jQuery and JavaScript) to load an SVG file and programmatically find objects from an identifier and set attributes of the found objects, and immediately display the changes. This is the basis of VisB, whose core is written in Java, JavaFX and JavaScript, and whose architecture is shown in Fig. 1.",
            "cite_spans": [],
            "section": "VisB Principles and Architecture",
            "ref_spans": [
                {
                    "start": 424,
                    "end": 425,
                    "mention": "1",
                    "ref_id": "FIGREF0"
                }
            ]
        },
        {
            "text": "This architecture makes VisB easy to maintain because it allows the ProB team to mostly use Java and JavaFX in development, while cutting down the interactions with web languages (such as JavaScript) to a bare minimum.",
            "cite_spans": [],
            "section": "VisB Principles and Architecture",
            "ref_spans": []
        },
        {
            "text": "The link to the formal model is provided by a lightweight glue file (see Listing 1.2), that provides two lists. VisB-items consist of SVG object identifiers, attributes, and expressions that provide the value the attribute should take depending on the state of the formal model. VisB-events link formal model events (aka operations or actions, depending on the formalism) to object identifiers. These events are executed when the object is clicked by the user.",
            "cite_spans": [],
            "section": "VisB Principles and Architecture",
            "ref_spans": []
        },
        {
            "text": "The motivation was to keep the foundation of VisB simple, and not to require the user to learn any new programming language (e.g., JavaScript, Flash, ...). The user just has to know relevant expressions or variables from the formal model and corresponding object identifiers in the SVG graphics file. Moreover, VisB works for all of ProB\u2019s supported state-based formalisms (B, Event-B, Z, TLA+, Alloy) in an identical fashion.\n",
            "cite_spans": [],
            "section": "VisB Principles and Architecture",
            "ref_spans": []
        },
        {
            "text": "One of the simpler examples of a VisB file is shown in Listing 1.2. The corresponding machine contains a bool variable and an operation called press_button that changes the status of this variable. We use the fact that ProB allows IF-THEN-ELSE and LET for expressions (to simplify the syntax of the VisB file). In Listing 1.2 the fill attribute of the SVG object with the identifier \u201cbutton\u201d is changed to green whenever the button variable \u201cbutton\u201d in the corresponding machine is set to true. This is realized with the IF-THEN-ELSE expression in the value attribute. For the visualization this means that the circle\u2019s color is changed from red to green, when the operation press_button is executed. Thanks to the VisB-events, the user can also execute press_button directly by clicking on the SVG object with the identifier \u201cbutton\u201d.\n",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": []
        },
        {
            "text": "The first visualisation created with VisB can be seen in Fig. 2. In the formal model, the state of a lift is represented by three variables: the current floor, an integer value between the ground floor and the top floor (topf), the current direction of the lift and a boolean variable indicating whether the door is open or not. In addition, the lift controller maintains the status of calling buttons inside the lift and on each floor. To cater for different number of floors, represented by the constant topf, we have made use of the SVG \u201cvisibility\u201d attribute to hide unused floors (see right of Fig. 2). Note that each floor is represented by five graphical objects. To avoid having to hide each object of a given floor individually, we have grouped the objects for each floor together. VisB can then be used to hide or show all objects of a floor in one go, as shown in Listing 1.3.\n\n",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": [
                {
                    "start": 62,
                    "end": 63,
                    "mention": "2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 604,
                    "end": 605,
                    "mention": "2",
                    "ref_id": "FIGREF1"
                }
            ]
        },
        {
            "text": "Unfortunately, not all attributes can be changed for groups of SVG objects in this way. For example, the x and y coordinates cannot be changed for groups. Hence, to achieve the vertical movement of the lift cabin, we need three VisB items, each changing the attribute y to the same value (see Listing 1.4).\n",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": []
        },
        {
            "text": "A solution to this drawback is to use embedded SVGs (i.e., nested SVG graphics embedded in the master SVG file) where it is possible to change the coordinates of those embedded SVGs. We have used this for the VisB visualization of the n-queens problem, partially shown in Listing 1.5, where the VisB items needed for the visualization of one given queen is shown. (Note, that the value of the second VisB item is not complete.) Additionally, each chess tile has a VisB event which triggers a B event to place a queen on that tile.\n",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": []
        },
        {
            "text": "For the n-queens problem, we programatically created the VisB file for the chess field and queens, which enabled us to visualize bigger chess fields (\\documentclass[12pt]{minimal}\n\t\t\t\t\\usepackage{amsmath}\n\t\t\t\t\\usepackage{wasysym} \n\t\t\t\t\\usepackage{amsfonts} \n\t\t\t\t\\usepackage{amssymb} \n\t\t\t\t\\usepackage{amsbsy}\n\t\t\t\t\\usepackage{mathrsfs}\n\t\t\t\t\\usepackage{upgreek}\n\t\t\t\t\\setlength{\\oddsidemargin}{-69pt}\n\t\t\t\t\\begin{document}$$120\\times {}120$$\\end{document}), as you can see on the right in Fig. 3.",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": [
                {
                    "start": 489,
                    "end": 490,
                    "mention": "3",
                    "ref_id": "FIGREF2"
                }
            ]
        },
        {
            "text": "A more complex example can be found in our ABZ 2020 case study article in the present proceedings, where SVGs were received from coordinators of the case study and used to visualize various classical B and Event-B models.",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": []
        },
        {
            "text": "In conclusion, thus far we seem to have met our goals of developing lightweight, easy-to-use and easy-to-maintain visualization technology, which nonetheless is flexible enough for creating simple academic visualizations up to complex, full-fledged industrial applications. VisB is available for download at:",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": []
        },
        {
            "text": "\nhttps://www3.hhu.de/stups/prob/index.php/VisB\n",
            "cite_spans": [],
            "section": "VisB Examples",
            "ref_spans": []
        }
    ],
    "ref_entries": {
        "FIGREF0": {
            "text": "Fig. 1.: VisB architecture",
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Fig. 2.: Example of VisB visualization of lift model",
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Fig. 3.: Example of VisB visualization of N-queens problem",
            "type": "figure"
        }
    },
    "back_matter": [],
    "bib_entries": {
        "BIBREF0": {
            "title": "",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF1": {
            "title": "Visualising event-B models with B-motion studio",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Ladenberger",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Bendisposto",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Leuschel",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Formal Methods for Industrial Critical Systems",
            "volume": "",
            "issn": "",
            "pages": "202-204",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF2": {
            "title": "ProB: an automated analysis toolset for the B method",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Leuschel",
                    "suffix": ""
                },
                {
                    "first": "MJ",
                    "middle": [],
                    "last": "Butler",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "STTT",
            "volume": "10",
            "issn": "2",
            "pages": "185-203",
            "other_ids": {
                "DOI": [
                    "10.1007/s10009-007-0063-9"
                ]
            }
        },
        "BIBREF3": {
            "title": "",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF4": {
            "title": "BRAMA: a new graphic animation tool for B models",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Servat",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "B 2007: Formal Specification and Development in B",
            "volume": "",
            "issn": "",
            "pages": "274-276",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF5": {
            "title": "Maestro: the INTO-CPS co-simulation framework",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Thule",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Lausdahl",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Gomes",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Meisl",
                    "suffix": ""
                },
                {
                    "first": "PG",
                    "middle": [],
                    "last": "Larsen",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Simul. Model. Pract. Theory",
            "volume": "92",
            "issn": "",
            "pages": "45-61",
            "other_ids": {
                "DOI": [
                    "10.1016/j.simpat.2018.12.005"
                ]
            }
        },
        "BIBREF6": {
            "title": "",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF7": {
            "title": "",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        }
    }
}