{
    "paper_id": "e1fea16bd575af6c01ddaae0248c3fa7ed9a8382",
    "metadata": {
        "title": "Revisit Prediction by Deep Survival Analysis",
        "authors": [
            {
                "first": "Sundong",
                "middle": [],
                "last": "Kim",
                "suffix": "",
                "affiliation": {},
                "email": "sundong@ibs.re.kr"
            },
            {
                "first": "Hwanjun",
                "middle": [],
                "last": "Song",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "KAIST",
                    "location": {
                        "settlement": "Daejeon",
                        "country": "South Korea"
                    }
                },
                "email": "songhwanjun@kaist.ac.kr"
            },
            {
                "first": "Sejin",
                "middle": [],
                "last": "Kim",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "KAIST",
                    "location": {
                        "settlement": "Daejeon",
                        "country": "South Korea"
                    }
                },
                "email": ""
            },
            {
                "first": "Beomyoung",
                "middle": [],
                "last": "Kim",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "KAIST",
                    "location": {
                        "settlement": "Daejeon",
                        "country": "South Korea"
                    }
                },
                "email": ""
            },
            {
                "first": "Jae-Gil",
                "middle": [],
                "last": "Lee",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "KAIST",
                    "location": {
                        "settlement": "Daejeon",
                        "country": "South Korea"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "In this paper, we introduce SurvRev, a next-generation revisit prediction model that can be tested directly in business. The SurvRev model offers many advantages. First, SurvRev can use partial observations which were considered as missing data and removed from previous regression frameworks. Using deep survival analysis, we could estimate the next customer arrival from unknown distribution. Second, SurvRev is an event-rate prediction model. It generates the predicted event rate of the next k days rather than directly predicting revisit interval and revisit intention. We demonstrated the superiority of the SurvRev model by comparing it with diverse baselines, such as the feature engineering model and state-of-the-art deep survival models.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Predicting customer revisit in offline stores has been feasible because of the advancement in sensor technology. In addition to well-known but difficult-toobtain customer revisit attributes, such as purchase history, store atmosphere, customer satisfaction with products, large-scale customer motion patterns captured via in-store sensors are effective in predicting customer revisit [9] . Market leaders, such as Alibaba, Amazon, and JD.com, opened the new generation of retail stores to satisfy customers. In addition, small retail chains are beginning to apply thirdparty retail analytics solutions built upon Wi-Fi fingerprinting and video content analytics to learn more about their customer behavior. For small stores that have not yet obtained all the aspects of customer behavior, the appropriate use of sensor data becomes more important to ensure their long-term benefit.",
            "cite_spans": [
                {
                    "start": 384,
                    "end": 387,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "By knowing the visitation pattern of customers, store managers can indirectly gauge the expected revenue. Targeted marketing can also be available by knowing the revisit intention of customers. By offering discount coupons, merchants can encourage customers to accidentally revisit their stores nearby. Moreover, they can offer a sister brand with finer products to provide new shopping experiences to customers. Consequently, they can simultaneously increase their revenue and satisfy their customers. A series of previously conducted works [9, 10] introduced a method of applying feature engineering to estimate important attributes for determining customer revisit. The proposed set of features was intuitive and easy to reproduce, and the model was powered by widely known machine learning models, such as XGBoost [2] .",
            "cite_spans": [
                {
                    "start": 542,
                    "end": 545,
                    "text": "[9,",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 546,
                    "end": 549,
                    "text": "10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 818,
                    "end": 821,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "However, some gaps did exist between their evaluation protocol and real application settings. Although their approach could effectively perform customer-revisit prediction, in downsampled and cross-validated settings, it was not guaranteed to work satisfactorily in imbalanced visitations with partial observations. In the case of class imbalance, the predictive power of each feature might disappear because of the dominance of the majority label, and such small gaps might result in further adjustment in actual deployment. In addition, in a longitudinal prediction setup, the cross-validation policy results in implicit data leakage because the testing set is not guaranteed to be collected later than the training set.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "By evaluating the frameworks using chronologically split imbalanced data, the gap between previously conducted works and real-world scenarios seemed to fill. However, an unconsidered challenge, i.e., partial observations, occurred after splitting the dataset by time. Partial observations occur for every customer, as the model should be trained up to certain observation time. In the case of typical offline check-in data, most customers are only one-time visitors for a certain point of interest [9] . Therefore, the amount of partial observations is considerably large for individual store level. However, previously conducted works [9, 10] ignored partial observations, as their models required labels for their regression model, resulting in not only significant information loss but also biased prediction, as a model is trained using only revisited cases. In this study, we adopt survival analysis [18] to counter the aforementioned instances.",
            "cite_spans": [
                {
                    "start": 498,
                    "end": 501,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 636,
                    "end": 639,
                    "text": "[9,",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 640,
                    "end": 643,
                    "text": "10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 905,
                    "end": 909,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "A practical model must predict the behavior of both partially observed customers as well as new visitors who first appear during the testing period. Predicting the revisit of both censored customers and new visitors simultaneously is very challenging, as the characteristics, such as the remaining observation time and their visit histories, of both of them inherently differ from each other. In a usual classification task, it is assumed that the class distributions between training and testing sets are the same. However, the expected arrival rate of new visitors might be lower than that of the existing customers, as the former did not appear during the training period [16] . To understand the revisit pattern using visitation histories with irregular arrival rates, we use deep learning to be free from arrival rate \u03bb and subsequently, predict quantized revisit rates.",
            "cite_spans": [
                {
                    "start": 675,
                    "end": 679,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "These abovementioned principles associated with a practical model might be crucial in applied data science research, and they offer considerable advantages compared with those offered by previously conducted works, which compromise difficulties. In the following section, we introduce our principled approach, i.e., SurvRev, to resolve customer-revisit prediction in more realistic settings.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Customer-Revisit Prediction [10] : Given a set of visits Vtrain = {v1, . . . , vn} with known revisit intentions RV bin (vi) and revisit intervals RV days (vi), where vi \u2208 Vtrain, RV bin (vi) \u2208 {0, 1}, and RV days (vi) = R>0, if RV bin (vi) = 1 \u221e, otherwise,",
            "cite_spans": [
                {
                    "start": 28,
                    "end": 32,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "build a classifier C that predictsRV bin (vj) andRV days (vj) for a new visit vj.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In this section, we introduce our customer-revisit prediction approach. We named our model SurvRev, which is the condensed form of S urvival Revisit predictor. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Deep Survival Model (SurvRev )"
        },
        {
            "text": "Fig. 2 depicts the architecture of the low-level visit encoder. In the encoder, the main area sequence inputs go through three consecutive layers and are, subsequently, combined with auxiliary visit-level inputs, i.e., user embeddings and handcrafted features. We first introduce three-tiered main layers for the area inputs, followed by introducing the process line of the auxiliary visit-level inputs. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Low-Level Visit Encoder"
        },
        {
            "text": "The first layer that is passed by an area sequence is a pretrained area embedding layer to obtain the dense representation for each sensor ID. We used the pretrained area and user embedding results via Doc2Vec [12] as initialization. The area embedding is concatenated with the dwell time, and, subsequently, it goes through a bidirectional LSTM (Bi-LSTM) [17] , which is expected to learn meaningful sequential patterns by looking back and forth. Each LSTM cell emits its learned representation, and the resulting sequences pass through a one-dimensional convolutional neural networks (CNN) to learn higher-level representations from wider semantics. We expect CNN layers to automate the manual process of grouping the areas for obtaining multilevel location semantics, such as category or gender-level sementics [10] . In business, the number of CNN layers can be determined depending on the number of meaningful semantic levels that the store manager wants to observe. The output of the CNN layer goes through self-attention [1] to examine all the information associated with visit. Using the abovementioned sequence of processes, SurvRev can learn the diverse levels of meaningful sequential patterns that determine customer revisits.",
            "cite_spans": [
                {
                    "start": 210,
                    "end": 214,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 356,
                    "end": 360,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 814,
                    "end": 818,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 1028,
                    "end": 1031,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Processing Area Sequences:"
        },
        {
            "text": "Adding Visit-Level Features: Here, we concatenate a user representation with an area sequence representation and, subsequently, apply FC layers with ReLU activation [4] . We can implicitly control the importance of both the representations by changing the dimensions for both the inputs. Finally, we concatenate selected handcrafted features with the combination of user and area representations. The handcrafted features contain the summary of each visit that may not be captured using the boxed component depicted in Fig. 2 . The selected handcrafted features are the total dwell time, average dwell time, number of areas visited, number of unique areas visited, day of the week, hour of the day, number of prior visits, and previous interval. We applied batch normalization [7] before passing the final result through the high-level module of SurvRev.",
            "cite_spans": [
                {
                    "start": 165,
                    "end": 168,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 777,
                    "end": 780,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [
                {
                    "start": 519,
                    "end": 525,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Processing Area Sequences:"
        },
        {
            "text": "The blue box in Fig. 1 depicts the architecture of the high-level event-rate predictor. Its main functionality is to consider the histories of a customer by using dynamic LSTMs [6] and predict the revisit rate for the next k days. For each customer, the sequence of outputs from the low-level encoder becomes the input to the LSTM layers. We use dynamic LSTMs to allow sequences with variable lengths, which include a parameter to control the maximum number of events to consider. The output from the final LSTM cell goes through the FC layers with softmax activation. We set the dimension k of the final FC layer to be 365 to represent quantized revisit rates [8] for the next 365 days. For convenience, we refer to this 365-dim revisit rate vector as\u03bb = [\u03bb t , 0 \u2264 t < k, t \u2208 N], where each element\u03bb t indicates a quantized revisit rate in a unit-time bin [t, t + 1).",
            "cite_spans": [
                {
                    "start": 177,
                    "end": 180,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 661,
                    "end": 664,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [
                {
                    "start": 16,
                    "end": 22,
                    "text": "Fig. 1",
                    "ref_id": null
                }
            ],
            "section": "High-Level Event-Rate Predictor"
        },
        {
            "text": "In this section, we explain the procedure to convert the 365-dim revisit rate\u03bb to other criteria, such as probability density function, expected value, and complementary cumulative distribution function (CCDF). The aforementioned criteria will be used to calculate the diverse loss function in Sect. 2.5. Remember that RV days (v) denotes the predicted revisit interval of visit v, meaning that SurvRev expects a revisit will occur afterRV days (v) from the time a customer made a visit v to a store.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Output Conversion"
        },
        {
            "text": "1. Substituting the quantized event rate\u03bb from 1 gives the survival rate, i.e., 1 \u2212\u03bb, which denotes the rate at which a revisit will not occur during the next unit time provided that the revisit has not happened thus far. Therefore, the cumulative product of the survival rate with time gives the quantized probability density function as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Output Conversion"
        },
        {
            "text": "2. Subsequently, the predicted revisit interval can be represented as a form of expected value as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Output Conversion"
        },
        {
            "text": "3. On the basis of the last time of the observation period, it can be predicted whether a revisit is made within a period, which is denoted byRV bin (v).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Output Conversion"
        },
        {
            "text": "Here, we define a suppress time t supp (v) = t end \u2212 t v , where t v denotes the visit time of v and t end the time when the observation ends. We used the term suppress time to convey that the customer suppresses his or her desire to revisit until the time the observation ends by not revisiting the store. Thus,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Output Conversion"
        },
        {
            "text": "4. Calculating the survival rate using suppress time gives CCDF and CDF, both of which will be used to compute the cross-entropy loss. When t supp (v) is a natural number, the following holds:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Output Conversion"
        },
        {
            "text": "We designed a custom loss function to learn the parameters of our SurvRev model. We defined four types of losses-negative log-likelihood loss, root-meansquared error (RMSE) loss, cross-entropy loss, and pairwise ranking losses. The prefixes L uc , L c , and L uc\u2212c mean that each loss is calculated for uncensored, censored, and all samples, respectively. Depending on the task domain, the losses to be considered will be slightly different. Therefore, the final L uc\u2212nll can be a weighted sum of five variants.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Loss Functions"
        },
        {
            "text": "The second loss is the RMSE loss which minimizes the error between the predicted revisit intervalRV days (v) and actual interval RV days (v). The term L uc\u2212rmse minimizes the error of the model for the case of uncensored samples. One might consider the RMSE loss a continuous expansion of negative log-likelihood loss.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RMSE Loss L uc\u2212rmse :"
        },
        {
            "text": "Using the cross-entropy loss, one can measure the performance of the classification model whose output is a probability value between 0 and 1. The cross-entropy loss decreases as the predicted probability converges to the actual label. We separate L uc\u2212c\u2212ce into L uc\u2212ce and L c\u2212ce denoting the partial cross-entropy value of the uncensored and censored sets, respectively.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cross-Entropy Loss L uc\u2212c\u2212ce :"
        },
        {
            "text": "Pairwise Ranking Loss L uc\u2212c\u2212rank : Motivated by the ranking loss function [13] and c-index [14] , we introduce the pairwise ranking loss to compare the orderings between the predicted revisit intervals. This loss function fine-tunes the model by making the tendency of the predicted and the actual intervals similar to each other. The loss function L uc\u2212c\u2212rank is formally defined using the following steps.",
            "cite_spans": [
                {
                    "start": 75,
                    "end": 79,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 92,
                    "end": 96,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Cross-Entropy Loss L uc\u2212c\u2212ce :"
        },
        {
            "text": "1. First, we define two matrices P and Q as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cross-Entropy Loss L uc\u2212c\u2212ce :"
        },
        {
            "text": "For a censored visit v, we use the suppress time t supp (v) instead of the actual revisit interval RV days (v) to draw a comparison between uncensored and censored cases. 2. The final pairwise ranking loss is defined as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cross-Entropy Loss L uc\u2212c\u2212ce :"
        },
        {
            "text": "By minimizing L uc\u2212c\u2212rank , our model encourages the correct ordering of pairs while discouraging the incorrect one. Both the constraint v i \u2208 V uncensored and variable Q ij remove the influence of incomparable pairs, such as v i and v j with RV days (v i ) = 3 and t supp (v j ) = 2, respectively, due to the censoring effect.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Cross-Entropy Loss L uc\u2212c\u2212ce :"
        },
        {
            "text": "Combining all the losses, we can design our final objective L to train our SurvRev model. Thus, arg min",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Final-Loss:"
        },
        {
            "text": "where \u03b8 denotes a model parameter of SurvRev. We used the product loss to benefit from all the losses and reduce the weight parameters among the losses.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Final-Loss:"
        },
        {
            "text": "To prove the efficacy of our model, we performed various experiments using a real-world in-store mobility dataset collected by Walkinsights. After introducing the tuned parameter values of the SurvRev model, we summarized the evaluation metrics required for performing revisit prediction (see Sect. 3.1). In addition, we demonstrate the superiority of our SurvRev model by comparison with seven different baseline event prediction models (see Sect. 3.2).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experiments"
        },
        {
            "text": "Data Preparation: We used a Wi-Fi fingerprinted dataset introduced in [9] , which represents customer mobility captured using dozens of in-store sensors in flagship offline retail stores located in Seoul. We selected four stores that had collected data for more than 300 days from Jan 2017. We consider each store independently, only a few customer overlaps occurred among the stores. We randomly selected 50,000 customers that had visits longer than 1 min, which is a sufficiently large number of customers to guarantee satisfactory model performance according to [10] . If a customer reappears within 10 min, we do not consider that particular subsequent visit as a new visit. We also designed several versions of training and testing sets by varying the training length to 180 and 240 days. default values. For the low-level module, the 64-dim Bi-LSTM unit was used. The kernel size of CNN was 3 with 16-dim filters, and the number of neurons in the FC layer was 128. We used only one dense layer. For a visit with a long sequence, we considered m areas that could cover up to 95% of all the cases, where m depends on each dataset. In the high-level module, the dynamic LSTM had 256dim units and processed up to 5 events. We used two layers of LSTM with tanh activation. For the rate predictor, we used two FC layers with 365 neurons and ReLU activation. For training the model, we used Adam [11] optimizer with the learning rate of 0.001. We set the mini-batch size to be 32 and ran 10 epochs. The NLL loss L uc\u2212nll was set as the average of L uc\u2212nll\u2212season and L uc\u2212nll\u2212month . Some of these hyperparameters were selected empirically via grid search.",
            "cite_spans": [
                {
                    "start": 70,
                    "end": 73,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 565,
                    "end": 569,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 1395,
                    "end": 1399,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Settings"
        },
        {
            "text": "We made a switch to control the number of user histories to be used while training the SurvRev model. For predicting partially-observed instances (v tep ), all the histories up to the observation time were used to train the model. For instance, if an input visit v 5 is a partial observation, then {v 1 , \u00b7 \u00b7 \u00b7 , v 5 } and t supp (v 5 ) are fed in the high-level event-rate predictor. For predicting firsttime visitors, only the first appearances (v 1 \u2208 V train ) were used to train the model. In the latter case, the LSTM length in a high-level event-rate predictor is always one because each training instance has no prior log.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Input Settings:"
        },
        {
            "text": "We used two metrics, namely, F-score and c-index, to evaluate the prediction performance.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Evaluation Metrics:"
        },
        {
            "text": "-F-score: F-score measures the binary revisit classification performance.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Evaluation Metrics:"
        },
        {
            "text": "-C-index [14] : C-index measures the global pairwise ordering performance, and it is the most generally used evaluation metric in survival analysis [13, 15] .",
            "cite_spans": [
                {
                    "start": 9,
                    "end": 13,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 148,
                    "end": 152,
                    "text": "[13,",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 153,
                    "end": 156,
                    "text": "15]",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [],
            "section": "Evaluation Metrics:"
        },
        {
            "text": "Comparison with Baselines: We verify the effectiveness of our SurvRev model on the large-scale in-store mobility data. To compare our method with various baseline methods, we implemented eight different event-prediction models.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Baselines Not Considering Covariates: The first three baselines focus on the distribution of revisit labels and consider them an arrival process. They do not consider the attributes, i.e., covariates, obtained from each visit.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "-Majority Voting (Majority): Prediction results are dictated by the majority class for classification, which depends on the average values of regression; this baseline is a naive but powerful method for an imbalanced dataset. -Personalized Poisson Process (Poisson) [16] : We assume that the inter-arrival time of customers follows the exponential distribution with a constant \u03bb. To make it personalized, we control \u03bb for each customer by considering his or her visit frequency and observation time. Baselines Considering Covariates: The following two models considered the covariates derived from each visit. For ensuring fairness, we used the same set of handcrafted features for the latter baseline.",
            "cite_spans": [
                {
                    "start": 266,
                    "end": 270,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "-Cox Proportional Hazard model (Cox-PH) [3] : It is a semi-parametric survival analysis model with proportional hazards assumption. -Gradient Boosting Tree with Handcrafted Features (XGBoost) [9] : It uses carefully designed handcrafted features with XGBoost classifier [2] .",
            "cite_spans": [
                {
                    "start": 31,
                    "end": 39,
                    "text": "(Cox-PH)",
                    "ref_id": null
                },
                {
                    "start": 40,
                    "end": 43,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 192,
                    "end": 195,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 270,
                    "end": 273,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Baselines Using Deep Survival Analysis: The last two models are state-of-the-art survival analysis models that applied deep learning.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "-Neural Survival Recommender (NSR) [8] : It is a deep multi-task learning model with LSTM and three-way factor unit used for music subscription data with sequential events. However, the disadvantage of this model is that the input for each cell is simple, and the input does not consider lower-level interactions. -Deep Recurrent Survival Analysis (DRSA) [15] : It is an auto-regressive model with LSTM. Each cell emits a hazard rate for each timestamp. However, the drawback of this model is that each LSTM considers only a single event. Comparison Results: Tables 2 and 3 summarize the performance of each model on partially observed customers (V tep ) and first-time visitors (V tef ), respectively. The prediction results on the partially observed set shows that SurvRev outperforms other baselines in terms of the c-index, in most cases. In addition, regarding first-time visitors, SurvRev outperforms other baselines in terms of the f-score. As a preliminary result, it is fairly satisfying to observe that our model showed its effectiveness on two different settings. However, we might need to further tune our model parameters to achieve the best results for every evaluation metric.",
            "cite_spans": [
                {
                    "start": 35,
                    "end": 38,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 355,
                    "end": 359,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [
                {
                    "start": 559,
                    "end": 573,
                    "text": "Tables 2 and 3",
                    "ref_id": "TABREF4"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Throughout ablation studies, we expect to observe the effectiveness of the components of both the low-level encoder and high-level eventrate predictor. The variations in both low-level encoders (L1-L6) and high-level event-rate predictors (H1-H2) are as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Ablation Studies:"
        },
        {
            "text": "Ablation by simplifying the low-level module: Ablation by simplifying the high-level module:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Ablation Studies:"
        },
        {
            "text": "-H1 (FC +FC ): Concatenate the outputs of the low-level encoder and, subsequently, apply an FC layer instead of LSTMs. -H2 (LSTM +FC ): Stack the outputs of the low-level encoder and, subsequently, apply two-level LSTM layers. This one is equivalent to our original high-level event-rate predictor described in Sect. 2.3. Figure 3 depicts the results of the ablation study. The representative c-index results are evaluated on a partially-observed set of store D with 240-day training interval. The results show that the subcomponents of both the low-level visit encoder and the high-level event-rate predictor are critical to designing the SurvRev architecture. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 322,
                    "end": 330,
                    "text": "Figure 3",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "Ablation Studies:"
        },
        {
            "text": "In this study, we proposed the SurvRev model for customer-revisit prediction. In summary, our SurvRev model successfully predicted customer revisit rates for the next time horizon by encoding each visit and managing the personalized history of each customer. Upon applying survival analysis with deep learning, we could easily analyze both first-time visitors and partially-observed customers with inconsistent arrival behaviors. In addition, SurvRev did not involve any parametric assumption. Through comparison with various event-prediction approaches, SurvRev proved effective by realizing several prediction objectives. For future work, we would like to extend SurvRev to other prediction tasks that suffer from partial observations and sessions with multilevel sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Neural machine translation by jointly learning to align and translate",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Bahdanau",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Cho",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bengio",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "XGBoost: a scalable tree boosting system",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Guestrin",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Regression models and life-tables",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "R"
                    ],
                    "last": "Cox",
                    "suffix": ""
                }
            ],
            "year": 1972,
            "venue": "J. Roy. Stat. Soc. Series B (Methodol.)",
            "volume": "34",
            "issn": "2",
            "pages": "187--220",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Deep sparse rectifier neural networks. In: AIS-TATS",
            "authors": [
                {
                    "first": "X",
                    "middle": [],
                    "last": "Glorot",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Bordes",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bengio",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Spectra of some self-exciting and mutually exciting point processes",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Hawkes",
                    "suffix": ""
                }
            ],
            "year": 1971,
            "venue": "Biometrika",
            "volume": "58",
            "issn": "1",
            "pages": "83--90",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Long short-term memory",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Hochreiter",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Schmidhuber",
                    "suffix": ""
                }
            ],
            "year": 1997,
            "venue": "Neural Comput",
            "volume": "9",
            "issn": "8",
            "pages": "1735--1780",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Batch normalization: accelerating deep network training by reducing internal covariate shift",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ioffe",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Szegedy",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Neural survival recommender",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Jing",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Smola",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Utilizing in-store sensors for revisit prediction",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A systemic framework of predicting customer revisit with in-store sensors",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Knowl. Inf. Syst",
            "volume": "",
            "issn": "",
            "pages": "1--31",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Adam: a method for stochastic optimization",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "P"
                    ],
                    "last": "Kingma",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Ba",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Distributed representations of sentences and documents",
            "authors": [
                {
                    "first": "Q",
                    "middle": [],
                    "last": "Le",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Mikolov",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "DeepHit: a deep learning approach to survival analysis with competing risks",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "R"
                    ],
                    "last": "Zame",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Yoon",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Van Der Schaar",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "On ranking in survival analysis: bounds on the concordance index",
            "authors": [
                {
                    "first": "V",
                    "middle": [
                        "C"
                    ],
                    "last": "Raykar",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Steck",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Krishnapuram",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Dehing-Oberije",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Lambin",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Deep recurrent survival analysis",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Ren",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Stochastic Processes",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "M"
                    ],
                    "last": "Ross",
                    "suffix": ""
                }
            ],
            "year": 1996,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Bidirectional recurrent neural networks",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Schuster",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "K"
                    ],
                    "last": "Paliwal",
                    "suffix": ""
                }
            ],
            "year": 1997,
            "venue": "IEEE Trans. Signal Process",
            "volume": "9",
            "issn": "8",
            "pages": "2673--2681",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Machine learning for survival analysis: a survey",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "K"
                    ],
                    "last": "Reddy",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "ACM Comput. Surv",
            "volume": "1",
            "issn": "1",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Low-level visit encoder of the SurvRev model.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Personalized Hawkes Process (Hawkes) [5]: It is an extended version of the Poisson process, and it includes self-stimulation and time-decaying rate \u03bb.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "L1 (Bi-LSTM +ATT ): Use only two layers to represent the visit. -L2 (CNN +ATT ): Use only CNN and attention layers to represent the visit. -L3 (Bi-LSTM +CNN +AvgPool ): Substitute an attention layer to pooling. -L4 (Bi-LSTM +CNN +ATT ): Use only area sequence information. -L5 (Bi-LSTM +CNN +ATT +UserID): Add user embedding results to L4. -L6 (Bi-LSTM +CNN +ATT +UserID+FE ): Add handcrafted features to L5.This one is equivalent to our original low-level encoder described in Sect. 2.2.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Ablation studies of the SurvRev model.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "The final output of the high-level module is a set of predicted revisit rates for the next k days. To calculate the loss function, we perform some calculations for converting event rates to revisit probability at time t and the expected",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "L uc\u2212nll : For performing model fitting, we minimize the negative log-likelihood of the empirical data distribution. We compute L uc\u2212nll only for those uncensored samples v in the training set that have a valid value of the next revisit interval, i.e., \u2200v : RV days (v) \u2208 R >0 . For stepby-step optimization, we design five cases of L uc\u2212nll by changing the interval parameters: L uc\u2212nll\u2212season , L uc\u2212nll\u2212month , L uc\u2212nll\u2212week , L uc\u2212nll\u2212date , and L uc\u2212nll\u2212day , for season, month, week, date, and day, respectively. Among these five variants, we introduce L uc\u2212nll\u2212season and L uc\u2212nll\u2212month by considering the case wherein RV days (v) = 105.-L uc\u2212nll\u2212season : For some applications, e.g., clothing, it is essential to capture seasonal visitation patterns. Thus, if the customer revisited within 105 days, the model learns to increase the likelihood of the interval RV days (v) \u2208 [90, 180). -L uc\u2212nll\u2212month : Similarly, the model learns to increase the likelihood of monthly interval RV days (v) \u2208 [90, 120).",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "Hyperparameter Settings: The embedding dimension was set to be 64 for both area embeddings and user embeddings. A set of new IDs and that of new areas in the testing set were mapped to[unk]  and, subsequently, embedded to",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "Statistics of the datasets.",
            "latex": null,
            "type": "table"
        },
        "TABREF4": {
            "text": "Superiority of SurvRev compared to baselines, evaluated on partial observations. We highlighted in bold the cases where SurvRev shows the best performance.",
            "latex": null,
            "type": "table"
        },
        "TABREF5": {
            "text": "Superiority of SurvRev compared to baselines, evaluated on first-time visitors.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}