{
    "paper_id": "2bcda36d390006af3c02fc70d34528825872df92",
    "metadata": {
        "title": "Epidemic Arrival Times; Theory, Discussion, and Limitations",
        "authors": [
            {
                "first": "Alastair",
                "middle": [],
                "last": "Jamieson-Lane",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Bernd",
                "middle": [],
                "last": "Blasius",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "The rise of the World Airline Network over the past century has lead to sharp changes in our notions of 'distance' and 'closeness' -both in terms of trade and travel, but also (less desirably) with respect to the spread of disease. Using flight data from the WAN, along with a drastically simplified epidemic model, we are able to predict epidemic arrival times, for arbitrary initial conditions, in a computationally efficient manner. Our framework provides some theoretical justification to the 'effective distance' originally introduced by Brockmann & Helbing (2013), however we also observed that the predictive power of such heuristics is significantly lower than previously reported. Further improvements to our framework allow predictions to be made, even in parameter regimes where past methods are known to fail, and illuminate the circumstances under which this class of methods can be expected to fail.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "It was said by Jules Verne in 1873 that \"The world has grown smaller, since a man can now go round it ten times more quickly than a hundred years ago,\" that one could, travel around the world in eighty days [16] . One can't help but wonder what Verne would think of the advances in technology that have occurred in the century and a half since, which now allow the circumnavigation of the globe in less than eighty hours. The World Aviation Network (WAN) has, over the past century, shrunk the globe to a fraction of its former size, allowing for vast increases in tourism, immigration, and trade. At the same time, diseases that might once have travelled at the speed of cart, ship or train now cross the world in a number of days or hours. In 2003 Severe Acute Respiratory Syndrome (SARS) was able to spread from China to Vietnam, Hong Kong and Canada within two weeks of being reported to the WHO [18] . Similarly, the 2009 H1N1 flu pandemic first reported in Mexico was able to reach both Europe and Asia within a fortnight [19] . Now, in 2020 we see that coronavirus SARS-CoV-2 has spread quickly across the world [20] , reaching all but a handful of countries.",
            "cite_spans": [
                {
                    "start": 207,
                    "end": 211,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 900,
                    "end": 904,
                    "text": "[18]",
                    "ref_id": null
                },
                {
                    "start": 1028,
                    "end": 1032,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 1119,
                    "end": 1123,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Modelling of disease spread and disease arrival time is critical, both to mitigate the effects of a disease, and determine where best to apply quarantine and screening protocols so as to minimize the spread of infection. In order to model the spread of disease, given our current WAN, a number of highly detailed epidemic simulation models have been created, such as GLEAMviz [3] . Depending 1 arXiv:2004.05557v1 [physics.soc-ph] 12 Apr 2020 on how they are set up, these models can include such factors as vaccination, incubation times, multiple susceptibility classes, non-linear responses, seasonal forcing, quarantine, and the stochastic movement of individual agents, providing a detailed and comprehensive modelling framework. Unfortunately, in many cases, such models quickly become black boxes in and of themselves-objects to be studied and analyzed only via costly simulation-predictions of the future that can be observed, but seldom understood. This difficulty is further exacerbated by the difficulties of determining parameter values, often a delicate task during the initial stages of a disease outbreak when information is scarce.",
            "cite_spans": [
                {
                    "start": 376,
                    "end": 379,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Depending on the questions being asked, explicit modelling of such intricate details is necessary, however, for other questions, such as the determination of epidemic arrival time, it seems that simpler methods may suffice. For this reason, a number of authors [2, 9] have produced \"distance metrics\" -artificial measures of distance based on flight data from the WAN. Effective distance measures predict relative arrival times for an epidemic starting in a specified location, predicting for example that an epidemic starting in Vancouver will take twice as long to reach Istanbul as it will to reach Rio de Janeiro. The absolute arrival time depends on disease parameters.",
            "cite_spans": [
                {
                    "start": 261,
                    "end": 264,
                    "text": "[2,",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 265,
                    "end": 267,
                    "text": "9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Such measures frequently rely on synthesizing a 'direct distance' between connected locations, and then determining the 'shortest path' between locations which are not connected directly. An example of such an effective distance, proposed by Brockmann & Helbing [2] , defines the direct distance between a pair of vertices as",
            "cite_spans": [
                {
                    "start": 262,
                    "end": 265,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "where P ij is the probability that a particular individual who is leaving location i is travelling to location j. The total effective distance is then given as the shortest path between a given pair of nodes:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "where here we minimize over all possible paths from i to j, and d a,b denotes the effective distance along each step of this shortest path (and P a,b the corresponding probability). A number of papers by Gautreau, Ianelli, et al. provide theoretical justifications to the effective distance, by first calculating the expected time for a growing epidemic to make its first 'jump', [6] , and then summing overall possible paths joining a pair of airports (in an appropriate manner) [9] . More recent work by Chen et al. [4] made use of linear spreading theory, approximating the growth of the epidemic as simple exponential growth. In doing so, they achieve the same high accuracy as Ianelli et al., but at significantly lower conceptual and computational complexity.",
            "cite_spans": [
                {
                    "start": 380,
                    "end": 383,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 480,
                    "end": 483,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 518,
                    "end": 521,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In what follows, we will improve upon Chen et al. linear spreading method, before going on to explore the strengths and, just as importantly, the limitations of the general class of 'effective distance' methods discussed in the previous paragraph. In section 2 we introduce the 'unbound growth arrival time' and demonstrate some of its key properties. We then show how a modified version of Brockmann & Helbing's \"effective distance\" can be found as an approximation of our results under appropriate circumstances. In section 3 we compare the predictions made by these methods to both simple deterministic ODE models, and large scale stochastic simulations. We then compare to arrival times as observed for H1N1 and SARS. In general, it is observed that both effective distance and unbound growth methods have reasonable predictive power, but that neither method provide the R 2 = 0.973 predictive power observed in the original paper ( [2] , Fig. 2 ), especially when compared to real world data.",
            "cite_spans": [
                {
                    "start": 937,
                    "end": 940,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 943,
                    "end": 949,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "In section 4 we explore possible sources of error in the unbound growth model, demonstrating both where the model is robust, and what types of changes will cause it to break down or give erroneous results. A slight tweak of the model allows us to maintain accuracy even in cases where the past approaches give poor results, at modest computational cost. The more technical discussion of efficient computational techniques, and comparison to the work of Gautreau, Iannelli, et al. [6, 9] can be found in the appendices.",
            "cite_spans": [
                {
                    "start": 480,
                    "end": 483,
                    "text": "[6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 484,
                    "end": 486,
                    "text": "9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Our primary goal in this paper is to demonstrate how previous results can be reached more directly via a minimal framework which is both conceptually and computationally simpler than those commonly used in the literature. Along the way, we are able to demonstrate the limitations and underlying assumption of these past models, and possible corrections and improvements -allowing us to model epidemics with more complex initial conditions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Consider a network of N connected nodes, each node representing a particular location. In our particular case these nodes will refer to cities, or, to be more specific, particular airports in the WAN. While traditionally one might model the spread of a disease on such a network using SIS, SIR dynamics or similar [17] , we are here interested only in the initial time of arrival at a given location, and not in the various non-linear effects observed as an epidemic saturates in a population after its arrival. We therefore model only the infected population, and neglect changes in the susceptible and recovered population (the S and R components of classical SIR dynamics).",
            "cite_spans": [
                {
                    "start": 314,
                    "end": 318,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Unbound Growth"
        },
        {
            "text": "We model the spread of infection within each population as unbound exponential growth, with some rate \u03b1 which accounts for both infection and recovery. We do not consider any manner of population size constraint either globally or locally. Our approach is thus similar to that used by Chen et al. [4] . In order to link our various sub-populations, we allow individuals to travel between nodes at some transition rate \u03b3F , where F is our 'flight matrix'. The off diagonal entries F i,j give the rate of travel from j to i, while the diagonal entries F i,i indicate the rate at which individuals leave location i, selected such that i F i,j = 0 for each source location j. Hence, F is mass preserving. The parameter \u03b3 is a simple scaling constant and gives the global rate of flying. It is assumed to be small relative to \u03b1, as the average infected individual does not travel on a daily basis, but is assumed to recover and/or infect others on that time scale. The expected number of infected individuals at a given location is thus governed by the equation:",
            "cite_spans": [
                {
                    "start": 297,
                    "end": 300,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "Unbound Growth"
        },
        {
            "text": "where x is a vector such that x i gives the expected number of infected individuals in location i. Unlike the various non-linear models used commonly throughout the literature, equation 3 can be solved explicitly using the matrix exponential:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Unbound Growth"
        },
        {
            "text": "x(t) = e \u03b1t e \u03b3F t x(0).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Unbound Growth"
        },
        {
            "text": "With this we can calculate \u03c4 i , the unbound-growth arrival time in location i, by solving the equation;",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(4)"
        },
        {
            "text": "x i (\u03c4 i ) = \u03c7.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(4)"
        },
        {
            "text": "Here \u03c7 is some arbitrarily defined 'epidemic threshold'; for our purposes it is assumed that x is normalized such that \u03c7 = 1. For any given initial conditions, x(0), the value of \u03c4 i will depend both on the epidemic growth rate \u03b1 and on our transition matrix \u03b3F . Unlike previous distance metrics [2, 9] , multiple starting points such as one might observe midway through an epidemic, are allowable (x(0) can have multiple non-zero entries).",
            "cite_spans": [
                {
                    "start": 297,
                    "end": 300,
                    "text": "[2,",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 301,
                    "end": 303,
                    "text": "9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "(4)"
        },
        {
            "text": "At this stage, we part ways with Chen et al. and their work. While Chen approximate e F t using powers of F , in what follows we will instead be solving the full equation (5) numerically, making use of eigenvector decomposition so as to efficiently calculate of all \u03c4 i for arbitrary x(0). Full details of these numerical methods are provided in Appendix A. If we restrict our focus to epidemics originating from a single location j (that is to say x(0) with a single non-zero entry at j), it is possible to calculate \u03c4 i,j , the expected epidemic travel time from j to i. Eigenvector decomposition allows for the calculation of all \u03c4 i,j in O(N 3 ) time. These costs are similar to those of determining all pairwise shortest path lengths, and are largely dominated by the eigenvector decomposition, which need only be calculated once for a given network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(4)"
        },
        {
            "text": "The unbound growth metric differs from effective distance in two major ways. The first is in the normalization of flight rates: while effective distance makes use of the flight probability matrix P , unbound growth considers the full transition matrix \u03b3F -in which flight intensity is explicitly considered. The second major differences is in how multiplicity of paths is considered: the effective distance is calculated using only the shortest path. The unbound growth arrival time is calculated from e \u03b3F t , and thus considers all possible paths through our flight network. In this section, we will illustrate the importance of these two differences through two toy examples.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "The contrast between using F and P matrices is best seen by considering a simple directed chain of three nodes. We consider the case where individuals flow from node A to node B at rate 1, and individuals transition from node B to node C at some dramatically reduced rate = 10 \u22124 . (see figure 1 )",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 287,
                    "end": 295,
                    "text": "figure 1",
                    "ref_id": null
                }
            ],
            "section": "Some Toy Examples"
        },
        {
            "text": "The lack of branching in our chain makes effective distance calculation rather straight forward; all transition probabilities are equal to either one or zero, and only a single path exists from A to C. Figure 1 : (Left) Sketch of small chain graph. Initial infection is assumed to take place in node A, the root node (blue). (Right) Flight matrix F of the small chain graph. Each column of the matrix represents the flow from the corresponding node.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 202,
                    "end": 210,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Some Toy Examples"
        },
        {
            "text": "Calculating x(t) explicitly for this chain we find:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "and hence \u03c4 B \u2248 \u2212log\u03b3/\u03b1 and \u03c4 C \u2248 \u2212(2 log \u03b3 + log )/\u03b1. In order to test these predictions, we compare to the results of a SIR model [10] , with reaction kinetics given by:",
            "cite_spans": [
                {
                    "start": 132,
                    "end": 136,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "For our simulation we consider a individual based model, in which all reactions take place according to a Poisson process, with rates \u03c1S i I i , \u03c3I i and \u03b3F ji I i respectively. Simulation is done using \u03c4 -leaping method [8] . The time of arrival of the first infected individual at node i we denote as T i . T i is a random variable, and our intention is to predict its expected value as accurately as possible.",
            "cite_spans": [
                {
                    "start": 221,
                    "end": 224,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "Comparing the observed arrival time, averaged over 500 simulations, with both the effective distance D and unbound-growth arrival time \u03c4 , we observe that normalizing away the rate of flow reduces the predictive power of our method (figure 2). That said, the discrepancy observed in the figure is the result of selecting \u03b3; for more realistic choices of F , where the normalization constants required for each columns do not vary across many orders of magnitude, P is a good approximation. In simulations where F can be known exactly, F is preferable, however, when comparing to real life data, F is, to some extent, unknowable, depending on both the number of flights taken from a particular airport each day, but also on the 'effective population' that said airport serves. Raw flight data alone is not enough to calculate F . In contrast P is easily calculated directly from simple flight data, and gives a good approximation of F up to a constant of proportionality. We now turn our attention to considering the effects of multiplicity of paths. In order to best observe this effect consider the case of a \"Spinning top\" graph, as depicted in figure 3 The spinning top graph consists of k + 4 nodes; a single central node (green) with no incoming edges, our initial site of infection, a 'top' and 'bottom' node with no outgoing edges (blue), a single \"up\" node directly between the center node and the top (red), and k \"down\" nodes between the center node and the bottom (yellow). Infected individuals in the central node will travel either up or down at a rate of \u03b3 -those travelling down select amongst the k 'down' nodes uniformly at random.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 1147,
                    "end": 1155,
                    "text": "figure 3",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Some Toy Examples"
        },
        {
            "text": "While the spinning top graph is neither the simplest case, nor the most realistic one, it is simple enough to remain analytically tractable, and acts as a clear illustration of several key distinctions between \u03c4 i and D ij .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "Calculating x(t) explicitly, we find",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "we see that the expected arrival at the top and bottom of our graph should be equal -indeed this is not surprising; because we exclude all non-linear effects the division of the 'down' compartment into k sub nodes has no effect on the behavior of the system. The behavior of the sum of all 'down' nodes is identical to the behavior of the single 'up' node. Hence we find that \u03c4 t = \u03c4 b \u2248 (2 log \u03b1 \u2212 2 log \u03b3)/\u03b1. The unbound-growth arrival time at each of the 'down' nodes is given by \u03c4 d \u2248 (log k \u2212 log \u03b3)/\u03b1. Unlike the case of effective distance, where the predicted order of arrival depends only on the geometry of the network, we see here that the order of \u03c4 t and \u03c4 d is dependent on the value of \u03b3 relative to 1/k.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": ": : Initial infection is assumed to take place in the center node (green). (Right) Flight matrix F of the Spinning top graph. Each column of the matrix represents the flow from the corresponding node. Infection spreads outwards from the initially infected \"center node\", both up and down towards the peripheries.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "Comparison of D and \u03c4 to simulations (see figure 4 ) demonstrates that effective distance distinguishes between the 'top' and 'bottom' node of the graph, while unbound growth correctly handles multiplicity of paths, and assigns the pair identical arrival times. We also see that \u03c4 i is also responsive to changes in \u03b3, and correctly predicts the change in expected order of arrival when \u03b3 is changed from 10 \u22122 to 10 \u22125 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 42,
                    "end": 50,
                    "text": "figure 4",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Some Toy Examples"
        },
        {
            "text": "Before moving on to the next section, it is worth emphasizing that both toy examples considered here have been explicitly crafted so as to highlight differences between our methods.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Some Toy Examples"
        },
        {
            "text": "The simple variable flow chain demonstrates that normalization of transport rates does lead to some loss of accuracy, but also that this loss of accuracy is likely to be negligible for realistic transport networks. The spinning top graph is constructed to demonstrate the importance of multiplicity of paths. In this case however, even in the minimal case k = 2, the effects of multiple paths are noticeable (see Fig. 13 , Appendix C).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 413,
                    "end": 420,
                    "text": "Fig. 13",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Some Toy Examples"
        },
        {
            "text": "While in our examples we have considered a particularly extreme case where multiplicity of paths causes the effective distance metric to break down, when dealing with more realistic graphs (such as the WAN), we observe that in many cases a single 'most likely' path does dominate the traffic for any given pair of nodes. Suppose such a dominant path does exist, and that this path consists of s steps. By approximating the matrix exponential by the dominant term in its fig. 3 . In all cases, we assume \u03b1 = \u03c1 = 0.5, \u03c3 = 0, k = 250, and \u03b3 as specified on our scatter plot. The initial susceptible population in each node is 80 million. Points are color coded so as to match the graph in figure  3 , that is to say, blue are top and bottom nodes, red represents our 'up' node, yellow our 'down' nodes, and green the initially infected 'center' node. power series, and then taking logarithms, we find",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 470,
                    "end": 476,
                    "text": "fig. 3",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 686,
                    "end": 695,
                    "text": "figure  3",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "Ignoring small terms and decomposing log(F s ij ) we find",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "where here F a,b represent transition rates along the most probable path. Hence, in the case of transmissions with a single dominant path, the unbound-growth arrival time we describe here implies a modified \"effective distance\" as a particular approximation. The logarithm first discussed by Brockmann & Helbing while introducing the effective distance can be seen to be a direct consequence of inverting exponential growth. The constant +1 is replaced by a \u2212 log \u03b3, more accurately reflecting where this constant term comes from, and how to adapt our distance measure in response to variable transport intensity. This modification is in line with the analytic work of previous authors [7] . Equation 14 can be thought of as a halfway point between the effective distance and the unbound growth arrival time -accounting correctly for rate of movement, but ignoring the issue of multiplicity of paths. The interested reader can find a comparison of this metric to various simulation results in appendix C.",
            "cite_spans": [
                {
                    "start": 686,
                    "end": 689,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 701,
                    "end": 703,
                    "text": "14",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "3 Comparison to simulations, past metrics, and real world data",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "As always, the purpose of mathematical modelling is to simplify our description of the universe as far as possible, but no further. In order to evaluate the validity of the rather drastic simplifications made thus far, we compare our predicted arrival time to both simulations and real world data. Let us start by considering the most straight forward and direct comparison; namely, how does the unbound growth metric compare to deterministic SIR dynamics on some arbitrary artificial network. We construct a scale free network [12] , and then simulate simple SIR dynamics (9) as a system of ODE's. As might be hoped, we observe near perfect correlation for the the unbound growth arrival time metric (see figure 5 ). This is to be expected, as the system we compare to is perfectly deterministic, and a close approximation to the equation that \u03c4 i is defined by. Figure 5 : Comparison of various distance metrics to the deterministic time at which I k (t) = 1. Each point represents a single node, with its y position determined by the predictions of a full SIR model, and the x coordinate given by one of three different prediction metrics. Color is determined by the 'number of steps' from our initial infection location. Here we consider a scale free network of 1500 nodes constructed using Mathew George's Scale-Free Network Generation tool [12] . Our epidemic parameters are \u03c1 = 0.5, \u03c3 = 0.25 and \u03b3 = 0.0001. Qualitatively similar results are obtained using other network structures. Different choices of Parameter values will either increase or reduce the R 2 value associated with the Effective Distance.",
            "cite_spans": [
                {
                    "start": 528,
                    "end": 532,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 1346,
                    "end": 1350,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [
                {
                    "start": 706,
                    "end": 714,
                    "text": "figure 5",
                    "ref_id": null
                },
                {
                    "start": 864,
                    "end": 872,
                    "text": "Figure 5",
                    "ref_id": null
                }
            ],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "We next compare to a significantly more intricate model-namely the stochastic global epidemic model GLEAMviz [3] . We make use of a standard epidemic model previously used to study H1N1 [1] , and consider a simple epidemic starting in Rio de Janeiro ( figure 6 ). We find that use of the matrix exponential rather than only the shortest path gives reasonable improvements, but also that both methods are still limited in their predictive power when faced with a truly stochastic model. We also note that these predictions were not made using the same underlying airline network as GLEAMviz uses internally; it is likely that the GLEAMviz team would find a tighter fit when making use of a adjacency network that perfectly matched their simulation. Finally, while comparison to simulations provides an effective test bed, useful in terms of repeatability, we are, generally speaking not interested in the results of simulation, but instead in the real world. We follow in the footsteps of Brockmann & Helbing [2] , and compare observed and predicted arrival time for both SARS and H1N1 (see figure 7) . We find that the unbound growth method gives results largely similar to the effective distance metric, with a slight improvement in R 2 value, given suitable \u03b1, \u03b3. Unfortunately, neither method is able to reproduce the very high R 2 values observed in the original paper. It is unclear if the observed discrepancies is due differences in implementation of the algorithm, differences in the underlying data, or some other cause. While it is possible that changes in the global flight network are to blame for these discrepancies, this explanation seems unlikely -increasing d i,j by one requires a 2.72 fold change in P i,j . Discrepancies greater than 5 require that P i,j change by more than two orders of magnitude between different flight networks. Such perturbations do not appear plausible.",
            "cite_spans": [
                {
                    "start": 109,
                    "end": 112,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 186,
                    "end": 189,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 1008,
                    "end": 1011,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 252,
                    "end": 260,
                    "text": "figure 6",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 1090,
                    "end": 1099,
                    "text": "figure 7)",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "Overall, it would appear that, when faced with the inherent stochasticity of the real world, both the unbound-growth arrival time, and all methods based on similar underling principles face significant difficulty. While we may effectively calculate the expected arrival time, the underlying variance in the system, and the exact details of the epidemic may lead to significant noise.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Derivation of modified effective distance"
        },
        {
            "text": "So far we have tested our unbound growth model in what may be considered close to optimal conditions; we have assumed that F ,\u03b1 and \u03b3 are all well known, that \u03b3 1 and \u03b1 \u2248 1 and that the susceptible population of each node is large enough that epidemic saturation is irrelevant. Each of the above assumptions may be violated in one context or another, and for this reason it is critical to understand how far each can be stretched before necessitating the use of a more complex model. Such understanding sheds light not only on the unboundgrowth arrival time itself, but also on the effective distance metric, which we have shown to rely on a similar theoretical foundation (see equation 14) The first, and most likely assumption to be violated in practice is the notion that we know \u03b1 and \u03b3. While \u03b3 can be determined to some reasonable level of accuracy via commercial flight data, \u03b1 is a number that will vary from illness to illness and may be known only to a limited degree of accuracy, particularly in the early stages of a pandemic. Fortunately the exponential model turns out to be robust against variations in both \u03b1 and \u03b3 -even when varying these parameters over an order of magnitude compared to the 'true' values used in simulations, predicted arrival times remain highly correlated with those observed in simulation (see figure 8 ). When using incorrect \u03b1 the constant of proportionality between \u03c4 i and observed arrival times is no longer equal to one, suggesting that the unbound growth model robustly estimates \u03b1\u03c4 i , such that the relative time of arrival at any two locations is largely independent of \u03b1 and \u03b3, but that incorrect estimates of \u03b1 will lead to corresponding inaccuracy in the absolute values of \u03c4 i ; if \u03b1 is estimated a factor of two high, then \u03c4 i will be a factor of two low. Errors in estimating \u03b3 have an even smaller impact -of the order log(\u03b3 true /\u03b3 est )/\u03b1-as is implied by eq. 14.",
            "cite_spans": [
                {
                    "start": 687,
                    "end": 690,
                    "text": "14)",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [
                {
                    "start": 1333,
                    "end": 1341,
                    "text": "figure 8",
                    "ref_id": null
                }
            ],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "Another systematic source of error is inaccuracies in our flight network data. These can be produced due to uncounted or unregistered flights (or other forms of transportation), out of date data, or as a direct result of changes to individual behavior during an epidemic (for example, quarantine measures, or panic amongst the populous). In order to test robustness to noise in our flight data, we compare the results of a full deterministic SIR model on some flight network F , to arrival times predicted using the perturbed matrixF , whereF ij = F ij e \u03beN (0,1) . We consider perturbations to both random and scale free networks (figure 9).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "We also consider how the unbound growth model might behave in cases where \u03b1 is very small-such as when dealing with diseases with slower spread and long incubation time such as HIV. In such a case, the time until the expected number of individuals at a location reaches one is generally large. Consider for example the extreme case \u03b1 = 0: we can easily imagine a single \"infected\" individual travelling throughout our network, its probability density slowly diffusing to steady state, and the expected number of infections never reaching x i (t) = 1 for any location. Despite this, each location will certainly have a time at which our single infected individual firsts arrives, and hence \u03c4 i = \u221e proves to be a Figure 2D ; we find that numerous details of the general shape are reconstructed (for example the four uppermost points have roughly the same geometry), but that the figure as presented in [2] is slanted significantly closer to a straight line. (Top Right) For suitably chosen \u03b1 and \u03b3 values, the unbound growth method gives slightly improved results, but is still limited by the accuracy of the underlying network, and the inherently noisy details of real world epidemiology. (Bottom) We compare effective distance and the unbound growth metric, with the SARS data. We were not able to reproduce the extremely tight correlation previously reported [2] . Once again, use of the unbound growth metric yields modest improvements in R 2 compared to our reconstruction the effective distance metric. The three filled nodes in these images corresponding to (from top to bottom) South Korea, Hong Kong, and the United States. As might be expected for distance measure based on flight data, both Korea and Hong Kong are 'close' to China according to both of metrics, while the USA is further away. This would appear to be in contrast to previously published results [2] , which appear to indicate that the United States is closest to China, while Korea is rather distant. These inconsistencies will be resolved with the original authors, after the present Pandemic situation has passed. Figure 8 : Calculating the unbound growth arrival time using incorrect growth and transport parameters leads to suboptimal results. Here, we consider the case of using \u03b1 and \u03b3 which are either an order of magnitude too high or to low compared to their true values (\u03b1 = 0.25, \u03b3 = 10 \u22124 ). Data is coloured according to the minimum number of steps required to reach the associated node from our starting location. As can be seen, while errors change the magnitude of our distance (note varying axis scales), the effect on relative distances is limited in eight of the nine cases considered, despite the significant error in parameter values. Figure 9 : (Top) Comparing the results of a full SIR simulation with the predictions made using a perturbed version of the original random network, we are still able to accurately predict 'arrival time', indicating that the method is robust even when link weights are increased or decreased by an order of magnitude. As previously, nodes are colour coded based on the number of steps to the initial infection site. Note that here, after noise is applied to calculateF , we demand symmetry, and recalculate diagonal entries so as to preserve mass. (Bottom) As above, but here we consider perturbations to a random scale free network. The structure of the network leads to a sharper separation based on \"number of steps\", but overall exhibits a roughly similar response to to noise; namely significant noise in F is required to damage the predictive power of the unbound-growth metric. Note that here we are comparing to a deterministic SIR model; this is done so as to highlight inaccuracies caused by changes to F , while ignoring the more general effects of noise. rather poor estimate. This breakdown of \u03c4 i can be seen in figure 10 .",
            "cite_spans": [
                {
                    "start": 901,
                    "end": 904,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 1361,
                    "end": 1364,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 1871,
                    "end": 1874,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 712,
                    "end": 721,
                    "text": "Figure 2D",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 2092,
                    "end": 2100,
                    "text": "Figure 8",
                    "ref_id": null
                },
                {
                    "start": 2732,
                    "end": 2740,
                    "text": "Figure 9",
                    "ref_id": null
                },
                {
                    "start": 3857,
                    "end": 3866,
                    "text": "figure 10",
                    "ref_id": null
                }
            ],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "At this juncture, it becomes obvious that the unbound-growth arrival time proposed in equation 5 gives poor results when \u03b1 is sufficiently small. We thus seek modifications to render the method more robust. So far, our approach has relied upon using x(t), a vector containing expected infected population in each location, in order to estimate T i , the time at which the first infection is imported. More accurate results can be obtained by instead calculating the expected number of imported infections. Define y(t), to be the vector valued function for the expected number of imported infections at a given location prior to time t. The rate of infection importation is given b\u1e8f",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "whereF is equal to the flight matrix F , except that all diagonal elements are replaced by zero. We thus see that y(t) counts the number of arrivals in each location but not departures nor infections. The system of equations formed by equations 3 and 15 can be re-written as a single matrix differential equation:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "This equation can be solved for any given time using the matrix exponential, which can be calculated efficiently so long as the eigen-decomposition is known. If we make the (somewhat dubious) assumption that the actual number of arrivals is a Poisson distributed random variable, then the probability of zero arrivals by a given time is given by e \u2212y(t) . The expected time for the first arrival can be found using:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "This formula gives more robust results than eq. 5, all be it at a higher computational cost. Here we have made use of similar techniques to a number of past papers in the literature [6, 9] , all be it in a different order. Theoretical discussion comparing equation 17 to these papers, along with a detailed explanation of efficient calculation of \u03c4 + i is provided in Appendix B. Regardless of the algorithm used, calculation of y i (t) and the corresponding integral comes at non-trivial computationally cost. In cases where \u03b1 \u03b3 the more detailed method gives negligible improvements compared to equation (5) , and the original unbound growth arrival time based only on x is recommended. In cases where \u03b1 is small and \u03c4 i gives poor predictions, \u03c4 + i can be used to obtain more robust results (see figure 10) .",
            "cite_spans": [
                {
                    "start": 182,
                    "end": 185,
                    "text": "[6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 186,
                    "end": 188,
                    "text": "9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 606,
                    "end": 609,
                    "text": "(5)",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [
                {
                    "start": 800,
                    "end": 810,
                    "text": "figure 10)",
                    "ref_id": null
                }
            ],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "Finally, while we have demonstrated the effectiveness of the exponential growth model when applied on the scale of the global aviation network, effective distance measures have also been considered on a much smaller scale in order to study the spread of antibiotic resistance between wards within a hospital [5] . In this case, assuming unbound growth becomes problematic, as the susceptible population in each node is rather small; a single ward might contain (for example) 30 beds, a far cry from the tens or hundreds of thousands found when each node represents an entire city. 16 ,17) . In all cases, we consider a random network of 600 nodes, arrival times are averaged over 500 simulations. In each case we provide both the R 2 value, and the computational time required to find the given metric. We observe that for \u03b1 \u03b3 (top row) all three metrics give reasonable results, with the two unbound-growth based methods giving a noticeable increase in accuracy. However, for \u03b1 \u2248 \u03b3 (bottom row), the simple unbound growth method based on equation 5 breaks down, and equations 16 and 17 are required for accurate prediction. where the susceptible population in each node has mean 8.5. We assume infection rate \u03c1 = 2.5, and recovery rate \u03c3 = 0. Note that for small populations, \u03c3 > 0 generally leads to extinction, particularly when \u03b3 < \u03c3.",
            "cite_spans": [
                {
                    "start": 308,
                    "end": 311,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 581,
                    "end": 588,
                    "text": "16 ,17)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "In such cases, where the local susceptible population is very small, we may encounter situations where our local epidemic is no longer in exponential growth phase by the time it spreads to a neighbouring node. Small population sizes also increase the importance of stochastic effects. This may, in certain cases lead to our simplified model being inaccurate (see figure 11 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 363,
                    "end": 372,
                    "text": "figure 11",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "In practice, for the SIR type models the parameter window where this concern is relevant is relatively narrow; infections which grow quickly enough to violate our assumptions are liable to burn through the entire local population and drive themselves to extinction before spreading. For SIS and SI type models, or any infection which is expected to reach a local endemic equilibrium, it is important to determine whether exponential growth is a good approximation before making use of the unbound-growth arrival time, or any effective distance metric that relies upon the same underlying assumptions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Robustness, Limitations and Extensions"
        },
        {
            "text": "Detailed, multi-compartment epidemic models allow us to answer a wide range of questions, at the cost of additional complexity. In cases where we have a particular question in mind, simpler models will suffice, and knowing which details to include and which to ignore provides not only convenience, but also insight into the driving factors behind the phenomena we wish to study.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "In studying epidemic arrival time in the world aviation network, it turns out that we need only two ingredients: transport and exponential growth. As indicated by Chen et al. we can ignore the more complex non-linear dynamics of saturation and recovery [4] , as might be encountered in an SIR model, and need only consider a simple \"single compartment\" epidemic model; one that is ana-lytically tractable yet nonetheless predicts the expected arrival times observed by more complicated models, both deterministic and stochastic.",
            "cite_spans": [
                {
                    "start": 253,
                    "end": 256,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "In using this simple unbound-growth model, we are able to explicitly state the assumptions underlying previously described effective distance measures: namely that the wave front is perpetually in its \"exponential growth\" phase during which non-linear effects are irrelevant, and thus arrival time is governed entirely by system dynamics in a naive population. In the language of both ecology and physics, we are dealing with a \"pulled wave\" phenomena [11, 15] , or alternatively \"linear spreading theory\" [4] . While here we have discussed these phenomena purely in the context of epidemic spread through the global flight network, it seems likely that a similar framework might apply when studying any suitable spreading phenomena in networks -for example the spreading of rumours through online communities [13] , or the spread of invasive species between distant ports [14] .",
            "cite_spans": [
                {
                    "start": 452,
                    "end": 456,
                    "text": "[11,",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 457,
                    "end": 460,
                    "text": "15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 506,
                    "end": 509,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 810,
                    "end": 814,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 873,
                    "end": 877,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "In identifying the assumptions implicitly underlying past methods, and considering an explicit model, we are able to demonstrate both the robustness and limitations of the proposed model, and provide alternative methods that remain effective in parameter regime where the simple \"unbound-growth\" model is demonstrated to give poor results.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Unfortunately, our attempts to reproduce past results appear to indicate that in practice, the predictive powers of effective distance metrics may be significantly lower than previously reported [2] -a disappointing, though not entirely unexpected result given the complexity and contingent nature of global epidemic spread. Knowledge of the WAN allows foresight, but can only be relied on for limited predictive power; when comparing to 'best practice' simulations we find that such simple methods such as those described here predict roughly 60% of variance, when compared to real world date, this predictive power reduces to 50% in the cases of H1N1, and a mere 30% in the case of SARS. Noise and chance are, as always, powerful forces within our world.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "A Computationally efficient methods for solving equation (5) In order to determine the arrival time, \u03c4 i , it is necessary to solve",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "here, \u03c7 is an arbitrarily choosen thresholed, assumed to be normalized to 1 and v i t is an indicator vector of the form [0, 0...1, 0...0] such that all entries are zero, save for the i th , which is one.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Generally speaking, this equation can not be solved exactly, and must instead be solved using numerical methods. Because e \u03b1t varies far faster than v i t e \u03b3F t x(0), we can form a simple iteration scheme by asserting",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Because e \u03b3F \u03c4 (n)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "i \u2248 e \u03b3F \u03c4 (n+1) i this iteration is almost equivalent to solving the exact equation, and converges quickly. Computing the matrix exponential however is a costly operation, one we would prefer to streamline wherever possible. To this end, it proves useful to first decompose of F using its eigenvectors: F = QDQ \u22121 . Here Q is a matrix such that each column contains an eigenvector of F , and D is a diagonal matrix containing the eigenvalues of F in corresponding order. We can then compute:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Because D is a diagonal matrix e \u03b3D\u03c4 (n) i can be computed using an elementwise exponentiation of only the diagonal terms, as opposed to full matrix exponentiation. All matrix-vector multiplications can be replaced by suitable vectorvector multiplications. (Q \u22121 x(0)) need only be computed once, and (v i t Q) is equivalent to examining the i th row of Q. Eigenvalue decomposition, the most costly operation involved in this procedure need only be computed once ever for a given F , and need not be repeated when varying \u03b1, \u03b3, i or x(0).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Suitable matlab code for the above iteration scheme is given by: B Computationally efficient methods for solving equation (17) , and a comparison to Gautreau and Iannelli",
            "cite_spans": [
                {
                    "start": 122,
                    "end": 126,
                    "text": "(17)",
                    "ref_id": "BIBREF16"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "In order to determine the improved unbound growth arrival time, \u03c4 + i , we must first have an efficient and reliable way of calculating y(t), and then use this method to approximate e \u2212yi(t) dt as accurately as possible.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B.1 Computationally Efficient Code"
        },
        {
            "text": "Calculation of y(t) can be completed using a similar approach to our calculation of x(t) -namely, we determine the eigendecomposition of the relevant 2N \u00d72N matrix (see equation 16) , and then use this eigendecomposition to take matrix exponentials using only vector-vector multiplication rather than matrixmatrix multiplication. We can avoid solving the 2N \u00d7 2N eigendecomposition problem by noting:",
            "cite_spans": [
                {
                    "start": 178,
                    "end": 181,
                    "text": "16)",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "B.1 Computationally Efficient Code"
        },
        {
            "text": "where D is a diagonal matrix containing the eigenvalues of F , Q is a full rank matrix containing the corresponding eigenvectors, and Q = (D + \u03b1/\u03b3) \u22121F Q.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B.1 Computationally Efficient Code"
        },
        {
            "text": "The expanded system has the same eigenvalues as the original system, along with N additional zeros. We find y(t) = Q exp(\u03b1t) exp(\u03b3Dt)Q \u22121 x(0). Now that we have an method for calculating y(t) we would like to calculate e \u2212yi(t) dt as efficiently as possible. This process is made significantly easier by first noting that for each i, as y i (t) passes through 1, it can be well approximated by a simple exponential growth function, that is to say, there exists some \u03b2 i , \u00b5 i such that y i (t) \u2248 exp[\u2212(t \u2212 \u00b5 i )/\u03b2 i ] in the vicinity of \u00b5 i . Because P (t < T i ) \u2248 1 when y i 1, and P (t < T i ) \u2248 0 when y i 1, we can safely use this exponential approximation of y with negligible impact on e \u2212yi(t) dt. In making this approximation we effectively assert that T i is well approximated by a Gumbel distribution: P (t < T ) \u2248 e \u2212 exp((t\u2212\u00b5i)/\u03b2i) . The Gumbel distribution has expected value \u00b5 i + 0.5772\u03b2 i . Hence, \u03c4 + i can be approximated using knowledge only of the time and slope with which y i crosses 1. The following code implements these calculations in an efficient manner. %Set up initial value, and matrix for finding slope. SlopeFinder= (F-diag(diag(F)))*[V,zeros(NumCities,NumCities)]; InfectedLevel=zeros(2*NumCities,1); InfectedLevel(1)=1; initV= Vbeta\\InfectedLevel; %Variables will be stored here. GumbelMu=-ones(NumCities,1); GumbelBeta=-ones(NumCities,1);; %We will consider a number of times as starting points for finding Mu. t=0; dt=0.5*(log(Threshold)-log(gam))/(alpha-recoveryRate); order of operations we simplify our work conceptually, and reduce computational time significantly. The resulting prediction however must be considered, at best, a heuristic, and unlike Gautreau, Iannelli et al. we make no claims of mathematical rigor.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B.1 Computationally Efficient Code"
        },
        {
            "text": "In practice, using the unbound-growth metric, we observe results similar to those found using Iannelli at al's methods (see figure 12 ). In addition, the improved unbound growth metric presented here appears to be more robust, in that it gives accurate results even in the case \u03b1/\u03b3 \u2248 1, where both Iannelli's technique and the basic-unbound growth method suffer difficulties. Figure 12 : For a random network containing 4000 nodes, we compare the average arrival time (averaged over 350 simulations), to time predicted using effective distance [2] , Ianelli's 'log inverse' formula (equation 25), and the improved unbound growth arrival time. In all cases, R 2 values, and calculation times are provided-calculation times given in seconds. Nodes are colour coded based on their 'number of steps' from the epidemic origin. As can be seen, Ianelli's technique and the improved unbound growth estimates give very similar predictions, however, the later is observed to be roughly 80 times faster.",
            "cite_spans": [
                {
                    "start": 544,
                    "end": 547,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 124,
                    "end": 133,
                    "text": "figure 12",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 376,
                    "end": 385,
                    "text": "Figure 12",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "B.1 Computationally Efficient Code"
        },
        {
            "text": "Here we provide a number of additional figures, that may be of interest to some readers, but are not of enough importance to place in the main text. Figure 13 : A repetition of our Spinning top graph experiment, with k = 2. Here we plot mean arrival time (averaged over 150 simulations) vs either effective distance, D, or unbound growth arrival time, \u03c4 i , for the Spinning top graph depicted in fig. 3 . In all cases, we assume \u03b1 = \u03c1 = 0.5, \u03c3 = 0, k =, and \u03b3 as specified on our scatter plot. Figure 14 : Here we compare the predictions of effective distance and the unbound-growth arrival time to those observed for a deterministic SIR modelin a manner similar to figure 5 of the main text. In contrast to the scale free network used for that figure, here we consider a random network, where, for each node we select five other nodes uniformly at random to link it to, and then impose symmetry by making all edges bidirectional. All nodes have an initial susceptible population of S = 10 9 . We use the parameter values \u03c1 = \u03b1 = 0.5 and \u03c3 = 0. For the two top figures we select \u03b3 = 10 \u2212 5, and for the lower two we select \u03b3 = 10 \u2212 8. We observe that the performance of the effective distance is sensitive to \u03b3, and that in this deterministic case the unbound growth arrival time gives near perfect prediction. Here we compare to the deterministic SIR simulations on a random network, as shown in figure 14 . The Modified effective distance gives strong predictions. The 'line separation' is generated as a result of the ignored \u2212s log t. (Middle) Comparison to results of our GLEAMviz simulation (as described in figure 6 ). As can be seen, the use of \u2212 log \u03b3 and F as opposed to 1 and P significantly improves the accuracy of the method, however the existence of multiple paths still results in the unbound growth model giving slightly better results. (Bottom) Here we compare the modified effective distance to real world data for H1N1 and SARS. Surprisingly, in this case, results are worse than those obtained by Brockmann & Helbing's original effective distance.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 149,
                    "end": 158,
                    "text": "Figure 13",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 397,
                    "end": 403,
                    "text": "fig. 3",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 495,
                    "end": 504,
                    "text": "Figure 14",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1398,
                    "end": 1407,
                    "text": "figure 14",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1615,
                    "end": 1623,
                    "text": "figure 6",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "C Some additional figures"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Human Mobility Networks, Travel Restrictions, and the Global Spread of 2009 H1N1 Pandemic",
            "authors": [
                {
                    "first": "Paolo",
                    "middle": [],
                    "last": "Bajardi",
                    "suffix": ""
                },
                {
                    "first": "Chiara",
                    "middle": [],
                    "last": "Poletto",
                    "suffix": ""
                },
                {
                    "first": "Jose",
                    "middle": [
                        "J"
                    ],
                    "last": "Ramasco",
                    "suffix": ""
                },
                {
                    "first": "Michele",
                    "middle": [],
                    "last": "Tizzoni",
                    "suffix": ""
                },
                {
                    "first": "Vittoria",
                    "middle": [],
                    "last": "Colizza",
                    "suffix": ""
                },
                {
                    "first": "Alessandro",
                    "middle": [],
                    "last": "Vespignani",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "PLOS ONE",
            "volume": "6",
            "issn": "1",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "The Hidden Geometry of Complex, Network-Driven Contagion Phenomena",
            "authors": [
                {
                    "first": "Dirk",
                    "middle": [],
                    "last": "Brockmann",
                    "suffix": ""
                },
                {
                    "first": "Dirk",
                    "middle": [],
                    "last": "Helbing",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Science",
            "volume": "342",
            "issn": "6164",
            "pages": "1337--1342",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "The GLEaMviz computational tool, a publicly available software to explore realistic epidemic spreading scenarios at the global scale",
            "authors": [
                {
                    "first": "Wouter",
                    "middle": [],
                    "last": "Van Den Broeck",
                    "suffix": ""
                },
                {
                    "first": "Corrado",
                    "middle": [],
                    "last": "Gioannini",
                    "suffix": ""
                },
                {
                    "first": "Bruno",
                    "middle": [],
                    "last": "Gon\u00e7alves",
                    "suffix": ""
                },
                {
                    "first": "Marco",
                    "middle": [],
                    "last": "Quaggiotto",
                    "suffix": ""
                },
                {
                    "first": "Vittoria",
                    "middle": [],
                    "last": "Colizza",
                    "suffix": ""
                },
                {
                    "first": "Alessandro",
                    "middle": [],
                    "last": "Vespignani",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "BMC Infectious Diseases",
            "volume": "11",
            "issn": "1",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Estimating epidemic arrival times using linear spreading theory",
            "authors": [
                {
                    "first": "Lawrence",
                    "middle": [
                        "M"
                    ],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "Matt",
                    "middle": [],
                    "last": "Holzer",
                    "suffix": ""
                },
                {
                    "first": "Anne",
                    "middle": [],
                    "last": "Shapiro",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Chaos",
            "volume": "28",
            "issn": "1",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Network analysis as a tool to improve infection prevention & outbreak management",
            "authors": [
                {
                    "first": "Friso",
                    "middle": [],
                    "last": "Coerts",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Arrival Time Statistics in Global Disease Spread",
            "authors": [
                {
                    "first": "Aurelien",
                    "middle": [],
                    "last": "Gautreau",
                    "suffix": ""
                },
                {
                    "first": "Alain",
                    "middle": [],
                    "last": "Barrat",
                    "suffix": ""
                },
                {
                    "first": "Marc",
                    "middle": [],
                    "last": "Barthelemy",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Journal of Statistical Mechanics: Theory and Experiment",
            "volume": "",
            "issn": "09",
            "pages": "9001--09001",
            "other_ids": {
                "arXiv": [
                    "arXiv:0707.3047"
                ]
            }
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Global disease spread: statistics and estimation of arrival times",
            "authors": [
                {
                    "first": "Aurelien",
                    "middle": [],
                    "last": "Gautreau",
                    "suffix": ""
                },
                {
                    "first": "Alain",
                    "middle": [],
                    "last": "Barrat",
                    "suffix": ""
                },
                {
                    "first": "Marc",
                    "middle": [],
                    "last": "Barthelemy",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Journal of Theoretical Biology",
            "volume": "251",
            "issn": "3",
            "pages": "509--522",
            "other_ids": {
                "arXiv": [
                    "arXiv:0801.1846"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Approximate accelerated stochastic simulation of chemically reacting systems",
            "authors": [
                {
                    "first": "Daniel",
                    "middle": [
                        "T"
                    ],
                    "last": "Gillespie",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "The Journal of Chemical Physics",
            "volume": "115",
            "issn": "4",
            "pages": "1716--1733",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Philipp Hoevel, and Igor M. Sokolov. Effective Distances for Epidemics Spreading on Complex Networks",
            "authors": [
                {
                    "first": "Flavio",
                    "middle": [],
                    "last": "Iannelli",
                    "suffix": ""
                },
                {
                    "first": "Andreas",
                    "middle": [],
                    "last": "Koher",
                    "suffix": ""
                },
                {
                    "first": "Dirk",
                    "middle": [],
                    "last": "Brockmann",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "95",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1608.06201"
                ]
            }
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A contribution to the mathematical theory of epidemics",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "William Ogilvy Kermack",
                    "suffix": ""
                },
                {
                    "first": "Gilbert",
                    "middle": [
                        "Thomas"
                    ],
                    "last": "Mckendrick",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Walker",
                    "suffix": ""
                }
            ],
            "year": 1927,
            "venue": "Proceedings of the Royal Society of London. Series A, Containing Papers of a Mathematical and Physical Character",
            "volume": "115",
            "issn": "772",
            "pages": "700--721",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Finding the sweet spot for invasion theory",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Mark",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Lewis",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Proceedings of the National Academy of Sciences",
            "volume": "113",
            "issn": "25",
            "pages": "6819--6820",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "B-A Scale-Free Network Generation and Visualization",
            "authors": [
                {
                    "first": "Mathew",
                    "middle": [],
                    "last": "George",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Statistical mechanics of rumour spreading in network communities",
            "authors": [
                {
                    "first": "Massimo",
                    "middle": [],
                    "last": "Ostilli",
                    "suffix": ""
                },
                {
                    "first": "Eiko",
                    "middle": [],
                    "last": "Yoneki",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [
                        "Y"
                    ],
                    "last": "Ian",
                    "suffix": ""
                },
                {
                    "first": "Jose",
                    "middle": [
                        "F F"
                    ],
                    "last": "Leung",
                    "suffix": ""
                },
                {
                    "first": "Pietro",
                    "middle": [],
                    "last": "Mendes",
                    "suffix": ""
                },
                {
                    "first": "Jon",
                    "middle": [],
                    "last": "Li\u00f3",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Crowcroft",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Procedia Computer Science",
            "volume": "1",
            "issn": "1",
            "pages": "2331--2339",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "The risk of marine bioinvasion caused by global shipping",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Seebens",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "T"
                    ],
                    "last": "Gastner",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Blasius",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Ecology Letters",
            "volume": "16",
            "issn": "6",
            "pages": "782--790",
            "other_ids": {
                "DOI": [
                    "10.1111/ele.12111"
                ]
            }
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Front propagation into unstable states",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Wim Van Saarloos",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Physics Reports",
            "volume": "386",
            "issn": "2",
            "pages": "29--222",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Around the World in Eighty Days. Porter & Coates, 1873. Google-Books-ID: sd06RZq4mN4C",
            "authors": [
                {
                    "first": "Jules",
                    "middle": [],
                    "last": "Verne",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Spatial epidemiology of networked metapopulation: An overview. bioRxiv",
            "authors": [
                {
                    "first": "Lin",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "Xiang",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "WHO | Situation updates -Avian influenza",
            "authors": [],
            "year": 2009,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "WHO. Novel Coronavirus (2019-nCoV) situation reports",
            "authors": [],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Graphs of mean arrival time (averaged over 500 simulations) vs either effective distance, D, or unbound growth arrival time, \u03c4 i , for the short chain depicted infig. 1. We assume \u03b1 = \u03c1 = 0.5, \u03c3 = 0, \u03b3 = 10 \u22122 and = 10 \u22124 . The initial susceptible population in each node is 80 million. Points are color coded so as to match the graph in figure 1.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "(Left) Sketch of transportation network for the 'Spinning top graph'. Nodes are colour coded by arrival time, and are referred to as 'top', 'up', 'center','down' and 'bottom' -these we abbreviate as t, u, c, d and b in the algebra.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Graphs of mean arrival time (averaged over 150 simulations) vs either effective distance, D, or unbound growth arrival time, \u03c4 i , for the Spinning top graph depicted in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Simulated arrival time at each airport, compared with either effective distance (Left) or unbound-growth based predictions (Right). Each node represents a single airport/city. Nodes are colour coded by the number of flights to reach them from the epidemic origin. Here we depict a single epidemic originating in Rio de Janeiro. Simulation conducted with the Agent Based global epidemic model GLEAMviz[3], Epidemic definition as given by Bajardi et al.[1]. Comparing to the arrival times averaged over 40 simulations gives modest improvements in R 2 values (0.429 and 0.669, respectively).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "(Top) We use data provided by Dirk Brockman (Private correspondence) to examine the predictive power of effective distance, and unbound growth predictions on arrival time in real world epidemics. (Top Left) We attempt to reconstruct",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Comparison of the average epidemic arrival time to three different prediction methods. (Left) we use effective distance, as described in equation 2. (Middle) we use the simple unbound growth arrival time, as calculated using equation 5. (Right) We use similar unbound growth methods, but track both the current expected population x as well as the expected number of immigrant infections y (equations",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "When populations are very small, the exponential growth assumption that the unbound growth arrival time relies upon no longer gives accurate predictions. Here we plot the effective distance (equation 2), unbound-growth arrival time (equation 5), and improved unbound-growth arrival time (equation 17) vs the average results of 150 simulations on a random graph of 3000 nodes,",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "%%Set up [Q,D_original] =eig(F); D= gamma * diag(D_original); %D is a vector of length N containing eigenvalues. initQ= Q\\x0; %initQ is a vector of length N, and is the ''eigenimage'' of x0. Tk=-ones(N,1); Threshold=1; for(ccc=1:N) guessT= (log(Threshold)-log(gamma))/alpha deltaT=5; while(abs(deltaT)>10^-3) expGammaF= Q(ccc,:)* (exp(D*guessT).*initQ); deltaT= (log(Threshold)-log(expGammaF))/alpha-guess; guessT= (log(Threshold)-log(expGammaF))/alpha; end Tk(ccc)=guessT; endThe computational cost of the above code is overwhelmingly dominated by eig(M), and hence the runtime scales like O(n 3 ), similar to the Floyd-Warshall algorithm as might be used to identify shortest paths when calculating effective distances.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "(V.*D' -diag(F).*V )./(gam*D'+alpha));; Vbeta=[V,zeros(NumCities,NumCities); vbetaSmall,eye(NumCities,NumCities)];",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "Here we compare the modified effective distance given in equation 14 to a number of the observed arrival times from throughout this paper.(Top)",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": [
        {
            "text": "while(min(GumbelMu)==- 1) t=t+dt; %Determine y. Select y which are close to y=1. y=Vbeta(((NumCities+1):end),:)*(exp(Dbeta*t).*initV); select= (GumbelMu==-1)&(y>=0.3);%Find slope for selected y. Use this slope to find mu more effectively. GumbelBeta(select)= (SlopeFinder(select,:)*(exp(Dbeta*t).*initV))./y(select); GumbelMu(select)= t-log(wob(select))./GumbelBeta(select); end tauPlus=GumbelMu-0.5772./GumbelBeta; %Use mu, and slope to find tau. tauPlus(1)=0;",
            "cite_spans": [
                {
                    "start": 23,
                    "end": 25,
                    "text": "1)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "annex"
        },
        {
            "text": "Our assumptions and methodology here have made use of many of the insights of Gautreau et al [7] and Iannelli et al [9] , all be it in a different order, and while such technical discussion would be out of place in the main body of this paper, we would be remiss not to highlight these past works her.Gautreau et al. demonstrated in their 2008 paper that the time taken for an infection to pass from one city to a neighbouring city was distributed according to a Gumbel distribution: P (t < T ) = e \u2212 exp((t\u2212\u00b5)/\u03b2) . This is most easily interpreted as an outer exponential resulting from the underlying Poisson like process of disease spread, and the inner exponential as the result of the ever increasing force of infection. Gautreau et al.'s approach can be used to formulate a modified 'direct distance; based on expected value of the Gumbel distribution, and these distances can be summed along shortest paths in order to estimate arrival times. Gautreau et al. thus arrive at results rather similar to our equation 14. In cases where there are multiple paths connect nodes i and j, the multiplicity of paths causes shortest path methods to overestimate arrival time. Gautreau et al provide a formula for predicting the expected arrival time given two parallel paths:Iannelli et al. were subsequently able to provide a formula for combining all paths joining a pair of nodes:Here P \u00acj,\u00acj represents the probability sub matrix with the j th row and column excluded, P \u00acj,j represents the j th column of P with the j th row excluded, and C = log(\u03b1/\u03b3) \u2212 0.57721. This formula is given as formula 28 in Iannelli et al.'s paper [9] . While very effective, this formula is also rather expensive computationally, requiring j separate large matrix divisions. Overall, the methods presented in this paper can be seen as a simple reversal of the operations used by Gautreau, Iannelli et al. Rather than calculate step times, and then combine the effects of multiple paths, we instead use the matrix exponential to consider all possible paths, and integrate over our Gumbel-like probability distribution only as our final step. In swapping the",
            "cite_spans": [
                {
                    "start": 93,
                    "end": 96,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 116,
                    "end": 119,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1019,
                    "end": 1022,
                    "text": "14.",
                    "ref_id": null
                },
                {
                    "start": 1626,
                    "end": 1629,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "B.2 Comparison to past methods"
        }
    ]
}