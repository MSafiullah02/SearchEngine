{
    "paper_id": "6132d8bfd92a6155b096884746ec4d82eafd0b53",
    "metadata": {
        "title": "A simple criterion to design optimal nonpharmaceutical interventions for epidemic outbreaks",
        "authors": [
            {
                "first": "Marco",
                "middle": [
                    "Tulio"
                ],
                "last": "Angulo",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad Nacional Aut\u00f3noma de M\u00e9xico",
                    "location": {
                        "settlement": "Juriquilla",
                        "country": "M\u00e9xico"
                    }
                },
                "email": "*mangulo@im.unam.mx"
            },
            {
                "first": "Fernando",
                "middle": [],
                "last": "Casta\u00f1os",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "CINVESTAV-IPN",
                    "location": {
                        "settlement": "Ciudad de M\u00e9xico",
                        "country": "M\u00e9xico"
                    }
                },
                "email": ""
            },
            {
                "first": "Jorge",
                "middle": [
                    "X"
                ],
                "last": "Velasco",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad Nacional Aut\u00f3noma de M\u00e9xico",
                    "location": {
                        "settlement": "Juriquilla",
                        "country": "M\u00e9xico"
                    }
                },
                "email": ""
            },
            {
                "first": "Jaime",
                "middle": [
                    "A"
                ],
                "last": "Moreno",
                "suffix": "",
                "affiliation": {
                    "laboratory": "Mata for helpful discussions",
                    "institution": "Universidad Nacional Aut\u00f3noma de M\u00e9xico",
                    "location": {
                        "settlement": "Ciudad de M\u00e9xico",
                        "country": "M\u00e9xico"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "To mitigate the COVID-19 pandemic, much emphasis exists on implementing non-pharmaceutical interventions to keep the reproduction number below one. But using that objective ignores that some of these interventions, like bans of public events or lockdowns, must be transitory and as short as possible because of their significative economic and societal costs. Here we derive a simple and mathematically rigorous criterion for designing optimal transitory non-pharmaceutical interventions. We find that reducing the reproduction number below one is sufficient but not necessary.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Instead, our criterion prescribes the required reduction in the reproduction number according to the maximum health services' capacity. To explore the implications of our theoretical results, we study the non-pharmaceutical interventions implemented in 16 cities during the COVID-19 pandemic. In particular, we estimate the minimal reduction of the contact rate in each city that is necessary to control the epidemic optimally. We also compare the optimal start of the intervention with the start of the actual interventions applied in each city. Our results contribute to establishing a rigorous methodology to guide the design of non-pharmaceutical intervention policies.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Since the seminal work of May and Anderson 1 , the design of interventions to eradicate infectious diseases has the objective of achieving a basic reproduction number R 0 below one. 2, 3 The underlying assumption here is that interventions like vaccination programs can be maintained for long periods, producing near permanent changes to the epidemic dynamics. This same objective is guiding the design of non-pharmaceutical interventions (NPIs) for the COVID-19 pandemic 4 . Yet, maintaining NPIs like bans of public events or lockdowns for long periods is infeasible because of their substantial economic and societal costs 5, 6 . In this sense, the objective of NPIs cannot be to eradicate a disease; rather, they aim to mitigate the economic and social costs of the epidemic outbreak 7 . However, as evidenced by the world's controversies during the COVID-19 pandemic, we still lack simple guidelines to design NPIs for mitigating epidemic outbreaks, analogous to the R 0 < 1 condition for eradication.",
            "cite_spans": [
                {
                    "start": 182,
                    "end": 184,
                    "text": "2,",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 185,
                    "end": 186,
                    "text": "3",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Here we use the classical Susceptible-Infected-Removed epidemiological model to fully characterize the design of NPIs for mitigating epidemic outbreaks. For this, we consider that NPIs should achieve an optimal tradeoff between two objectives 8 . First, optimal NPIs must minimize the period in which they need to be applied, consequently minimizing their associated economic and societal costs. Second, optimal NPIs must guarantee that the number of infections does not exceed the health services' capacity, avoiding unnecessary deaths due to a saturated health system 9 . We obtain a full analytical characterization of such optimal NPIs, specifying the reduction in the disease transmission that is optimal for each state in which an epidemic can be. Furthermore, this characterization yields the necessary and sufficient criterion for the existence of optimal NPIs, analogous to the R 0 < 1 condition. We find that reducing the reproduction number below one is sufficient but not necessary for their existence. Instead, our criterion shows that the maximum health services' capacity determines the necessary reduction in the reproduction number. The consequence of not reducing the reproduction number below one is that interventions must start before the disease prevalence reaches the maximum health services' capacity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "We explore the implications of our theoretical result by analyzing the response of 16 cities across the globe to the COVID-19 pandemic. We find that most cities achieved a larger-than-necessary reduction in transmission. We also compare the actual start of the NPIs in each city with the optimal start obtained from our analysis, finding that most cities responded before it was necessary. Our results contribute to understanding how to best respond to an epidemic outbreak using non-pharmaceutical interventions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Our objective is to characterize the reduction in the disease transmission that is optimal for each state in which the epidemic outbreak can be. In the classical Susceptible-Infected-Removed model, the state 2 can be characterized by the pair (S, I) \u2208 [0, 1] 2 , where I is the disease prevalence (i.e., proportion of the population that is infected) and S the proportion of the population that is susceptible to the disease (Fig.   1a ). We discuss later other more detailed epidemic models. The epidemic state changes with time t as the disease is transmitted, producing the trajectory (S(t), I(t)) for t \u2265 0. To mitigate the epidemic outbreak, consider we can apply one or several NPIs that reduce disease transmission by the factor (1 \u2212 u), for some u \u2208 [0, 1]. Here, u = 0 if the NPIs achieve no reduction, and u = 1 if they completely stop transmission.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 425,
                    "end": 435,
                    "text": "(Fig.   1a",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "Since it is unfeasible to stop transmission fully, we upper-bound the reduction by u max \u2208 (0, 1). We say that the intervention u is admissible if u \u2208 [0, u max ]. To describe the health services' capacity, we consider they can adequately manage a maximum prevalence I max \u2208 (0, 1]. For example, hospitals may saturate when the disease prevalence exceeds I max , causing higher mortality 10 . In this sense, NPIs must maintain the disease prevalence below I max .",
            "cite_spans": [
                {
                    "start": 388,
                    "end": 390,
                    "text": "10",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "Characterizing optimal non-pharmaceutical interventions. In principle, several admissible interventions with different duration can keep the disease prevalence below I max . For instance, the intervention 1 in the example of Fig. 1b -c keeps this restriction and has a duration of 63 days. Intervention 2 also keeps this restriction, but it only lasts 32 days. To design the optimal NPI, we ask for the intervention with minimal duration. More precisely, we ask for the admissible reduction u * (S(t), I(t)) required now (i.e., at the current state) such that: (1) it minimizes the duration of the intervention; and (2) it ensures that the prevalence can be maintained below I max for all future time by using some admissible intervention. If the optimal NPI problem has a solution u * , then u * (S, I) characterizes the optimal reduction in the disease transmission that the NPIs should achieve given that the epidemic is in the state (S, I). The optimal intervention also gives the optimal state to start the NPIs, and optimal way to stop them.",
            "cite_spans": [
                {
                    "start": 561,
                    "end": 564,
                    "text": "(1)",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 616,
                    "end": 619,
                    "text": "(2)",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [
                {
                    "start": 225,
                    "end": 232,
                    "text": "Fig. 1b",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "Our first main result is a complete analytical characterization of the optimal NPIs in the SIR model (Supplementary Note S1). We prove that the solution to the optimal intervention is fully characterized by the separating curve",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "The separating curve is key because it partitions the (S, I) plane in two regions (top row in Fig. 2 ). All states below or on the separating curve are feasible, meaning that the optimal NPI problem has a solution.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 94,
                    "end": 100,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "By contrast, all states above the separating curve are unfeasible because the admissible interventions cannot maintain the disease prevalence below I max . Note that the shape of the separating curve depends on I max and R c . If R c \u2264 1, the separating curve is the straight line \u03a6(S) = I max . When R c > 1, the separating curve becomes nonlinear.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "The optimal intervention. The separating curve also characterizes the optimal transmission reduction at any state of the epidemic (Box 1). For all states (S, I) below the separating curve, the optimal intervention is u * (S, I) = 0. With this intervention, the trajectory of some states will hit the separating curve at some point (S 1 , I 1 ), where I 1 = \u03a6(S 1 ). When that happens the intervention starts with its maximal value u * (S 1 , I 1 ) = u max (i.e. a, maximal reduction of transmission). Then, the optimal intervention \"slides\" the trajectory along the separating curve. Finally, the optimal intervention stops when the susceptible S reaches the region S \u2264 R \u22121 0 . Note that once the trajectory reaches this region, prevalence will decrease without further intervention.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "To better understand the optimal intervention, we illustrate its behavior in its three qualitative different cases. The first is when the intervention starts just when the prevalence reaches I max (Fig. 2a) . This case happens when interventions are strong enough to maintain I(t) constant the first time t 1 they reach Fig. 2a ). Our analysis shows that this occurs if and only if u max is large enough to render R c = (1 \u2212 u max )R 0 \u2264 1, yielding the constant separating curve \u03a6(S) = I max . In this case, the optimal intervention is \"do nothing\" until I(t 1 ) = I max . The optimal reduction u * (t 1 ) in the contact rate is maximal at that time, and then decreases to zero in a hyperbolic arc (bottom in Fig. 2a ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 197,
                    "end": 206,
                    "text": "(Fig. 2a)",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 320,
                    "end": 327,
                    "text": "Fig. 2a",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 710,
                    "end": 717,
                    "text": "Fig. 2a",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "The second is when an \"early\" intervention is necessary before the prevalence reaches I max (Fig. 2b ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 92,
                    "end": 100,
                    "text": "(Fig. 2b",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "This case happens when no admissible reduction in the contact rate can immediately stop I(t) at I max if the susceptible population is large at that time. We find this occurs if and only if u max yields R c > 1, leading to S * < 1 and a separating curve that decreases to the right of S * (top in Fig. 2b) .separating curve Here, the optimal intervention starts when the trajectory hits the separating curve (red point in Fig. 2b ). Since the separating curve points is nonlinear, this hitting time marks the \"early start\" of the intervention. The intervention starts with the maximum reduction u * = u max . Then, it maintains this maximum reduction to slide the trajectory over the separating curve. Once the trajectory reaches I max , the optimal reduction decreases in a hyperbolic arc (bottom in Fig. 2b ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 297,
                    "end": 305,
                    "text": "Fig. 2b)",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 422,
                    "end": 429,
                    "text": "Fig. 2b",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 801,
                    "end": 808,
                    "text": "Fig. 2b",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "The third is when the initial state (S 0 , I 0 ) lies above or to the right of the separating curve (Fig. 2c ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 100,
                    "end": 108,
                    "text": "(Fig. 2c",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "This case occurs when u max is so small that, even if the maximum admissible reduction maintained from the start, the prevalence will exceed I max (top in Fig. 2c ). In this case the optimal intervention problem 4 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 155,
                    "end": 162,
                    "text": "Fig. 2c",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint is unfeasible because it is impossible to achieve I(t) \u2264 I max . Note, however, that the optimal intervention still yields the smallest prevalence peak.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "A simple criterion to design optimal non-pharmaceutical interventions. We demonstrated above that the optimal transitory intervention exists even when R c > 1. However, how large can R c be before an optimal NPI does not exist because it is impossible to maintain the prevalence below I max ? In the case I(0) \u2192 0 and S(0) \u2192 1, our characterization shows that an optimal NPIs exists for all (R c , I max )",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "such that the separating curve satisfies \u03a6(1) \u2265 0 (Supplementary Note S2-1). This observation yields the necessary and sufficient condition for the existence of NPIs:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "The above inequality is our second main result, connecting the health services' capacity I max with the controlled reproduction number R c = (1 \u2212 u max )R 0 that it can successfully maintain. This inequality governs the existence of optimal NPIs for mitigating epidemic outbreaks, in analogy to how the condition R c < 1 works for the eradication of diseases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "Note that the condition R c < 1 is sufficient for NPIs, but the inequality (2) shows that this condition is far from necessary. If I max > 0, there exists R c > 1 for which optimal NPIs exist ( Fig. 3a) . In these cases, it is possible to maintain I(t) \u2264 I max using an admissible intervention. However, this requires an \"early start\" of the intervention, as demonstrated in Fig. 2b . Note also that the maximum feasible R c increases with I max .",
            "cite_spans": [
                {
                    "start": 75,
                    "end": 78,
                    "text": "(2)",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [
                {
                    "start": 194,
                    "end": 202,
                    "text": "Fig. 3a)",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 375,
                    "end": 382,
                    "text": "Fig. 2b",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "To understand how to apply (2) for designing NPIs, consider an infectious disease outbreak with a given R 0 and that the maximum prevalence that the health services can manage is I max . Then, the inequality (2) gives the criterion to design NPIs by providing the range of contact rate reduction u max that the NPIs should attain. In particular, it provides the minimal reduction u * max in the contact rate required for the existence of optimal NPIs. By construction, optimal NPIs have the minimum possible duration. But their duration might be more than is feasible in practice. We investigated how R c and I max change the duration of the optimal intervention (Supplementary Note S2-2). In general, the duration of the optimal NPIs increases as I max decreases (Fig. 3b) . This result makes sense as a smaller health system's capacity requires a stronger flattening of the prevalence curve. The duration also increases as the pair (R c , I max ) approaches the feasibility boundary of the inequality (2). In particular, close to this feasibility boundary, the duration is very sensitive to changes in these two parameters. Hence, the pair u max and I max should be designed to remain sufficiently 5 far from the feasibility boundary.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 764,
                    "end": 773,
                    "text": "(Fig. 3b)",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "Application to the COVID-19 pandemic. We explored the implications of our simple rule for designing NPIs by analyzing how 16 cities implemented NPIs during the COVID-19 pandemic. To estimate the proportion I max of each city, we first collected information about the available intensive care beds in each city during the pandemic. We then used available knowledge of the disease to estimate the fraction of infected individuals who require intensive care (Supplementary Note S3). The I max we obtain ranges from 2.87 \u00d7 10 \u22123 for Lima (Peru) to 109.78 \u00d7 10 \u22123 for Boston (US), reflecting the large heterogeneity of health services across the globe (Fig. 3c) . We calculated the maximum feasible R * c for each city from these quantities using our design criterion (2) . Since R * c is a monotone function of I max we find the same trend as in I max (Fig. 3d) . The smallest R * c = 1.08 occurs for Lima and the largest R * c = 1.75 for Boston. Note that in both cases R * c > 1. For the R 0 of a city's disease outbreak, NPIs policies must be implemented to guarantee that reduction u max can be achieved such that (1 \u2212 u max )R 0 \u2264 R * c . Next, we investigated the minimal reduction u * max in transmission required to achieve those upper bounds for the COVID-19 pandemic case. For this, we first collected information for the R 0 in each city calculated at the start of the pandemic and when the NPIs were inactive (Supplementary Note S3). We find a median nominal R 0 of 2.2, with Tokyo having the smallest one (R 0 = 1.3) and Madrid having the largest one (R 0 = 3.11), Fig. 3e . From these values of R 0 , we calculated the minimal required reduction u * max per city (blue in Fig. 3f ). For the nominal R 0 's per city, we find that a median reduction of u * max of 0.42 is necessary. However, this minimal necessary reduction is heterogeneous across cities. For example, Tokyo just requires u * max = 0.15 while Madrid requires u * max = 0.61. These two cities have the smallest and largest R 0 , respectively. If two cities have a comparable R 0 , then the city with large I max end ups requiring a smaller u * max (e.g., Boston with u * max = 0.26 and Lima with u * max = 0.50). To evaluate the feasibility of achieving the minimal reduction predicted by our analysis, we collected data for the average mobility reduction in each city during the NPIs in each city (grey in Fig. 3d and Supplementary Note S3). Considering this average mobility reduction as a proxy for the reduction in disease transmission, we find that all cities achieved a greater than necessary reduction. For example, Delhi attained a mobility reduction of 0.84, while the minimal necessary reduction in transmission according to our analysis is 0.42. Other cities are in the boundary. For example, New South Wales attained a mobility reduction of 0.48, while the minimal necessary reduction in transmission was 0.44. Overall, across cities, we find a median excess of 0.22 in the reduction of mobility compared to the minimal reduction in transmission predicted by our analysis.",
            "cite_spans": [
                {
                    "start": 763,
                    "end": 766,
                    "text": "(2)",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [
                {
                    "start": 647,
                    "end": 656,
                    "text": "(Fig. 3c)",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 848,
                    "end": 857,
                    "text": "(Fig. 3d)",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1574,
                    "end": 1581,
                    "text": "Fig. 3e",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1682,
                    "end": 1689,
                    "text": "Fig. 3f",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 2382,
                    "end": 2389,
                    "text": "Fig. 3d",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "Finally, we compared the start of the optimal NPI with the actual start of the NPIs implemented in each city (Fig. 4) . Most cities (10/16) started their NPIs before the optimal start date, with a median of 6 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 109,
                    "end": 117,
                    "text": "(Fig. 4)",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "RESULTS"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . 40 days of anticipation. Here, Tokyo is an outlier with almost 150 days of anticipation. Four cities (New South Wales, New York, British Columbia, and Boston) started their NPIs at almost the optimal time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "Only one city (Madrid) started its NPIs after the optimal start date calculated by our analysis (about ten days of delay). We also found significant heterogeneity in the duration of the calculated optimal NPIs across cities, ranging from about 15 days for Boston to more than one year in Lima. This heterogeneity comes from the heterogeneity in the estimated health system capacity I max . In Lima, for example, the ratio of intensive care units to habitants is 517/8.575 \u00d7 10 6 = 6.02 \u00d7 10 \u22125 (i.e., I max = 2.87 \u00d7 10 \u22123 ), while in Boston the ratio is two orders of magnitude larger 1600/694\u00d710 3 = 2.3\u00d710 \u22123 (i.e., I max = 109.78\u00d710 \u22123 ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "Cities with smaller I max yields optimal NPIs that are longer, up to the point when their duration makes them impossible to implement. Assuming, as illustrative example, that 150 days is the maximal duration of feasible NPIs, our analysis predicts that I max needs to be at least as in Mexico City (12.63 \u00d7 10 \u22123 ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "RESULTS"
        },
        {
            "text": "Obtaining our criterion to design optimal NPIs was possible only because we characterized the necessary and sufficient conditions for the existence of solutions to an optimal control problem. Deriving such complete characterization is challenging -especially for high-dimensional systems-because it involves solving an infinite-dimensional optimization problem 11 . Indeed, computational methods 12 cannot produce such characterization, and established analytical methods like Pontryagin's Maximum Principle only yields necessary conditions for optimality 11 . We note there are several studies applying these and other similar methods to the SIR model 13, 14 , in particular during the COVID-19 pandemic 10, 15-17 . Our choice of a simple SIR model was motivated by its epidemiological adequacy for the COVID-19 pandemic and its low dimensionality, allowing us to apply Green's Theorem to compare the cost of any two interventions analytically. In this sense, the method we use is closer to our previous work on optimal control for bioreactors 18 . Our results could guide a similar complete characterization for more detailed epidemic models or more detailed optimization objectives, but this is likely very challenging.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION AND CONCLUSIONS"
        },
        {
            "text": "Our choice of the simple SIR model also gives us a complete understanding of the optimal intervention at any state that the epidemic can take. The feedback form u * (S, I) of the optimal intervention reflects such understanding, telling us the optimal action to perform if the epidemic is in the state (S, I). Contrast this feedback strategy to most other studies applying optimal control to epidemic diseases, where the optimal intervention is written in open-loop u * (t) (see Supplementary Note S4 for details about how our work is related to existing optimal control studies). For a particular initial state, the open-loop intervention gives the optimal action at any time. However, it does not tell us what is the optimal action if we would have started at a different initial state. Understanding the optimal action to perform at any state has the 7 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION AND CONCLUSIONS"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . crucial advantage of allowing us to apply this knowledge to any model, and therefore to reality. Indeed, it is well-established that feedback gives the control strategies the required robustness to work on real processes 19 . Our feedback optimal intervention has also this robustness (Supplementary Note S5). More precisely, we show that the optimal intervention works despite the presence of an incubation period, or when a fraction of the infected individuals remain hidden to the epidemic surveillance (e.g., because they are asymptomatic, as in . Future work could also analyze the robustness of the optimal intervention when the current state of the epidemic is not entirely known. For example, this case may happen when significative delays exist in reporting newly infected cases, or when test for identifying infected individuals are limited.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION AND CONCLUSIONS"
        },
        {
            "text": "The optimal intervention resulting from our analysis takes a continuum of values that may be infeasible to implement in practice. We can use an averaging approach to circumvent this problem. Namely, consider a time window of T days (e.g., a week). Suppose that the average reduction prescribed by the optimal intervention over a certain window is\u016b * . We can realize this reduction on average by combining d = T\u016b * /u max days of maximum reduction with (T \u2212 d) days without intervention. This approach yields an intervention similar to Karin et al. 20 , with the difference that the periods of intervention and activity are optimally balanced.",
            "cite_spans": [
                {
                    "start": 549,
                    "end": 551,
                    "text": "20",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "DISCUSSION AND CONCLUSIONS"
        },
        {
            "text": "We will inevitably face new epidemics where non-pharmaceutical interventions are the only option to control infections. Our analysis suggests that, during the COVID-19 pandemic, less than half of the cities we studied attained enough health resources to respond adequately. Indeed, in some cities like Lima and Dehli, their health services' capacity is so low that they are practically condemned to either exceed their capacity or live with near-permanent interventions. We must develop a scientific understanding that can inform the design of non-pharmaceutical interventions and plan the required health services capacity. We hope our work helps to catalyze the efforts to bring that understanding into practice.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION AND CONCLUSIONS"
        },
        {
            "text": "The SIR model is a keystone in our understanding of infectious diseases, capturing the most essential features of the epidemiological dynamics for the mitigation or eradication of epidemic outbreaks 2, 21 . The SIR model with interventions u(t) \u2208 [0, u max ] reducing disease transmission takes the form",
            "cite_spans": [],
            "ref_spans": [],
            "section": "BOX 1. Optimal NPIs for the Susceptible-Infected-Removed (SIR) model."
        },
        {
            "text": "Here, S(t), I(t), and R(t) are the proportion of the population that is susceptible, infected, or removed (i.e., recovered or dead) at time t \u2265 0, respectively. Because S(t) + I(t) + R(t) = 1 for all t \u2265 0, we can just consider the (S, I) dynamics. We denote by (S 0 , I 0 ) the initial state of the model at t = 0. The parameters are the contact rate \u03b2 \u2265 0 and the the mean residence time of infected individuals \u03b3 \u2265 0 (in units of day \u22121 ). By assuming S(0) \u2248 1, these two parameters yield the basic reproduction number R 0 = \u03b2/\u03b3. In Supplementary Note S1, we prove that the optimal intervention is fully characterized by the separating curve of Eq. (1). This separating curve characterizes the optimal intervention as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "BOX 1. Optimal NPIs for the Susceptible-Infected-Removed (SIR) model."
        },
        {
            "text": "(1) an optimal intervention exists if and only if the initial state (S 0 , I 0 ) lies below this separating curve (i.e., I 0 \u2264 \u03a6(S 0 ));",
            "cite_spans": [],
            "ref_spans": [],
            "section": "BOX 1. Optimal NPIs for the Susceptible-Infected-Removed (SIR) model."
        },
        {
            "text": "(2) if it exists, the optimal intervention u * takes the feedback form",
            "cite_spans": [],
            "ref_spans": [],
            "section": "BOX 1. Optimal NPIs for the Susceptible-Infected-Removed (SIR) model."
        },
        {
            "text": "In words, the optimal intervention starts when I(t) reaches \u03a6(S(t)), and then it slides I(t) along \u03a6(S) until reaching the region where S \u2264 R \u22121 0 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "BOX 1. Optimal NPIs for the Susceptible-Infected-Removed (SIR) model."
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "9"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. For the optimal NPI design problem, the objective is to design the intervention u * (t) with minimal duration such that u * (t) \u2208 [0, u max ] and I (t) \u2264 I max for all t \u2265 0. b and c. Panels show the response of the SIR model for two interventions (parameters are \u03b2 = 0.52, \u03b3 = 1/7, I 0 = 8.855 \u00d7 10 \u22127 and S 0 = 1 \u2212 I 0 ). Intervention 1 guarantees that I (t) \u2264 I max and has a duration of 63 days (dashed line). Intervention 2 also guarantees that I (t) \u2264 I max but its duration is only 32 days (solid line). Actually, intervention 2 is the optimal one derived using our analysis: it is the shortest intervention satisfying I(t) \u2264 I max . For comparison, panel b also shows the response of the model without intervention (i.e., u(t) \u2261 0).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "10"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. In this case, the optimal intervention waits until I (t 1 ) = I max at time t 1 = 37 (red point). At that time the intervention starts with roughly u * (t 1 ) = 0.7, then decreases in an hyperbolic",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "This yields S * < 1 (green point in top panel) and a curved separating curve \u03a6(S; I max , R c ) (blue in top panel). Note here that \u03a6(1) > 0, implying that the epidemic still can be controlled for S 0 \u2248 1 and I 0 \u2248 0. In this case, the optimal intervention for the initial condition hits the separating curve below I max at time t = 35 (red point in top panel). At that instant the intervention starts with the maximal value u max , and continues in that form until the trajectory reaches I max (green point). At that instant, the intervention decreases in an hyperbolic arc until vanishing at t = 80. The duration of the intervention was t * f = 45 days. c. Choosing u max = 0.4 yields R c = 2.184 > 1, leading to S * < 1 and a separating curve that reaches zero before near S = 0.8. In this case, the optimal intervention problem does not have a solution for all initial states S 0 > 0.8. This is illustrated by the red initial state. The problem does not have a solution because even by applying the maximum intervention the infected I (t) will go beyond I max .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "11"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. (2). The problem is feasible even when the interventions cannot reduce the basic reproduction below one (i.e., even when R c = (1 \u2212 u max )R 0 > 1). b. Duration of the optimal intervention in units of \u03c4 = \u03b3t. Lower I max results in longer duration of the optimal intervention. c. Calculated I max according to the proportion of available intensive care beds in each city and the estimated fraction of infected individuals requiring intensive care. d. Maximum controlled reproduction number R c that each city can handle according to its I max . Larger I max allows a larger R c . e. Initial basic reproduction number R 0 per city, before any intervention started. Median (blue big dot), and 95% confidence interval (smaller dots) are shown. f. Minimum u max necessary for feasibility for each city (blue) according to the R 0 of panel c. Grey bars denote the reported average mobility reduction in each city between March 19 and April 30.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "12"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "13"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. rep., National Bureau of Economic Research (2020).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "[16] F. P L. S . Optimal covid-19 quarantine and testing policies .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "[17] C. T et al. Modeling, state estimation, and optimal control for the us covid-19 outbreak. arXiv preprint arXiv:2004.06291 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "14 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. [29] X. Y Y. Z . Optimal and sub-optimal quarantine and isolation control in sars epidemics. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "15"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint S1. Characterization of the optimal intervention in the Susceptible-",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "The model is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "where the parameters \u03b2 > 0, \u03b3 > 0 are assumed constant. Since the total population N = S + I + R remains constant all the time, the model can be reduced to that of a second order system using only the states (S, I), which is what we will do. The maximal (acceptable) value of I is I max and the maximal achievable value of the control is u max . So the state has to belong to the following feasible sets",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "Sometimes it will be useful to write the differential equation in a compact form as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "The trajectory starting at the initial point x 0 = (S 0 , I 0 ) and subject to the control u : R \u2192 U F is denoted by \u03c6 (t, x 0 , u (\u00b7)).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "The optimal control problem consists in finding the control strategy u such that, starting from the initial point (S 0 , I 0 ) the target set 1",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "is reached in the minimal time with the state restriction I (t) \u2264 I max satisfied for all time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "Now let us define the reachable set for an initial state x 0 as the set of points that can be reached from the initial point x 0 with feasible control, i.e.,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "x 0 , u (\u00b7)) for some finite t \u2265 0 and admissible u .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "Also, we define the controllable set of the target set T as the set of points from which some point in the target T can be reached with a feasible control, i.e.,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "x, u (\u00b7)) for some finite t \u2265 0 and admissible u .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "The set C (T ) can be equivalently described as R (T ) for the system",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": "i.e., the set of points that can be reached from the set T for the dynamics with backward time. Now, the 1 Note that this set is positively invariant without control (u = 0), and when the trajectory is in this set it will die out without control action.",
            "cite_spans": [
                {
                    "start": 105,
                    "end": 106,
                    "text": "1",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Infected-Removed model"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "1"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint optimal control problem has a solution if and only if",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Since the points of the form (S, I) = (S, 0) are equilibria for every control value, R ((S, 0)) = (S, 0), so we exclude them from the initial conditions for which there is a solution (except if the equilibrium is already in the target set). Now, since S < 0 for S > 0, I > 0,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "for every initial condition (except for initial conditions of the form (S, 0) ). It is obvious that, for the problem to be feasible, the initial state has to be in the feasible set X F , i.e.,",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 71,
                    "end": 77,
                    "text": "(S, 0)",
                    "ref_id": null
                }
            ],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Although it does not seem to be possible to find explicitly the trajectories of the system, it is easy to find its orbits. For this we write (we exclude the points for which I = 0 since they are equilibria)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": "which is a separable differential equation (DE) . Assuming that u is constant and integrating we obtain",
            "cite_spans": [
                {
                    "start": 43,
                    "end": 47,
                    "text": "(DE)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": "An interesting rewriting of (S1) is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": "This means that the quantity I (t) + S (t) \u2212 \u03b3 (1\u2212u)\u03b2 ln (S (t)) remains constant along the trajectory. Note that this constant depends on the control value used. The above equation is well-known for the SIR model 21 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": "Given an initial condition (S 0 , I 0 ) this expression gives, for any 0 < S < S 0 the (unique) value of I that is reached in future time 2 . Thus there exists a function I (S; (S 0 , I 0 )) that gives the value of I as a function of S and the initial condition. Moreover, from the first equation in the DE we obtain",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": "and, if we take the expression I (S; (S 0 , I 0 )), we obtain a separable DE that can be integrated,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": ", and that gives the time to reach the point (S, I (S)) from the initial point (S 0 , I 0 ) with the (constant) control u. Although it does not seem possible to give an explicit expression for this integral, it is clear 2 If we select S > S 0 the obtained value of I is reached in a past time (t < 0).",
            "cite_spans": [
                {
                    "start": 220,
                    "end": 221,
                    "text": "2",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "S1.1 Calculation of the orbits"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint that S parametrizes uniquely the solutions (since it is monotone).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "If we apply a constant control 0 \u2264 u \u2264 u max the infection will eventually die out, i.e., the value I (\u221e) = 0 will be reached asymptotically (otherwise R (t) would continue growing, which is impossible). We can therefore compute S (\u221e) implicitly from (S1) as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.2 The number of infected people"
        },
        {
            "text": "Note that the final value of S depends on the initial values, but also on the control used.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.2 The number of infected people"
        },
        {
            "text": "If we assume that the model is normalized, and the initial value is S 0 = 1 and I 0 \u2248 0, then",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.2 The number of infected people"
        },
        {
            "text": "Note that, if u \u2192 1 \u2212 , then S (\u221e) \u2192 1 \u2212 so, the larger the value of u, the larger the value of S (\u221e) also is. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.2 The number of infected people"
        },
        {
            "text": "In the phase plane (S, I) both point to the \"left\", since the first component (in the direction of S) is always negative (recall that SI > 0). Since for the second components of the vector fields we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.3 Reachable set from"
        },
        {
            "text": "it follows that F 0 is \"above\" F u max . Therefore,the reachable set R (x 0 ) is bounded by the two trajectories \u03c6 (t, x 0 , u = 0) and \u03c6 (t, x 0 , u max ) (see Fig. S1 ). These two bounding orbits can be easily calculated using (S1). In particular, we can calculate the maximal value achieved by I for every (constant) control action,",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 161,
                    "end": 168,
                    "text": "Fig. S1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "S1.3 Reachable set from"
        },
        {
            "text": "3 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.3 Reachable set from"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. and gives the maximum incidence as a function of the control strategy u:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "In order to be able to find the optimal orbit (trajectory) solving the optimal control problem, it is necessary to be able to compare the cost of two different trajectories that start at the same initial point and end at the same final point. Consider two orbits \u03c9 i x 0 , x f , u i , i = 1, 2, joining the (same) points x 0 and x f using two different control actions, u 1 and u 2 , respectively. The cost going through \u03c9 i is (recall that our cost is time)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.4 Comparing the cost of two different trajectories"
        },
        {
            "text": "along the trajectory. Given two such orbits, we want to compare both costs. This can be done, for example, by subtracting them, i.e., if J (u 1 ) \u2212 J (u 2 ) < 0 then the cost of \u03c9 1 is lower than that of \u03c9 2 . The cost J (u i ) can be calculated as a line integral along the trajectory. We can see this in the following manner. Calculate",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.4 Comparing the cost of two different trajectories"
        },
        {
            "text": "Now, by properties of the determinant this is also the same as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.4 Comparing the cost of two different trajectories"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "4"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . Therefore,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "which is a line integral along the orbit \u03c9 i . Since the two paths have the same initial and final points, they form a closed curve, and calculating the line integral along the closed curve followed in the counterclockwise direction we obtain the difference of the costs, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where \u0393 is the closed path of the two orbits followed in the counterclockwise direction. For this we have to assume that: (1) the two paths (orbits) do not intersect at any points except the initial and final ones, and (ii) that \u2206 0. Using Green's theorem, the line integral can be calculated using a surface integral:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where R is the region enclosed by the closed curve \u0393. For our problem this becomes",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "In our case,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "We see that w < 0 everywhere, and therefore the integral is always negative, implying that the \"upper\" orbit has a lower cost than the \"lower\" orbit (in the closed path traversed in the counterclockwise direction). This observation allows us to find the optimal orbit by comparing it with others.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "From the previous results, the \"upper\" trajectory is the one with no control (u = 0) and, in terms of the cost alone, this trajectory is better than any other one joining the same two points. However, such control may be inadmissible, since the corresponding I can go over I max at some periods of time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5 Determining the optimal orbit"
        },
        {
            "text": "The computation of the optimal control can be approached in two ways:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5 Determining the optimal orbit"
        },
        {
            "text": "\u2022 Fix the initial condition x 0 , find its optimal orbit and then its associated optimal control.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5 Determining the optimal orbit"
        },
        {
            "text": "\u2022 Study the optimal control problem for all possible initial conditions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5 Determining the optimal orbit"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "5"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Although the second approach is obviously better, it is more difficult, so we will start with the first approach. In fact, both approaches should lead to the same conclusions. Now we can divide the study of the optimal orbit in several cases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "This is the case in which S 0 \u2264 \u03b3 \u03b2 . That is, the case in which we start in the target set.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.1 Trivial"
        },
        {
            "text": "This is the case if I 0 > I max .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.2 Unfeasible"
        },
        {
            "text": "This will be the case if, and only if, the maximum\u012a given by (S3) with u = 0 is such that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.3 The uncontrolled orbit is optimal"
        },
        {
            "text": "If\u012a given by (S3) with u = 0 is larger than I max andS = \u03b3 \u03b2S 0 > \u03b3 \u03b2 , it is necessary to apply some control to maintain I below the maximal value I max .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "Now we calculate the value of S = S c at which the orbit (first) touches I max . For this we solve (use (S1))",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "for S and obtain two solutions: S 1 , S 2 . Define S c = max {S 1 , S 2 } as the largest. Now we calculate the value of S = S * at which it is possible to achieve I \u2264 0 (that is, that it is possible to stop the growth of I). This value can be calculated from",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "There are two possible situations:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "1. Bang plus singular arc. If \u03b3 \u03b2 < S c \u2264 S * , then the optimal control strategy consists in",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "where u sing is the control required to maintain I = I max constant, i.e., I = 0,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "6 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.5.4 Singular arc"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Bang-Bang plus singular arc. When S c > S * then it is necessary to start (if possible) with the control strategy before reaching the maximal value of I = I max . Otherwise, this limit will be surpassed. However, this is only feasible if, moving backwards from the point (S * , I max ) with the maximal control u max it is possible to reach a point (S 0 , I * 0 ) such that I * 0 \u2265 I 0 . If I * 0 < I 0 , then it is not possible to solve the optimal problem, since any strategy will either surpass the maximal value I max or it will not reach the target.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "The value of I * 0 can be calculated from (S1),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "so that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "If I * 0 = I 0 , the optimal control is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "When I * 0 > I 0 , the control is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "where the value of (S s , I s ) is a switching point. It is characterized as follows: the trajectory starting at (S 0 , I 0 ), i.e., \u03c6 (t, (S 0 , I 0 ) , u = 0) intersects the trajectory that starts at (S * , I max ) but goes backwards in time, i.e., \u03c6 (\u2212t, (S * , I max ) , u max ). Such point (S s , I s ) can be calculated from (S1) as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "Substituting the first into the second we get",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "Solving for S s in the second we arrive at",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "ln (S * ) .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "When\u012a \u2264 I max then the control strategy is simply \"do nothing\" all the time, i.e. u = 0 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "\u2022 The \"green\" point (S * , I max ). S * corresponds to the maximal value of S for which it is possible to keep I max constant, given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "We \"saturate\" the value of S * , since S * > 1 does not make sense. The control required to achieve this is the \"singular\" control",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "Note that, if S > S * , it is not possible to keep I at I max and I > 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "If S * = 1, then the optimal control is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "is the point at which the trajectory \u03c6 (t, x 0 , u = 0) reaches the value I max and can be calculated from the equation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "This equation has a unique solution in the intervalS < S max < S 0 only if I 0 < I max <\u012a, S 0 >S. If S * \u2265 S max , then the optimal control is (as in the previous case)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "This is the situation in our example for u max = 0.57 (or any value larger than this) (see Fig. S3 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 91,
                    "end": 98,
                    "text": "Fig. S3",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "2."
        },
        {
            "text": "\u2022 The \"red\" point (S s , I s ). At this point the trajectory \u03c6 \u2212t, x f , u * crosses the trajectory \u03c6 (t, x 0 , u = 0). Note that if this crossing does not exist, then the optimal control problem is unfeasible. We have three possible cases:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "-If S * \u2265 S max this point exists and it coincides with (S max , I max ), i.e. (S s , I s ) = (S max , I max ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "The optimal control is as in the previous case.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "-If S * < S max the point (S s , I s ) may exist or not. We calculate",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": "ln (S * ) . * If S * \u2264 S * \u2264 S 0 then (S s , I s ) exists and (S s , I s ) is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2."
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "9"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. The optimal control is a bang-bang-singular arc-bang strategy:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "This is the case of Fig. S2 . * If S 0 < S * then (S s , I s ) does not exist. We fix its value (arbitrarily) as (S s , I s ) = (1, 0). In this case the optimal control problem is unfeasible. This is the case if in our example we set u max \u2264 0.35. See Fig. S4 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 20,
                    "end": 27,
                    "text": "Fig. S2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 252,
                    "end": 259,
                    "text": "Fig. S4",
                    "ref_id": "FIGREF4"
                }
            ],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "The previous \"open loop\" strategy can be implemented as a state feedback control. This strategy is rather simple, since there is basically only one switching curve: \u03c6 \u2212t, x f , u * (this is the discontinuous blue line in the Figures). There is a second switch: when the target region has been attained, the control is switched off, but this happens in a \"natural\" manner.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.7 A feedback control strategy"
        },
        {
            "text": "The switching curve is defined as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S1.7 A feedback control strategy"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "10"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. The optimal control feedback is thus given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "(S4)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Alternatively, we can implement a pure switching control since the \"equivalent control\" 22 will realize the singular control on the singular arc,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Note that this control strategy extends the control action beyond the region where the optimal control is feasible. This extension is not strictly based on the value function, and therefore there is not a unique way to do so. In our case, for example, the zero control region is extended to the (non feasible) region defined by I \u2265 I max \u2227 S \u2264S = \u03b3 \u03b2 . But another possible (and maybe better) extension is to set u = u max in this region, since then the limit I max will be reached faster than without control action. The resulting controller is then given b\u1ef9",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "where we have slightly changed the switching function to include this region. Some results can be seen in Figs. S5 and S6. From these figures one also observes that, an extra benefit of applying some control compared to not doing anything is that, when the infection dies, the total number of infected people is larger if no action is 11 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. taken than if some control action is applied. We see this in the figures by noting that S (\u221e) is larger with control than without it. This number can be further increased if instead of taking no control once S < \u03b3 \u03b2 one still applies some control action (of course, the number of infected people is minimized by applying u max ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "12"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "13"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint S2. Necessary and sufficient conditions for the existence of optimal NPIs S2.1 Necessary and sufficient conditions for existence.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Let (S 0 , I 0 ) denote the initial state of the SI model. As shown in Supplementary Note S1, the necessary and sufficient condition for the existence of NPIs is that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "To characterize a condition that is independent of the initial state, we consider the limit case of S 0 = 1 and I 0 = 0. Under this assumption, the necessary and sufficient condition of existence is that \u03a6(1) \u2265 0. In other words, the boundary of existence of NPIs is when the separating curve exactly crosses I = 0 at S = 1. Substituting S = 1 in the separating curve of Eq. (1), we obtain the condition",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "which is precisely the inequality (2).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "In the SI model dS dt",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Calculating the duration of the optimal intervention."
        },
        {
            "text": "the duration of the optimal intervention depends on the parameters \u03b2, \u03b3, u max and I max To describe duration only in terms of R 0 = \u03b2/\u03b3, u max and I max , we note the above system can be rewritten as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Calculating the duration of the optimal intervention."
        },
        {
            "text": "where \u03c4 = \u03b3t. In this last rewriting, time is in units of mean residence time of infected individuals. We simulated the above normalized SIR model on a time interval t \u2208 [0, t f ] with u(t) = u * (t) = u * (S(t), I(t)) given by the optimal feedback intervention of Eq. (S4). Then, the duration d of the optimal intervention is given by the length of time where u * (t) > 0, i.e.,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Calculating the duration of the optimal intervention."
        },
        {
            "text": "14 . CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S2.2 Calculating the duration of the optimal intervention."
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "Supplementary Fig. S7 shows the data used for our analysis. Data was collected using the following methodology:",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 14,
                    "end": 21,
                    "text": "Fig. S7",
                    "ref_id": null
                }
            ],
            "section": "S3.2 Data used in our analysis."
        },
        {
            "text": "1. Number of intensive care beds in each city. This was obtained from official statements when possible (e.g., the Massachusetts Department of Public Health for Boston). In other cases, this number was obtained from public statements of authorities of each city. A complete list of the references appears in the Supplementary Fig. S7 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 312,
                    "end": 333,
                    "text": "Supplementary Fig. S7",
                    "ref_id": null
                }
            ],
            "section": "S3.2 Data used in our analysis."
        },
        {
            "text": "2. Population in each city. Data was obtained from Wikipedia.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S3.2 Data used in our analysis."
        },
        {
            "text": "3. Reduction of mobility in each city. This was obtained from Google Community Mobility Reports https://www.google.com/covid19/mobility/. For our analysis, we considered three categories of mobility: retail & recreation, transit stations, and workplaces. To estimate an overall mobility reduction, we averaged the mobility reduction in these three categories from March 19 to April 30. Data was accessed on May 7, 2020.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S3.2 Data used in our analysis."
        },
        {
            "text": "4. Basic reproduction number. We estimated this quantity from the value of the effective timevarying reproduction number R t at the start of the pandemic around March 8, 2020. These estimates were obtained from the website https://epiforecasts.io/covid/.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S3.2 Data used in our analysis."
        },
        {
            "text": "We used data from the Oxford Coronavirus Government Response Tracker 27 . For our analysis, we considered only the start dates for school closing and workplace closing. Here we assumed that the NPIs started in each city at the same time they started in the country. The time of start of the NPIs was calculated with respect to the date of the first confirmed case in each country.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Start of NPIs for each city."
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "15"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "16"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint",
            "cite_spans": [],
            "ref_spans": [],
            "section": "(which was not certified by peer review)"
        },
        {
            "text": "For the control of infectious diseases, there is a large body of work using optimal control methods to design interventions, including vaccination and quarantines 28, 29 , drug treatments 30 , or dispersal of insecticides and education campaigns 31 . The standard tool to solve these optimal control problem is the celebrated Pontryagin's Maximum Principle 32 . However, note that the Maximum Principle only gives necessary conditions for optimality. The gap between the necessary and sufficient conditions for optimality needs to be closed using additional arguments, often relying on assuming that the control appears multiplying an affine function of the state variables. This assumption is not satisfied in our formulation of optimal NPIs. We emphasize that the optimal interventions obtained from this approach result in open loop strategies which only depend on time. By contrast, our analysis gives a feedback optimal strategy that characterizes the optimal action to make according to the actual state of the epidemic. Indeed, our characterization of optimal NPIs does not rely on the Maximum Principle. Instead, the low dimensional of our model allows us to apply Green's Theorem to compare the cost of two different interventions. The consequence of our approach is that we obtain a feedback or closed loop strategy that corrects itself based on the actual state of the epidemic.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4. Related work"
        },
        {
            "text": "The COVID-19 pandemic has stirred much interest on designing non-pharmaceutical interventions. This has led to strategies like interspacing mitigation with brief periods of activity 20 . Optimal control methods have been also applied, for example to minimize the peak of infection 33 , minimize the number of infections 17 , minimize the economic costs 15 , or maximize welfare 16 . Compared to these studies, our analytical characterization of optimal NPIs provides gives us a complete understanding of the optimal decisions that need to be made. For example, no intervention is needed before reaching the separating curve.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S4. Related work"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "17"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint",
            "cite_spans": [],
            "ref_spans": [],
            "section": "17"
        },
        {
            "text": "Here we evaluate the robustness of the optimal intervention agains dynamics that were not considered in its derivation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S5. Robustness of the optimal intervention"
        },
        {
            "text": "To evaluate the robustness of the optimal intervention to the presence of an incubation period of the disease, we considered the SEIR dynamics S = \u2212(1 \u2212 u)\u03b2 SI, E = (1 \u2212 u)\u03b2 SI \u2212 \u03bbE,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "S5.1 Robustness to the presence of an incubation period."
        },
        {
            "text": "Above, E(t) denotes the fraction of individuals in the population exposed to the disease, but which are not yet infectious, at time t. The parameter 1/\u03bb \u2265 0 denotes the incubation period of the disease in units of days. Supplementary Fig. S8 shows the result of applying the optimal intervention to the above SEIR with different values of the incubation period. Namely, we apply u(t) = u * (I(t), S(t)) with u * (I, S) as in Eq. (S4). When the incubation period is small compared to the period of the disease (i.e., 1/\u03b3), the response of the optimal intervention in the original SIR model and in the SEIR are very similar. These incubation periods are reasonable for influenza-like diseases. We do find that prevalence exceeds I max , but this excess is less than 1% (Supplementary Fig. S8a ). This confirms the robustness of the optimal intervention to the presence of incubation period. The response of SEIR with the optimal intervention remains acceptable up to an incubation period that is about 75% of the disease period ( Supplementary Fig. S8b-c) . For this last case, the incubation period is similar to what has been observed for the SARS-CoV-2 virus.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 220,
                    "end": 241,
                    "text": "Supplementary Fig. S8",
                    "ref_id": null
                },
                {
                    "start": 767,
                    "end": 790,
                    "text": "(Supplementary Fig. S8a",
                    "ref_id": null
                },
                {
                    "start": 1028,
                    "end": 1053,
                    "text": "Supplementary Fig. S8b-c)",
                    "ref_id": null
                }
            ],
            "section": "S5.1 Robustness to the presence of an incubation period."
        },
        {
            "text": "To evaluate the robustness of the optimal intervention to hidden infected individuals, consider that that infections can be symptomatic or asymptomatic. We assume that all asymptomatic infections do not require hospital care, and hence remain undetected by the epidemic surveillance system. To model this scenario, we consider the dynamics S = \u2212(1 \u2212 u)\u03b2 S(I a + I s ), Above, I s denotes the proportion of symptomatic infections and I a the fraction of asymptomatic ones. The model assumes that a fraction p \u2208 [0, 1] of infections result in symptomatic cases, and the rest (1 \u2212 p) in asymptomatic ones. We assume that infectious period 1/\u03b3 is the same for both symptomatic and asymptomatic individuals. Since we assume that only symptomatic individuals end up requiring hospital care, we consider that the objective is to keep I s (t) \u2264 I max only. The control applied is u(t) = u * (I s (t), S(t)) where u * (I, S) is given by Eq. (S4) . Supplementary Fig. S9 shows the result of applying the optimal intervention to the above model with different values of the proportion of symptomatic cases p. For the wide range p \u2208 [55/100, 80/100], we find that effect of hidden infections is that the optimal intervention becomes over cautious, in the sense that now I s never reaches I max .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 932,
                    "end": 936,
                    "text": "(S4)",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 939,
                    "end": 960,
                    "text": "Supplementary Fig. S9",
                    "ref_id": null
                }
            ],
            "section": "S5.2 Robustness to the presence of hidden infected individuals."
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "18"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "18"
        },
        {
            "text": ". CC-BY-NC-ND 4.0 International license It is made available under a is the author/funder, who has granted medRxiv a license to display the preprint in perpetuity. (which was not certified by peer review)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "19"
        },
        {
            "text": "The copyright holder for this preprint this version posted May 21, 2020. . https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint",
            "cite_spans": [],
            "ref_spans": [],
            "section": "19"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Vaccination and herd immunity to infectious diseases",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "M R M"
                    ],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Nature",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "we estimated the fraction f of infected individuals requiring intensive-care under the following assumptions: 1. Current estimates for the fraction p \u2208 [0, 1] of infected individuals that are symptomatic show a large variability 23 , ranging from a 20/100 in a report of the World Health Organization",
            "authors": [],
            "year": null,
            "venue": "For COVID-19 pandemic by the SARS-CoV-2 virus",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "25 , we assume that from the individuals that are symptomatic, a fraction 15/100 develop severe symptoms",
            "authors": [
                {
                    "first": "Following",
                    "middle": [],
                    "last": "Kremer",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "26 , from the individuals that develops severe symptoms",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Finally",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Optimal non-pharmaceutical interventions. a. A Susceptible-Infected-Removed (SIR) model with the non-pharmaceutical interventions (NPIs) that reduce disease transmission.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Optimal interventions in the Susceptible-Infected model. For all panels, the parameters of the SIR model are \u03b3 = 1/7, \u03b2 = 0.52, (i.e., R 0 = 3.64) and I max = 0.1. We consider a population of N = 8.855 \u00d7 10 6 individuals, like in Mexico City, and an initial state I 0 = 1/N and S = 1 \u2212 I 0 (white dot with red boundary). a. For u max = 0.8 we have R c = (1 \u2212 u max )R 0 = 0.728 \u2264 1. This yields S * = 1 (green point in the top panel) and the straight separating curve \u03a6(S; I max , R c ) = I max (blue line).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Minimum necessary reduction in transmission for the COVID-19 pandemic. a. The optimal NPI problem is feasible if it is possible to maintain I (t) \u2264 I max for all t \u2265 0. The panel shows the feasibility region determined by Eq.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Optimal interventions for the COVID-19 pandemic. Day 0 corresponds to the date of the first confirmed case in each city.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Figure showsthe optimal interventions for the SI model using two different proportions of symptomatic individuals (solid and dashed), assuming the median R 0 in each city and considering \u03b3 = 1/5. Black lines denotes the start of the actual interventions in each city.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "of the optimal intervention in the Susceptible-Infected-Removed model 2 S1.1 Calculation of the orbits . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 3 S1.2 The number of infected people . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 S1.3 Reachable set from (S 0 , I 0 ) . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 S1.4 Comparing the cost of two different trajectories . . . . . . . . . . . . . . . . . . . . . . 5 S1.5 Determining the optimal orbit . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 6 S1.5.1 Trivial . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 S1.5.2 Unfeasible . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 S1.5.3 The uncontrolled orbit is optimal . . . . . . . . . . . . . . . . . . . . . . . . . . 7 S1.5.4 Singular arc . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 7 S1.6 The optimal path . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 9 S1.7 A feedback control strategy . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 11 S2 Necessary and sufficient conditions for the existence of optimal NPIs 15 S2.1 Necessary and sufficient conditions for existence. . . . . . . . . . . . . . . . . . . . . . 15 S2.2 Calculating the duration of the optimal intervention. . . . . . . . . . . . . . . . . . . . . 15 S3 Application to the COVID-19 pandemic 16 S3.1 Estimate for the fraction of infected individuals requiring intensive care. . . . . . . . . . 16 S3.2 Data used in our analysis. . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 16 S4 Related work 18 S5 Robustness of the optimal intervention 19 S5.1 Robustness to the presence of an incubation period. . . . . . . . . . . . . . . . . . . . . 19 S5.2 Robustness to the presence of hidden infected individuals. . . . . . . . . . . . . . . . .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "At each point in the state space, the directions in which the vector field points for different values of the control are given by F u (x) = f (x) + g (x) (1 \u2212 u). The extreme values are given by F 0",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Phase Plane with maximal and minimal orbits bounding the reaching set R (x 0 ). Max corresponds to the trajectory \u03c6 (t, x 0 , u = 0) while Min to \u03c6 (t, x 0 , u = u max )",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "Phase Plane for u max = 0.57",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "Phase Plane with u max = 0.35",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "Optimal feedback control with u max = 0.25, so that the problem is unfeasible.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF12": {
            "text": "Optimal feedback control with u max = 0.6, so that the problem is feasible.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF13": {
            "text": "I s = p (1 \u2212 u)\u03b2 S(I a + I s ) \u2212 \u03b3I s , I a = (1 \u2212 p) (1 \u2212 u)\u03b2 S(I a + I s ) \u2212 \u03b3I a , R = \u03b3 s I s + \u03b3 a I a .(S6)",
            "latex": null,
            "type": "figure"
        },
        "FIGREF14": {
            "text": "Robustness of the optimal intervention to the presence of an incubation period. Parameters of the model not specified in the panels are: \u03b2 = 0.52, u max = 0.6, I max = 1/8, I 0 = 1.129 \u00d7 10 \u22127 , S 0 = 1 \u2212 I 0 , and E 0 = 0. Solid line denotes the proportion of infected individuals under the optimal intervention. Dashed line denotes the proportion of infected individuals without intervention. a. Small incubation period. b. Medium incubation period. c. Large incubation period. Robustness of the optimal intervention to the presence of hidden infections. Parameters of the model not specified in the panels are: \u03b2 = 0.52, \u03b3 = 1/7, u max = 0.6, I max = 1/8, I s0 = I a0 = 1.129 \u00d7 10 \u22127 , S 0 = 1 \u2212 2I s0 . Pink denotes the proportion of symptomatic infected individuals I s (t). The grey area denotes the proportion of asymptomatic infected individuals I a (t). a. Large proportion of symptomatic individuals p. b. Medium proportion of symptomatic individuals p. c. Small proportion of symptomatic individuals p.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": ". https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint [2] R. M. A R. M. M . Infectious diseases of humans: dynamics and control (Oxford university press, 1992). [3] C. F et al. Factors that make an infectious disease outbreak controllable. Proceedings of the National Academy of Sciences 101 no. 16, pp. 6146-6151 (2004). [4] K. K . Ending coronavirus lockdowns will be a dangerous process of trial and error. Mitigation strategies for pandemic influenza a: balancing conflicting policy objectives. PLoS computational biology 7 no. 2. [7] N. F et al. Impact of non-pharmaceutical interventions (npis) to reduce covid-19 mortality and healthcare demand. imperial college covid-19 response team (2020).",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "Optimal time control of bioreactors for the wastewater treatment. Optimal Control Applications and Methods 20 no. 3, pp. 145-164 (1999).",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "Under the above assumptions, the fraction of infected individuals requiring intensive care has a nominal value",
            "latex": null,
            "type": "table"
        },
        "TABREF4": {
            "text": ". https://doi.org/10.1101/2020.05.19.20107268 doi: medRxiv preprint COVID-19 (by City) Declaration of City Mayor to El Universal (April 25) https:// www.eluniversal.com.mx/metropoli/cdmx/anuncia-cdmx-500-camas-mas-para-cuidados-intensivos As in April 27 https://projects.thecity.nyc/2020_03_covid-19-tracker/ Massachusetts Department of Public Health COVID-19 Dashboard -Tuesday, May 05, 2020 https://www.mass.gov/doc/covid-19-dashboard-may-5-2020/ download Mobility reduction in Suffolk County Dehli (India) April 20. Princeton Center For Disease Dynamics, Economics & Policy https://cddep.org/wp-content/uploads/2020/04/State-wise-estimates-of-current-beds-and-ventilators_20Apr2020.pdf Lombardy (Italy) March 13, Critical Care Utilization for the COVID-19 Outbreak in Lombardy, Italy. https://jamanetwork.com/journals/jama/ fullarticle/2763188 https://ec.europa.eu/jrc/en/news/ forecasting-covid-19-impact-icu-bed-demand-lombardy April 2, https://berlinspectator.com/2020/04/02/corona-crisis-in-germany-intensive-care-capacities-increased-substantially/ https://www.tagesspiegel.de/berlin/mueller-zu-besuchin-der-charite-wie-sich-berlins-groesstes-krankenhausauf-den-corona-ernstfall-vorbereitet/25714372.html April 26 https://www.japantimes.co.jp/news/2020/04/26/ national/science-health/japan-icu-bed-shortage-most-prefectures-coronavirus-peak/#.XrMwYC2ZOCM April 3 https://as.com/diarioas/2020/04/03/actualidad/ 1585905064_448015.html 0.54 April 29 https://www.gob.pe/institucion/minsa/noticias/142142-peru-implemento-822-camas-uci-para-la-atencion-de-pacientes-covid-19 March 20 https://www.cbc.ca/news/canada/british-columbia/ bc-hospital-beds-covid-19-1.5505356 April 8, https://publichealth.uga.edu/athens-covid-19-hospitalizations-new-report/ Mobility data of Decentralized Administration of Thessaly and Central Greece 0.66 March 26 https://www.lanacion.com.ar/sociedad/coronavirus-estan-preparadas-terapias-intensivas-del-pais-nid2347722 May 7, Austrian Ministry of Health https:// info.gesundheitsministerium.at/dashboard_Hosp.html?l=en March 19, https://theconversation.com/how-well-avoid-australias-hospitals-being-crippled-by-coronavirus-133920 https://www.health.nsw.gov.au/Infectious/covid-19/ communities-of-practice/documents/covid-19-adult-intensive-care-pandemic-response-planning.pdf May 3, https://www.rte.ie/news/2020/0503/1136299-coronavirus-ireland/ April 14, https://www.eltiempo.com/colombia/otras-ciudades/ camas-en-colombia-para-atender-a-paciente-con-coronavirus-484048 Supplementary Figure S7 | Table with the response of 16 cities during the COVID-19 pandemic.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "We thank Luis Rodrigo Moreno Morton, Pablo Barberis, Leonid Fridman, Saul Hernandez, Alejandro Vargas, Sebastian Michel Mata for helpful discussions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgements."
        },
        {
            "text": "For obtaining the optimal path it is useful to construct some system trajectories (not all of them are really required for the final calculation, though). Let us define the initial point x 0 = (S 0 , I 0 ) and the final point as x f = S , I max = \u03b3 \u03b2 , I max . x f is the point of the target set at the upper right corner. The trajectories (or orbits) we want to find are four:1. \u03c6 (t, x 0 , u = 0). In words, it is the trajectory without control starting at x 0 .2. \u03c6 (t, x 0 , u max ). In words, it is the trajectory with maximal control starting at x 0 .3. \u03c6 \u2212t, x f , u = 0 . In words, it is the trajectory without control that ends in x f . 4. \u03c6 \u2212t, x f , u * : In words, it is the trajectory with control u * = min 1 \u2212 \u03b3 \u03b2S , u max that ends at x f . The control u * is such that this trajectory does not violate the restriction I \u2264 I max . For values of S \u2265 S * , it is equal to u max , and for S \u2264 S * it is the control for the singular arc, i.e., it maintains I = I max until x f is reached.These trajectories are presented in Fig. S2 for the parameters: \u03b2 = 0.52, \u03b3 = 1 5 , I max = 0.1, S 0 = 0.99, I 0 = 0.01 and u max = 0.4. There are also some key points to find, besides the initial x 0 and final x f ones. These are:\u2022 The \"blue\" point S ,\u012a in Fig. S2 where \u03c6 (t, x 0 , u = 0) attains its maximum value,This is the same point at which this trajectory crosses the critical valueS = \u03b3 \u03b2 after which I < 0 with zero control.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 1036,
                    "end": 1043,
                    "text": "Fig. S2",
                    "ref_id": null
                },
                {
                    "start": 1258,
                    "end": 1265,
                    "text": "Fig. S2",
                    "ref_id": null
                }
            ],
            "section": "S1.6 The optimal path"
        }
    ]
}