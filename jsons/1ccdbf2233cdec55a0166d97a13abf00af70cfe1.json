{
    "paper_id": "1ccdbf2233cdec55a0166d97a13abf00af70cfe1",
    "metadata": {
        "title": "The Tajima heterochronous n-coalescent: inference from heterochronously sampled molecular data",
        "authors": [
            {
                "first": "Lorenzo",
                "middle": [],
                "last": "Cappello",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Stanford University",
                    "location": {}
                },
                "email": ""
            },
            {
                "first": "Amandine",
                "middle": [],
                "last": "V\u00e9ber",
                "suffix": "",
                "affiliation": {
                    "laboratory": "CMAP",
                    "institution": "\u00c9cole Polytechnique",
                    "location": {
                        "postBox": "I.P. Paris"
                    }
                },
                "email": ""
            },
            {
                "first": "Julia",
                "middle": [
                    "A"
                ],
                "last": "Palacios",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Stanford University",
                    "location": {}
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "The observed sequence variation at a locus informs about the evolutionary history of the sample and past population size dynamics. The standard Kingman coalescent model on genealogies -timed trees that represent the ancestry of the sample -is used in a generative model of molecular sequence variation to infer evolutionary parameters. However, the state space of Kingman's genealogies grows superexponentially with sample size n, making inference computationally unfeasible already for small n. We introduce a new coalescent model called Tajima heterochronous n-coalescent with a substantially smaller cardinality of the genealogical space. This process allows to analyze samples collected at different times, a situation that in applications is both met (e.g. ancient DNA and RNA from rapidly evolving pathogens like viruses) and statistically desirable (variance reduction and parameter identifiability). We propose an algorithm to calculate the likelihood efficiently and present a Bayesian nonparametric procedure to infer the population size trajectory. We provide a new MCMC sampler to explore the space of Tajima's genealogies and model parameters. We compare our procedure with state-of-the-art methodologies in simulations and applications. We use our method to re-examine the scientific question of how Beringian bison went extinct analyzing modern and ancient molecular sequences of bison in North America, and to reconstruct population size trajectory of SARS-CoV-2 from viral sequences collected in France and Germany.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Statistical inference of evolutionary parameters from a sample of n DNA sequences accounts for the dependence among samples and models observed variation through two stochastic processes: an ancestral process of the sample represented by a genealogy g, which depends on the effective population size trajectory (N e (t)) t\u22650 , and a mutation process with a given set of parameters \u00b5 that, conditionally on g, models the phenomena that have given rise to the sequences. However, state-of-the-art methodologies are not scalable to the amount of data available because the latent space of genealogies lives in a high dimensional space. In this paper, we tackle the problem of scalability from a modeling perspective: we propose a new ancestral process for heterochronous data that dramatically reduces the state space of genealogies. We complement this model with a new algorithm for fast likelihood calculations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Inference for (N e (t)) t\u22650 has important applications in many fields, such as genetics, anthropology, and public health. In the absence of natural selection, the effective population size can be used to approximate census population size. While census population size estimates can be difficult to obtain due to high costs and challenging sampling designs, we can reconstruct past population sizes from observed signatures of genetic diversity in a sample of the population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "For example, one can estimate the population size of a virus from genetic samples in a situation where census counts are believed to be inaccurate, as it is common during an epidemic. Inferring population size dynamics -timing of population events, growth and decline rates -rather than estimating census counts, may be of scientific interest. For example, Shapiro et al. (2004) reconstructed bison population dynamics, providing new insights into the extinction of Beringian bison. In this paper, we include two studies supporting the motivations highlighted above: in one study we analyze viral samples of SARS-CoV-2, the virus responsible for the coronavirus disease, and in a second study, we analyze ancient samples of bison in North America (dataset described by Froese et al. (2017) ).",
            "cite_spans": [
                {
                    "start": 357,
                    "end": 378,
                    "text": "Shapiro et al. (2004)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 769,
                    "end": 789,
                    "text": "Froese et al. (2017)",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Both Bayesian and frequentist methods rely on the marginal likelihood computed by integrating over the space G n of tree topologies with n leaves, and over the space of branch lengths. That Ancestral sequence Figure 1 : Coalescence and mutation. A genealogy of 10 individuals at a locus of 100 sites is depicted as a bifurcating tree. Six mutations (at different sites) along the branches of the tree give rise to the 10 sequences. The 94 sites that do not mutate are represented by black dots in the ancestral sequence. The nucleotides at the polymorphic sites are shown, and the colored arrows depict how ancestral sites are modified by mutation.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 209,
                    "end": 217,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "where the n \u2212 1 random variables with values in R + are the times between consecutive coalescence events in the genealogy, and \u03c0(\u00b7 | (N e (t)) t\u22650 ) denotes the probability distribution on G n \u00d7 R n\u22121 + implied by the ancestral process as a function of the past population size trajectory (N e (t)) t\u22650 . The genealogy g is an auxiliary variable introduced to compute P (Y | g, N e (t), \u00b5)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "because direct calculation of the marginal P (Y|N e (t), \u00b5) is intractable. The prevailing consensus in the literature is to compute (1) with \u03c0 defined as the Kingman-coalescent prior law on leaflabeled genealogies (formally introduced in Kingman (1982a,b) ). However, the cardinality of G n grows superexponentially with n (|G n | = n!(n \u2212 1)!/2 n\u22121 ), creating a computational bottleneck in the calculation of the integral (1) .",
            "cite_spans": [
                {
                    "start": 133,
                    "end": 136,
                    "text": "(1)",
                    "ref_id": null
                },
                {
                    "start": 239,
                    "end": 256,
                    "text": "Kingman (1982a,b)",
                    "ref_id": null
                },
                {
                    "start": 425,
                    "end": 428,
                    "text": "(1)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "An alternative to the Kingman n-coalescent is to use a lower resolution coalescent process, known as the Tajima n-coalescent (Tajima, 1983; Sainudiin et al., 2015; Palacios et al., 2019) .",
            "cite_spans": [
                {
                    "start": 125,
                    "end": 139,
                    "text": "(Tajima, 1983;",
                    "ref_id": "BIBREF35"
                },
                {
                    "start": 140,
                    "end": 163,
                    "text": "Sainudiin et al., 2015;",
                    "ref_id": "BIBREF30"
                },
                {
                    "start": 164,
                    "end": 186,
                    "text": "Palacios et al., 2019)",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "While the state space of the Kingman n-coalescent is in bijection with the set of timed and labeled binary trees with n leaves, the state space of the Tajima n-coalescent is in bijection with the set of timed and unlabeled binary trees with n leaves. The cardinality of the space of the timed and unlabeled binary tree topologies with n leaves is given by the (n \u2212 1)-th Euler zigzag number (Disanto and Wiehe, 2013) , which behaves like 2(2/\u03c0) n (n \u2212 1)! when n increases. While the cardinality of the space of Tajima trees still grows superexponentially in n, its rate of growth is drastically smaller than that of the space of Kingman trees. Palacios et al. (2019) show that when all sequences are sampled at the same time, employing the Tajima coalescent allows fast inference of (N e (t)) t\u22650 .",
            "cite_spans": [
                {
                    "start": 391,
                    "end": 416,
                    "text": "(Disanto and Wiehe, 2013)",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 645,
                    "end": 667,
                    "text": "Palacios et al. (2019)",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The main focus of this work is to develop a scalable model for sequences observed at different time points like those at the tips of the genealogy in Figure 1 . The need to model heterochronous data is motivated by both applications and statistical reasons. In applications, viral samples (HIV, influenza) are routinely collected serially. Ancient DNA studies are another very active area of research in which the sampling design is intrinsically sequential. At least two statistical reasons are motivating this model. First, it usually leads to a decrease in the variance of the estimate (Felsenstein and Rodrigo, 1999) . In coalescent-based inference, the smaller the number of extant lineages in a given time interval, the greater the variance of our estimate of the interval length, and consequently, the greater the variance of any estimate that depends on that length such as (N e (t)) t\u22650 . By including heterochronous samples, we can increase the number of active lineages in the past, and thus obtain better estimates. Second, Parag and Pybus (2019) show that including heterochronous samples is necessary (in some cases) to make the parameters describing (N e (t)) t\u22650 identifiable. The main challenge in employing Tajima genealogies for coalescent-based inference is that the sequence data can be allocated, i.e. mapped, to a given genealogy, in many possible ways. The allocation is necessary to compute the likelihood. To find all possible maps, Palacios et al. (2019) use a backtracking algorithm that proceeds in a bottom-up fashion: starting from the tips of the tree, the algorithm moves along the tree to the root checking for possible allocations of subsets of the data Y to clades of the tree g. Our proposal reverts this process and proceeds in a top to bottom fashion eliminating the backtracking step and reducing its computational complexity. While there is no exact analytical expression for the computational complexity of the backtracking algorithm, a loose upper bound of the backtracking algorithm is O(n!), which we bring down to O(n 2 ) with our new proposal. The lower bound is of the order of O(n) for both algorithms. The algorithm relies on a novel graphical representation of the data as a tree structure. We note that this tree is related to the definition of the directed acyclic graph (DAG) used in Palacios et al. (2019) , with some important differences. The DAG depends on g whereas the tree we introduced is solely a function of the data. This implies that we need to define it only once. Also, the DAG groups sequences differently since it does not incorporate sampling time information.",
            "cite_spans": [
                {
                    "start": 289,
                    "end": 305,
                    "text": "(HIV, influenza)",
                    "ref_id": null
                },
                {
                    "start": 589,
                    "end": 620,
                    "text": "(Felsenstein and Rodrigo, 1999)",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 1036,
                    "end": 1058,
                    "text": "Parag and Pybus (2019)",
                    "ref_id": "BIBREF27"
                },
                {
                    "start": 1459,
                    "end": 1481,
                    "text": "Palacios et al. (2019)",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 2338,
                    "end": 2360,
                    "text": "Palacios et al. (2019)",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [
                {
                    "start": 150,
                    "end": 158,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "The rest of the paper proceeds as follows. In Section 2, we define the Tajima heterochronous n-coalescent. In Section 3, we introduce the mutation model we shall assume, describe the data, define the likelihood and the new algorithm to compute it. Section 4 describes the MCMC algorithm for posterior inference, and in Section 5, we present a comprehensive simulation study outlininghow the model works and comparing our method to state-of-the-art alternatives. In Section 6, we analyze modern and ancient bison sequences described in Froese et al. (2017) . In Section 7, we apply our method to SARS-CoV-2 viral sequences collected in France and in Germany.",
            "cite_spans": [
                {
                    "start": 535,
                    "end": 555,
                    "text": "Froese et al. (2017)",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Section 8 concludes. An open-source implementation is given in R package phylodyn, which is available for download at https://github.com/JuliaPalacios/phylodyn.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The Tajima heterochronous n-coalescent is an inhomogeneous continuous-time Markov chain that describes the ancestral relationships of a set of n individuals sampled, possibly at different times, from a very large population. The set of ancestral relationships of the sample is represented by a ranked genealogy as the one depicted in Figure 2 . Every organism is dated and labeled according to the time in which the organism lived (if ancient, by radiocarbon date) or in which the living organism was sequenced. In this generalization of the Tajima coalescent, each pair of extant ancestral lineages merges into a single lineage at an instantaneous rate which depends on the current effective population size N e (t), and new lineages are added when one of the prescribed sampling times is reached. In this work, we do not model the stochasticity of sampling times but we condition on them as being fixed. Tajima heterochronous n-coalescent with n = (7, 3) and s = (s 1 , s 2 ), represented as a ranked tree shape with coalescence and sampling times, denoted g. The column to the right displays the corresponding jump chain (see the text for notation). Let us introduce some notation. Let m be the number of sampling time points and n be the total number of samples. Let n = (n 1 , . . . , n m ) denote the number of sequences collected at times s = (s 1 , . . . , s m ), with s 1 = 0 denoting the present time, and s j > s j\u22121 for j = 2, . . . , m (time goes from present towards the past). We refer to the sequences counted in n i as \"belonging 6 to sampling group s i \". Let t = (t n+1 , . . . , t 2 ) be the vector of coalescent times with t n+1 = 0 < t n < ... < t 2 ; these are the times when two lineages have a common ancestor. Note that the subscript in t k does not indicate the current number of lineages, as it is often done in the coalescent literature, but it indicates the number of lineages that have yet to coalesce (some sequences may not have been sampled yet). We use the rank order of the coalescent events (bottom-up) to label the internal nodes of the genealogy. That is, the node corresponding to the coalescent event occurring at time t n is labeled 1 (see t 10 in Figure 2 ), the node corresponding to the coalescence event occurring at time t n\u22121 is labeled 2, etc. We refer to the internal node labels as vintages (i.e., rankings).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 334,
                    "end": 342,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 2190,
                    "end": 2198,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "The Tajima heterochronous n-coalescent is the process (a(t), b(t)) t\u22650 that keeps track of a(t), ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "can be obtained by merging two lineages of (a(t i \u2212), b(t i \u2212)) and |b| denotes the cardinality of the set b.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "Observe that the quantity m j=1 a j (t i \u2212) + |b(t i \u2212)| appearing in (2) corresponds to the total number of extant lineages just before the event at t i . Furthermore, since only two lineages coalesce at time t i , at most two terms in the product appearing in the numerator of (2) are not equal to one. Finally, if m = 1, (2) degenerates into the transition probabilities of the Tajima isochronous n-coalescent; on the other hand if m = n, the process degenerates into the Kingman heterochronous n-coalescent since all singletons are uniquely labeled by their sampling times. To define the distribution of the holding times, we introduce the following notation. We denote the intervals that end with a coalescent event at t k by I 0,k and the intervals that end with a sampling time within the interval (t k+1 , t k ) as I i,k where i \u2265 1 is an index tracking the sampling events in (t k+1 , t k ). More specifically, for every k \u2208 {2, . . . , n}, we define",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "and for every i \u2265 1 we set",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": ") with the max taken over all s j\u2212i+1 > t k+1 and s j < t k . (4)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "We also let n i,k denote the number of extant lineages during the time interval I i,k . For example, 8 in Figure 2 , in (t 9 , t 8 ) we have I 0,8 = [s 2 , t 8 ), I 1,8 = [t 9 , s 2 ) and no I i,8 for i \u2265 2. The vector of coalescent times t is a random vector whose density with respect to Lebesgue measure on R n\u22121 + can be factorized as the product of the conditional densities of t k\u22121 knowing t k , which reads: for k = 3, ..., n + 1,",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 106,
                    "end": 114,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "where t n+1 = 0 by convention, C i,k := n i,k 2 , and the integral over I i,k\u22121 is zero if there are less than i sampling times between t k and t k\u22121 . The distribution of the holding times defined above corresponds to the same distribution of holding times in the heterochronous Kingman coalescent (Felsenstein and Rodrigo, 1999) . Although the heterochronous Tajima coalescent takes value on a different state space, it remains true that every pair of extant lineages coalesces at equal rate.",
            "cite_spans": [
                {
                    "start": 299,
                    "end": 330,
                    "text": "(Felsenstein and Rodrigo, 1999)",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "Finally, given n, s and t, a complete realization of the Tajima heterochronous n-coalescent chain can be uniquely identified with a partially labeled binary ranked tree shape g of n = (n 1 , . . . , n m ) samples at (s 1 , . . . , s m ) with its n \u2212 1 coalescent transitions, so that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "Equation (6) gives the prior probability of the tree topology under the Tajima heterochronous n-coalescent. Putting together (5) and (6), we obtain a prior \u03c0(g | s, n, (N e (t)) t\u22650 ) \u03c0(g | s, n, (N e (t)) t\u22650 ) = P (g | t, s, n) n+1 k=3 p(t k\u22121 | t k , s, n, (N e (t)) t\u22650 ),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "which can be used in (1) .",
            "cite_spans": [
                {
                    "start": 21,
                    "end": 24,
                    "text": "(1)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "2 The Tajima heterochronous n-coalescent"
        },
        {
            "text": "We assume that the observed data Y consists of n sequences at z polymorphic (mutating) sites at a non-recombining contiguous segment of DNA of organisms with low mutation rate. Under these assumptions, a widely studied mutation model is the infinite sites model (ISM) (Kimura, 1969; Watterson, 1975) with Poissonian mutation, which corresponds to throwing a Poisson point process of mutations on the branches of g at rate \u00b5 such that every mutation occurs at a different site and no mutations are hidden by a second mutation affecting the same site.",
            "cite_spans": [
                {
                    "start": 268,
                    "end": 282,
                    "text": "(Kimura, 1969;",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 283,
                    "end": 299,
                    "text": "Watterson, 1975)",
                    "ref_id": "BIBREF36"
                }
            ],
            "ref_spans": [],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "An important consequence of the ISM is that Y can be represented as an incidence matrix Y 1 and a frequency counts matrix Y 2 . Y 1 is a k \u00d7 z matrix with 0-1 entries, where 0 indicates the ancestral type and 1 indicates the mutant type; k is the number of unique sequences (or haplotypes) observed in the sample, and the columns correspond to polymorphic sites. Y 2 is a k \u00d7 m count matrix where the (i, j)th entry denotes how many haplotype i sequences belonging to group s j are sampled. For example, the n = 10 sequences defined by the realizations of the ancestral and mutation processes depicted in Figure 1 can be summarized into Y 1 and Y 2 displayed in Figure 3 (A).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 605,
                    "end": 613,
                    "text": "Figure 1",
                    "ref_id": null
                },
                {
                    "start": 662,
                    "end": 670,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "Y 1 and Y 2 can alternatively be represented graphically as an augmented perfect phylogeny T. This graphical representation of the data is exploited by our likelihood algorithm. The augmented perfect phylogeny representation is an extension of the gene tree or perfect phylogeny (Gusfield, 1991; Griffiths and Tavare, 1994; Palacios et al., 2019) representation to the heterochronous case. The standard perfect phylogeny definition leaves out the information carried by Y 2 . To our knowledge, Gusfield's approach has never been generalized to the heterochronous case. In the augmented perfect phylogeny T = (V, E), V is the set of nodes of T, and E is the set of weighted edges. We define T as follows:",
            "cite_spans": [
                {
                    "start": 279,
                    "end": 295,
                    "text": "(Gusfield, 1991;",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 296,
                    "end": 323,
                    "text": "Griffiths and Tavare, 1994;",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 324,
                    "end": 346,
                    "text": "Palacios et al., 2019)",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "1. Each haplotype labels at least one leaf in T. If a haplotype is observed at k different sampling times, then k leaves in T will be labeled by the same haplotype. The pair (haplotype label, sampling group) uniquely labels each leaf node. is summarized as an incidence matrix Y 1 (h denotes the haplotypes, l the segregating sites, the colors correspond to those depicted in Figure 1 ) and a matrix of frequencies Y 2 (s denotes the sampling group). Panel (B): T denotes the perfect phylogeny corresponding to Y 1 and Y 2 ; each of the 6 polymorphic sites labels exactly one edge. When an edge has multiple labels, the order of the labels is irrelevant. Each leaf node is labeled by a pair (haplotype, sampling time), with each haplotype possibly labeling more than one leaf nodes. Panel (C): |E i | corresponds to the number of mutations along the edge subtending node V i in (B) and |V i | corresponds to the number of sequences descending from V i in (B), see the text for details.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 376,
                    "end": 384,
                    "text": "Figure 1",
                    "ref_id": null
                }
            ],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "2. Each of the z polymorphic sites labels exactly one edge. When multiple sites label the same edge, the order of the labels along the edge is arbitrary. Some external edges (edges subtending leaves) may not be labeled, indicating that they do not carry additional mutations to their parent node.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "3. For any pair (haplotype h k , sampling group), the labels of the edges along the unique path from the root to the leaf h k specify all the sites where h k has the mutant type. Figure 3 (B) plots T corresponding to Y 1 and Y 2 displayed in Figure 3 (A). Observe that T includes sampling information in the leaf labels. In the example, h C labels two leaves because it is observed at times s 1 and s 2 . The corresponding edges E 3 and E 4 are unlabeled, i.e., no mutations are allocated to those edges because the underlying nodes carry identical sequences (same haplotype). We \"augment\" Gusfield's perfect phylogeny because the sampling information is crucial in the likelihood calculation.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 179,
                    "end": 187,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 242,
                    "end": 250,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "T implicitly carries some quantitative information that can be quickly summarized. We denote the number of observed sequences subtended by an internal node V by |V |. If V is a leaf node, |V | denotes the frequency of the haplotype h observed at the corresponding sampling time s. Similarly, we denote the number of mutation labels assigned to an edge E by |E|. If no mutations are assigned to E, then |E| = 0. For parsimony, the edge that connects node V i to its parent node is denoted by E i . See Figure 3 (C) for an example. Gusfield (1991) gives an algorithm to construct the \"traditional perfect phylogeny\" T' in linear time. Constructing T from T' is straightforward since all we need is to incorporate the sampling information and add leaf nodes if a haplotype is observed at multiple sampling times.",
            "cite_spans": [
                {
                    "start": 530,
                    "end": 545,
                    "text": "Gusfield (1991)",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [
                {
                    "start": 501,
                    "end": 509,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "If we drew T from the data in Figure 3 , it would not have node V 4 , but only a single node V 3 labeled by haplotype h C . A description of the algorithm can be found in the supplementary material.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 30,
                    "end": 38,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Infinite Sites Model and the Perfect Phylogeny"
        },
        {
            "text": "The crucial step needed to compute the likelihood of a Tajima genealogy g is to sum over all possible allocations of mutations to its branches. This can be efficiently done by exploiting the augmented perfect phylogeny representation of the data T and by first mapping nodes of T to subtrees of g. We stress that the need for an allocation step arises only when working with Tajima genealogies. In Kingman's coalescent, tree leaves are labeled by the sequences to which they correspond, and so there is a unique possible allocation. In Tajima's coalescent, leaves are unlabeled, creating potential symmetries in the tree, and so we have to scan all the possible ways in which the observed sequences may be allocated to g.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood"
        },
        {
            "text": "Let a denote a possible mapping of nodes of T to subtrees of g. a is encoded as a vector of length n \u2212 1, where the i-th entry gives the node in T which is mapped to the subtree with vintage i, g i (including the branch that subtends vintage i). Our algorithm first maps all non-singleton nodes V of T to subtrees of g, that is, only nodes such that |V | > 1 are entries of a. Singleton nodes in T (V \u2208 V such that |V | = 1) are treated separately and are initially excluded from the allocation step. For example, Figure 4 shows a possible vector a whose entries are the non-singleton nodes V 0 , V 1 , V 2 , and V 5 of T of Figure 3 . We note that nodes can appear more than once in a, meaning that they can be mapped to more than one subtree. On the other hand, a single node V i is not necessarily mapped to all the vintages, leaves and internal branches of g j ; different nodes may be mapped to some subtrees of g j (including external branches), leading to a situation where V i is mapped to only a subset of the vintages and branches constituting g j . For example, in Figure 4 , V 1 is mapped to g 6 and g 3 , but V 2 is mapped to g 1 , a subtree of both g 6 and g 3 ; hence V 1 is only mapped to the green part of g 6 and g 3 as depicted in the Figure. The precise mapping of nodes in T to subtrees of g described below is needed to allocate mutations in T to branches of g. We will explain the allocation of mutations on g for a given a in the next subsection.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 514,
                    "end": 522,
                    "text": "Figure 4",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 625,
                    "end": 633,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 1076,
                    "end": 1084,
                    "text": "Figure 4",
                    "ref_id": "FIGREF6"
                },
                {
                    "start": 1254,
                    "end": 1261,
                    "text": "Figure.",
                    "ref_id": null
                }
            ],
            "section": "Allocations"
        },
        {
            "text": "We now define an algorithm to efficiently find all possible mappings a for a given g. We encode the set of all possible a, as an #a \u00d7 (n \u2212 1) matrix A, where each row is a possible a (n \u2212 1 columns) and the number of rows #a is equal to the number of possible allocations. To generate A, the algorithm proceeds recursively from top to bottom in g, by sweeping through subtrees in g and matching them to nodes in T according to parent-offspring relationships and number of descendants in both T and g.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": "To be more precise, the algorithm is initialized by setting",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": ", V 0 is mapped to all subtrees in g. The algorithm proceeds iteratively, adding and removing rows from A, iterating over an index i going from n \u2212 2 to 1. The first step is to define A(i), the set of node allocations in the i-th column of A. Then for all V \u2208 A(i), the algorithm iterates through the following steps: define T V as the set",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": "the submatrix of A obtained by extracting all the row vectors whose I-th elements are V . The",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": "The simple rule described above is fast to compute but it leads to incorrect allocations because nodes may be mapped a redundant number of times. For example, it is easy to see that implementing the algorithm above, we could define an allocation a where node V 2 is allocated to all subtrees of size two; however, V 2 should be allocated at most once. This issue can be avoided by noting that internal nodes in V should appear in each a a number of times equal to their number of child nodes minus one, while leaf nodes, say V \u2208 V, should appear |V | \u2212 1 times. Hence, we complete each iteration by eliminating rows of A where this rule is violated.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": "A second elimination rule is needed to account for the constraints imposed by the sampling time information: rows are eliminated when their assignments involve nodes labeled by a sampling time s \"matched\" to subtrees of g that have leaf branches terminating at a different sampling time. Algorithm 1 in the Appendix summarizes the above description. Figure 5 gives examples of possible allocations of T to two different genealogies g and g'.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 350,
                    "end": 358,
                    "text": "Figure 5",
                    "ref_id": "FIGREF8"
                }
            ],
            "section": "Allocations"
        },
        {
            "text": "The second genealogy g' differs from g by the order of the coalescent events 3 and 6 which are inverted. g and g' share the common allocation",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": ". This difference is due to the fact that V 5 has three descendants belonging to sampling group s 1 , while g has two subtrees with 3 leaves sampled at s 1 , and g' has only one. We note that The two genealogies differ solely by the inversion of the coalescent events 3 and 6. This change gives rise to differences in the possible allocations: for example, V 5 can be mapped to the subtree defined by node 3 in g but not in g'.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": "singleton nodes also need to be allocated, both in a 1 and a 2 . We will elaborate on this point in the next subsection.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Allocations"
        },
        {
            "text": "To calculate the likelihood, we assume the ISM of mutations and that mutations occur according to a Poisson point process with rate \u00b5 on the branches of g, where \u00b5 is the total mutation rate. To compute the likelihood we need to map mutations in T to branches of g and this is done for each mapping a i of non-singleton nodes of T to subtrees of g . For every V in T such that |V | > 1,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "we define E V as the set formed by the edges in T that subtend singleton children of V and, with the exception of V = V 0 , E V in addition includes the edge that subtends V . For the example in Figure 3 ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 195,
                    "end": 203,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Likelihood Calculations"
        },
        {
            "text": "where we recall that #a is the number of possible allocations, we have written N e = (N e (t)) t\u22650 , and P (V, E V , a i | g, N e , \u00b5) is the probability of observing the mutations of the E V edges along the corresponding branches of g defined by the mapping a i as follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "If V has no singleton child nodes, then E V = {E} and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "where l is the length of the branch in g that subtends g j , j is the largest index such that a i,j = V , and T denotes the length of the subtree in g to which V is mapped in a i (as described in Subsection 3.2.1). For example, considering V 2 in Figure 4 , we have T 2 = 2t n + (t n\u22122 \u2212 t n ) and l = (t n\u22122 \u2212 t n ) is the length of the branch connecting vintage 1 to vintage 3.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 247,
                    "end": 255,
                    "text": "Figure 4",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Likelihood Calculations"
        },
        {
            "text": "If node V has singleton child nodes,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "where the first term on the r.h.s is defined exactly as the quantity on the r.h.s. of (9), while the second term corresponds to the probability of all possible different matchings between R 1 , . . . , R k , the first k indexes such that a i,R j = V , and |E ch 1 |, |E ch 2 |, . . . , |E ch k |, the k numbers of mutations observed on the edges E ch 1 , . . . , E ch k leading to the child nodes of V . In this expression, \u03a0(E V ) is the set of all possible such matchings R.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 428,
                    "end": 431,
                    "text": "V )",
                    "ref_id": null
                }
            ],
            "section": "Likelihood Calculations"
        },
        {
            "text": "Before defining \u03a0(E V ) more precisely, we make two observations. First, not all matchings are possible since not all leaf branches terminate at the same time (heterochronous sampling).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "Second, it is enough to consider the allocations that contribute to distinct likelihood values, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "allocations for which the underlying samples are \"distinguishable\" in the sense that they have a different number of mutations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "We define \u03a0(E V ) as the set of all possible \"distinct matchings of number of observed singleton mutations to singleton branches\", that is, allocations which lead to a distinct likelihood values. To construct \u03a0(E V ), we first partition the singleton edges E ch 1 , . . . , E ch k according to the sampling times of the corresponding nodes V ch 1 , . . . , V ch k . Let k i be the number of nodes in {V ch 1 , . . . , V ch k } with sampling time s i , i.e., the size of each subset of the partition. We then further partition these subsets by grouping together the edges carrying the same number of mutations (defined as |E ch 1 |, . . . , |E ch k |). For each given sampling time s j , let k (1) j , . . . , k (m j ) j denote the cardinalities of the m j sub-subsets obtained by this procedure, so that k j =",
            "cite_spans": [
                {
                    "start": 693,
                    "end": 696,
                    "text": "(1)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "where the product in (11) is the number of permutations with repetition of the different edges that are compatible with the data in terms of sampling times and numbers of mutations carried.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "Note that Equation (11) is not the same as Equation (6) Lastly, we note that knowing a priori the full matrix A allows to compute efficiently the likelihood (8) via a sum-product algorithm. Indeed, for each V \u2208 V * there may be several rows",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "is the same, due to the fact that V is mapped to the same subtree in all these allocations. For such a V , one could compute the likelihood corresponding to these r allocations a 1 , . . . , a r in the following way:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "The exact sum-product formulation of (8) is specific to the observed Y and A.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood Calculations"
        },
        {
            "text": "In Section 2 we have introduced a new prior for genealogies and in Section 3, we have expounded how to compute the likelihood of heterochronous data Y generated by a Poisson process of mu-tations superimposed on this new genealogy. We finally need to specify a prior distribution on (N e (t)) t\u22650 to complete our Bayesian model. In this paper, we follow Palacios and Minin (2013) , who place a Gaussian process (GP) prior on (log(N e (t))) t\u22650 (the logarithm is used to ensure that N e (t) \u2265 0 for all t). We thus have:",
            "cite_spans": [
                {
                    "start": 354,
                    "end": 379,
                    "text": "Palacios and Minin (2013)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Bayesian Model and MCMC inference"
        },
        {
            "text": "where C(\u03c4 ) is the covariance function of the Gaussian process. As in Palacios and Minin (2013) , for computational convenience we use Brownian motion with covariance elements Cov(log(N e (t)), log(N e (t )) = \u03c4 min(t, t )",
            "cite_spans": [
                {
                    "start": 70,
                    "end": 95,
                    "text": "Palacios and Minin (2013)",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Bayesian Model and MCMC inference"
        },
        {
            "text": "for any t, t > 0 as our GP prior. From (13), the posterior distribution can be written as \u03c0((log(N e (t))) t\u22650 , \u03c4, g|Y, \u00b5) \u221d P (Y|g, (log(N e (t))) t\u22650 , \u00b5)\u03c0(g|(log(N e (t))) t\u22650 )\u03c0((log(N e (t))) t\u22650 |\u03c4 )\u03c0(\u03c4 ),",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Bayesian Model and MCMC inference"
        },
        {
            "text": "which we approximate via MCMC methods. Full conditionals are not available, and so we use Metropolis-within-Gibbs updates. At each MCMC iteration, we jointly update ((log(N e (t))) t\u22650 , \u03c4 ) via a Split Hamiltonian Monte Carlo (HMC) (Shahbaba et al., 2014) suitably adapted to phylodynamics inference by Lan et al. (2015) ; then we update the topology g and t. We propose two Metropolis steps to update g and t. The latter may also be combined in a single step. The transitions for g and t are tailored to the Tajima n-coalescent genealogies. To update g, we employ the scheme in Palacios et al. (2019) . To update t, we propose a new sampler, which allows to propose branch lengths that account for the observed sampling times constraints, an issue specific to heterochronous samples under the ISM assumption and detailed in the next subsection.",
            "cite_spans": [
                {
                    "start": 233,
                    "end": 256,
                    "text": "(Shahbaba et al., 2014)",
                    "ref_id": "BIBREF32"
                },
                {
                    "start": 304,
                    "end": 321,
                    "text": "Lan et al. (2015)",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 580,
                    "end": 602,
                    "text": "Palacios et al. (2019)",
                    "ref_id": "BIBREF26"
                }
            ],
            "ref_spans": [],
            "section": "Bayesian Model and MCMC inference"
        },
        {
            "text": "Under the ISM hypothesis, mutations partition the observed sequences into two sets: the sequences that carry the mutations and the sequences that do not. This recursive partitioning of the sequences is graphically represented by T. As a consequence, not all topologies g and not all vectors t are compatible with the data, i.e. have posterior probability or density greater than 0.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Constraints imposed by the ISM hypothesis"
        },
        {
            "text": "The combinatorial constraints imposed by the ISM on the space of topologies are discussed in detail in Cappello and Palacios (2020) .",
            "cite_spans": [
                {
                    "start": 103,
                    "end": 131,
                    "text": "Cappello and Palacios (2020)",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "Constraints imposed by the ISM hypothesis"
        },
        {
            "text": "The constraints on t solely arise in the heterochronous case. First note that the definition of the Tajima heterochronous n-coalescent implies that there can be at most n 1 \u2212 1 coalescence events before s 2 , at most n 1 +n 2 \u22121 events before s 3 , and so on. Moreover, if there are shared mutations between some (but not all) samples with different sampling times, the maximum number of coalescent events between the involved sampling times is further restricted. In the example of Figure 3 (A), there is a shared mutation l 3 between 3 samples with sampling time s 1 and a sample with sampling time s 2 > s 1 . Out of the 7 samples obtained at time s 1 , the 3 samples that share the l 3 mutation could coalesce first some time between s 1 and s 2 (at most 2 coalescent events among the 4 sequences descending from node V 1 ), but they need to coalesce with the sample at time s 2 in node V 1 before they coalesce with the other 4 samples collected at time s 1 (those can coalesce at most 3 times between s 1 and s 2 ). Therefore, there are at most 5 coalescent events before s 2 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 483,
                    "end": 491,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Constraints imposed by the ISM hypothesis"
        },
        {
            "text": "To encode the constraints imposed by the sampling information, we define a vector c of length m, where the ith entry denotes the maximum number of coalescent events that can happen (strictly) before time s i for given Y, s and n. Trivially c 1 =0 because there are no samples. Let us stress that c does not define the number of coalescent events in a given interval (a quantity determined by t), but it is the maximum number of coalescent events that can happen before each sampling time to ensure compatibility with the data. In the example of Figure 3 (A), we have c = (0, 5). Note that c 2 is 5 and not n 1 \u2212 1 = 6. In the online supplementary material, we provide a greedy search algorithm to define c.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 545,
                    "end": 553,
                    "text": "Figure 3",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "Constraints imposed by the ISM hypothesis"
        },
        {
            "text": "Let \u2206t := (t n \u2212 t n+1 , . . . , t 2 \u2212 t 3 ) be the vector of intercoalescence times, and (\u2206t i ) i\u2208I the subvector of elements of \u2206t at positions I \u2286 {1, . . . , n \u2212 1}. The proposal is generated in three steps. First, we uniformly sample the number of intercoalescent times proposal moves -i.e., the cardinality of I, then we uniformly choose which times to modify -i.e., we define I, and lastly, we sample the proposals (\u2206t i ) i\u2208I . The first two steps balance between fast exploration of the coalescent times state-space and a high acceptance probability -few changes are expected to lead to higher acceptance rates while many changes are expected to lead to faster exploration of the state space. In our implementation we limit the maximum possible number of intercoalescent times moves to a fixed number Z n \u2212 1. Lastly, we sample new states (\u2206t i ) , for i \u2208 I from a truncated normal with mean \u2206t i and standard deviation \u03c3\u2206t i . The left tail is truncated by a parameter lo i , and the right tail is left unbounded. Three reasons motivate this choice: it has positive support, it can be centered and scaled around the current \u2206t i using a single parameter \u03c3, and we can set the lower bound lo i to ensure that only compatible times t are proposed. To set the values of lo i , we rely on c, the vector that specifies the maximum number of coalescent events possible before each sampling time. We note that the elements of c can be used to index coalescent times. In particular, t n\u2212c i denotes the time of the (c i + 1)th coalescent event. For example in Figure 2 , t n\u2212c 1 = t 10 is the first coalescent event, and t n\u2212c 2 = t 5 is the sixth coalescent event. Given c, lo i is set to",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 1564,
                    "end": 1572,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Coalescent times updates"
        },
        {
            "text": "where 1(i \u2264 c j + 1) is an indicator function. Equation (15) ensures the proposal t n\u2212c j \u2265 s j for all j. Indeed, note that t n\u2212c j = c j +1 k=1 \u2206t k . Hence, if (t n\u2212c j \u2212 \u2206t i ) \u2212 s j > 0 for any given j such that i \u2264 c j + 1, then the proposed value of (\u2206t i ) could be zero and still t n\u2212c j would be a compatible time. In this case, we do not need to impose any restriction on the lower bound of the truncated normal. On the other hand, if the vector considered in (15) has one or more positive values, the proposed value (\u2206t i ) should be large enough to ensure that for all sampling times s j , there will never be more than c j coalescent events before s j . In other words, we truncate the proposal distribution support to ensure the compatibility of t'. We discuss how to set Z and \u03c3 in Section 5.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coalescent times updates"
        },
        {
            "text": "The transition density of coalescent times is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coalescent times updates"
        },
        {
            "text": "with Truncated N(\u2206t i , \u03c3 it i , lo i , \u221e) denoting a truncated normal density function with mean \u2206t i , standard deviation \u03c3\u2206t i , lower bound lo i and upper bound \u221e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Coalescent times updates"
        },
        {
            "text": "We explore the ability of our procedure to reconstruct (N e (t)) t\u22650 in simulation across a range of demographic scenarios which capture realistic and challenging population size trajectories encountered in applications. The code for simulations and inference is implemented in R package phylodyn, which is available for download at https://github.com/JuliaPalacios/phylodyn.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulations"
        },
        {
            "text": "Simulation setup. Given n, s, and (N e (t)) t\u22650 , we simulate genealogies under the Tajima heterochronous n-coalescent (Section 2). Given a realized g and fixed \u00b5, we draw M mutations from a Poisson distribution with parameter \u00b5L (L is the length of the tree g: the sum of all branch lengths of g) and place them independently and uniformly at random along the branches of the timed genealogy. Y 1 , Y 2 and T are then constructed as described in Section 3.1. We simulate genealogies with three population scenarios:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Simulations"
        },
        {
            "text": ":",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A bottleneck (\"bottleneck\")"
        },
        {
            "text": "2. An instantaneous drop (\"drop\") :",
            "cite_spans": [
                {
                    "start": 25,
                    "end": 33,
                    "text": "(\"drop\")",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "21"
        },
        {
            "text": "3. Two periods of constant population size with an exponential growth in between (\"exp\"):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "21"
        },
        {
            "text": "For each scenario, we generated genealogies with three numbers of leaves (n = 14, 35, 70) and different n, s as summarized in Table 1 . The mutation parameter is varied to analyze the effect of the number of segregating sites on the quality of the estimation. We empirically assess the accuracy of our estimates with three commonly used criteria. The first one is the sum of relative errors (SRE).",
            "cite_spans": [
                {
                    "start": 73,
                    "end": 89,
                    "text": "(n = 14, 35, 70)",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 126,
                    "end": 133,
                    "text": "Table 1",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "21"
        },
        {
            "text": "where ( ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "21"
        },
        {
            "text": "whereN 97.5 (v i ) andN 2.5 (v i ) are respectively the 97.5% and 2.5% quantiles of the posterior distribution of N (v i ). Lastly, we consider the envelope measure defined by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "21"
        },
        {
            "text": "which measures the proportion of the curve that is covered by the 95% credible region. In this simulation study we fix k = 100, v 1 = 0 and v k = .8 t 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "21"
        },
        {
            "text": "MCMC tuning parameters. The posterior approximation is sensitive to both the initial values of (g, (N e (t)) t\u22650 ) and the MCMC parameters. We initialize g with the serial UPGMA (Drummond and Rodrigo, 2000) . In addition to the usual MCMC parameters such as chain length, burnin and thinning, there are three parameters specific to our method: the HMC step size , the maximum number of intercoalescent times proposals (Z), and the standard deviation \u03c3 that parametrizes the transition kernel k(t, t ). While all three parameters contribute to the mixing of the Markov chain and acceptance rates, in our experience, and \u03c3 are the most influential. In settings similar to the ones analyzed here (time scale, type of trajectory patterns, and mutation rate), parameter values \u2208 [0.03, 0.09], Z \u2208 {1, 2, 3}, and \u03c3 \u2208 [0.01, 0.03] lead to a similar mixing of the Markov chain and accuracy (w.r.t the metrics considered). We based these guidelines on extensive simulation studies on the 9 datasets considered (Table 1) , which we believe to be representative of a broad set of settings encountered in applications. In our simulations, we set = 0.07, Z = 2, and \u03c3 = 0.02 for the \"bottleneck\" and \"drop\" trajectories, and we set = 0.08, Z = 2, and \u03c3 = 0.02 for the \"exp\" trajectories.",
            "cite_spans": [
                {
                    "start": 178,
                    "end": 206,
                    "text": "(Drummond and Rodrigo, 2000)",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [
                {
                    "start": 1001,
                    "end": 1010,
                    "text": "(Table 1)",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "21"
        },
        {
            "text": "Inference is carried out with 3 \u00d7 10 5 iterations for n = 14, 4 \u00d7 10 5 iterations for n = 35 and Comparison to other methods. To our knowledge, no other method simultaneously deals with heterochronous data, assumes the ISM, samples Tajima genealogies and does Bayesian nonparametric inference. All available methodologies rely on the Kingman coalescent coupled with finite sites mutation models, with the Jukes-Cantor model (Jukes and Cantor, 1969) being the closest to the ISM. Hence, it is not fully possible to isolate the impact of using Tajima's genealogies in lieu of Kingman's. Nevertheless, we include some alternative estimates for completeness. We compare our results to two popular methodologies implemented in BEAST (Drummond et al., 2012) : the Bayesian Skyline (SKY) (Drummond et al., 2005) ",
            "cite_spans": [
                {
                    "start": 424,
                    "end": 448,
                    "text": "(Jukes and Cantor, 1969)",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 728,
                    "end": 751,
                    "text": "(Drummond et al., 2012)",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 781,
                    "end": 804,
                    "text": "(Drummond et al., 2005)",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "21"
        },
        {
            "text": "Field Skyride (GMRF) (Minin et al., 2008) . For the SKY and GMRF, we use the Jukes Cantor mutation model (Jukes and Cantor, 1969) , and approximate posterior distributions with 10 7 iterations after a burn-in period of 10 6 iterations and after thinning every 10 3 iterations. We also compare our results to an oracle estimator that infers (N e (t)) t\u22650 from the \"true\" g. The oracle estimation is obtained using the method of Palacios and Minin (2012) with the same Gaussian process prior on (N e (t)) t\u22650 . Note that the goal of the comparison is not to determine whether our method is superior, rather see if the performance of Tajima-based inference is in line with the results obtained through two popular Kingman-based methods in some challenging population scenarios.",
            "cite_spans": [
                {
                    "start": 21,
                    "end": 41,
                    "text": "(Minin et al., 2008)",
                    "ref_id": "BIBREF22"
                },
                {
                    "start": 105,
                    "end": 129,
                    "text": "(Jukes and Cantor, 1969)",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 427,
                    "end": 452,
                    "text": "Palacios and Minin (2012)",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "and the Gaussian Markov Random"
        },
        {
            "text": "Results. The results of the nine curves estimated with our method are plotted in Figure 6 . The supplementary material includes the plots for SKY and GMRF. True trajectories are depicted as dashed lines, posterior medians as black lines and 95% credible regions as gray shaded areas. Table 2 summarizes SRE, MRW, and ENV for the 9 simulated data sets achieved with our method (\"Tajima\"), SKY, GMRF, and \"Oracle\". SKY estimates for \"Exp\" n = 14 are not included because we could not obtain convergent runs. Accuracy increases with sample size: credible regions shrink substantially in all three scenarios. As n increases, posterior medians track more closely the true trajectories. It is well known in the literature that abrupt population size changes are the most difficult to recover. The \"drop\" and \"bottleneck\" scenarios are less accurate for n = 14, as exhibited by the wider credible region. We recover the bottleneck (panel first row and first column), but we do not recover the instantaneous drop (panel first row and third column). Table 2 : Simulation: performance comparison between Tajima and Oracle models. We compute three statistics -envelope (ENV), sum of relative errors (SRE) and mean relative width (MRW) -for three population trajectories (Bottle, Exp, Drop) and three population sizes (n = 14, 35, 70). Tajima refers to the estimation of (N e (t)) t\u22650 through our model, SKY refers to Drummond et al. (2005) , GMRF to Minin et al. (2008) . Oracle refers to the method of Palacios and Minin (2012) (known g). Bold depicts the method with the best performance (excluding the \"oracle\"). SKY \"Exp\" n = 14 results are not included because we could not obtain convergent runs. Table 5 largely confirms the analysis of Figure 6 . Recall that SKY and GMRF rely on Kingman coalescent rather than Tajima coalescent; SKY and GMRF methods assume a different mutation model, whereas Oracle relies on knowing the true g rather than computing its posterior.",
            "cite_spans": [
                {
                    "start": 1406,
                    "end": 1428,
                    "text": "Drummond et al. (2005)",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 1439,
                    "end": 1458,
                    "text": "Minin et al. (2008)",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [
                {
                    "start": 81,
                    "end": 89,
                    "text": "Figure 6",
                    "ref_id": "FIGREF12"
                },
                {
                    "start": 284,
                    "end": 291,
                    "text": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 1041,
                    "end": 1048,
                    "text": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 1692,
                    "end": 1699,
                    "text": "Table 5",
                    "ref_id": null
                },
                {
                    "start": 1733,
                    "end": 1741,
                    "text": "Figure 6",
                    "ref_id": "FIGREF12"
                }
            ],
            "section": "and the Gaussian Markov Random"
        },
        {
            "text": "First, no method unequivocally outperforms the others. The oracle methodology is the method with the best overall performance more frequently. Surprisingly, the advantage of knowing g is not as big as one would expect. Both SKY and GMRF have much narrower credible regions for the bottleneck trajectory. On the other hand, Tajima has the best overall performance in the \"drop\" trajectory (low SRE and MRW). Note that 100% ENV is not always an indicator of accuracy because it can be achieved with a very wide credible region.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "%ENV"
        },
        {
            "text": "Lastly, note that no method outperforms the others. This is consistent with theoretical expectations as we are comparing two resolutions of the same ancestral process. Reassuringly, Tajima Table 1 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 182,
                    "end": 188,
                    "text": "Tajima",
                    "ref_id": null
                },
                {
                    "start": 189,
                    "end": 196,
                    "text": "Table 1",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "%ENV"
        },
        {
            "text": "Recent advances in molecular and sequencing technologies allow recovering genetic material from ancient specimens (P\u00e4\u00e4bo et al., 2004) . In this section, we analyze modern and ancient bison sequences. These mammals offer a case study of a population experiencing a population growth followed by a decline. It was a long-standing question whether the drop was instigated by human intervention or by environmental changes. Shapiro et al. (2004) first reconstructed the genetic history of Beringian bisons. Their estimate for the start of the decline supports the environmental hypothesis, in particular, they suggest that the decline may be due to environmental events preceding the last glacial maxima (LGM). This data-set has been the subject of extensive Figure 7 : Bison study: data (Froese et al., 2017) .",
            "cite_spans": [
                {
                    "start": 114,
                    "end": 134,
                    "text": "(P\u00e4\u00e4bo et al., 2004)",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 421,
                    "end": 442,
                    "text": "Shapiro et al. (2004)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 785,
                    "end": 806,
                    "text": "(Froese et al., 2017)",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [
                {
                    "start": 756,
                    "end": 764,
                    "text": "Figure 7",
                    "ref_id": null
                }
            ],
            "section": "North American Bison data"
        },
        {
            "text": "Perfect phylogeny T of 38 bison sequences selected from Froese et al. (2017) data-set. Node labels depict the number of sequences subtending that node. The 91 mutations are allocated along the edges of T (all of them are single digits). Sampling information are not written in this Figure. The two vectors n and s are represented by the columns to the right of T. Sampling times are obtained by radiocarbon dating. The scale is number of years before present. research in the past decade.",
            "cite_spans": [
                {
                    "start": 56,
                    "end": 76,
                    "text": "Froese et al. (2017)",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [
                {
                    "start": 282,
                    "end": 289,
                    "text": "Figure.",
                    "ref_id": null
                }
            ],
            "section": "North American Bison data"
        },
        {
            "text": "We analyze new bison data recently described by Froese et al. (2017) . We fit our coalescent model to these sequences and estimate population size dynamics. To our knowledge, there is no phylodynamics analysis of this data set in the literature. Two motivations underlie this study: first, Shapiro et al. (2004) We selected 38 out of 50 sequences. We removed the control group sequences and the Siberian sequences to analyze samples from a single population (Froese et al. (2017) (Figure 1) suggested population structure). We removed the Bison latifrons sequence because it has 3803 ambiguities i.e., sites in a sequence that cannot be unambiguously assigned to a unique nucleotide For our inference procedure, we set = 0.09, Z 1 = 2, \u03c3 = 0.02, and approximated the posterior distribution with 1.5 \u00d7 10 6 iterations after a burn-in of 8 \u00d7 10 5 and after thinning every 200 iterations. As a comparison, we ran GMRF on BEAST and approximated the posterior distribution with 1\u00d710 7 iterations after a burn-in of 1\u00d710 6 and after thinning every 1000 iteration.",
            "cite_spans": [
                {
                    "start": 48,
                    "end": 68,
                    "text": "Froese et al. (2017)",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 290,
                    "end": 311,
                    "text": "Shapiro et al. (2004)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 458,
                    "end": 479,
                    "text": "(Froese et al. (2017)",
                    "ref_id": "BIBREF11"
                }
            ],
            "ref_spans": [
                {
                    "start": 480,
                    "end": 490,
                    "text": "(Figure 1)",
                    "ref_id": null
                }
            ],
            "section": "North American Bison data"
        },
        {
            "text": "We used the default values for all GMRF hyperparameters. We initialized both methods with the same genealogy (serial UPGMA). To compute the likelihood, we used the BEAST mutation rate estimate per site per year of 2.52 \u00d7 10 \u22128 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "North American Bison data"
        },
        {
            "text": "The first panel of Figure 8 plots a summary of the effective population size pattern recovered by a recent analysis of Shapiro et al. (2004) data by Faulkner et al. (2020) . While the precise timings and the details of the trajectory differ from method to method, the broad patterns are consistent. The population peak is estimated to be between 41.6 and 47.3 kya. The timing of the start of the decline is the main feature of interest. We plot the posterior medians (black lines) of (N e (t)) t\u22650 along with the 95% credible regions (gray area) obtained from posterior samples by sampling Tajima's trees (\"Tajima\", second panel) and Kingman's trees (\"GMRF\", third panel).",
            "cite_spans": [
                {
                    "start": 119,
                    "end": 140,
                    "text": "Shapiro et al. (2004)",
                    "ref_id": "BIBREF33"
                },
                {
                    "start": 149,
                    "end": 171,
                    "text": "Faulkner et al. (2020)",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [
                {
                    "start": 19,
                    "end": 27,
                    "text": "Figure 8",
                    "ref_id": "FIGREF15"
                }
            ],
            "section": "North American Bison data"
        },
        {
            "text": "Both our method and GMRF recover the pattern described in the first panel. The LGM in the Northern hemisphere reached its peak between 26.5 and 19 kya (Clark et al., 2009 ). Hence, the analysis of the 2017 data still supports the hypothesis of a decline that initiated before the LGM. However, our estimates suggest an initial decline much closer to the LGM peak than the analysis of the 2004 data. Human arrival in North America via the Berigian bridge route should have happened around 14 \u2212 16 kya (Llamas et al., 2016) . Therefore, despite the mismatch of the timing, the human-induced decline hypothesis has little evidence also according to our analysis of this new dataset.",
            "cite_spans": [
                {
                    "start": 151,
                    "end": 170,
                    "text": "(Clark et al., 2009",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 500,
                    "end": 521,
                    "text": "(Llamas et al., 2016)",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [],
            "section": "North American Bison data"
        },
        {
            "text": "SARS-CoV-2 is the virus causing the pandemic of novel coronavirus disease in 2019-2020 and it is of interest to explore the utility of viral molecular sequences for surveillance during the outbreak of the epidemic. Here, we analyze 123 whole genome sequences collected in France, and 32 sequences collected in Germany that were made publicly available in the GISAID EpiCov database (Shu and McCauley, 2017) . We note that our estimates may not reflect the whole countries effective population sizes but simply local effective population trajectories of the locations Figure 9 : 2019-2020 SARS-CoV-2: N e (t) posterior median estimates from SARS-CoV-2 GISAID data sets from France and Germany. Black curves in the first row panels depict estimated posterior medians of (N e (t)) t\u22650 obtained from n = 32 viral samples from Germany. Black curves in the second row panels depict estimated posterior medians of (N e (t)) t\u22650 obtained from n = 123 viral samples from France. The left column corresponds to our method's results and the second column to GMRF results. The posterior medians are depicted as solid black lines and the 95% Bayesian credible regions are depicted by shaded areas. n and s are depicted by the heat maps at the bottom of the last two panels: the squares along the time axis depicts the sampling time, while the intensity of the black color depicts the number of samples.",
            "cite_spans": [
                {
                    "start": 382,
                    "end": 406,
                    "text": "(Shu and McCauley, 2017)",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [
                {
                    "start": 567,
                    "end": 575,
                    "text": "Figure 9",
                    "ref_id": null
                }
            ],
            "section": "SARS-CoV-2"
        },
        {
            "text": "in which our samples were obtained. We only analyzed high coverage sequences with more than 25000 base pairs and performed multiple sequence alignment with Mafft (Katoh and Standley, 2013) . To encode nucleotide data as binary sequences Y 1 , we used the GenBank MN908947 (Wu et al., 2020) sequence as ancestral reference and eliminated sites that were not present in the ancestral sequence. The numbers of variable sites observed are 137 and 45 for France and Germany respectively. The observed patterns of mutations in both datasets are compatible with the ISM (no site was further removed). The Gisaid reference numbers of the sequences included in this study and data access acknowledgment are included in the supplementary material. We note that observed differences may be caused by sequencing errors and these are being ignored in our study. The heat maps included in each panel of Figure 9 show the sampling frequency For our inference procedure, we set = 0.11, Z 1 = 2, \u03c3 = 0.02, and approximate the posterior distribution with 1.4 \u00d7 10 6 iterations after a burn-in of 8 \u00d7 10 5 and after thinning every 100 iterations. For comparison, we ran GMRF on BEAST assuming the HKY mutation model (Hasegawa M, 1985) as proposed in previous studies (Scire et al., 2020) and approximate the posterior distribution with 5 \u00d7 10 7 iterations after a burn-in of 5 \u00d7 10 6 and after thinning every 1000 iteration. We used the default values for all GMRF hyperparameters. We initialized both methods with the serial UPGMA genealogy (Drummond and Rodrigo, 2000) . A final remark. Our estimates should be interpreted as estimates of genetic diversity over time and not as number of infections. Our model ignores recombination, population structure and selection. Viruses tend to exhibit antigenic drifts, selective sweeps, and tend to cluster spa-tially following migration events (Rambaut et al., 2008) . All these aspects may hinder the use of coalescent-based models to analyze viral population size dynamics. Indeed, the scientific knowledge on this virus is still limited and the validity of our model assumptions to SARS-CoV-2 is an active area of research.",
            "cite_spans": [
                {
                    "start": 162,
                    "end": 188,
                    "text": "(Katoh and Standley, 2013)",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 272,
                    "end": 289,
                    "text": "(Wu et al., 2020)",
                    "ref_id": "BIBREF37"
                },
                {
                    "start": 1197,
                    "end": 1215,
                    "text": "(Hasegawa M, 1985)",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1248,
                    "end": 1268,
                    "text": "(Scire et al., 2020)",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 1523,
                    "end": 1551,
                    "text": "(Drummond and Rodrigo, 2000)",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 1870,
                    "end": 1892,
                    "text": "(Rambaut et al., 2008)",
                    "ref_id": "BIBREF29"
                }
            ],
            "ref_spans": [
                {
                    "start": 889,
                    "end": 897,
                    "text": "Figure 9",
                    "ref_id": null
                }
            ],
            "section": "SARS-CoV-2"
        },
        {
            "text": "We have introduced a new methodology for Bayesian nonparametric inference of population size trajectory from heterochronous DNA sequences collected at a single non-recombining locus. The main focus of this work is scalability. In this respect, we developed a fast alternative to the Kingman's coalescent that can be used for nonparametric inference of serially sampled sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "We also developed a fast algorithm to compute the likelihood of Tajima genealogies, which is in itself a relevant contribution to the literature.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "We applied our method to a recent data set including modern and ancient bison sequences.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "There has been a lot of interest in determining whether the decline in the bison population was human-induced or climate-induced. Genetic evidence supported the environmental hypothesis, estimating the population peak to be approximately 45kya. Our analysis reconstructed a similar population size pattern. However, we estimated the peak to be about 29.5 kya. These analyses confirm that the population decline started sometimes before the LGM. We believe that this brings further genetic evidence to the environmentally induced population decline hypothesis.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "This paper makes important steps in the direction of a more scalable coalescent-based inference. However, the Tajima heterochronous n-coalescent has some limitations which need to be",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "addressed. An obvious one is that we do not model population structure. In the ancient bison application, we removed the Beringian sequences, keeping only North-American ones, because population structure violated the assumption of the standard coalescent, and consequently of any of its \"resolutions\". We have also stressed the importance of this feature in the analysis of viral data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "In addition, throughout the paper, we assumed the infinite site model of mutation. This prevented us from analyzing the original bison data of Shapiro et al. (2004) , as well as many other data that violate the ISM assumption. Given the promise of Tajima based inference shown here, incorporating other mutation models seems to be an interesting avenue of research.",
            "cite_spans": [
                {
                    "start": 143,
                    "end": 164,
                    "text": "Shapiro et al. (2004)",
                    "ref_id": "BIBREF33"
                }
            ],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Simulation study: Plots of the estimates obtained from BEAST of the methods GMRF and SKY",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "for the examples discussed in Section 5. (N e (t)) t\u22650 posterior distribution from simulated data of under three population size trajectories (rows) -bottleneck (\"Bottle\"), exponential growth (\"Exp\") and instantaneous fall (\"Drop\") -different sample sizes (columns) -n = 14, n = 35 and n = 70. Posterior medians are depicted as solid black lines and 95% Bayesian credible intervals are depicted by shaded areas. n and s are depicted by the heat maps at the bottom of each panel: the squares along the time axis depicts the sampling time, while the intensity of the black color depicts the number of samples. Top three rows panels depict estimates obtained through SKY, bottom three rows depicts estimates obtained through GMRF. More details are given in Table 1. SARS-CoV-2 Molecular Data Description: Data set used in the study in Section 7. We acknowledge the following sequence submitting laboratories to Gisaid.org:",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 754,
                    "end": 762,
                    "text": "Table 1.",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Discussion"
        },
        {
            "text": "\u2022 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        }
    ],
    "bib_entries": {
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Define A(i) unique nodes in the ith column of A (b) For all V \u2208 A(i) do",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Include V in T V if it has more than two child nodes iii. Define I, set of vintages corresponding to all subtrees of g i iv. If |T V | = 0: do nothing Else if |T V | = 1: set column A V (\u00b7, I) equal to T V Else if |T V | > 1: copy A V (, I) |T V | \u2212 1 times, attach the copies to A and set each copy equal to one element of T V v",
            "authors": [
                {
                    "first": "T V",
                    "middle": [],
                    "last": "Define",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Sequential importance sampling for multi-resolution Kingman-Tajima coalescent counting",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Cappello",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Palacios",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Annals of Applied Statistics",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "The last glacial maximum",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "U"
                    ],
                    "last": "Clark",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "S"
                    ],
                    "last": "Dyke",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "D"
                    ],
                    "last": "Shakun",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "E"
                    ],
                    "last": "Carlson",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Clark",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Wohlfarth",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "X"
                    ],
                    "last": "Mitrovica",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "W"
                    ],
                    "last": "Hostetler",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "M"
                    ],
                    "last": "Mccabe",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Science",
            "volume": "325",
            "issn": "5941",
            "pages": "710--714",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Exact enumeration of cherries and pitchforks in ranked trees under the coalescent model",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Disanto",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Wiehe",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Mathematical biosciences",
            "volume": "242",
            "issn": "2",
            "pages": "195--200",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Bayesian coalescent inference of past population dynamics from molecular sequences",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Drummond",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Shapiro",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [
                        "G"
                    ],
                    "last": "Pybus",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Molecular biology and evolution",
            "volume": "22",
            "issn": "5",
            "pages": "1185--1192",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Reconstructing genealogies of serial samples under the assumption of a molecular clock using serial-sample UPGMA",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Drummond",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Rodrigo",
                    "suffix": ""
                }
            ],
            "year": 2000,
            "venue": "Molecular Biology and Evolution",
            "volume": "17",
            "issn": "12",
            "pages": "1807--1815",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Bayesian phylogenetics with BEAUti and the BEAST 1",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Drummond",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Suchard",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Xie",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Molecular Biology and Evolution",
            "volume": "29",
            "issn": "7",
            "pages": "1969--1973",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Horseshoe-based Bayesian nonparametric estimation of effective population size trajectories",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Faulkner",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "F"
                    ],
                    "last": "Magee",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Shapiro",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [
                        "N"
                    ],
                    "last": "Minin",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Coalescent approaches to HIV population genetics, in 'The Evolution of HIV",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Felsenstein",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "G"
                    ],
                    "last": "Rodrigo",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "233--272",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Fossil and genomic evidence constrains the timing of bison arrival in North America",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Froese",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Stiller",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "D"
                    ],
                    "last": "Heintzman",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "V"
                    ],
                    "last": "Reyes",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "D"
                    ],
                    "last": "Zazula",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "E"
                    ],
                    "last": "Soares",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Meyer",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Hall",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Jensen",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "J"
                    ],
                    "last": "Arnold",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Proceedings of the National Academy of Sciences",
            "volume": "114",
            "issn": "13",
            "pages": "3457--3462",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Sampling theory for neutral alleles in a varying environment",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Griffiths",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Tavare",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Philosophical Transactions of the Royal Society of London. Series B: Biological Sciences",
            "volume": "344",
            "issn": "",
            "pages": "403--410",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Efficient algorithms for inferring evolutionary trees",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Gusfield",
                    "suffix": ""
                }
            ],
            "year": 1991,
            "venue": "Networks",
            "volume": "21",
            "issn": "1",
            "pages": "19--28",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Dating of the human-ape splitting by a molecular clock of mitochondrial DNA",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hasegawa",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Kishino",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [
                        "T"
                    ],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": 1985,
            "venue": "Journal of Molecular Evolution",
            "volume": "2",
            "issn": "",
            "pages": "160--164",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Evolution of protein molecules",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "H"
                    ],
                    "last": "Jukes",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "R"
                    ],
                    "last": "Cantor",
                    "suffix": ""
                }
            ],
            "year": 1969,
            "venue": "Mammalian protein metabolism",
            "volume": "3",
            "issn": "21",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Mafft multiple sequence alignment software version 7: improvements in performance and usability",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Katoh",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Standley",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Molecular biology and evolution",
            "volume": "30",
            "issn": "4",
            "pages": "772--780",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "The number of heterozygous nucleotide sites maintained in a finite population due to steady flux of mutations",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kimura",
                    "suffix": ""
                }
            ],
            "year": 1969,
            "venue": "Genetics",
            "volume": "61",
            "issn": "4",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "On the genealogy of large populations",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "F"
                    ],
                    "last": "Kingman",
                    "suffix": ""
                }
            ],
            "year": 1982,
            "venue": "Journal of Applied Probability",
            "volume": "19",
            "issn": "",
            "pages": "27--43",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "The coalescent', Stochastic processes and their applications",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "F C"
                    ],
                    "last": "Kingman",
                    "suffix": ""
                }
            ],
            "year": 1982,
            "venue": "",
            "volume": "13",
            "issn": "",
            "pages": "235--248",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "An efficient Bayesian inference framework for coalescent-based nonparametric phylodynamics",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Lan",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Palacios",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Karcher",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [
                        "N"
                    ],
                    "last": "Minin",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Shahbaba",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Bioinformatics",
            "volume": "31",
            "issn": "20",
            "pages": "3282--3289",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Ancient mitochondrial DNA provides high-resolution time scale of the peopling of the americas",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Llamas",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Fehren-Schmitz",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Valverde",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Soubrier",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Mallick",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Rohland",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Nordenfelt",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Valdiosera",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "M"
                    ],
                    "last": "Richards",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rohrlach",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Smooth skyride through a rough skyline: Bayesian coalescent-based inference of population dynamics",
            "authors": [
                {
                    "first": "V",
                    "middle": [
                        "N"
                    ],
                    "last": "Minin",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "W"
                    ],
                    "last": "Bloomquist",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "A"
                    ],
                    "last": "Suchard",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Molecular biology and evolution",
            "volume": "25",
            "issn": "7",
            "pages": "1459--1471",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Genetic analyses from ancient DNA",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "P\u00e4\u00e4bo",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Poinar",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Serre",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Jaenicke-Despr\u00e9s",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Hebler",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Rohland",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kuch",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Krause",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Vigilant",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Hofreiter",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Annu. Rev. Genet",
            "volume": "38",
            "issn": "",
            "pages": "645--679",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Integrated nested Laplace approximation for Bayesian nonparametric phylodynamics",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Palacios",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [
                        "N"
                    ],
                    "last": "Minin",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Proceedings of the Twenty-Eighth Conference on Uncertainty in Artificial Intelligence', UAI'12",
            "volume": "",
            "issn": "",
            "pages": "726--735",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Gaussian process-based Bayesian nonparametric inference of population size trajectories from gene genealogies",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Palacios",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [
                        "N"
                    ],
                    "last": "Minin",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Biometrics",
            "volume": "69",
            "issn": "1",
            "pages": "8--18",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Bayesian estimation of population size changes by sampling Tajimas trees",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Palacios",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "V\u00e9ber",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Cappello",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Wakeley",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ramachandran",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Genetics",
            "volume": "213",
            "issn": "2",
            "pages": "967--986",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Robust design for coalescent model inference",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "V"
                    ],
                    "last": "Parag",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [
                        "G"
                    ],
                    "last": "Pybus",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Systematic biology",
            "volume": "68",
            "issn": "5",
            "pages": "730--743",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Exploring the temporal structure of heterochronous sequences using tempest (formerly path-o-gen)",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "T"
                    ],
                    "last": "Lam",
                    "suffix": ""
                },
                {
                    "first": "Max",
                    "middle": [],
                    "last": "Carvalho",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Pybus",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [
                        "G"
                    ],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Virus evolution",
            "volume": "2",
            "issn": "1",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "The genomic and epidemiological dynamics of human influenza a virus",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [
                        "G"
                    ],
                    "last": "Pybus",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "I"
                    ],
                    "last": "Nelson",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Viboud",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "K"
                    ],
                    "last": "Taubenberger",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Holmes",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Nature",
            "volume": "453",
            "issn": "7195",
            "pages": "615--619",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "Finding the best resolution for the Kingman-Tajima coalescent: theory and applications",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Sainudiin",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Stadler",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "V\u00e9ber",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Journal of Mathematical Biology",
            "volume": "70",
            "issn": "6",
            "pages": "1207--1247",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "Phylodynamic analyses based on 93 genomes",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Scire",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "G"
                    ],
                    "last": "Vaughan",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Stadler",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "Split Hamiltonian Monte Carlo",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Shahbaba",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Lan",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "O"
                    ],
                    "last": "Johnson",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "M"
                    ],
                    "last": "Neal",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Statistics and Computing",
            "volume": "24",
            "issn": "3",
            "pages": "339--349",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "Rise and fall of the beringian steppe bison",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Shapiro",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Drummond",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "C"
                    ],
                    "last": "Wilson",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "E"
                    ],
                    "last": "Matheus",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "V"
                    ],
                    "last": "Sher",
                    "suffix": ""
                },
                {
                    "first": "O",
                    "middle": [
                        "G"
                    ],
                    "last": "Pybus",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "T P"
                    ],
                    "last": "Gilbert",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Barnes",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Binladen",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Science",
            "volume": "306",
            "issn": "5701",
            "pages": "1561--1565",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "Gisaid: Global initiative on sharing all influenza data-from vision to reality",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Shu",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Mccauley",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Eurosurveillance",
            "volume": "22",
            "issn": "13",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "Evolutionary relationship of dna sequences in finite populations",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Tajima",
                    "suffix": ""
                }
            ],
            "year": 1983,
            "venue": "Genetics",
            "volume": "105",
            "issn": "2",
            "pages": "437--460",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "On the number of segregating sites in genetical models without recombination",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Watterson",
                    "suffix": ""
                }
            ],
            "year": 1975,
            "venue": "Theoretical Population Biology",
            "volume": "7",
            "issn": "2",
            "pages": "256--276",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "A new coronavirus associated with human respiratory disease in china",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Wu",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Yu",
                    "suffix": ""
                },
                {
                    "first": "Y.-M",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                },
                {
                    "first": "Z.-G",
                    "middle": [],
                    "last": "Song",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Hu",
                    "suffix": ""
                },
                {
                    "first": "Z.-W",
                    "middle": [],
                    "last": "Tao",
                    "suffix": ""
                },
                {
                    "first": "J.-H",
                    "middle": [],
                    "last": "Tian",
                    "suffix": ""
                },
                {
                    "first": "Y.-Y",
                    "middle": [],
                    "last": "Pei",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nature",
            "volume": "579",
            "issn": "7798",
            "pages": "265--269",
            "other_ids": {}
        },
        "BIBREF40": {
            "ref_id": "b40",
            "title": "University of Duesseldorf",
            "authors": [
                {
                    "first": "\u2022",
                    "middle": [],
                    "last": "Center",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Microbiology",
                    "suffix": ""
                },
                {
                    "first": "Hospital",
                    "middle": [],
                    "last": "Virology",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Hygiene",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Detlef Kindgen-Milles, Malte Kohns Vasconcelos",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF43": {
            "ref_id": "b43",
            "title": "Olivier Terrier",
            "authors": [
                {
                    "first": "Ciri",
                    "middle": [],
                    "last": "\u2022 Laboratoire Virpath",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "U111",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Ucbl1",
                    "suffix": ""
                },
                {
                    "first": "Cnrs",
                    "middle": [],
                    "last": "Inserm",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Lyon",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Aurlien Traversier",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF44": {
            "ref_id": "b44",
            "title": "Germany North Rhine Westphalia EPI ISL 414509 2020-02-28 Germany North Rhine Westphalia EPI ISL 417457 2020-03-10 Germany Duesseldorf EPI",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF45": {
            "ref_id": "b45",
            "title": "France Auvergne-Rhne-Alpes EPI ISL 418420 2020-03-17 France Auvergne-Rhne-Alpes EPI ISL 418422 2020-03-17 France Auvergne-Rhne-Alpes EPI",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF46": {
            "ref_id": "b46",
            "title": "France Auvergne-Rhne-Alpes EPI ISL 419184 2020-03-22 France Auvergne-Rhne-Alpes EPI ISL 419185 2020-03-22 France Auvergne-Rhne-Alpes EPI ISL 419186 2020-03-22 France Auvergne-Rhne-Alpes EPI",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF47": {
            "ref_id": "b47",
            "title": "France Auvergne-Rhne-Alpes EPI ISL 416756 2020-03-06 France Auvergne-Rhne-Alpes EPI ISL 417337 2020-03-07 France Auvergne-Rhne-Alpes EPI",
            "authors": [
                {
                    "first": "France",
                    "middle": [],
                    "last": "Ile De France",
                    "suffix": ""
                },
                {
                    "first": "Epi",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF1": {
            "text": "3 ),b(t 3 )) = ((0,0), {5,8}) (a(t 4 ),b(t 4 )) = ((1,0), {5,7}) (a(t 5 ),b(t 5 )) = ((1,1), {5,6}) (a(t 6 ),b(t 6 )) = ((1,2), {3,5}) (a(t 7 ),b(t 7 )) = ((1,3), {3,4}) (a(t 8 ),b(t 8 )) = ((2,3), {2,3}) (a(s 2 ),b(s 2 )) = ((3,3), {1,2}) (a(t 9 ),b(t 9 )) = ((3,0), {1,2}) (a(t 10 ),b(t 10 )) = ((5,0), {1}) (a(t 11 ),b(t 11 )) = ((7,0), {}) Example of a Tajima heterochronous genealogy and its jump chain. A realization of a",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "a vector of length m whose j-th position indicates the number of singletons (i.e., lineages that have not been involved in a coalescence event) from sampling group s j at time t, and b(t) is the set of vintaged lineages at time t. The process starts at t = 0 in state (a(0) = (n 1 , 0, . . . , 0), b(0) = \u2205), jumps deterministically at every sampling time and jumps stochastically at every random coalescent time until it reaches the unique absorbing state (a(t 2 ) = (0, . . . , 0), b(t 2 ) = {n \u2212 1}) at time t 2 , when all n samples have a single most recent common ancestor at the root (Figure 2). At each sampling time s i , the state of the Tajima coalescent jumps deterministically as follows: (a(s i ), b(s i )) = (a(s i \u2212) + n i e i , b(s i \u2212)), where f (s i \u2212) denotes the left-limit of the function f at s i and e i is the i-th unit vector. Let us now turn to the embedded jump chain at coalescent times. At time t i , two extant lineages coalesce to create a new lineage with vintage n + 1 \u2212 i. Four types of coalescence transitions are possible depending on which and how many sampling groups are involved: (1) two singletons of the same sampling group coalesce (up to m possible moves for the chain), (2) two singletons of different sampling groups coalesce (up to m(m \u2212 1)/2 possible moves), (3) one singleton lineage and one vintaged lineage coalesce (up to m possible moves), or (4) two vintaged lineages coalesce (only one possibility because for vintages, the sampling information is irrelevant). Each pair coalesces with the same probability and the transition probabilities at 7 coalescent times are thus given by",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "shows a possible realization from the Tajima heterochronous n-coalescent.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Incidence matrix, frequency matrix and perfect phylogeny representation. Panel (A): data",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "A possible allocation of non-singleton nodes of V to subtrees of g. For a given allocation a (bottom figure), we display how subtrees in g (identified by the vintage tag at their root -black number in the top figure) are allocated to the nodes of T. Each color depicts an allocation of a subtree to a node: V 5 (red), V 0 (blue), V 1 (green) and V 2 (yellow).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Example of allocations for two distinct genealogies. Two possible samples from the Tajima heterochronous n-coalescent. Below we list all the possible allocations of nodes of T to g and g'.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "in Palacios et al. (2019) because here we account for the different sampling groups. It degenerates into Equation (6) in Palacios et al. (2019) in the isochronous case.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "v 1 , . . . , v k ) is a regular grid of k time points, N e (v i ) is the posterior median of N e at time v i and N e (v i ) is the value of the true trajectory at time v i . The second criterion is the mean relative width, defined by",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "\u00d7 10 5 iterations for n = 70. Posterior distributions are approximated after a burn-in period of 23 5 \u00d7 10 4 iterations and after thinning every 20 iterations.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF12": {
            "text": "-based estimates are competitive with Kingman-based estimates. The current simulation study cannot single out the benefit of employing Tajima vs Kingman topologies because no available implementations rely on an identical mutation model and MCMC scheme. This analysis is out of the current scope and will be the subject of future research. Simulation: effective population size posterior medians from different trajectories and sample sizes. (N e (t)) t\u22650 posterior distribution from simulated data with three population size trajectories (rows) -bottleneck (\"Bottle\"), exponential growth (\"Exp\") and instantaneous fall (\"Drop\") -different sample sizes (columns) -n = 14, n = 35 and n = 70. Posterior medians are depicted as solid black lines and 95% Bayesian credible intervals are depicted by shaded areas. n and s are depicted by the heat maps at the bottom of each panel: the squares along the time axis depicts the sampling time, while the intensity of the black color depicts the number of samples. More details are given in",
            "latex": null,
            "type": "figure"
        },
        "FIGREF14": {
            "text": "sequences include 602 base pairs from the mitochondrial control region, while Froese et al. (2017) provide the full mitochondrial genome (16322 base pairs after alignment); second, we are interested in testing whether the previously published overwhelming evidence in favor of the environmentally induced population decline is confirmed by this new data. Froese et al. (2017) data comprises 50 sequences (14 modern and 36 ancient). DNA was extracted from bison specimens from Canada (28, three locations), USA (9, two locations); Siberia (7, three locations), and unknown locations (5). It includes sequences of 37 Bison priscus (extinct ancient bison), 1 Bison latifrons (extinct ancient bison), 11 Bison bison (modern bison), and 4 Bos grunniens (control group).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF15": {
            "text": "Bison in North America: effective population size \"expected trajectory\" and posterior median estimates fromFroese et al. (2017) data set. The first panel depicts a sketch of a \"consensus population trajectory\" obtained from the phylodynamics study of the data ofShapiro et al. (2004) inFaulkner et al. (2020). The second and third panels display estimated posterior medians of (N e (t)) t\u22650 (as black curves) obtained from n = 38 ancient and modern sequences from North America specimens inFroese et al. (2017) data. The second panel corresponds to our method and the third panel to GMRF. The posterior medians are depicted as solid black curves and the 95% Bayesian credible regions are depicted by shaded areas. n and s are depicted by the heat maps at the bottom of the last two panels: the squares along the time axis depicts the sampling time, while the intensity of the black color depicts the number of samples. More details are given in Figure 7. basis at sites where all the other samples have valid entries. Out of the 94 observed polymorphic sites, we retain 91 sites compatible with the ISM assumption. To encode data in the 0 \u2212 1 incidence matrix representation Y 1 , we use the root of the UPGMA tree reconstructed using R function upgma (phanghorn) as the ancestral state. Figure 7 displays the perfect phylogeny T and the vectors s and n.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF16": {
            "text": "We detect the population decline only up to about 60kya ago, afterward the median trajectory is quite flat while the credible regions are wide. This can be explained by the fact that we have no samples from 42kya to 128.5kya. On the other hand, GMRF detects more clearly the population decline. The GMRF median time estimate of the population peak is 29.6 kya, while the median time estimate for our method is 29.7 kya. Thus, the estimates of the main event of interest, the population decline, are practically identical. The difference between the estimates obtained analyzing 2017 data differ substantially from the estimates of a population peak between 41.6 and 47.3 kya obtained analyzing the 2004 data.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF17": {
            "text": "BEAST estimates a mutation rate of 5.99 \u00d7 10 \u22124 mutations per site per year in the French dataset, and 7.41 \u00d7 10 \u22124 mutations per site per year in the German dataset. Our estimate follows the method discussed by Rambaut et al. (2016) obtained by regressing the Hamming distance of the sequences to the ancestral reference sequence on time difference between the sampling times and the reference sampling time. We estimated a mutation rate of 1.07 \u00d7 10 \u22123 mutations per site per year in the French dataset, and 8.54 \u00d7 10 \u22124 mutations per site per year in the German dataset.We show the estimates of effective population size with our method in the first column ofFigure 9and with BEAST in the second column. Results for Germany correspond to the first row and for France to the second row. Both analyses of the French dataset exhibit exponential growth from mid-December of 2019 to the end of February (Tajima estimate of median population peak is 2020/02/29, GMRF estimate is 2020/03/1). Following the exponential growth, both methods suggest a decline. Both analyses of the German dataset recover nearly constant trajectories, possibly due to sampling time concentration in mid-march and spatial sampling concentration in Duesseldorf (see online supplementary material for details).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF18": {
            "text": "Simulation: effective population size posterior medians from different trajectories and sample sizes.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "The Tajima heterochronous n-coalescent fundamentally differs from the Tajima isochronous n-coalescent in that sequences sampled at different times are not exchangeable. The Tajima isochronous n-coalescent distinguishes between singletons and vintaged lineages, where a singleton lineage refers to a lineage that subtends a leaf in g, and a vintaged lineage refers to a lineage that subtends an internal node in g. Singletons are indistinguishable while vintages are labeled by the ranking of the coalescence event at which they were created. When dealing with heterochronous samples, singletons are instead implicitly labeled by their underlying sampling times. To account for this difference, we define a new Markov chain.The present paper contains three main contributions: first, we propose a new lower-resolution continuous-time Markov chain (CTMC) which we call the Tajima heterochronous n-coalescent, that allows to model partially-labeled genealogies of heterochronous samples. Second, we introduce a new algorithm to compute the likelihood. Likelihood calculation inPalacios et al. (2019) called BESTT relies on a backtracking algorithm that is computationally unfeasible for sample 4 sizes greater than 35. Our new algorithm can accommodate up to 100 sequences. Lastly, we introduce new MCMC proposals for efficient exploration of the space of Tajima genealogies and do Bayesian nonparametric inference on (N e (t)) t\u22650 .",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "Summary of parameter values used in simulations. List of parameters n, s, \u00b5 and demographic scenarios (N e (t)) t\u22650 used to simulate data. We report the realized number M of mutations for each of the 9 data sets (# mutations).",
            "latex": null,
            "type": "table"
        },
        "TABREF5": {
            "text": "information. In the French dataset, 109 out of 123 samples were collected in March (at least one sample every day from 03/01/20 to 03/22/20), 9 in February (spread over 5 different dates), 5 in January (spread over 3 days, oldest sample dated 01/23/20). In the German dataset, 25 out of 32 samples were collected in March (spread over 7 different dates and 03/16/20 last sampling day), 6 in February (spread over 4 dates), 1 in January (oldest sample 01/28/20). We include in each dataset the reference sequence.",
            "latex": null,
            "type": "table"
        },
        "TABREF6": {
            "text": "Charit\u00e9 Universit\u00e4tsmedizin Berlin, Institute of Virology. Victor M Corman, Julia Schneider, Talitha Veith, Barbara M\u00fchlemann, Markus Antwerpen, Christian Drosten, gisaid epi isl date country division EPI ISL 418218 2020-02-21 France Hauts de France EPI ISL 418220 2020-02-28 France Hauts de France EPI ISL 414626 2020-02-29 France Hauts de France EPI ISL 414627 2020-03-02 France Hauts de France EPI ISL 414630 2020-03-03 France Hauts de France EPI ISL 414635 2020-03-04 France Hauts de France EPI ISL 414637 2020-03-04 France Hauts de France EPI ISL 414638 2020-03-04 France Hauts de France EPI ISL 415649 2020-03-05 France Hauts de France EPI ISL 418223 2020-03-05 France Hauts de France EPI ISL 418224 2020-03-08 France Hauts de France EPI ISL 418225 2020-03-08 France Hauts de France EPI ISL 415654 2020-03-09 France Hauts de France EPI ISL 416493 2020-03-08 France Hauts de France EPI ISL 416495 2020-03-10 France Hauts de France EPI ISL 416496 2020-03-10 France Hauts de France EPI ISL 416497 2020-03-10 France Hauts de France EPI ISL 418226 2020-03-09 France Hauts de France EPI ISL 418227 2020-03-12 France Hauts de France EPI ISL 418228 2020-03-12 France Hauts de France EPI ISL 418231 2020-03-15 France Hauts de France EPI ISL 418236 2020-03-16 France Hauts de France EPI ISL 418237 2020-03-16 France Hauts de France EPI ISL 418238 2020-03-16 France Hauts de France EPI ISL 418239 2020-03-16 France Hauts de France EPI ISL 406596 2020-01-23 France Ile de France EPI ISL 406597 2020-01-23 France Ile de France EPI ISL 411219 2020-01-28 France Ile de France EPI ISL 408430 2020-01-29 France Ile de France EPI ISL 408431 2020-01-29 France Ile de France",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "Algorithm 1 Description of the algorithm to define the allocation matrix Inputs: T, s Output: A",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Appendix"
        },
        {
            "text": "Algorithm Description: Augmented Perfect Phylogeny. The algorithm below uses Gusfield's perfect phylogeny as an input, duplicates nodes corresponding to haplotypes that are sampled more than once, and returns the augmented perfect phylogeny T.Algorithm 2 Define T Inputs: T' (Gusfield, 1991) , s, Y 2 Output: T 1. Algorithm Description: Computing c. We compute c through greedy search. The idea is simple: it is not possible to build a compatible topology g conditionally on an incompatible vector t. We initially assume that ISM does not impose any constraints on t, check if we can build a compatible topology, if we are, it will mean that indeed ISM does not impose constraints, if not, it will mean that we need to add some constraints. We continue iteratively until we manage to sample a compatible g. To do this process, we consider one sampling group at a time. We define a vector add of length m whose ith entry is the number of coalescent events that happens before s i . Note that if we are interested in sampling g (ignoring branch information), add is the only time information we need. We can sample compatible g's through a simple extension of an Algorithm 2 in Cappello and Palacios 37 (2020) . We refer to that paper for details.",
            "cite_spans": [
                {
                    "start": 275,
                    "end": 291,
                    "text": "(Gusfield, 1991)",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1176,
                    "end": 1207,
                    "text": "Cappello and Palacios 37 (2020)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "SUPPLEMENTARY MATERIAL"
        },
        {
            "text": "Inputs: T, s Output: c 1. Initialize c = (n 1 \u2212 1,Given add, try to sample a compatible topology g (c) If g compatible: set c i = add i+1Else if g not compatible: set add i+1 = a i+1 \u2212 1, . . . , add m = add m \u2212 1 and return to (b) 3. Return c.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Algorithm 3 Define c"
        }
    ]
}