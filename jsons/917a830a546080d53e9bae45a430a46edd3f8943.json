{
    "paper_id": "917a830a546080d53e9bae45a430a46edd3f8943",
    "metadata": {
        "title": "A Computational Toolset for Rapid Identification of SARS-CoV-2, other Viruses, and Microorganisms from Sequencing Data",
        "authors": [
            {
                "first": "Shifu",
                "middle": [],
                "last": "Chen",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Chinese Academy of Sciences",
                    "location": {
                        "postCode": "518055",
                        "settlement": "Shenzhen",
                        "region": "Guangdong",
                        "country": "China"
                    }
                },
                "email": "chen@haplox.com"
            },
            {
                "first": "Changshou",
                "middle": [],
                "last": "He",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Yingqiang",
                "middle": [],
                "last": "Li",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Zhicheng",
                "middle": [],
                "last": "Li",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Chinese Academy of Sciences",
                    "location": {
                        "postCode": "518055",
                        "settlement": "Shenzhen",
                        "region": "Guangdong",
                        "country": "China"
                    }
                },
                "email": ""
            },
            {
                "first": "Charles",
                "middle": [
                    "E"
                ],
                "last": "Melan\u00e7on",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Iii",
                "middle": [],
                "last": "",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "In this paper, we present a toolset and related resources for rapid identification of viruses and microorganisms from short-read or long-read sequencing data. We present fastv as an ultra-fast tool to detect microbial sequences present in sequencing data, identify target microorganisms, and visualize coverage of microbial genomes. This tool is based on the k-mer mapping and extension method. K-mer sets are generated by UniqueKMER, another tool provided in this toolset.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "UniqueKMER can generate complete sets of unique k-mers for each genome within a large set of viral or microbial genomes. For convenience, unique k-mers for microorganisms and common viruses that afflict humans have been generated and are provided with the tools. As a lightweight tool, fastv accepts FASTQ data as input, and directly outputs the results in both HTML and JSON formats. Prior to the k-mer analysis, fastv automatically performs adapter trimming, quality pruning, base correction, and other pre-processing to ensure the accuracy of k-mer analysis. Specifically, fastv provides built-in support for rapid SARS-CoV-2 identification and typing. Experimental results showed that fastv achieved 100% sensitivity and 100% specificity for detecting SARS-CoV-2 from sequencing data; and can distinguish SARS-CoV-2 from SARS, MERS, and other coronaviruses. This toolset is available at: https://github.com/OpenGene/fastv.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "As part of the OpenGene projects, fastv and UniqueKMER are open-sourced through the MIT license.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Fastv is available at https://github.com/OpenGene/fastv, and UniqueKMER is available at https://github.com/OpenGene/UniqueKMER. The pre-computed unique k-mer resources are also provided in these repositories.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "This tool presents a new tool fastv for rapid identification of SARS-Cov-2, other viruses and microorganisms. Another tool UniqueKMER is presented for generation of high-quality unique k-mers.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "Unique k-mer resources for tens of thousands of viruses and microorganisms have been precomputed, and uploaded to the tools' repositories.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        },
        {
            "text": "A pipeline for alignment-based SARS-CoV-2 identification was provided in Supplementary file 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "The COVID-19 pandemic has spread to over 200 countries and territories, and has made a terrible impact on lives and economies worldwide [1] [2] [3] . Based on the current pandemic situation and many research reports [4] , COVID-19 may continue to spread for a long period of time, and may eventually become a flu-like seasonal outbreak [5] . Under these circumstances, it is important to develop new technologies for rapid detection of COVID-19.",
            "cite_spans": [
                {
                    "start": 136,
                    "end": 139,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 140,
                    "end": 143,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 144,
                    "end": 147,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 216,
                    "end": 219,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 336,
                    "end": 339,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "Nucleic acid sequencing is a key technology for identifying and studying SARS-CoV-2, the causative agent of COVID-19. Metagenomic and metatranscriptomic next-generation sequencing (mNGS) are powerful tools to study the genetic composition and function of microbial populations, as well as to analyse the relationship between microorganisms and their host or environment [6, 7] .",
            "cite_spans": [
                {
                    "start": 370,
                    "end": 373,
                    "text": "[6,",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 374,
                    "end": 376,
                    "text": "7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "Since the first clinical application of metagenomic sequencing (mNGS) for the diagnosis of leptospirosis in 2014 [8] , mNGS has been used widely for the identification and diagnosis of new and rare pathogens. NGS technology has also played an important role in COVID-19 diagnosis and research. The earliest COVID-19 case, which was initially diagnosed as pneumonia caused by an unknown pathogen, was identified due to the presence of SARS-like sequences found using mNGS [9] . The first complete genome of SARS-CoV-2 (GenBank: MN908947) reported on January 11, 2020 was assembled using NGS data [10] . Soon after, the whole-genome sequence of SARS-CoV-2 was also obtained by mNGS using the Oxford Nanopore platform supplemented with Sanger sequencing [11] .",
            "cite_spans": [
                {
                    "start": 113,
                    "end": 116,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 471,
                    "end": 474,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 595,
                    "end": 599,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 751,
                    "end": 755,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "The rapid acquisition and publication of the SARS-CoV-2 genome was essential to design fluorescent PCR probes for COVID-19 nucleic acid detection kits.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "With the viral genome in hand, we can now explore the possibility of using mNGS directly as a detection method to determine whether SARS-CoV-2 RNA is present or absent in a sample. In theory, a simple and straightforward approach would be to first map sequencing reads obtained from the sample to the viral genome using common aligners such as BWA [12] or Bowtie2 [13] , and then to analyze the alignment results to determine the coverage of the viral genome and the number of properly mapped reads. However, in practice, such an alignment-based method is prone to problems stemming from both false positives and false negatives. On one hand, some viruses have genomes very similar to SARS-CoV-2, which can lead to false positive results. For example, the genome of bat coronavirus RaTG13 is sufficiently similar to SARS-CoV-2 (96% identity) to cause non-specific alignment [14] . On the other hand, in some cases the virus-specific reads obtained may not be abundant enough for unambiguous detection, which can lead to false negative results. Examples of such cases may be when the viral RNA is highly degraded, or when the sequencing library has been incompletely target enriched by multiple-PCR [15] or hybrid capture [16] . In these scenarios, alignment-based methods may be not specific or sensitive enough. Such alignment-based methods are also computationally intensive, and therefore not particularly fast or efficient.",
            "cite_spans": [
                {
                    "start": 348,
                    "end": 352,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 364,
                    "end": 368,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 874,
                    "end": 878,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1198,
                    "end": 1202,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1221,
                    "end": 1225,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "In order to detect SARS-CoV-2 more quickly and accurately, we have developed an alignment-free method based on k-mer mapping and extension. The use of k-mer-based methods to analyse microbial sequencing data is not a new method. For example, SPINGO [17] provides rapid specie classification for microbial amplicon sequences based on k-mer mapping technology. Kraken2 [18] , a very popular taxonomic classification system, is based on k-mer matches. However, we are currently unaware of a fast, reliable, and user-friendly k-mer-based tool for identifying nucleic acids from SARS-CoV-2 and other viruses or microorganisms using sequencing data. This unmet need has led us to develop a new toolset and to provide corresponding k-mer resources.",
            "cite_spans": [
                {
                    "start": 249,
                    "end": 253,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 367,
                    "end": 371,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "Here, we present fastv and UniqueKMER, along with the pre-computed unique k-mer resources.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "The fastv tool has three major functions: to analyse which viral and/or microbial sequences are present in the sequencing data, to determine whether sequences from a specific virus or microorganism (e.g. SARS-CoV-2) can be found in the sequencing data, and to analyse coverage of a specific viral or microbial genome by a set of sequencing data. All three of these methods rely on a unique k-mer set for each microorganism, making it essential to produce high-quality unique k-mer sets. We developed another tool, UniqueKMER, to generate a complete set of unique k-mers for each of a large set of microbial genomes. The unique k-mers can be filtered to remove the k-mers that can be mapped to a reference genome (e.g. the human genome). Generating unique k-mers for tens of thousands of viral and microbial species would typically require tremendous memory and computing resources. We have designed efficient algorithms to make this computation feasible on ordinary computing servers. UniqueKMER requires only one hour to generate reference-filtered unique k-mers for about 12,000 viral genomes on an ordinary PC.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "As a lightweight tool, fastv accepts FASTQ data as input, and directly outputs the results in HTML and JSON formats. The HTML result is highly informative and provides interactive reports for manually reading, while the JSON result is structured such that it can easily be used by downstream analysis tools. Prior to the k-mer analysis, fastv automatically performs adapter trimming, quality pruning, base correction, and other pre-processing to ensure the accuracy of k-mer analysis. These pre-processing features are derived from fastp [19] , a popular quality control and filtering tool for NGS data previously developed by our group. The fastv tool is ultra-fast -it can process 10M+ bases per second -and can complete the processing of a typical mNGS dataset in a few minutes.",
            "cite_spans": [
                {
                    "start": 538,
                    "end": 542,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "We conducted identification experiments on 27 samples positive for SARS-CoV-2 and 25 samples negative for SARS-CoV-2. The results showed that fastv achieved 100% sensitivity and 100% specificity; and that it can distinguish SARS-CoV-2 from SARS [20] , MERS [21] , and other coronaviruses [22] . Although our original intention in developing these tools was to quickly identify SARS-CoV-2 from sequencing data, our tool can detect any target virus or microorganism for which a unique k-mer file is provided. We also conducted experiments using several other viral genomes such as Epstein-Barr Virus (EBV), Human Papillomavirus (HPV), and Hepatitis B Virus (HBV). The results demonstrated that our tools perform well on a variety of viral genomic datasets.",
            "cite_spans": [
                {
                    "start": 245,
                    "end": 249,
                    "text": "[20]",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 257,
                    "end": 261,
                    "text": "[21]",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 288,
                    "end": 292,
                    "text": "[22]",
                    "ref_id": "BIBREF21"
                }
            ],
            "ref_spans": [],
            "section": "INTRODUCTION"
        },
        {
            "text": "This section consists of three subsections: rapid identification of microorganisms from sequencing data, algorithms for efficiently generating unique k-mer sets, and pre-generation of unique k-mer sets for common viruses and microorganisms.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "MATERIAL AND METHODS"
        },
        {
            "text": "Fastv is a highly optimized FASTQ scanner and k-mer mapper. Sequencing reads are first preprocessed to remove adapters and unqualified bases. Continuous k-mers are then computed for each read to be mapped to unique k-mer indexes. Fastv accepts input from any or all of the following three FASTA file types to generate corresponding k-mer indexes: a. Unique k-mer collection for a large set of viruses or microorganisms. This file contains a list of viruses or microorganisms along with their unique k-mers. The identifier of each FASTA entry represents the name of a viral or microbial genome, while its corresponding multi-line sequences represent its unique k-mer keys. This file typically consists of all viruses or microorganisms that might be detected, with reference genomes available.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fastv: rapid identification of microorganisms from sequencing data"
        },
        {
            "text": "b. Unique k-mer set for a specific virus or microorganism. This file contains a list of k-mer keys unique to a specific virus or microorganism. The sequence of each FASTA entry represents a k-mer key, while its corresponding FASTA identifier represents its position in the viral or microbial genome. This file typically represents the unique k-mer set for the virus or microorganism of interest, such as SARS-CoV-2.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fastv: rapid identification of microorganisms from sequencing data"
        },
        {
            "text": "c. Genome sequences for a specific virus or microorganism. This file contains one or more reference genomes for the target virus or microorganism. Typically, multiple genomes represent different subtypes of the target virus or microorganism. For instance, if the target virus is HPV, the genomes may comprise HPV-16, HPV-18, HPV-31, etc [23] . Due to the differences among different genome sequences, the coverage and mismatch rate of each genome will be different. This information can be used for microbial subtype identification.",
            "cite_spans": [
                {
                    "start": 337,
                    "end": 341,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "Fastv: rapid identification of microorganisms from sequencing data"
        },
        {
            "text": "Extraction of k-mers from reads and processing of k-mer indexes are independent processes. the items with black backgrounds are results that will be output to HTML/JSON reports. An individual thread loads the FASTQ data to read packs (pack size = 1000). Multi-threaded read processors process data pack by pack. For each read or read pair, pre-processing is performed as in fastp. kmers are extracted from the read and its reverse complement, and are then converted to 64-bit keys.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fastv: rapid identification of microorganisms from sequencing data"
        },
        {
            "text": "Each 64-bit key is used to search one of the three k-mer indexes built from the k-mer collection file, kmer file, or genome(s) file.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fastv: rapid identification of microorganisms from sequencing data"
        },
        {
            "text": "Read pre-processing. To avoid generating erroneous k-mer keys, sequencing adapters and lowquality bases must be removed. Fastv utilizes the adapter cutting and quality pruning features from fastp, which we developed previously. Adapter sequences can either be auto-detected or specified from the command line. For paired-end sequencing data, overlapping regions are detected and incorrect bases in the overlapping regions are corrected. The algorithms for, and implementations of these features can be found in the fastp publication [19] . For data generated by long-read platforms (e.g. PacBio or ONT), long reads are segmented, generating multiple short reads.",
            "cite_spans": [
                {
                    "start": 533,
                    "end": 537,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                }
            ],
            "ref_spans": [],
            "section": "Fastv: rapid identification of microorganisms from sequencing data"
        },
        {
            "text": "To accelerate k-mer generation and lookup, we use a unique 64-bit integer to represent each k-mer. A base (A/T/C/G) is represented by two bits, so a 64-bit integer can represent up to a 32-mer, which is sufficiently longfor identifying a virus or microorganism.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "K-mer generation and representation."
        },
        {
            "text": "Any k-mer key that contains a degenerate base (i.e. N base) is ignored. This k-mer representation has been used widely in our previous works, such as GeneFuse [24] . A progressive method for k-mer calculation is applied to accelerate k-mer generation. The formula to compute the n th k-mer key can be denoted as:",
            "cite_spans": [
                {
                    "start": 159,
                    "end": 163,
                    "text": "[24]",
                    "ref_id": "BIBREF23"
                }
            ],
            "ref_spans": [],
            "section": "K-mer generation and representation."
        },
        {
            "text": "representation of a base (A/T/C/G), and bit_mask is a 64-bit value determined by the length k of kmer.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "K-mer generation and representation."
        },
        {
            "text": "The k-mer collection file can contain unique k-mers for tens of thousands of viral or microbial genomes, with each containing hundreds to thousands of k-mer keys.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "K-mer collection scanning."
        },
        {
            "text": "Therefore, there may be tens of millions of k-mer keys in total. It would be trivial to use a map<key, id> to index this data, but such an implementation would result in very slow access. Our approach was to build a hash function to hash the 64-bit key to a larger number (i.e. 2 30 ), which stores the index to the k-mer element. Because of the nature of the hash function, two different keys may have the same hash value, resulting in a hash collision [25] . However, as long as the hash function is sufficiently random, the probability of collision will follow a probability distribution that will result in only a small fraction of keys to have hash collisions. This kind of space-for-time approach results in a significant increase in efficiency and makes it feasible to detect tens of thousands of microorganisms at once. The algorithm to build such a k-mer collection index is briefly illustrated as Algorithm 1. It should be noted that, to obtain a higher running speed, we did not use mutex locks to synchronize the k-mer hit counting operation between multiple threads. Our results demonstrate that, while this might lead to slight instability in the results (less than 1 in 10 4 ), it does not have an impact on the overall quality of the results.",
            "cite_spans": [
                {
                    "start": 280,
                    "end": 282,
                    "text": "30",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 454,
                    "end": 458,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "K-mer collection scanning."
        },
        {
            "text": "The hash function used in Algorithm 1 is a simple formula that can be calculated efficiently. We have used this hash function in previous works [26] . It utilizes the multiplication and bit manipulation of the key with several big prime numbers:",
            "cite_spans": [
                {
                    "start": 144,
                    "end": 148,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [],
            "section": "Algorithm 1: generation of KMER collection index"
        },
        {
            "text": "Since the k-mer list of a specific virus or microorganism is typically small, it is trivial to implement k-mer scanning on such a short list. A simple unordered map is used to represent the index for such a k-mer set, with the values used as k-mer hit statistics. In contrast to k-mer collection scanning, where multiple threads share a single hit counting statistics array, each thread in the k-mer scanning operation uses its own statistics array. These arrays are subsequently merged to generate the overall statistics, making the k-mer scanning result stable and reproducible.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "K-mer scanning for a specific virus or microorganism."
        },
        {
            "text": "Genome coverage statistics and subtyping. The genomes are indexed as a map, with its key as the same 64-bit k-mer key, and its value as a list of genome positions (GP). A genome position includes a genome ID and a position in that genome. For a given read, if one of its 64-bit k-mer keys is a hit to the genome index, the read will be mapped to the corresponding genome location. The edit distance [27] between the read and the genome sequence will be obtained; and if the edit distance is less than or equal to the threshold, a match will be recorded and the coverage of that genome will be updated. It is worth mentioning that some microbial genomes (i.e. EBV) have a large number of repeated sequences [28] , which will result in some keys being hits to many different genome positions.",
            "cite_spans": [
                {
                    "start": 399,
                    "end": 403,
                    "text": "[27]",
                    "ref_id": "BIBREF26"
                },
                {
                    "start": 706,
                    "end": 710,
                    "text": "[28]",
                    "ref_id": "BIBREF27"
                }
            ],
            "ref_spans": [],
            "section": "K-mer scanning for a specific virus or microorganism."
        },
        {
            "text": "In such cases, fastv divides the coverage and mismatch numbers of a read into multiple parts, and distributes them to each position, producing smooth and uniform coverage. When multiple genomes are input, the coverage result will be sorted by the coverage. This feature can help identify a subtype of a specific virus or microorganism.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "K-mer scanning for a specific virus or microorganism."
        },
        {
            "text": "Visualization. The k-mer scanning results of different inputs are visualized in a figure on a single HTML page. For k-mer scanning of a specific virus or microorganism, the result is simply plotted with the widely used library Plotly.js. For genome k-mer scanning results, we developed a much more efficient toolkit based on native browser utilities to illuminate genome coverage and mismatch ratios.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "K-mer scanning for a specific virus or microorganism."
        },
        {
            "text": "Our highly optimized method can easily support the visualization of hundreds of genomes, which is impossible for most common plotting libraries. A demonstration of a fastv HTML report is shown in Figure 2 . Plotly.js, whereas the result for genome coverage is visualized by a custom toolkit we developed. The k-mer collection scanning result shows that the data contains sequences of two microbial genomes.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 196,
                    "end": 204,
                    "text": "Figure 2",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "K-mer scanning for a specific virus or microorganism."
        },
        {
            "text": "One is phi-X174, which is actually introduced by the Illumina PhiX control library [29] , and the other is SARS-CoV-2. The genome coverage statistics show that SARS-CoV-2 most closely matches strain Wuhan-Hu-1. The red marks indicate the regions with a high mismatch ratio.",
            "cite_spans": [
                {
                    "start": 83,
                    "end": 87,
                    "text": "[29]",
                    "ref_id": "BIBREF28"
                }
            ],
            "ref_spans": [],
            "section": "K-mer scanning for a specific virus or microorganism."
        },
        {
            "text": "Since the key features of fastv rely on unique k-mer mapping and extension, it is important to obtain high quality unique k-mer sets for microorganisms of interest. Although a number of k-mer generation tools are currently available [30, 31] , none are suitable for our application because we must both generate unique k-mers for tens of thousands of viruses and/or microorganisms, and filter the k-mer keys based on the reference genome. These unmet needs have led us to develop UniqueKMER, a new unique k-mer generation tool. The workflow of UniqueKMER is briefly described in Figure 3 . keys that belong to a single genome. The original index keys that can be mapped to the reference with edit distance less than the threshold will be filtered out, producing the final index. The S-bit keys are used to identify seeds for key-reference mapping. The k-mer key length N is configurable, and is usually set to a number between 20 and 30. The bit length S of S-bit is an even number much less than 2N.",
            "cite_spans": [
                {
                    "start": 233,
                    "end": 237,
                    "text": "[30,",
                    "ref_id": "BIBREF29"
                },
                {
                    "start": 238,
                    "end": 241,
                    "text": "31]",
                    "ref_id": "BIBREF30"
                }
            ],
            "ref_spans": [
                {
                    "start": 579,
                    "end": 587,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "UniqueKMER: efficient unique k-mer generation for large datasets"
        },
        {
            "text": "The UniqueKMER workflow consists of two parts ( Figure 3 ): unique k-mer generation and unique kmer filtering. In the first part all k-mer keys are extracted, and keys that belong to more than one genome are removed as non-unique keys. In the second part, both the keys that exactly match the reference genome and the keys that can be partially mapped to reference genome are removed.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 48,
                    "end": 56,
                    "text": "Figure 3",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "UniqueKMER: efficient unique k-mer generation for large datasets"
        },
        {
            "text": "Although this can be done with a common aligner such as BWA or Bowtie2, these are not ideal for partial mapping of short sequences. We developed an algorithm based on S-bit seeding and edit distance computation to address this problem, as briefly shown in Algorithm 2. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "UniqueKMER: efficient unique k-mer generation for large datasets"
        },
        {
            "text": "We pre-generated unique k-mers for two datasets. The first dataset is the NCBI viral genomes RefSeq database [32] , which can be found at https://ftp.ncbi.nlm.nih.gov/refseq/release/viral/. The other pre-generated dataset is the NCBI human bacterial microbiome RefSeq database [33] , which can be found at https://ftp.ncbi.nlm.nih.gov/genomes/HUMAN_MICROBIOM/Bacteria/. Because bacterial genomes often have multiple contigs, we concatenated contigs from a single bacterial genome by inserting 32 Ns between each contig, guaranteeing that no artifactual k-mer keys will be introduced unexpectedly. The generated resources can be found at the UniqueKMER repository (https://github.com/OpenGene/UniqueKMER).",
            "cite_spans": [
                {
                    "start": 109,
                    "end": 113,
                    "text": "[32]",
                    "ref_id": "BIBREF31"
                },
                {
                    "start": 277,
                    "end": 281,
                    "text": "[33]",
                    "ref_id": "BIBREF32"
                }
            ],
            "ref_spans": [],
            "section": "Pre-generation of unique k-mers for SARS-CoV-2 and other common viruses and microorganisms"
        },
        {
            "text": "SARS-CoV-2 is included in the viral genome list so its unique k-mer set was also generated. We few mutations to date [35] , the similarity between the genomes of different types is very high.",
            "cite_spans": [
                {
                    "start": 117,
                    "end": 121,
                    "text": "[35]",
                    "ref_id": "BIBREF34"
                }
            ],
            "ref_spans": [],
            "section": "Pre-generation of unique k-mers for SARS-CoV-2 and other common viruses and microorganisms"
        },
        {
            "text": "Nevertheless, coverage sorting is able to identify the most closely related genome to the query sequence data. The selected SARS-CoV-2 genomes are available at the fastv repository (https://github.com/OpenGene/fastv), and may be updated according to new researches.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Pre-generation of unique k-mers for SARS-CoV-2 and other common viruses and microorganisms"
        },
        {
            "text": "To evaluate the performance of fastv for SARS-CoV-2 identification, we conducted experiments on 27 samples that were positive for SARS-CoV-2 and 25 samples that were negative for SARS-CoV-2. The platforms used for sequencing these samples were diverse, and included Illumina, Oxford Nanopore, BGI-Seq, Capillary (Sanger sequencing), and Ion Torrent. For comparison, we also conducted alignment-based identification of SARS-CoV-2 using the widely used aligner BWA. The results are shown in Table 1 . As shown in Table 1 , fastv achieved 100% sensitivity and 100% specificity for all tested samples;",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 489,
                    "end": 496,
                    "text": "Table 1",
                    "ref_id": "TABREF1"
                },
                {
                    "start": 511,
                    "end": 518,
                    "text": "Table 1",
                    "ref_id": "TABREF1"
                }
            ],
            "section": "SARS-CoV-2 identification"
        },
        {
            "text": "and could distinguish SARS-CoV-2 from SARS, MERS, and other coronaviruses. The pipeline for alignment-based SARS-CoV-2 identification, which is described in Supplementary File 1, is based on the widely used alignment method BWA-MEM [12] . The alignment-based pipeline failed to identify a SARS-CoV-2 sample, which was previously enriched by using multiplex PCR technology. It also incorrectly identified the bat coronavirus RaTG13 sample as SARS-CoV-2 since genome of RaTG13 has about 96% similarity to genome of SARS-CoV-2 [14] . Even if careful manual adjustment of the alignment parameters may result in a better result on this dataset, it is difficult to ensure that the adjusted parameters can achieve good results on other datasets. The fastv results are based on the default parameters determined before this experiment. Therefore results obtained using fastv are more robust and reliable than those obtained using the BWA alignment-based method.",
            "cite_spans": [
                {
                    "start": 232,
                    "end": 236,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 524,
                    "end": 528,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "SARS-CoV-2 identification"
        },
        {
            "text": "We also conducted experiments using data from other viruses and microorganisms. Epstein-Barr virus (EBV) has a long repetitive region within its genome, which often causes difficulties for other kmer-based algorithms because these algorithms map a k-mer key to the location where it first appears. But our optimized k-mer mapping algorithm distributes hits corresponding to a k-mer key to all places where it appears, resulting in smoother coverage. An example of EBV identification is shown in Figure 4 to illustrate the smooth coverage obtained for genomes with repetitive regions. SRR11308108, SRR11308109, SRR11308111 and SRR11308112) were tested. The results showed that fastv could distinguish the virus subtypes for all these data very accurately. Figure 5 shows the correct HBV subtyping result of dataset SRR11308112, which is the output of sequencing data from a HBV-C infected sample. conservative regions [36] , where the genomes of different subtypes are very similar. This led to the other HBV subtypes appearing to be partly covered, but obviously not covered as well as HBV-C.",
            "cite_spans": [
                {
                    "start": 917,
                    "end": 921,
                    "text": "[36]",
                    "ref_id": "BIBREF35"
                }
            ],
            "ref_spans": [
                {
                    "start": 495,
                    "end": 503,
                    "text": "Figure 4",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 755,
                    "end": 763,
                    "text": "Figure 5",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "Identification of other viruses"
        },
        {
            "text": "When the pathogen is unknown, fastv can also be used to quickly identify microorganisms in sequenced samples to speculate what the pathogen is. In order to use this function, a k-mer collection file containing many possible viruses and microorganisms should be first prepared. For the convenience of users, we have pre-generated a k-mer collection file, which consists of genomes for all viruses and human bacteria that with a reference genome provided in NCBI RefSeq database. This pre-generated k-mer collection file can be downloaded from fastv repository. After scanning the FASTQ data, fastv will report the k-mer coverage for each microbial genome with valid hits. This information can be used to identify the possible pathogen. We evaluated seven mNGS datasets (SRA accessions: SRP006887, SRP006881, SRP000376, SRP007321, ERS4389819, SRP000657 and SRP004485), which were generated by Illumina and LS454 sequencers. All the correct pathogens were successfully detected, with the k-mer coverage varying from 15.19% to 99.94%.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Identification of pathogen from mNGS data without set a target virus or microorganism"
        },
        {
            "text": "In summary, we describe a new tool, fastv, for rapid identification of viruses and microorganisms from sequencing data. This tool is based on the k-mer mapping and extension method, and relies on high-quality unique k-mers. We also describe a new tool, UniqueKMER, to generate such high-quality unique k-mer sets for a large collection of viruses and microorganisms. Experimental results show that with the k-mers generated by UniqueKMER, fastv is able to detect SARS-CoV-2 with 100% sensitivity and 100% specificity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "Because of the rapid and unpredictable spread of COVID-19, it is important to develop inexpensive, rapid, and reliable methods for identification of its causative agent, SARS-CoV-2. Next generation sequencing-based methods are suitable for SARS-CoV-2 detection, and offer some advantages over other detection methods. Therefore, computational tools that can rapidly and reliably identify SARS-CoV-2 from sequencing data will be valuable to the research community. Fastv can also output ontarget (e.g. SARS-CoV-2) clean reads to individual FASTQ files, which can be input to downstream analysis pipelines. For example, genome assembly with the on-target clean reads will be simpler and faster. The on-target reads can also be input to database search utilities like BLAST [37] .",
            "cite_spans": [
                {
                    "start": 771,
                    "end": 775,
                    "text": "[37]",
                    "ref_id": "BIBREF36"
                }
            ],
            "ref_spans": [],
            "section": "DISCUSSION"
        },
        {
            "text": "Although our original intention in developing fastv and UniqueKMER was to quickly identify SARS-CoV-2 from sequencing data, these tools can be used more generally to detect any target virus or microorganism for which unique k-mer files are provided. The results of our experiments with EBV, HPV, and HBV sequencing data demonstrate the general applicability of our tools. Because fastv can rapidly scan tens of thousands of genomes, it is a powerful tool for analysing mNGS data, particularly for identifying pathogens from mNGS data. Fastv can be used for rapid screening of possible viruses or bacteria to get the information that can further help determine the pathogen. We will continue to update our resource library so that researchers can directly use the pre-generated high-quality unique k-mer files for mNGS data analysis. It should be pointed out that currently fastv sorts the results according to the genome coverage and median k-mer hits, without considering the pathogenicity of each virus or microorganism. In future work, we will further link the microbial pathogen databases, like the FDA-ARGOS [38] , to provide better functions for pathogen identification. percent=$(awk 'BEGIN{printf \"%0.2f\",('$coverd_base'/'$genome_length')*100}') awk -v num1=$percent -v num2=20 'BEGIN{print(num1>num2)?\"POSITIVE\":\"NEGATIVE\"}'",
            "cite_spans": [
                {
                    "start": 1113,
                    "end": 1117,
                    "text": "[38]",
                    "ref_id": "BIBREF37"
                }
            ],
            "ref_spans": [],
            "section": "DISCUSSION"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Coronavirus covid-19 has killed more people than SARS and MERS combined, despite lower case fatality rate",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Mahase",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "BMJ",
            "volume": "368",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "The global macroeconomic impacts of COVID-19: Seven scenarios",
            "authors": [
                {
                    "first": "W",
                    "middle": [
                        "J"
                    ],
                    "last": "Mckibbin",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Fernando",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Economic effects of coronavirus outbreak (COVID-19) on the world economy",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Fernandes",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Available at SSRN",
            "volume": "3557504",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Responding to Covid-19-a once-in-a-century pandemic?",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Gates",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "New England Journal of Medicine",
            "volume": "382",
            "issn": "",
            "pages": "1677--1679",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Temperature and latitude analysis to predict potential spread and seasonality for COVID-19",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "M"
                    ],
                    "last": "Sajadi",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Habibzadeh",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vintzileos",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "Available at SSRN",
            "volume": "3550308",
            "issn": "2020",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Consensus statement: virus taxonomy in the age of metagenomics",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Simmonds",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Adams",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Benk\u0151",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Nature Reviews Microbiology",
            "volume": "15",
            "issn": "",
            "pages": "161--168",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Metagenomics and future perspectives in virus discovery",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "L"
                    ],
                    "last": "Mokili",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Rohwer",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "E"
                    ],
                    "last": "Dutilh",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Current opinion in virology",
            "volume": "2",
            "issn": "",
            "pages": "63--77",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Actionable diagnosis of neuroleptospirosis by next-generation sequencing",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "R"
                    ],
                    "last": "Wilson",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "N"
                    ],
                    "last": "Naccache",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Samayoa",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "N Engl J Med",
            "volume": "370",
            "issn": "",
            "pages": "2408--2417",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "A Novel Coronavirus from Patients with Pneumonia in China",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Zhu",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "N Engl J Med",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A new coronavirus associated with human respiratory disease in China",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Wu",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Yu",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nature",
            "volume": "579",
            "issn": "",
            "pages": "265--269",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "A familial cluster of pneumonia associated with the 2019 novel coronavirus indicating person-to-person transmission: a study of a family cluster",
            "authors": [
                {
                    "first": "Jf-W",
                    "middle": [],
                    "last": "Chan",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Yuan",
                    "suffix": ""
                },
                {
                    "first": "K-H",
                    "middle": [],
                    "last": "Kok",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "The Lancet",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Fast and accurate short read alignment with Burrows-Wheeler transform",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Durbin",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Bioinformatics",
            "volume": "25",
            "issn": "",
            "pages": "1754--1760",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Fast gapped-read alignment with Bowtie 2",
            "authors": [
                {
                    "first": "B",
                    "middle": [],
                    "last": "Langmead",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "L"
                    ],
                    "last": "Salzberg",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Nat Methods",
            "volume": "9",
            "issn": "",
            "pages": "357--359",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "A Genomic Perspective on the Origin and Emergence of SARS-CoV-2",
            "authors": [
                {
                    "first": "Y",
                    "middle": [
                        "Z"
                    ],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "C"
                    ],
                    "last": "Holmes",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Cell",
            "volume": "181",
            "issn": "",
            "pages": "223--227",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Practical innovations for high-throughput amplicon sequencing",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "S"
                    ],
                    "last": "Lundberg",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Yourstone",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Mieczkowski",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Nature Methods",
            "volume": "10",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Hybrid capture and next-generation sequencing identify viral integration sites from formalin-fixed, paraffin-embedded tissue",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "J"
                    ],
                    "last": "Duncavage",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Magrini",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Becker",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "The Journal of Molecular Diagnostics",
            "volume": "13",
            "issn": "",
            "pages": "325--333",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "SPINGO: a rapid species-classifier for microbial amplicon sequences",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Allard",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [
                        "J"
                    ],
                    "last": "Ryan",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [
                        "B"
                    ],
                    "last": "Jeffery",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "BMC Bioinformatics",
            "volume": "16",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Improved metagenomic analysis with Kraken 2",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "E"
                    ],
                    "last": "Wood",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lu",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Langmead",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Genome Biol",
            "volume": "20",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "fastp: an ultra-fast all-in-one FASTQ preprocessor",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Zhou",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Bioinformatics",
            "volume": "34",
            "issn": "",
            "pages": "884--890",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "A novel coronavirus associated with severe acute respiratory syndrome",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "G"
                    ],
                    "last": "Ksiazek",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Erdman",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "S"
                    ],
                    "last": "Goldsmith",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "New England Journal of Medicine",
            "volume": "348",
            "issn": "",
            "pages": "1953--1966",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Hospital outbreak of Middle East respiratory syndrome coronavirus",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Assiri",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Mcgeer",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "M"
                    ],
                    "last": "Perl",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "New England Journal of Medicine",
            "volume": "369",
            "issn": "",
            "pages": "407--416",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Bat Coronaviruses in China",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Fan",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [
                        "L"
                    ],
                    "last": "Shi",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Viruses",
            "volume": "11",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Human papillomavirus (HPV) study of 2916 cytological samples by PCR and DNA sequencing: genotype spectrum of patients from the west German area",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Speich",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Schmitt",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Bollmann",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Journal of medical microbiology",
            "volume": "53",
            "issn": "",
            "pages": "125--128",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "GeneFuse: detection and visualization of target gene fusions from DNA sequencing data",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Huang",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "International Journal of Biological Sciences",
            "volume": "14",
            "issn": "",
            "pages": "843--848",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Theoretical and experimental assessment of degenerate primer tagging in ultra-deep applications of next-generation sequencing",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "H"
                    ],
                    "last": "Liang",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Mo",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Dong",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Nucleic Acids Res",
            "volume": "42",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "MutScan: fast detection and visualization of target mutations by scanning FASTQ data",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Huang",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Wen",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "BMC Bioinformatics",
            "volume": "19",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "A survey of graph edit distance",
            "authors": [
                {
                    "first": "X",
                    "middle": [],
                    "last": "Gao",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Xiao",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Tao",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "Pattern Analysis and Applications",
            "volume": "13",
            "issn": "",
            "pages": "113--129",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "The role of repetitive DNA sequences in the size variation of Epstein-Barr virus (EBV) nuclear antigens, and the identification of different EBV isolates using RFLP and PCR analysis",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Falk",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Gratama",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Rowe",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "Journal of General Virology",
            "volume": "76",
            "issn": "",
            "pages": "779--790",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Illumina sequencing library preparation for highly multiplexed target capture and sequencing",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Meyer",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kircher",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Cold Spring Harbor Protocols",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "k-core: Hardware Accelerator for k-mer Generation and Counting used in Computational Genomics",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "M"
                    ],
                    "last": "Bose",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [
                        "S"
                    ],
                    "last": "Lalapura",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Saravanan",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "2019 32nd International Conference on VLSI Design and 2019 18th International Conference on Embedded Systems (VLSID)",
            "volume": "",
            "issn": "",
            "pages": "347--352",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "A flexible parallel library for k-mer indexing of biological sequences on distributed memory systems",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Pan",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Flick",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Jain",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "IEEE/ACM Transactions on Computational Biology and Bioinformatics",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "NCBI viral genomes resource",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "R"
                    ],
                    "last": "Brister",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Ako-Adjei",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bao",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Nucleic acids research",
            "volume": "43",
            "issn": "",
            "pages": "571--577",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "NCBI reference sequences (RefSeq): a curated nonredundant sequence database of genomes, transcripts and proteins",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "D"
                    ],
                    "last": "Pruitt",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Tatusova",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "R"
                    ],
                    "last": "Maglott",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "Nucleic acids research",
            "volume": "35",
            "issn": "",
            "pages": "61--65",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "The proximal origin of SARS-CoV-2",
            "authors": [
                {
                    "first": "K",
                    "middle": [
                        "G"
                    ],
                    "last": "Andersen",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Rambaut",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [
                        "I"
                    ],
                    "last": "Lipkin",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nature Medicine",
            "volume": "26",
            "issn": "",
            "pages": "450--452",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "The 2019-new coronavirus epidemic: Evidence for virus evolution",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Benvenuto",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Giovanetti",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Ciccozzi",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "J Med Virol",
            "volume": "92",
            "issn": "",
            "pages": "455--459",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "Whole-genome sequencing identifies recurrent mutations in hepatocellular carcinoma",
            "authors": [
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Kan",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Zheng",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Genome Res",
            "volume": "23",
            "issn": "",
            "pages": "1422--1433",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "NCBI BLAST: a better web interface",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Johnson",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Zaretskaya",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Raytselis",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Nucleic acids research",
            "volume": "36",
            "issn": "",
            "pages": "5--9",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "FDA-ARGOS is a database with public quality-controlled reference genomes for diagnostic use and regulatory science",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Sichtig",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Minogue",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Yan",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Nature Communications",
            "volume": "10",
            "issn": "",
            "pages": "1--13",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "summarizes the fastv workflow.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Overview of the fastv workflow. The items with grey backgrounds are input files, while",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Fastv HTML report demonstration. The result for targeted k-mer hits is visualized using",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Overview of the UniqueKMER workflow. The items with grey backgrounds are input files, while the items with black backgrounds are output files. The original index consists of unique k-mer",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "selected twelve SARS-CoV-2 genomes from the GISAID database. Forster et al. recently conducted evolutionary analysis of 160 SARS-CoV-2 genomes[34]. They classified SARS-CoV-2 into three types (A, B, and C) according to amino acid changes, and determined the evolutionary relationships of these types. Based on this work, we selected two ancestral and derived genomes from each type, taking into consideration the date and location of the collected samples. Because SARS-CoV-2 has",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "EBV identification using fastv. The EBV genome has a large repetitive region between 12kb and 35kb. The coverage result generated by fastv (A) shows even coverage of this region, and is similar to the IGV visualization of the BWA alignment result (B). The data used in this experiment was whole genome sequencing of an EBV-positive sample, downloaded from NCBI SRA (SRA accession: ERR1293949). We evaluated the subtyping function of fastv with sequencing data from samples infected with HPV and HBV. For HPV, genomes of nine HPV subtypes (HPV-6b, HPV-11, HPV-16, HPV-18, HPV-31, HPV-33, HPV-45, HPV-52, HPV-58) were included in the genomes FASTA file, and three datasets (SRA accessions: SRR1609138\uff0cSRR160913 and SRR1609140) were tested. For HBV, genomes of eight HBV subtypes (HBV-A to HBV-H) were included and four datasets (SRA accessions:",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "HBV subtyping using fastv. Eight HBV subtypes (HBV-A to HBV-H) are included in the genome list. The subtyping result is HBV-C, which is 99.69% covered. HBV genome has many",
            "latex": null,
            "type": "figure"
        },
        "TABREF1": {
            "text": "Comparative performance of fastv and alignment-based method for identification of SARS-",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "# Use fastp for adapter trimming and quality pruning fastp -i $sample_R1.fastq.gz -o $sample_clean_R1.fastq.gz -I $sample_R2.fastq.gz -O $sample_clean_R2.fastq.gz -h $sample_clean.html -j $sample_clean.json > $sample_clean.log & # Extract microbial reads by filtering human reads. bwa mem -R \"@RG\\tID:$sample\\tLB:$sample\\tPL:$sample\\tSM:$sample\" -t 8 -k 32 -M $path/bwaindex/hg19.fa $sample_clean_R1.fastq.gz $sample_clean_R2.fastq.gz | sentieon util sort -o $sample.hg19.sort.bam -t 8 --sam2bam -isamtools view -b -f 12 -F 256 $sample.hg19.sort.bam > $sample.hg19.bothEndsUnmapped.bam $sample.hg19.bothEndsUnmapped.sorted.bam bamToFastq -i $sample.hg19.bothEndsUnmapped.sorted.bam -fq $sample.rmhost.clean.1.fq -fq2 $sample.rmhost.clean.2.fq # Remove Ribosomal RNA (rRNA) reads bwa mem -R \"@RG\\tID:$sample\\tLB:$sample\\tPL:$sample\\tSM:$sample\" -t 8 -k 32 -M $path/rRNA_fa/sequence.fa $sample.rmhost.clean.1.fq $sample.rmhost.clean.2.fq | sentieon util sort -o $sample.rRNA.sort.bam -t 8 --sam2bam -isamtools view -b -f 12 -F 256 $sample.rRNA.sort.bam > $sample.rRNA.bothEndsUnmapped.bam $sample.rRNA.bothEndsUnmapped.sorted.bam bamToFastq -i $sample.rRNA.bothEndsUnmapped.sorted.bam -fq $sample.rmrRNA.clean.1.fq -fq2 $sample.rmrRNA.clean.2.fq # Align reads to the SARS-CoV-2 genome, remove duplicates, and calculated the coverage. bwa mem -R \"@RG\\tID:$sample\\tLB:$sample\\tPL:$sample\\tSM:$sample\" -t 8 -k 32 -M $path/bwaindex/SARS-CoV-2.fa $sample.rmrRNA.clean.1.fq $sample.rmrRNA.clean.2.fq | sentieon util sort -o $sample.sort.bam -t 8 --sam2bam -igencore -i $sample.sort.bam -o $sample.gencore.sort.bam -r $path/bwaindex/SARS-CoV-2.fa -j $sample.gencore.json -h $sample.gencore.html samtools index $sample.gencore.sort.bams samtools depth -aa $sample.gencore.sort.bam > $sample.gencore.sort.depth samtools mpileup -AB -Q 25 -q 30 -d 100000 -f $path/bwaindex/SARS-CoV-2.fa $sample.gencore.sort.bam > $sample.gencore.sort.mpileup # Determine the result by evaluate the coverage of SARS-CoV-2 genome, greater than 20% means positive. #!/bin/bash genome_length=$(awk '{print NR}' $sample.gencore.sort.depth | tail -n1) coverd_base=$(awk '{print NR}' $sample.gencore.sort.mpileup | tail -n1)",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The authors would like to thank the community users for testing these tools and reporting bugs. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgement"
        },
        {
            "text": "The authors declare no conflicts of interest.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "CONFLICT OF INTEREST"
        }
    ]
}