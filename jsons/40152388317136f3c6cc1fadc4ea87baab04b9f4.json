{"paper_id": "40152388317136f3c6cc1fadc4ea87baab04b9f4", "metadata": {"title": "Partially latent class models for case-control studies of childhood pneumonia aetiology", "authors": [{"first": "Zhenke", "middle": [], "last": "Wu", "suffix": "", "affiliation": {"laboratory": "", "institution": "Johns Hopkins University", "location": {"settlement": "Baltimore", "country": "USA"}}, "email": ""}, {"first": "Maria", "middle": [], "last": "Deloria-Knoll", "suffix": "", "affiliation": {"laboratory": "", "institution": "Johns Hopkins University", "location": {"settlement": "Baltimore", "country": "USA"}}, "email": ""}, {"first": "Laura", "middle": ["L"], "last": "Hammitt", "suffix": "", "affiliation": {"laboratory": "", "institution": "Johns Hopkins University", "location": {"settlement": "Baltimore", "country": "USA"}}, "email": ""}, {"first": "Scott", "middle": ["L"], "last": "Zeger", "suffix": "", "affiliation": {"laboratory": "", "institution": "Johns Hopkins University", "location": {"settlement": "Baltimore", "country": "USA"}}, "email": ""}]}, "abstract": [{"text": "In population studies on the aetiology of disease, one goal is the estimation of the fraction of cases that are attributable to each of several causes. For example, pneumonia is a clinical diagnosis of lung infection that may be caused by viral, bacterial, fungal or other pathogens. The study of pneumonia aetiology is challenging because directly sampling from the lung to identify the aetiologic pathogen is not standard clinical practice in most settings. Instead, measurements from multiple peripheral specimens are made. The paper introduces the statistical methodology designed for estimating the population aetiology distribution and the individual aetiology probabilities in the Pneumonia Etiology Research for Child Health study of 9500 children for seven sites around the world. We formulate the scientific problem in statistical terms as estimating the mixing weights and latent class indicators under a partially latent class model (PLCM) that combines heterogeneous measurements with different error rates obtained from a case-control study.We introduce the PLCM as an extension of the latent class model.We also introduce graphical displays of the population data and inferred latent class frequencies.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}, {"text": "The methods are tested with simulated data, and then applied to Pneumonia Etiology Research for Child Health data. The paper closes with a brief description of extensions of the PLCM to the regression setting and to the case where conditional independence between the measures is relaxed.", "cite_spans": [], "ref_spans": [], "section": "Abstract"}], "body_text": [{"text": "Identifying the pathogens that are responsible for infectious diseases in a population poses significant statistical challenges. Consider the measurement problem in the Pneumonia Etiology Research for Child Health (PERCH) study, which is a case-control study that has enrolled 9500 children from seven sites around the world. Pneumonia is a clinical syndrome that develops because of an infection of the lung tissue by bacteria, viruses, mycobacteria or fungi . The appropriate treatment and public health control measures vary by pathogen. Which pathogen is infecting the lung usually cannot be directly observed and must therefore be inferred from multiple peripheral measurements with differing error rates. The primary goals of the PERCH study are to integrate the multiple sources of data (a) to attribute a particular case's lung infection to a pathogen and (b) to estimate the prevalences of the aetiologic pathogens in a population of children that met clinical pneumonia definitions. The basic statistical framework of the problem is pictured in Fig. 1 . The disease status is determined by clinical examination including chest X-ray (Deloria-Knoll et al., 2012) . The known pneumonia status (case-control) is directly caused by the presence or absence of a pathogencaused infection in the lung. For controls, the lung is known to be sterile and has no infection. For a child who has been clinically diagnosed with pneumonia, the pathogen causing the infection in the child's lung is the scientific target of interest. Among the candidate pathogens being tested, we assume that only one is the primary cause. Extensions to multiple pathogens are straightforward. Because, for most cases, it is not possible to sample the lung directly, we do not know with certainty which pathogen infected the lung, so we seek to infer the infection status on the basis of a series of laboratory measurements of specimens from various body fluids and body sources.", "cite_spans": [{"start": 1143, "end": 1171, "text": "(Deloria-Knoll et al., 2012)", "ref_id": "BIBREF21"}], "ref_spans": [{"start": 1055, "end": 1061, "text": "Fig. 1", "ref_id": "FIGREF0"}], "section": "Introduction"}, {"text": "The PERCH study was originally designed with three sources of measurements that are relevant to the lung infection: directly from the lung by lung aspirate, from blood culture and from the nasopharyngeal cavity (by swab). Therefore, our model was designed to accommodate all three sources. As the study progressed, less than 1% of cases had direct lung measurements and this sampled group was unrepresentative of all cases. The model, and accompanying software, includes all three sources of measurements for application to other aetiology studies, but the analysis of the motivating PERCH data below uses only blood culture and nasopharyngeal swab data.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "The measurement error rates differ by type of measurement. Here, an error rate or epidemi-ologic error rate is the probability of the pathogen's presence or absence in a specimen test given the presence or absence of infection in the lung. For this application, it is convenient to categorize measures into three subgroups referred to as 'gold', 'silver' and 'bronze' standard measurements. A gold standard (GS) measurement is assumed to have both perfect sensitivity and perfect specificity. Lung aspirate data would have been GS. A silver standard (SS) measurement is assumed to have perfect specificity, but imperfect sensitivity. Culturing bacteria from blood samples ('B-cX') is an example of SS measurements in the PERCH study. Finally, bronze standard (BS) measurements are assumed to have imperfect sensitivity and imperfect specificity. Polymerase chain reaction evaluation of bacteria and viruses from nasopharyngeal samples is an example.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "In the PERCH study, both SS and BS measurements are available for all cases. BS, but not SS, measures are available for controls. Our goal was to develop a statistical model that combines GS and SS measurements from cases, with BS data from cases and controls to estimate the distribution of pathogens in the population of pneumonia cases, and the conditional probability that each of the J pathogens is the primary cause of an individual child's pneumonia given her or his set of measurements. Even in applications where GS data are not available, a flexible modelling framework that can accommodate GS data is useful for both the evaluation of statistical information from BS data (Section 3) and the incorporation of GS data if they become available as measurement technology improves.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "Latent class models (LCMs) (Goodman, 1974) have been successfully used to integrate multiple diagnostic tests or raters' assessments to estimate a binary latent status for all study subjects (Hui and Walter, 1980; Qu and Hadgu, 1998; Albert et al., 2001; Albert and Dodd, 2008) . In the LCM framework, conditional distributions of measurements given latent status are specified. Then the marginal likelihoods of the multivariate measurements are maximized as a function of the disease prevalence, sensitivities and specificities. This framework has also been extended to infer ordinal latent status (Wang et al., 2011) .", "cite_spans": [{"start": 27, "end": 42, "text": "(Goodman, 1974)", "ref_id": "BIBREF12"}, {"start": 191, "end": 213, "text": "(Hui and Walter, 1980;", "ref_id": "BIBREF16"}, {"start": 214, "end": 233, "text": "Qu and Hadgu, 1998;", "ref_id": "BIBREF25"}, {"start": 234, "end": 254, "text": "Albert et al., 2001;", "ref_id": "BIBREF3"}, {"start": 255, "end": 277, "text": "Albert and Dodd, 2008)", "ref_id": "BIBREF2"}, {"start": 599, "end": 618, "text": "(Wang et al., 2011)", "ref_id": "BIBREF26"}], "ref_spans": [], "section": "Introduction"}, {"text": "There are three salient features of the PERCH childhood pneumonia problem that require extension of the typical LCM approach. First, we have partial knowledge of the latent lung state for some subjects as a result of the case-control design. In the standard LCM approach, the study population comprises subjects with completely unknown class membership. In this study, controls are known to have no pathogen infecting the lung. Also, if GS measurements were available from the lung for some cases, their latent variable would be directly observed. As the latent state is known for a non-trivial subset of the study population, we refer to this model as a partially latent class model (PLCM).", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "Second, in most LCM applications, the number of observed measurements on a subject is much larger than the number of latent state categories. Here, the number of observations is of the same order as the number of categories that the latent status can assume. For example, if we consider only the PERCH study BS data, we simultaneously observe the presence or absence of each member from a list of possible pathogens for each child. Even with additional control data, the larger number of latent categories of latent status leads to weak model identifiability as is discussed in more detail in Section 2.1.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "Lastly, measurements with differing error rates (i.e. GS, SS and BS) need to be integrated. Note that the modelling framework that is introduced here is general and can be applied to studies where multiple BS measurements are available, each with a different set of error rates. Understanding the relative value of each level of measurements is important to invest resources into data collection (number of subjects, type of samples) and laboratory assays optimally. An important goal is therefore to estimate the relative information from each type of measurements about the population and individual aetiology distributions. Albert and Dodd (2008) studied a model where some subjects are selected to verify their latent status (i.e. collect GS measurements) with the probability of verification either depending on the previous test results or being completely at random. They showed that GS data can make model estimates more robust to model misspecifications. We further quantify how much GS data would reduce the variance of model parameter estimates for design purposes. Also, they considered binary latent status and did not have available control data. Another related literature that uses both GS and BS data is on verbal autopsy in the setting where no complete vital registry system has been established in the community (King and Lu, 2008) . Quite similar to the goal of inferring pneumonia aetiology from laboratory measurements, the goal of verbal autopsy is to infer the cause of death from a prespecified list by asking close family members questions about the presence or absence of several symptoms. King and Lu (2008) proposed to estimate the causeof-death distribution in a community by using data on dichotomous symptoms and GS data from the hospital where the cause of death and symptoms are both recorded. However, their method involves non-parametric models and requires a sizable sample of GS data, especially when the number of symptoms is large. In addition, a key difference between verbal autopsy and most infectious disease aetiology studies is that the verbal autopsy studies are by definition case only.", "cite_spans": [{"start": 627, "end": 649, "text": "Albert and Dodd (2008)", "ref_id": "BIBREF2"}, {"start": 1332, "end": 1351, "text": "(King and Lu, 2008)", "ref_id": "BIBREF19"}, {"start": 1618, "end": 1636, "text": "King and Lu (2008)", "ref_id": "BIBREF19"}], "ref_spans": [], "section": "Introduction"}, {"text": "Another approach that has previously been used with case and control data is to perform logistic regression of case status on laboratory measurements and then to calculate point estimates of population attributable risks for each pathogen (Bruzzi et al., 1985; Blackwelder et al., 2012) . This method does not account for imperfect laboratory measurements and cannot use GS or SS data if available. Also, the population attributable fraction method assigns zero aetiology for the subset of pathogens that have estimated odds ratios that are smaller than 1, without taking account of the statistical uncertainty for the odds ratio estimates.", "cite_spans": [{"start": 239, "end": 260, "text": "(Bruzzi et al., 1985;", "ref_id": "BIBREF6"}, {"start": 261, "end": 286, "text": "Blackwelder et al., 2012)", "ref_id": "BIBREF4"}], "ref_spans": [], "section": "Introduction"}, {"text": "In this paper, we define and apply a PLCM to incorporate these three features: known infection status for controls, a large number of latent classes and multiple types of measurement. We use a hierarchical Bayesian formulation to estimate (a) the population aetiology distribution or aetiology fraction (the frequency with which each pathogen 'causes' clinical pneumonia in the case population) and (b) the individual aetiology probabilities (the probabilities that a case is 'caused' by each of the candidate pathogens, given observed specimen measurements for that individual).", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "In Section 4, to facilitate communications with scientists, we introduce graphical displays that put data, model assumptions and results together. They enable the scientific investigators to understand better the various sources of evidence from data and their contribution to the final aetiology estimates.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "The remainder of this paper proceeds as follows. In Section 2, we formulate the PLCM and the Gibbs sampling algorithms for implementation. In Section 3, we evaluate our method through simulations tailored for the childhood pneumonia aetiology study. Section 4 presents the analysis of PERCH data. Lastly, Section 5 concludes with a discussion of results and limitations and a few natural extensions of the PLCM also motivated by the PERCH data, as well as future directions of research.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "The R package implementing the methods proposed in this paper is available from https:// github.com/zhenkewu/nplcm.", "cite_spans": [], "ref_spans": [], "section": "Introduction"}, {"text": "We develop a PLCM to address two characteristics of the motivating pneumonia problem: (a) a partially latent state variable because the pathogen infection status is known for controls but not cases and (b) multiple categories of measurements with different error rates across classes.", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "As shown in Fig. 1 , let I L i , taking values in {0, 1, 2, : : : , J}, represent the true state of child i's lung (i = 1, : : : , N) where 0 represents no infection (control) and I L i = j, j = 1, : : : , J, represents the jth pathogen from a prespecified cause-of-pneumonia list that is assumed to be exhaustive. I L i is the scientific target of inference for individual diagnosis. Let M S i represent the J \u00d7 1 vector of binary indicators of the presence or absence of each pathogen in the measurement at site S, where, in our childhood pneumonia aetiology study, S can be nasopharyngeal, blood or lung. Let m S i be the actual observed values. In what follows, we replace S with BS, SS or GS, because they correspond to the measurement types nasopharyngeal, blood and lung respectively.", "cite_spans": [], "ref_spans": [{"start": 12, "end": 18, "text": "Fig. 1", "ref_id": "FIGREF0"}], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "Let Y i = y i \u2208 {0, 1} represent the indicator of whether child i is a healthy control or a clinically diagnosed case. Note that I L i = 0 given Y i = 0. To formalize the PLCM, we define three sets of parameters:", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "(a) \u03c0 = .\u03c0 1 , : : : , \u03c0 J / , the vector of compositional probabilities for each of J pathogen causes, i.e. Pr.I L i = j|Y i = 1, \u03c0/, j = 1, : : : , J;", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "the false positive rate (FPR) for measurement j (j = 1, : : : , J) at site S (note that the FPRs {\u03c8 S j } J j=1 can be estimated from the control data at site S, because I L i = 0 denotes that the ith subject has no infection in the lung, i.e. a control); (c) \u03b8 S j = Pr.M S ij = 1|I L i = j/, the true positive rate (TPR) for measurement j at site S for a person whose lung is infected by pathogen j, j = 1, : : : , J.", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "We further let \u03c8 S = .\u03c8 S 1 , : : : , \u03c8 S J / and \u03b8 S = .\u03b8 S 1 , : : : , \u03b8 S J / . Using these definitions, we have FPR \u03c8 GS j = 0 and TPR \u03b8 GS j = 1 for GS measurements, so M GS ij = 1 if and only if I L i = j, j = 1, : : : , J (perfect sensitivity and specificity). For SS measurements, the FPR \u03c8 SS", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "We formalize the model likelihood for each type of measurement. We first describe the model for BS measurement M BS for a control or a case. For control i, positive detection of the jth pathogen is a false positive representation of the non-infected lung. Therefore, we assume that M BS ij |\u03c8 BS \u223c Bernoulli.\u03c8 S j /, j = 1, : : : , J, with conditional independence, or equivalently", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "For a case infected by pathogen j, the positive detection rate for the jth pathogen in BS assays is \u03b8 BS j . Since we assume a single cause for each case, detection of pathogens other than j will be false positive results with probability equal to the FPR as in the controls: \u03c8 BS l , l = j. This non-differential misclassification across the case and control populations is the essential assumption of the latent class approach because it allows us to borrow information from control BS data to distinguish the true cause from background colonization. We further discuss this non-differential misclassification in the context of the pneumonia aetiology problem in the final section. Then,", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "is the likelihood contributed by BS measurements from case i, where m = m BS i . Similarly, the likelihood contribution from case i's SS measurements that have perfect specificities can be written as", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "where m = m SS i and 1 {\u00b7} is the indicator function, which equals 1 if the statement in the brackets is true and otherwise is 0. Here J J represents the number of actual SS measurements on each case, and \u03b8 SS = .\u03b8 SS 1 , : : : , \u03b8 SS J /. SS measurements test only for a subset of all J pathogens (for example blood culture detects only bacteria) and J is the number of bacteria that are potential causes. Finally, for completeness, GS measurement is assumed to follow a multinomial distribution with likelihood", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "Let \u03b4 i be the binary indicator of a case i having GS measurements; it equals 1 if the case has available GS data and 0 otherwise. Combining likelihood components (1)-(4), the total model likelihood for BS, SS and GS data across independent cases and controls is", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "where \u03b3 = .\u03b8 BS , \u03c8 BS , \u03b8 SS , \u03c0/ stacks all unknown parameters, and data", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "collect all the available measurements on study subjects. Our primary statistical goal is to estimate the posterior distribution of the population aetiology distribution \u03c0, and to obtain individual etiology (I L \u00c5 ) prediction given a case's measurements. To enable Bayesian inference, prior distributions on model parameters are specified as follows: \u03c0 \u223c Dirichlet.a 1 , : : : , a J /, \u03c8 BS j \u223c beta.b 1j , b 2j /, \u03b8 BS j \u223c beta.c 1j , c 2j /, j = 1, : : : , J, and \u03b8 SS j \u223c beta.d 1j , d 2j /, j = 1, : : : , J . Hyperparameters for the aetiology prior, a 1 , : : : , a J , are usually 1s to denote equal and non-informative prior weights for each pathogen if expert prior knowledge is unavailable. The FPR for the jth pathogen, \u03c8 BS j , generally can be well estimated from control data; thus b 1j = b 2j = 1 is the default choice. For TPR parameters \u03b8 BS j and \u03b8 SS j , if prior knowledge on TPRs is available, we choose .c 1j , c 2j / so that the 2:5% and 97:5% quantiles of the beta distribution with parameter .c 1j , c 2j / match the prior minimum and maximum TPR values elicited from pneumonia experts. Otherwise, we use default value 1s for the beta hyperparameters. Similarly we choose values of .d 1j , d 2j / either by prior knowledge or default values of 1. We finally assume prior independence of the parameters as", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "represents the distribution of random variable or vector A. These priors represent a balance between explicit prior knowledge about measurement error rates and the desire to be as objective as possible for a particular study. As described in the next section, the identifiability constraints on the PLCM require specification of a reasonable subset of parameter values to identify parameters of greatest scientific interest.", "cite_spans": [], "ref_spans": [], "section": "A partially latent class model for multiple indirect measurements"}, {"text": "Potential non-identifiability of LCM parameters is well known (Goodman, 1974) . For example, an LCM with four observed binary indicators and three latent classes is not identifiable despite providing 15 degrees of freedom to estimate 14 parameters (Goodman, 1974) . In principle, the Bayesian framework avoids the non-identifiability problem in LCMs by incorporating prior information about unidentified parameter subspaces (e.g. Garrett and Zeger (2000) ). Many researchers point out that the posterior variance for non-identifiable parameters does not decrease to 0 as the sample size approaches \u221e (e.g. Kadane (1975) , Gustafson et al. (2001) and Gustafson (2005) ). Even when data are not fully informative about a parameter, an identified set of parameter values that is consistent with the observed data can, nevertheless, be valuable in a complex scientific investigation (Gustafson, 2009 ) such as the PERCH study.", "cite_spans": [{"start": 62, "end": 77, "text": "(Goodman, 1974)", "ref_id": "BIBREF12"}, {"start": 248, "end": 263, "text": "(Goodman, 1974)", "ref_id": "BIBREF12"}, {"start": 430, "end": 454, "text": "Garrett and Zeger (2000)", "ref_id": "BIBREF11"}, {"start": 606, "end": 619, "text": "Kadane (1975)", "ref_id": "BIBREF18"}, {"start": 622, "end": 645, "text": "Gustafson et al. (2001)", "ref_id": "BIBREF15"}, {"start": 650, "end": 666, "text": "Gustafson (2005)", "ref_id": "BIBREF13"}, {"start": 879, "end": 895, "text": "(Gustafson, 2009", "ref_id": "BIBREF14"}], "ref_spans": [], "section": "Model identifiability"}, {"text": "When GS data are available, the PLCM is identifiable; when they are not, the two sets of parameters \u03c0 and {\u03b8 BS j } J j=1 are not both identified and prior knowledge must be incorporated. Here we restrict attention to the scenario with only BS data for simplicity but similar arguments pertain to the BS plus SS scenario. The problem can be understood from the form of the positive measurement rates for pathogens among cases. In the PLCM likelihood for the BS data (only retaining components in equation (5) with superscripts BS), the positive rate for pathogen j is a convex combination of the TPR and FPR:", "cite_spans": [], "ref_spans": [], "section": "Model identifiability"}, {"text": "where the left-hand side of this equation can be estimated by the observed positive rate of pathogen j among cases. Although the control data provide \u03c8 BS j -estimates, the two parameters \u03c0 j and \u03b8 BS j are not both identified. GS data, if available, identify \u03c0 j and resolve the lack of identifiability. Otherwise, we need to incorporate prior scientific information on one of them, usually the TPR (\u03b8 BS j ). In the PERCH study, prior knowledge about \u03b8 BS j is obtained from infectious disease and laboratory experts (Murdoch et al., 2012) based on vaccine probe studies (Cutts et al., 2005; Madhi et al., 2005) . If the observed case positive rate is much higher than the rate in controls (\u03c8 BS j ), only large values of the TPR (\u03b8 BS j ) are supported by the data, making aetiology estimation more precise (Section 2.2).", "cite_spans": [{"start": 519, "end": 541, "text": "(Murdoch et al., 2012)", "ref_id": "BIBREF21"}, {"start": 573, "end": 593, "text": "(Cutts et al., 2005;", "ref_id": "BIBREF8"}, {"start": 594, "end": 613, "text": "Madhi et al., 2005)", "ref_id": "BIBREF23"}], "ref_spans": [], "section": "Model identifiability"}, {"text": "The full model identification can be generally characterized by inspecting the Jacobian matrix of the transformation F from model parameters \u03b3 to the distribution p of the observables, p = F.\u03b3/. Let \u03b3 = .\u03b8 BS , \u03c8 BS , \u03c0 1 , : : : , \u03c0 J\u22121 / represent the .3J \u2212 1/-dimensional unconstrained model parameters. The PLCM defines the transformation .p 1 , p 0 / = F.\u03b3/, where p 1 and p 0 are the two contingency probability distributions for the BS measurements in the case and control populations, each with dimension 2 J \u2212 1. It can be shown that the Jacobian matrix has J \u2212 1 of its singular values 0, which means that the model parameters \u03b3 are not fully identified from the data. The FPRs (\u03c8 BS j , j = 1, : : : , J) in the PLCM are, however, identifiable parameters that can be estimated from control data. Therefore, the PLCM is termed partially identifiable (Jones et al., 2010) .", "cite_spans": [{"start": 860, "end": 880, "text": "(Jones et al., 2010)", "ref_id": "BIBREF17"}], "ref_spans": [], "section": "Model identifiability"}, {"text": "The parameters in likelihood (5) include the population aetiology distribution \u03c0, TPRs and FPRs for BS measurements, \u03c8 BS and \u03b8 BS , and TPRs for SS measurements \u03b8 SS . The posterior distribution of these parameters can be estimated by constructing approximating samples from the joint posterior via a Markov chain Monte Carlo (MCMC) Gibbs sampler. The full conditional distributions for the Gibbs sampler are detailed in Appendix A.", "cite_spans": [], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "We develop a Gibbs sampler with two essential steps:", "cite_spans": [], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "(a) multinomial sampling of lung infection state among cases, I L i |\u03c0, Y i = 1 \u223c multinomial.\u03c0/;", "cite_spans": [], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "(b) the measurement stage given lung infection state,", "cite_spans": [], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "conditionally independent. This is readily implemented by using the freely available software WinBUGS 1.4 (Lunn et al., 2000) . In the application below, convergence was monitored by using auto-correlations, kernel density plots and Brooks-Gelman-Rubin statistics (Brooks and Gelman, 1998) of the MCMC chains. The statistical results below are based on 10 000 iterations of burn-in followed by 50 000 production samples from each of three parallel chains.", "cite_spans": [{"start": 106, "end": 125, "text": "(Lunn et al., 2000)", "ref_id": "BIBREF22"}, {"start": 264, "end": 289, "text": "(Brooks and Gelman, 1998)", "ref_id": "BIBREF5"}], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "The Bayesian framework naturally allows individual within-sample classification (infection diagnosis) and out-of-sample prediction. This section describes how we calculate the aetiology probabilities for an individual with measurements m \u00c5 . We focus on the more challenging inference scenario when only BS data are available; the general case follows directly. ", "cite_spans": [], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "The form of R jl informs us about what is required for correct diagnosis of an individual. Suppose that I L i = j; then, averaging over m \u00c5 , we have E[R jl ] = log.\u03c0 j =\u03c0 l / + I.\u03b8 BS (Kullback, 2012 ) that represents the expected amount of information in m \u00c5j \u223c Bernoulli.v 1 / for discriminating against m \u00c5j \u223c Bernoulli.v 2 /. If v 1 = v 2 , then I.v 1 ; v 2 / = 0. The form of E[R jl ] shows that there is only additional information from BS data about an individual's aetiology in the person's data when there is a difference between \u03b8 BS j and \u03c8 BS j , j = 1, : : : , J. Following equation (7), we average Pr.I L i = j|m \u00c5 , \u03b3/ over MCMC iterations to obtain an individual prediction for the jth pathogen,p ij , with \u03b3 replaced by its simulated values \u03b3 \u00c5 at each iteration. Repeating for j = 1, : : : , J, we obtain a J probability vector,p i = .p i1 , : : : ,p iJ / , that sums to 1. This scheme is especially useful when a newly examined case has a BS measurement pattern that is not observed in D, which often occurs when J is large. The final decisions regarding which pathogen to treat can then be based onp i . In particular, the pathogen with largest posterior value might be selected. It is Bayes optimal under mean misclassification loss. Individual aetiology predictions described here generalize the positive or negative predictive value from single to multivariate binary measurements and can aid diagnosis of case subjects under other user-specified misclassification loss functions.", "cite_spans": [{"start": 185, "end": 200, "text": "(Kullback, 2012", "ref_id": "BIBREF20"}], "ref_spans": [], "section": "Parameter estimation and individual aetiology prediction"}, {"text": "To demonstrate the utility of the PLCM for studies like the PERCH study, we simulate BS data sets with 500 cases and 500 controls for three pathogens A, B and C by using known PLCM specifications. We focus on three states to facilitate viewing of the \u03c0-estimates and individual predictions in the three-dimensional simplex S 2 . We use a ternary diagram (Aitchison, 1986) representation where the vector \u03c0 = .\u03c0 A , \u03c0 B , \u03c0 C / is encoded as a point with each component being the perpendicular distance to one of the three sides. The parameters involved are fixed at TPR \u03b8 = .\u03b8 A , \u03b8 B , \u03b8 C / = .0:9, 0:9, 0:9/ , FPR \u03c8 = .\u03c8 A , \u03c8 B , \u03c8 C / = .0:6, 0:02, 0:05/ and \u03c0 = .\u03c0 A , \u03c0 B , \u03c0 C / = .0:67, 0:26, 0:07/ . We focus on BS and GS data here and have dropped the BS superscript on the parameters for simplicity. We further let the fraction of cases with GS measurements, \u0394, be either 1% as in the PERCH study or 10%. Although GS measurements are rare in the PERCH study, we investigate a large range of \u0394 to understand in general how much statistical information is contained in BS measurements relative to GS measurements.", "cite_spans": [{"start": 354, "end": 371, "text": "(Aitchison, 1986)", "ref_id": "BIBREF1"}], "ref_spans": [], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": "For any given data set, three distinct subsets of the data can be used: BS only, GS only and BS plus GS, each producing its posterior mean of \u03c0, and 95% credible region (Bayesian confidence region), by a transformed Gaussian kernel density estimator for compositional data (Chac\u00f3n et al., 2011) . To study the relative importance of the GS and BS data, the primary quantity of interest in the simulations is the relative sizes of the credible regions for each data mix. Here, we use uniform priors on \u03b8 and \u03c8, and a Dirichlet.1, : : : , 1/ prior for \u03c0. The results are shown in Fig. 2 .", "cite_spans": [{"start": 273, "end": 294, "text": "(Chac\u00f3n et al., 2011)", "ref_id": "BIBREF7"}], "ref_spans": [{"start": 578, "end": 584, "text": "Fig. 2", "ref_id": "FIGREF2"}], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": "First, in Figs 2(a) (1% GS) and 2(b) (10% GS), each region covers the true aetiology \u03c0. In data that are not shown here, the nominal 95% credible regions cover slightly more than 95% of 200 simulations. Credible regions narrow in on the truth as we combine BS and GS data, and as the fraction of subjects with GS data, \u0394, increases. Also, the posterior mean from the BS plus GS analysis is an optimal balance of information contained in the GS and BS data.", "cite_spans": [], "ref_spans": [], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": "Using the same simulated data sets, Figs 2(c) and 2(d) also show individual aetiology predictions for each of the 8 .= 2 3 / possible BS measurements .m A , m B , m C / , m j = 0, 1, obtained by the methods from Section 2.2. Consider the example of a newly enrolled case without GS data and with no pathogen observed in her BS data: m = .0, 0, 0/ . Suppose that she is part of a case population with 10% GS data. In the case that is illustrated in Fig. 2(d) , her posterior predictive distribution has highest posterior probability 0:76 on pathogen A reflecting two competing forces: the FPRs that describe background colonization (colonization among the controls) and the population aetiology distribution. Given other parameters, m = .0, 0, 0/ gives the smallest likelihood for I L i = A because of its high background colonization rate (FPR \u03c8 A = 0:6). However, before observing .0, 0, 0/ , \u03c0 A is well estimated to be much larger than \u03c0 B and \u03c0 C . Therefore the posterior distribution for this case is heavily weighted towards pathogen A.", "cite_spans": [], "ref_spans": [{"start": 448, "end": 457, "text": "Fig. 2(d)", "ref_id": "FIGREF2"}], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": "Because it is rare to observe pathogen B in a case whose pneumonia is not caused by B, for a case with observation .1, 1, 1/ , the prediction favours B. Although B is not the most prevalent cause among cases, the presence of B in the BS measurements gives the largest likelihood when , , , 95% credible regions for analysis using BS data only, BS plus GS data and GS data only respectively; , , , corresponding posterior mean of \u03c0;", "cite_spans": [], "ref_spans": [], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": ", 95% highest posterior density region of the uniform prior distribution I L i refers to B. For any measurement pattern with a single positive result, the case is always classified into that category in this example.", "cite_spans": [], "ref_spans": [], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": "Most predictions are stable with increasing GS percentage \u0394. Only 000 cases have predictions that move from near the centre to the corner of A. This is mainly because that TPR \u03b8 and aetiology fractions \u03c0 are not as precisely estimated in GS scarce scenarios relative to GS abundant scenarios. Averaging over a wider range of \u03b8 and \u03c0 produces 000 case predictions that are ambiguous, i.e. near the centre. As \u0394 increases, parameters are well estimated, and precise predictions result.", "cite_spans": [], "ref_spans": [], "section": "Simulation for three pathogens case with gold standard and bronze standard data"}, {"text": "The PERCH study is an on-going standardized and comprehensive evaluation of aetiologic agents causing severe and very severe pneumonia among hospitalized children aged 1-59 months in seven low and middle income countries . The study sites include countries with a significant burden of childhood pneumonia and a range of epidemiologic characteristics. The PERCH study is a case-control study that has enrolled over 4000 patients hospitalized for severe or very severe pneumonia and over 5000 controls selected randomly from the community frequency matched on age in each month. More details about the PERCH design are available in Deloria-Knoll et al. (2012) .", "cite_spans": [{"start": 631, "end": 658, "text": "Deloria-Knoll et al. (2012)", "ref_id": "BIBREF21"}], "ref_spans": [], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "To analyse PERCH data with the PLCM model, we have focused on preliminary data from one site with good availability of both SS and BS laboratory results (no missingness). Final analyses of all seven countries will be reported elsewhere on completion of the study. Included in the current analysis are BS data (nasopharyngeal specimens with PCR detection of pathogens) for 432 cases and 479 frequency-matched controls on 11 species of pathogens (seven viruses and four bacteria, representing a subset of pathogens evaluated; their abbreviations are shown on the right-hand margin in Fig. 3 , and full names in Table 1 ) and SS data (blood culture results) on the four bacteria for only the cases.", "cite_spans": [], "ref_spans": [{"start": 582, "end": 588, "text": "Fig. 3", "ref_id": "FIGREF3"}, {"start": 609, "end": 616, "text": "Table 1", "ref_id": "TABREF0"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "In the PERCH study, prior scientific knowledge of measurement error rates is incorporated in the analysis. On the basis of microbiology studies (Murdoch et al., 2012) , the PERCH investigators selected priors for the TPRs of our BS measurements, \u03b8 BS j , in the range of 50-100% for viruses and 0-100% for bacteria. Priors for the SS TPRs were based on observations from vaccine probe studies-randomized clinical trials of pathogen-specific vaccines where the total number of clinical pneumonia cases prevented by the vaccine is much larger than the few SS laboratory-confirmed cases prevented. Comparing the total preventable disease burden with the number of blood culture (SS) positive cases prevented provides information about the TPR of the bacterial blood culture measurements, \u03b8 SS j , j = 1, : : : , 4. Our analysis used the range 5-15% for the SS TPRs of the four bacteria that are consistent with the vaccine probe studies (Cutts et al., 2005; Madhi et al., 2005) . We set beta priors that match these ranges (Section 2) and assumed a Dirichlet(1, : : : , 1) prior on aetiology fractions \u03c0.", "cite_spans": [{"start": 144, "end": 166, "text": "(Murdoch et al., 2012)", "ref_id": "BIBREF21"}, {"start": 934, "end": 954, "text": "(Cutts et al., 2005;", "ref_id": "BIBREF8"}, {"start": 955, "end": 974, "text": "Madhi et al., 2005)", "ref_id": "BIBREF23"}], "ref_spans": [], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "In latent variable models such as the PLCM, key variables are not directly observed. It is therefore essential to picture the model inputs and outputs side by side to understand the analysis better. In this spirit, Figs 3(a) and 3(b) display, for each of the 11 pathogens, a summary of the BS and SS data respectively along with some of the intermediate model results, and the prior and posterior distributions for the aetiology fractions in Fig. 3 (c) (the rows are ordered by posterior means). The observed BS rates (with 95% confidence intervals) for cases and controls are shown on the far left with dots. The conditional odds ratio contrasting the case and control rates given the other pathogens is listed with 95% confidence interval in the box to the right of the BS data summary. Below the case and control observed rates is a horizontal line with a triangle. From left to right, the line starts at the estimated FPR\u03c8 BS j and ends at the estimated TPR \u03b8 BS j , both obtained from the model. Below the TPR are two boxplots summarizing its posterior (top) and prior (bottom) distributions for that pathogen. These boxplots show how the prior assumption influences the TPR estimate as expected given the identifiability constraints that were discussed in Section 2.1. The triangle on the line is the model estimate of the case rate to compare with the observed value above it. As discussed in Section 2.1, the model-based case rate is a linear combination of the FPR and TPR with mixing fraction equal to the estimated aetiology fraction. Therefore, the location of the triangle, expressed as a fraction of the distance from the FPR to the TPR, is the model-based point estimate of the aetiologic fraction for each pathogen. The SS data are shown in a similar fashion to the right of the BS data. By definition, the FPR is 0:0% for SS measures and there are no control data. The observed rate for the cases is shown with its 95% confidence interval. The estimated SS TPR\u03b8 SS j with prior and posterior distributions is shown as for the BS data, except that we plot 95% and 50% credible intervals for the SS TPR above its prior 95% and 50% intervals. Fig. 3 (c) displays the marginal posterior and prior distributions of the aetiologic fraction for each pathogen. We appropriately normalized each density to match the height of the prior and posterior curves. The posterior mean, 50% and 95% credible intervals are shown above the density. Fig. 3 shows that respiratory syncytial virus, RSV, Streptococcus pneumoniae, PNEU, rhinovirus, RHINO, and human metapneumovirus, HMPV A B, occupy the greatest fractions of the aetiology distribution, from 15% to 30% each. That RSV has the largest estimated mean aetiology fraction reflects the large discrepancy between case and control positive rates in the BS data: 25:1% versus 0:8% (marginal odds ratio 38:5 (95% credible interval .18:0, 128:7/)). RHINO has case and control rates that are close to each other, yet its estimated mean aetiology fraction is 16:7%. This is because the model considers the joint distribution of the pathogens, not the marginal rates. The conditional odds ratio of case status with RHINO given all the other pathogen measures is estimated to be 1:5 .1:1, 2:1/, in contrast with the marginal odds ratio, which is close to 1 .0:8, 1:3/.", "cite_spans": [], "ref_spans": [{"start": 442, "end": 448, "text": "Fig. 3", "ref_id": "FIGREF3"}, {"start": 2157, "end": 2163, "text": "Fig. 3", "ref_id": "FIGREF3"}, {"start": 2446, "end": 2452, "text": "Fig. 3", "ref_id": "FIGREF3"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "As discussed in Section 2.1, the data alone cannot precisely estimate both the aetiologic fractions and TPRs without prior knowledge. This is evidenced by comparing the prior and posterior distributions for the TPRs in the BS boxes for some pathogens such as HMPV A B and PARA1 (i.e. Fig. 3(a) ). The posteriors are similar to their priors, indicating that little else about the TPR is learned from the data. The posteriors for some pathogens making up \u03c0 (i.e. shown in Fig. 3(c) ) are likely to be sensitive to the prior specifications of the TPRs.", "cite_spans": [], "ref_spans": [{"start": 284, "end": 293, "text": "Fig. 3(a)", "ref_id": "FIGREF3"}, {"start": 470, "end": 479, "text": "Fig. 3(c)", "ref_id": "FIGREF3"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "We performed sensitivity analyses using multiple sets of priors for the TPRs. At one extreme, we ignored background scientific knowledge and let the priors on the FPR and TPR be uniform for both the BS and the SS data. Ignoring prior knowledge about error rates lowers the aetiology estimates of the bacteria PNEU and Staphylococcus aureus, SAUR. The substantial reduction in the aetiology fraction for PNEU, for example, is a result of the difference in the TPR prior for the SS measurements. In the original analysis (Fig. 3) , the informative prior on the SS sensitivity (TPR) places 95% mass between 5% and 15%. Hence the model assumes that almost 90% of the PNEU infections are being missed in the SS sampling. When a uniform prior is substituted, the fraction that is assumed missed is greatly reduced. For RSV, its posterior mean aetiology fraction is stable (29:4\u221230:0%). The aetiology estimates for other pathogens are fairly stable, with changes in posterior means between \u22122:3% and 3:4%.", "cite_spans": [], "ref_spans": [{"start": 519, "end": 527, "text": "(Fig. 3)", "ref_id": "FIGREF3"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "Under the original priors for the TPR, PARA1 has an estimated aetiologic fraction of 6:4%, even though it has conditional odds ratio 5:9 .2:6, 15:0/. In general, pathogens with larger conditional odds ratios have larger aetiology fraction estimates. But a pathogen also needs a reasonably high observed case positive rate to be allocated a high aetiology fraction. The posterior aetiology fraction estimate of 6:4% for PARA1 results because the prior for the TPR takes values in the range of 50\u221299%. By equation (6), the TPR weight in the convex combination with the FPR (around 1:5%) must be very small to explain the small observed case rate 5:6%. When a uniform prior is placed on the TPR instead, the PARA1 aetiology fraction increases to 9:4% with a wider 95% credible interval.", "cite_spans": [], "ref_spans": [], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "We believe that RHINO's aetiologic fraction may be inflated as a result of its negative association with RSV among cases. Under the conditional independence assumption of the PLCM, this dependence can only be explained by multinomial correlation between the latent cause indicators: I L i \u2261 RSV versus I L i \u2261 RHINO, i.e. \u2212\u03c0 RSV \u03c0 RHINO . There is strong evidence that RSV is a common cause with a stable estimate\u03c0 RSV around 30%. The strong negative association in the cases' measurements between RHINO and RSV therefore is being explained by a larger aetiologic fraction estimate\u03c0 RHINO relative to other pathogens that have less or no association with RSV among the cases. The conditional independence assumption is leveraging information from the associations between pathogens in estimation of the aetiologic fractions. If true, this issue can be addressed by extending the PLCM to allow for alternative sources of correlation between the measurements, e.g. competition between pathogens within the nasopharyngeal space.", "cite_spans": [], "ref_spans": [], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "We have checked the model in two ways by comparing the characteristics of the observed measurements' joint distribution with the same characteristic for the distribution of data of the same size generated by the model. By generating the new data characteristics at every iteration of the MCMC chain, we can obtain the posterior predictive distribution by integrating over the posterior distribution of the parameters (Garrett and Zeger, 2000) .", "cite_spans": [{"start": 417, "end": 442, "text": "(Garrett and Zeger, 2000)", "ref_id": "BIBREF11"}], "ref_spans": [], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "Among the cases, the 95% predictive interval includes the observed values in all except two of the BS patterns and even there the fits are reasonable. Among the controls, there is evidence of a lack of fit for the most common BS pattern with only PNEU and HINF (Fig. S1 in the on-line supplementary materials). Fewer cases with this pattern are observed than predicted under the PLCM. This lack of fit is probably due to associations of pathogen measurements in control subjects. Note that the FPR estimates remain consistent regardless of such correlation as the number of controls increases; however, posterior variances for them may be underestimated.", "cite_spans": [], "ref_spans": [{"start": 261, "end": 269, "text": "(Fig. S1", "ref_id": "FIGREF0"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "A second model checking procedure is for the conditional independence assumption. We estimated standardized log-odds-ratios for cases and controls (Fig. S2 in on-line supplementary materials). Each value is the observed log-odds-ratio for a pair of BS measurements minus the mean log-odds-ratio from the posterior predictive distribution value, under the model's independence assumption, divided by the standard deviation of the same posterior predictive distribution. We find two large deviations among the cases: RSV with RHINO and RSV with HMPV. These are probably caused by strong seasonality in RSV that is out of phase with weaker seasonality in the other two. Otherwise, the number of standardized log-odds-ratios that are greater than 2 (eight out of 110) associations is only slightly larger than what is expected under the assumed model (six expected).", "cite_spans": [], "ref_spans": [{"start": 147, "end": 155, "text": "(Fig. S2", "ref_id": "FIGREF2"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "An attractive feature of using MCMC sampling to estimate posterior distributions is the ease of estimating posteriors for functions of the latent variables and/or parameters. One interesting question from a clinical perspective is whether viruses or bacteria are the major cause and, among each subgroup, which species predominate. Fig. 4(a) shows the posterior distribution for the rate of viral pneumonia, and the conditional distributions of the two leading viruses and bacteria among viral and bacterial causes in Figs 4(b) and 4(c) respectively. The posterior distribution of the viral aetiologic fraction has mode around 70:0% with 95% credible interval .57:0%, 79:2%/. As shown in Fig. 4(b) , PNEU accounts for most bacterial cases (47:2% .24:9%, 71:1%/), and SAUR accounts for 25:5% .8:7%, 49:9%/. Of all viral cases (Fig. 4(c) ), RSV is estimated to cause about 42:9% .32:8%, 54:8%/, and RHINO about 24:2% .13:7%, 37:2%/.", "cite_spans": [], "ref_spans": [{"start": 332, "end": 341, "text": "Fig. 4(a)", "ref_id": "FIGREF4"}, {"start": 688, "end": 697, "text": "Fig. 4(b)", "ref_id": "FIGREF4"}, {"start": 825, "end": 835, "text": "(Fig. 4(c)", "ref_id": "FIGREF4"}], "section": "Analysis of Pneumonia Etiology Research for Child Health data"}, {"text": "In this paper, we estimated the frequency with which pathogens cause disease in a case population by using a PLCM to allow for known states for a subset of subjects and for multiple types of measurement with different error rates. In a case-control study of disease aetiology, measurement error will bias estimates from traditional logistic regression and attributable fraction methods. The PLCM avoids this pitfall and more naturally incorporates multiple sources of data. Here we formulated the model with three levels of measurement error rates.", "cite_spans": [], "ref_spans": [], "section": "Discussion"}, {"text": "Without GS data, we show that the PLCM is only partially identified because of the relationship between the estimated TPR and prevalence of the associated pathogen in the population. Therefore, the inferences are sensitive to the assumptions about the TPR. Uncertainty about their values persists in the final inferences from the PLCM regardless of the number of subjects studied.", "cite_spans": [], "ref_spans": [], "section": "Discussion"}, {"text": "The current model provides a novel solution to the analytic problems that are raised by the PERCH study. This paper introduces and applies a PLCM to a preliminary set of data from one PERCH study site. Confirmatory laboratory testing, incorporation of additional pathogens and adjustment for potential confounders may change the scientific findings that will be reported in the final complete analysis of the study results when it is completed.", "cite_spans": [], "ref_spans": [], "section": "Discussion"}, {"text": "An essential assumption that is relied on in the PLCM is that the probability of detecting one pathogen at a peripheral body site depends on whether that pathogen is infecting the child's lung but is unaffected by the presence of other pathogens in the lung, i.e. the non-differential misclassification error assumption. We have formulated the model to include GS measures even though they are available for only a small and unrepresentative subset of the PERCH cases. In general, the availability of GS measures makes it possible to test this assumption as has been discussed by Albert and Dodd (2008) .", "cite_spans": [{"start": 580, "end": 602, "text": "Albert and Dodd (2008)", "ref_id": "BIBREF2"}], "ref_spans": [], "section": "Discussion"}, {"text": "Several extensions have potential to improve the quality of inferences that are drawn and are being developed for the PERCH study. First, because the control subjects have known class, we can model the dependence structure between the BS measurements and use this to avoid aspects of the conditional independence assumption that is central to most LCM methods. The approach is to extend the PLCM to have K subclasses within each of the current disease classes. These subclasses can introduce correlation between the BS measurements given the true disease state. An interesting question concerns the bias-variance trade-off for different values of K. This idea follows previous work on the parallel factors decomposition of probability distribution for multivariate categorical data (Dunson and Xing, 2009) . This extension will enable model-based checking of the standard PLCM.", "cite_spans": [{"start": 782, "end": 805, "text": "(Dunson and Xing, 2009)", "ref_id": "BIBREF10"}], "ref_spans": [], "section": "Discussion"}, {"text": "Second, in our analyses to date, we have assumed that the pneumonia case definition is error free. Given new biomarkers and availability of chest radiographs that can improve on the clinical diagnosis of pneumonia, one can introduce an additional latent variable to indicate true disease status and use these measurements to assign probabilistically each subject as a case or control. Finally, regression extensions of the PLCM would allow PERCH investigators to study how the aetiology distributions vary with human immunodeficiency virus status, age group and season.", "cite_spans": [], "ref_spans": [], "section": "Discussion"}], "bib_entries": {"BIBREF1": {"ref_id": "b1", "title": "The Statistical Analysis of Compositional Data", "authors": [{"first": "J", "middle": [], "last": "Aitchison", "suffix": ""}], "year": 1986, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF2": {"ref_id": "b2", "title": "On estimating diagnostic accuracy from studies with multiple raters and partial gold standard evaluation", "authors": [{"first": "P", "middle": [], "last": "Albert", "suffix": ""}, {"first": "L", "middle": [], "last": "Dodd", "suffix": ""}], "year": 2008, "venue": "J. Am. Statist. Ass", "volume": "103", "issn": "", "pages": "61--73", "other_ids": {}}, "BIBREF3": {"ref_id": "b3", "title": "Latent class modeling approaches for assessing diagnostic error without a gold standard: with applications to p53 immunohistochemical assays in bladder tumors", "authors": [{"first": "P", "middle": [], "last": "Albert", "suffix": ""}, {"first": "L", "middle": [], "last": "Mcshane", "suffix": ""}, {"first": "J", "middle": [], "last": "Shih", "suffix": ""}], "year": 2001, "venue": "Biometrics", "volume": "57", "issn": "", "pages": "610--619", "other_ids": {}}, "BIBREF4": {"ref_id": "b4", "title": "Statistical methods in the global enteric multicenter study (gems)", "authors": [{"first": "W", "middle": [], "last": "Blackwelder", "suffix": ""}, {"first": "K", "middle": [], "last": "Biswas", "suffix": ""}, {"first": "Y", "middle": [], "last": "Wu", "suffix": ""}, {"first": "K", "middle": [], "last": "Kotloff", "suffix": ""}, {"first": "T", "middle": [], "last": "Farag", "suffix": ""}, {"first": "D", "middle": [], "last": "Nasrin", "suffix": ""}, {"first": "B", "middle": [], "last": "Graubard", "suffix": ""}, {"first": "H", "middle": [], "last": "Sommerfelt", "suffix": ""}, {"first": "M", "middle": [], "last": "Levine", "suffix": ""}], "year": 2012, "venue": "Clin. Infect. Dis", "volume": "55", "issn": "", "pages": "246--253", "other_ids": {}}, "BIBREF5": {"ref_id": "b5", "title": "General methods for monitoring convergence of iterative simulations", "authors": [{"first": "S", "middle": [], "last": "Brooks", "suffix": ""}, {"first": "A", "middle": [], "last": "Gelman", "suffix": ""}], "year": 1998, "venue": "J. Computnl Graph. Statist", "volume": "7", "issn": "", "pages": "434--455", "other_ids": {}}, "BIBREF6": {"ref_id": "b6", "title": "Estimating the population attributable risk for multiple risk factors using case-control data", "authors": [{"first": "P", "middle": [], "last": "Bruzzi", "suffix": ""}, {"first": "S", "middle": [], "last": "Green", "suffix": ""}, {"first": "D", "middle": [], "last": "Byar", "suffix": ""}, {"first": "L", "middle": [], "last": "Brinton", "suffix": ""}, {"first": "C", "middle": [], "last": "Schairer", "suffix": ""}], "year": 1985, "venue": "Am. J. Epidem", "volume": "122", "issn": "", "pages": "904--914", "other_ids": {}}, "BIBREF7": {"ref_id": "b7", "title": "Gaussian kernels for density estimation with compositional data", "authors": [{"first": "J", "middle": [], "last": "Chac\u00f3n", "suffix": ""}, {"first": "G", "middle": [], "last": "Mateu-Figueras", "suffix": ""}, {"first": "J", "middle": [], "last": "Mart\u00edn-Fern\u00e1ndez", "suffix": ""}], "year": 2011, "venue": "Comput. Geosci", "volume": "37", "issn": "", "pages": "702--711", "other_ids": {}}, "BIBREF8": {"ref_id": "b8", "title": "Efficacy of nine-valent pneumococcal conjugate vaccine against pneumonia and invasive pneumococcal disease in the Gambia: randomised, double-blind", "authors": [{"first": "F", "middle": ["T"], "last": "Cutts", "suffix": ""}, {"first": "S", "middle": ["M"], "last": "Zaman", "suffix": ""}, {"first": "G", "middle": [], "last": "Enwere", "suffix": ""}, {"first": "S", "middle": [], "last": "Jaffar", "suffix": ""}, {"first": "O", "middle": ["S"], "last": "Levine", "suffix": ""}, {"first": "J", "middle": ["B"], "last": "Okoko", "suffix": ""}, {"first": "C", "middle": [], "last": "Oluwalana", "suffix": ""}, {"first": "A", "middle": [], "last": "Vaughan", "suffix": ""}, {"first": "S", "middle": ["K"], "last": "Obaro", "suffix": ""}, {"first": "A", "middle": [], "last": "Leach", "suffix": ""}, {"first": "K", "middle": ["P"], "last": "Mcadam", "suffix": ""}, {"first": "E", "middle": [], "last": "Biney", "suffix": ""}, {"first": "M", "middle": [], "last": "Saaka", "suffix": ""}, {"first": "U", "middle": [], "last": "Onwuchekwa", "suffix": ""}, {"first": "F", "middle": [], "last": "Yallop", "suffix": ""}, {"first": "N", "middle": ["F"], "last": "Pierce", "suffix": ""}, {"first": "B", "middle": ["M"], "last": "Greenwood", "suffix": ""}], "year": 2005, "venue": "Adegbola, R. A. and the Gambian Pneumococcal Vaccine Trial Group", "volume": "365", "issn": "", "pages": "1139--1146", "other_ids": {}}, "BIBREF9": {"ref_id": "b9", "title": "and the Pneumonia Methods Working Group (2012) Identification and selection of cases and controls in the pneumonia etiology research for child health project", "authors": [{"first": "M", "middle": [], "last": "Deloria-Knoll", "suffix": ""}, {"first": "D", "middle": ["R"], "last": "Feikin", "suffix": ""}, {"first": "J", "middle": ["A G"], "last": "Scott", "suffix": ""}, {"first": "K", "middle": ["L"], "last": "O&apos;brien", "suffix": ""}, {"first": "A", "middle": ["N"], "last": "Deluca", "suffix": ""}, {"first": "A", "middle": ["J"], "last": "Driscoll", "suffix": ""}, {"first": "O", "middle": ["S"], "last": "Levine", "suffix": ""}], "year": null, "venue": "Clin. Infect. Dis", "volume": "54", "issn": "", "pages": "117--123", "other_ids": {}}, "BIBREF10": {"ref_id": "b10", "title": "Nonparametric bayes modeling of multivariate categorical data", "authors": [{"first": "D", "middle": [], "last": "Dunson", "suffix": ""}, {"first": "C", "middle": [], "last": "Xing", "suffix": ""}], "year": 2009, "venue": "J. Am. Statist. Ass", "volume": "104", "issn": "", "pages": "1042--1051", "other_ids": {}}, "BIBREF11": {"ref_id": "b11", "title": "Latent class model diagnosis", "authors": [{"first": "E", "middle": [], "last": "Garrett", "suffix": ""}, {"first": "S", "middle": [], "last": "Zeger", "suffix": ""}], "year": 2000, "venue": "Biometrics", "volume": "56", "issn": "", "pages": "1055--1067", "other_ids": {}}, "BIBREF12": {"ref_id": "b12", "title": "Exploratory latent structure analysis using both identifiable and unidentifiable models", "authors": [{"first": "L", "middle": [], "last": "Goodman", "suffix": ""}], "year": 1974, "venue": "Biometrika", "volume": "61", "issn": "", "pages": "215--231", "other_ids": {}}, "BIBREF13": {"ref_id": "b13", "title": "On model expansion, model contraction, identifiability and prior information: two illustrative scenarios involving mismeasured variables", "authors": [{"first": "P", "middle": [], "last": "Gustafson", "suffix": ""}], "year": 2005, "venue": "Statist. Sci", "volume": "20", "issn": "", "pages": "111--140", "other_ids": {}}, "BIBREF14": {"ref_id": "b14", "title": "What are the limits of posterior distributions arising from nonidentified models, and why should we care?", "authors": [{"first": "P", "middle": [], "last": "Gustafson", "suffix": ""}], "year": 2009, "venue": "J. Am. Statist. Ass", "volume": "104", "issn": "", "pages": "1682--1695", "other_ids": {}}, "BIBREF15": {"ref_id": "b15", "title": "Case-control analysis with partial knowledge of exposure misclassification probabilities", "authors": [{"first": "P", "middle": [], "last": "Gustafson", "suffix": ""}, {"first": "N", "middle": [], "last": "Le", "suffix": ""}, {"first": "R", "middle": [], "last": "Saskin", "suffix": ""}], "year": 2001, "venue": "Biometrics", "volume": "57", "issn": "", "pages": "598--609", "other_ids": {}}, "BIBREF16": {"ref_id": "b16", "title": "Estimating the error rates of diagnostic tests", "authors": [{"first": "S", "middle": [], "last": "Hui", "suffix": ""}, {"first": "S", "middle": [], "last": "Walter", "suffix": ""}], "year": 1980, "venue": "Biometrics", "volume": "36", "issn": "", "pages": "167--171", "other_ids": {}}, "BIBREF17": {"ref_id": "b17", "title": "Identifiability of models for multiple diagnostic testing in the absence of a gold standard", "authors": [{"first": "G", "middle": [], "last": "Jones", "suffix": ""}, {"first": "W", "middle": [], "last": "Johnson", "suffix": ""}, {"first": "T", "middle": [], "last": "Hanson", "suffix": ""}, {"first": "R", "middle": [], "last": "Christensen", "suffix": ""}], "year": 2010, "venue": "Biometrics", "volume": "66", "issn": "", "pages": "855--863", "other_ids": {}}, "BIBREF18": {"ref_id": "b18", "title": "The role of identification in Bayesian theory", "authors": [{"first": "J", "middle": [], "last": "Kadane", "suffix": ""}], "year": 1975, "venue": "Studies in Bayesian Econometrics and Statistics", "volume": "", "issn": "", "pages": "175--191", "other_ids": {}}, "BIBREF19": {"ref_id": "b19", "title": "Verbal autopsy methods with multiple causes of death", "authors": [{"first": "G", "middle": [], "last": "King", "suffix": ""}, {"first": "Y", "middle": [], "last": "Lu", "suffix": ""}], "year": 2008, "venue": "Statist. Sci", "volume": "23", "issn": "", "pages": "78--91", "other_ids": {}}, "BIBREF20": {"ref_id": "b20", "title": "Information Theory and Statistics", "authors": [{"first": "S", "middle": [], "last": "Kullback", "suffix": ""}], "year": 2012, "venue": "", "volume": "", "issn": "", "pages": "", "other_ids": {}}, "BIBREF21": {"ref_id": "b21", "title": "The pneumonia etiology research for child health project: a 21st century childhood pneumonia etiology study", "authors": [{"first": "O", "middle": ["S"], "last": "Levine", "suffix": ""}, {"first": "K", "middle": ["L"], "last": "O&apos;brien", "suffix": ""}, {"first": "M", "middle": [], "last": "Deloria-Knoll", "suffix": ""}, {"first": "D", "middle": ["R"], "last": "Murdoch", "suffix": ""}, {"first": "D", "middle": ["R"], "last": "Feikin", "suffix": ""}, {"first": "A", "middle": ["N"], "last": "Deluca", "suffix": ""}, {"first": "A", "middle": ["J"], "last": "Driscoll", "suffix": ""}, {"first": "H", "middle": ["C"], "last": "Baggett", "suffix": ""}, {"first": "W", "middle": ["A"], "last": "Brooks", "suffix": ""}, {"first": "S", "middle": ["R"], "last": "Howie", "suffix": ""}, {"first": "K", "middle": ["L"], "last": "Kotloff", "suffix": ""}, {"first": "S", "middle": ["A"], "last": "Madhi", "suffix": ""}, {"first": "S", "middle": ["A"], "last": "Maloney", "suffix": ""}, {"first": "S", "middle": [], "last": "Sow", "suffix": ""}, {"first": "D", "middle": ["M"], "last": "Thea", "suffix": ""}, {"first": "J", "middle": ["A"], "last": "Scott", "suffix": ""}], "year": 2012, "venue": "Clin. Infect. Dis", "volume": "54", "issn": "", "pages": "93--101", "other_ids": {}}, "BIBREF22": {"ref_id": "b22", "title": "WinBUGS-a Bayesian modelling framework: concepts, structure, and extensibility", "authors": [{"first": "D", "middle": ["J"], "last": "Lunn", "suffix": ""}, {"first": "A", "middle": [], "last": "Thomas", "suffix": ""}, {"first": "N", "middle": [], "last": "Best", "suffix": ""}, {"first": "D", "middle": [], "last": "Spiegelhalter", "suffix": ""}], "year": 2000, "venue": "Statist. Comput", "volume": "10", "issn": "", "pages": "325--337", "other_ids": {}}, "BIBREF23": {"ref_id": "b23", "title": "The impact of a 9-valent pneumococcal conjugate vaccine on the public health burden of pneumonia in hiv-infected and -uninfected children", "authors": [{"first": "S", "middle": ["A"], "last": "Madhi", "suffix": ""}, {"first": "L", "middle": [], "last": "Kuwanda", "suffix": ""}, {"first": "C", "middle": [], "last": "Cutland", "suffix": ""}, {"first": "K", "middle": ["P"], "last": "Klugman", "suffix": ""}], "year": 2005, "venue": "Clin. Infect. Dis", "volume": "40", "issn": "", "pages": "1511--1518", "other_ids": {}}, "BIBREF24": {"ref_id": "b24", "title": "Pneumonia Methods Working Group, PERCH Core Team (2012) Laboratory methods for determining pneumonia etiology in children", "authors": [{"first": "D", "middle": ["R"], "last": "Murdoch", "suffix": ""}, {"first": "K", "middle": ["L"], "last": "O&apos;brien", "suffix": ""}, {"first": "A", "middle": ["J"], "last": "Driscoll", "suffix": ""}, {"first": "R", "middle": ["A"], "last": "Karron", "suffix": ""}, {"first": "N", "middle": [], "last": "Bhat", "suffix": ""}], "year": null, "venue": "Clin. Infect. Dis", "volume": "54", "issn": "", "pages": "146--152", "other_ids": {}}, "BIBREF25": {"ref_id": "b25", "title": "A model for evaluating sensitivity and specificity for correlated diagnostic tests in efficacy studies with an imperfect reference test", "authors": [{"first": "Y", "middle": [], "last": "Qu", "suffix": ""}, {"first": "A", "middle": [], "last": "Hadgu", "suffix": ""}], "year": 1998, "venue": "J. Am. Statist. Ass", "volume": "93", "issn": "", "pages": "920--928", "other_ids": {}}, "BIBREF26": {"ref_id": "b26", "title": "Supporting information Additional 'supporting information' may be found in the on-line version of this article: 'Web-based supplementary materials for \"Partially-latent class models (pLCM) for case-control studies of childhood pneumonia etiology", "authors": [{"first": "Z", "middle": [], "last": "Wang", "suffix": ""}, {"first": "X", "middle": [], "last": "Zhou", "suffix": ""}, {"first": "M", "middle": [], "last": "Wang", "suffix": ""}], "year": 2011, "venue": "Biostatistics", "volume": "12", "issn": "", "pages": "567--581", "other_ids": {}}}, "ref_entries": {"FIGREF0": {"text": "Directed acyclic graph illustrating relationships between lung infection state I L , imperfect laboratory measurements on the presence or absence of each of a list of pathogens at each site M NP , M B and M L , disease outcome Y and covariates X", "latex": null, "type": "figure"}, "FIGREF1": {"text": "The within-sample classification for case i is based on the posterior distribution of latent indicators given the observed data, i.e. Pr.I L i = j|D/, j = 1, : : : , J, which can be obtained by averaging along the cause indicator I L i chain from MCMC samples. For a case with new BS measurements m \u00c5 , we have Pr.I L i = j|m \u00c5 , D/ = Pr.I L i = j|m \u00c5 , \u03b3/Pr.\u03b3|m \u00c5 , D/d\u03b3, j = 1, : : : , J, .7/ where the second factor in the integrand can be approximated by the posterior distribution given current data, i.e. Pr.\u03b3|D/. For the first term in the integrand, we explicitly obtain the model-based, one-sample conditional posterior distribution, Pr.I L i = j|m \u00c5 , \u03b3/ = \u03c0 j l j .m \u00c5 ; \u03b3/ m \u03c0 r m l m .m \u00c5 ; \u03b3/, j = 1, : : : , J, where l m .m \u00c5 ; \u03b3/ = .\u03b8 BS j / m AEj .1 \u2212 \u03b8 BS j / 1\u2212m AEj l =j .\u03c8 BS l / m AEl .1 \u2212 \u03c8 BS l / 1\u2212m AEl is the mth mixture component likelihood function evaluated at m \u00c5 . The log-relative-probability of I L i = j versus I L i = l is", "latex": null, "type": "figure"}, "FIGREF2": {"text": "(a), (b) Population and (c), (d) individual aetiology estimates for a single sample with 500 cases and 500 controls with true \u03c0 D .0.67, 0.26, 0.07/ 0 and either (a), (c) 1% .N D 5/ or (b), (d) 10% GS data on cases (in (c) and (d), 8 (= 2 3 ) BS measurement patterns and predictions for individual children are shown with measurement patterns attached; the numbers at the vertices show empirical frequencies of GS measurements):\u02da, true population aetiology distribution \u03c0;", "latex": null, "type": "figure"}, "FIGREF3": {"text": "(a) Observed BS rates (with 95% confidence intervals) for cases and controls, (b) SS data and (c)\u03c0 (see the text for further explanation)", "latex": null, "type": "figure"}, "FIGREF4": {"text": "Summary of posterior distribution of pneumonia aetiology estimates ( , 95% credible regions within the bacterial or viral groups): (a) posterior distribution of viral aetiology; (b) posterior aetiology distribution for the top two causes given a bacterial infection; (c) posterior aetiology distribution for the top two causes given a viral infection", "latex": null, "type": "figure"}, "TABREF0": {"text": "Pathogen names and their abbreviations", "latex": null, "type": "table", "html": "<html><body><table><tr><td>Bacteria\n</td><td>\u00a0</td></tr><tr><td>HINF </td><td>Haemophilus influenzae\n</td></tr><tr><td>PNEU </td><td>Streptococcus pneumoniae\n</td></tr><tr><td>SASP </td><td>Salmonella species\n</td></tr><tr><td>SAUR </td><td>Staphylococcus aureus\n</td></tr><tr><td>Viruses\n</td><td>\u00a0</td></tr><tr><td>ADENO </td><td>Adenovirus\n</td></tr><tr><td>COR 43 </td><td>Coronavirus OC43\n</td></tr><tr><td>FLU C </td><td>Influenza virus type C\n</td></tr><tr><td>HMPVA B </td><td>Human metapneumovirus type A or B\n</td></tr><tr><td>PARA1 </td><td>Parainfluenza type 1 virus\n</td></tr><tr><td>RHINO </td><td>Rhinovirus\n</td></tr><tr><td>RSVA B </td><td>Respiratory syncytial virus type A or B\n</td></tr></table></body></html>"}}, "back_matter": [{"text": "We thank the members of the larger PERCH Study Group for discussions that helped to shape the statistical approach that is presented herein, and the study participants. ", "cite_spans": [], "ref_spans": [], "section": "Acknowledgements"}, {"text": "In this section, we provide analytic forms of full conditional distributions that are essential for the Gibbs sampling algorithm. We use a data augmentation scheme by introducing latent lung state I L i into the sampling chain and we have the following full conditional distributions.i is available, the full conditional is given bywhere n 1 and n 0 are the numbers of cases and controls respectively, and N j = \u03a3 i:ij is the number of positive results at position j for cases with I L i = j and all controls.ij is the number of positive results for cases with jth pathogen as their causes.When no SS data are available, this conditional distribution reduces to beta.d 1j , d 2j /, the prior. (e) [\u03c0|I L i , i : Y i = 1] \u223c Dirichlet.a 1 + U 1 , : : : , a J + U J /, where U j = \u03a3 i:Y i =1 1 {I L i =j} .", "cite_spans": [], "ref_spans": [], "section": "Appendix A: Full conditional distributions in Gibbs sampler"}]}