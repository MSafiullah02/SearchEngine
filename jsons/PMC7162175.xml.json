{
    "paper_id": "PMC7162175",
    "metadata": {
        "title": "The Supramap project: linking pathogen genomes with geography to fight emergent infectious diseases",
        "authors": [
            {
                "first": "Daniel",
                "middle": [
                    "A."
                ],
                "last": "Janies",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Travis",
                "middle": [],
                "last": "Treseder",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Boyan",
                "middle": [],
                "last": "Alexandrov",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Farhat",
                "middle": [],
                "last": "Habib",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Jennifer",
                "middle": [
                    "J."
                ],
                "last": "Chen",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Renato",
                "middle": [],
                "last": "Ferreira",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "\u00dcmit",
                "middle": [],
                "last": "\u00c7ataly\u00fcrek",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Andr\u00e9s",
                "middle": [],
                "last": "Var\u00f3n",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Ward",
                "middle": [
                    "C."
                ],
                "last": "Wheeler",
                "suffix": "",
                "email": null,
                "affiliation": {}
            }
        ]
    },
    "body_text": [
        {
            "text": "Supramap is superficially similar to other efforts for projecting phylogenetic trees in GIS, such as MigraPhyla (HoDac et al., 2007) and Geophylobuilder (Kidd and Liu, 2008). There are also papers that use GIS to study the spread of pathogens but do not provide accompanying applications (Lemey et al., 2009). Some have released applications that project trees but have not published research case studies (e.g., Piel, 2007; Maddison and Maddison, 2009). GenGIS combines data visualizations, including trees and gene frequency data, with R scripts (Parks et al., 2009).",
            "cite_spans": [],
            "section": "Other tree projection efforts",
            "ref_spans": []
        },
        {
            "text": "In contrast to these efforts, the Supramap web application provides a complete workflow including parallel direct optimization of raw data into trees and implied alignments, tree projection into a Keyhole Markup Language (KML) file, and character diagnosis with presentation of mutation or other character change data implied by the phylogeny for each node of the tree. The diagnosis functionality is similar to a user performing character mapping on a traditional cladogram using the \u201cTrace Character History\u201d feature in Mesquite or \u201cMap Characters\u201d feature in TNT (Goloboff et al., 2008). In the case of Supramap, character changes are optimized on the projected tree. Thus, Supramap enables character evolution studies in biogeographic and temporal contexts. Below, we include a case study for character evolution in hypothesis driven research on the spread of key mutations in lineages of infectious diseases (Janies et al., 2007, 2008; Hill et al., 2009).",
            "cite_spans": [],
            "section": "Other tree projection efforts",
            "ref_spans": []
        },
        {
            "text": "Supramap is distinct from all the efforts described above in that it is both a client and a web service that is instantiated on a computing cluster freely available for use by the scientific community. In this respect, Supramap resembles the RAxML web\u2010server (Stamatakis et al., 2008; http://phylobench.vital-it.ch/raxml-bb/) or SWAMI (Rifaieh et al., 2007; http://www.phylo.org/portal2) in that a phylogenetic search application is spawned via a web interface to a computing cluster. RAxML requires the user to upload a precomputed alignment. In contrast, Supramap does not require an alignment (although it can use pre\u2010aligned data if the user prefers). A typical Supramap run performs integrated alignment and phylogenetic analysis as implemented in POY (Var\u00f3n et al., 2009). SWAMI supports POY but not the geographical projection capabilities of Supramap.",
            "cite_spans": [],
            "section": "A client, web service and computing power",
            "ref_spans": []
        },
        {
            "text": "Many services for syndromic surveillance of infectious diseases are available. These services scrape, filter, and map news or search data from the Internet on the occurrence of disease symptoms (Brownstein et al., 2008; Ginsberg et al., 2008). Supramap complements these services. Syndromic surveillance is patient\u2010centric whereas Supramap is pathogen\u2010centric. As Supramap focuses on genomic and geographic data, it allows the user to understand the key mutations and pathogen phenotypes as diseases spread over time, geography, and among hosts, including animals and humans.",
            "cite_spans": [],
            "section": "Pathogen\u2010centric disease surveillance",
            "ref_spans": []
        },
        {
            "text": "Like syndromic data, pathogen genomic data are a key source of medical intelligence that aid public health officials in controlling an outbreak of disease. For example, in the early days of the SARS epidemic, the cases were reported as atypical pneumonia, which often indicates a bacterial agent. Only through serological, microscopic and nucleotide sequence characterization was it understood that SARS was caused by a previously undiscovered coronavirus (CoV) (Ksiazek et al., 2003). Furthermore, it was not until the full genome of SARS\u2010CoV was sequenced, shared and compared via phylogenetics to related coronaviruses from a variety of animals that the zoonotic origins of SARS\u2010CoV could be put in the evolutionary and geographic context necessary for disease surveillance (Guan et al., 2003; Marra et al., 2003; Rota et al., 2003; Janies et al., 2008).",
            "cite_spans": [],
            "section": "Pathogen\u2010centric disease surveillance",
            "ref_spans": []
        },
        {
            "text": "In this report, we focus on the implementation and use of Supramap to track the evolution of phenotypes and mutations in sequence data derived from H5N1 influenza over time, hosts, and geography. Supramap has been used to visualize the spread of pathogens carrying key mutations that confer the ability of the pathogen to replicate in novel host species or to resist drugs (Janies et al., 2007, 2008; Hill et al., 2009). Studies in natural history and anthropology are also underway with Supramap.",
            "cite_spans": [],
            "section": "Pathogen\u2010centric disease surveillance",
            "ref_spans": []
        },
        {
            "text": "The Supramap server consists of two main elements. The first is a web service created via a JBOSS application server (http://www.jboss.org). The web service executes POY processes and generates KML files on the cluster. The second is a client written in Ruby using the Ruby on Rails\u00ae framework (http://www.rubyonrails.org). A Phusion Passenger\u2122 (http://www.modrails.com) server supports the client. Both elements use MySQL\u00ae (http://www.mysql.com) as the data store.",
            "cite_spans": [],
            "section": "Architecture ::: Methods",
            "ref_spans": []
        },
        {
            "text": "We have created a web interface where users can upload data files, name projects, and organize sets of data files into jobs to be executed. The user may study one or many loci and set up various types of analyses by choosing from uploaded files. We post a detailed manual: http://supramap.osu.edu/sm/supramap/tutorials. Once the user starts a job, the Supramap system will perform a phylogenetic analysis using dynamic homology (integrated alignment and tree search; Wheeler et al., 2006), generate a tree and KML file, and present statistics on the run. Statistics include the optimal tree cost found during the search and the number of times this tree cost was hit. If the user prefers, multiple sequence alignment and or tree search can be pre\u2010computed locally with edit costs, search heuristics and optimality criterion specified by the user. Then the user can upload aligned data and or a tree and use the Supramap web service for character diagnosis and tree projection resulting in a KML file.",
            "cite_spans": [],
            "section": "User interface ::: Methods",
            "ref_spans": []
        },
        {
            "text": "The algorithm that generates the KML file computes three data points: altitude, longitude, and latitude for each node of the tree. The altitude of each node is calculated by multiplying its tree height by a constant (Janies et al., 2007). The root node is assigned the highest altitude, internal nodes are lower, and terminal nodes have an altitude of zero.",
            "cite_spans": [],
            "section": "Geographical projection of the tree ::: Phylogenetic analyses",
            "ref_spans": []
        },
        {
            "text": "Leaf nodes of the tree represent observed taxa (e.g., viral isolates), whose GIS coordinates are found in the CSV file. The algorithm must compute the latitude and longitude of the internal nodes, which represent common ancestors. In a post order traversal of the tree, each node\u2019s latitude and longitude equals the calculated geographical midpoint of its two children. Once the geographical data have been computed for the tree, the algorithm generates the KML tags, includes apomorphy data in the pop\u2010up windows of the KML, and writes a KML file that is viewable with a GIS (Fig. 1).",
            "cite_spans": [],
            "section": "Geographical projection of the tree ::: Phylogenetic analyses",
            "ref_spans": [
                {
                    "start": 577,
                    "end": 583,
                    "mention": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ]
        },
        {
            "text": "A heuristic, minimum length tree found by the POY search is presented to the user as a text file with taxa in nested parentheses. This file can be viewed with a flat tree viewer such as TreeView (Page, 2001). The results of the tree projected onto the earth are presented to the user as a KML file suitable for viewing with a variety of software including Google Earth\u2122 (http://earth.google.com), ArcGIS Explorer\u2122 (http://www.esri.com/software/arcgis/explorer/index.html), NASA Worldwind (http://worldwind.arc.nasa.gov), and Google Maps\u2122 (http://maps.google.com).",
            "cite_spans": [],
            "section": "Output ::: Phylogenetic analyses",
            "ref_spans": []
        },
        {
            "text": "We used 239 nucleotide sequences for the polymerase basic 2 genomic segment of recent isolates of H5N1 influenza. These isolates represent a sample of the diversity of lineages spreading westward from China across Russia, the Middle East, Africa, and Europe. We chose the strain A/goose/Yunnan/3315/2005 as an outgroup. This strain was discovered to be the most closely related isolate to the root of the westward clade in our analyses of datasets that contained much more background data, including many isolates from China, Japan, Korea and South East Asia ranging back to 1996.",
            "cite_spans": [],
            "section": "Data for the case study ::: Phylogenetic analyses",
            "ref_spans": []
        },
        {
            "text": "For character evolution studies we chose two characters. One character was chosen to illustrate host data (i.e. avian, feline, human, mustelid, or an environmental isolate) and another character was chosen for amino acid genotypes (i.e., glutamic acid or lysine) for position 627 of polymerase basic protein 2 (PB2). When the PB2 protein contains lysine at position 627, the influenza virus is able replicate in the lower temperature (relative to avian) of the mammalian respiratory tract (Tarendeau et al., 2008).",
            "cite_spans": [],
            "section": "Data for the case study ::: Phylogenetic analyses",
            "ref_spans": []
        },
        {
            "text": "The phylogenetic analysis found a single best tree of length 1528 steps. The tree in the visualization suggests that H5N1 lineages carrying lysine\u2010627 in PB2 are spreading westward (Fig. 1). For raw data, results, and an interactive KML file, see: http://supramap.osu.edu/sm/supramap/publications.",
            "cite_spans": [],
            "section": "Results",
            "ref_spans": [
                {
                    "start": 182,
                    "end": 188,
                    "mention": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ]
        },
        {
            "text": "We used the concentrated changes test (CCT; Maddison, 1990) to provide an independent check on two hypotheses generated by the visualization and tree. The CCT is a measure of covariation between two binary characters on a phylogenetic tree. The CCT was calculated using MacClade (Maddison and Maddison, 2003). As the tree and the number of changes are large, we used a simulation of 500 000 iterations. We examined covariation in shifts from avian to mammalian hosts and mutations from glutamic acid (E) to lysine (K) at position 627 of the PB2 protein (E627K). We also examined covariation of the spread of the virus west of 100\u00b0 east longitude with E627K mutations.",
            "cite_spans": [],
            "section": "Results",
            "ref_spans": []
        },
        {
            "text": "In the tree resulting from analysis of 239 PB2 sequences, there are eight shifts from avian to mammal hosts for H5N1 influenza and eight E627K mutations. Two of the eight avian to mammal host shifts are coincident with E627K mutations. We found a correlation (CCT = 0.0059) between the shift from avian to mammalian hosts and the E627K mutation.",
            "cite_spans": [],
            "section": "Results",
            "ref_spans": []
        },
        {
            "text": "The westward movement of the virus is less well correlated with E627K (CCT = 0.0289). The virus is highly mobile eastward and westward. There are 16 east\u2010to\u2010west transitions and two of these transitions are coincident with E627K mutations. This leads to the higher CCT value.",
            "cite_spans": [],
            "section": "Results",
            "ref_spans": []
        },
        {
            "text": "As we conducted two tests, we adjusted for multiple testing using a Bonferroni correction resulting in a cutoff of 0.025 for statistical significance. Based on this cutoff, avian to mammal host shifts in H5N1 are significantly correlated with E627K mutations. Although close to the cutoff, the westward spread of the virus is not significantly correlated with E627K mutations.",
            "cite_spans": [],
            "section": "Results",
            "ref_spans": []
        },
        {
            "text": "The Supramap workflow initially depended on using Extensible Stylesheet Language (XSL) transformations (XSLT) to filter and convert results from POY to KML. This information includes the tree structure and character changes associated with each branch in nested elements.",
            "cite_spans": [],
            "section": "Performance ::: Discussion",
            "ref_spans": []
        },
        {
            "text": "However, XSLT processing is memory intensive. Trees with large numbers of isolates and character changes can exceed the memory available and prevent the process from completing XSLT.",
            "cite_spans": [],
            "section": "Performance ::: Discussion",
            "ref_spans": []
        },
        {
            "text": "To address the limitations of XSLT, we have implemented plug\u2010ins for POY. The plug\u2010in contains functions that perform the KML generation inside POY. Thus the user can complete the entire Supramap workflow using POY as a stand\u2010alone application. No XSLT steps are needed using plug\u2010ins. The data are kept in memory that is allocated to the POY process and used therein for calculating and generating the KML visualization.",
            "cite_spans": [],
            "section": "Performance ::: Discussion",
            "ref_spans": []
        },
        {
            "text": "The use of a workflow that is entirely contained within POY has the disadvantage over the web\u2010based application in that the user has to learn the command line syntax of POY and use their local computing resources. However, an important issue in research on emergent infectious diseases is data security. One solution to this problem is that users can run a binary of POY enabled via plug\u2010ins for KML generation on local computers without the use of a remote cluster and without transmission of their data outside of their organization. We include instructions for: the web and stand\u2010alone implementations of Supramap and POY, projection of precomputed trees, and colouring tree branches in KML at this web page: http://supramap.osu.edu/sm/supramap/tutorials.",
            "cite_spans": [],
            "section": "A stand\u2010alone application ::: Discussion",
            "ref_spans": []
        },
        {
            "text": "We hope that our tools will complement data sharing efforts such as NIH\u2019s GenBank (http://ncbi.nlm.nih.gov) and The Global Initiative on Sharing All Influenza Data (http://gisaid.org). In Supramap, we share powerful software tools and computing via an easy\u2010to\u2010use interface. Our overarching goal is to build communities of researchers and public health officials to leverage combined strengths and expertise to fight infectious diseases. Once produced and shared, KML encoded maps can be layered in a GIS. Layering pathogen phylogenies with other data such as host distributions, transit systems and environmental conditions will provide a common analytical framework in which a multidisciplinary team can work to understand the origin and spread of emergent diseases.",
            "cite_spans": [],
            "section": "Sharing of expertise, computational resources and results in kind with data ::: Discussion",
            "ref_spans": []
        }
    ],
    "ref_entries": {
        "FIGREF0": {
            "text": "Figure 1:  Screen capture of a phylogeny of avian influenza (H5N1) projected into Google Earth\u2122 by Supramap. This tree depicts the westward spread of H5N1. Red colour for tree branches indicate a genotype of lysine (K) at amino acid position 627 in the PB2 protein of the avian influenza virus (H5N1), which confers increase replication in mammals. White colour for tree branches indicate a genotype of glutamic acid (E), the wild type for H5N1. Colour changes along branches indicate a mutation. Mutations at each node can be viewed in pop\u2010up windows.",
            "type": "figure"
        }
    },
    "back_matter": [],
    "bib_entries": {
        "BIBREF0": {
            "title": "Surveillance sans fronti\u00e8res: internet\u2010based emerging infectious disease intelligence and the HealthMap project",
            "authors": [],
            "year": 2008,
            "venue": "PLoS Med.",
            "volume": "5",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF1": {
            "title": "Genomic analysis and geographic visualization of the spread of avian influenza (H5N1)",
            "authors": [],
            "year": 2007,
            "venue": "Syst. Biol.",
            "volume": "56",
            "issn": "",
            "pages": "321-329",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF2": {
            "title": "Evolution of genomes, host shifts and the geographic spread of SARS\u2010CoV and related coronaviruses",
            "authors": [],
            "year": 2008,
            "venue": "Cladistics",
            "volume": "24",
            "issn": "",
            "pages": "111-130",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF3": {
            "title": "GEOPHYLOBUILDER 1.0: an ARCGIS extension for creating \u2018geophylogenies\u2019",
            "authors": [],
            "year": 2008,
            "venue": "Mol Ecol Resour",
            "volume": "8",
            "issn": "",
            "pages": "88-91",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF4": {
            "title": "A novel coronavirus associated with Severe Acute Respiratory Syndrome",
            "authors": [],
            "year": 2003,
            "venue": "N. Eng. J. Med.",
            "volume": "348",
            "issn": "",
            "pages": "1953-1966",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF5": {
            "title": "Bayesian phylogeography finds its roots",
            "authors": [],
            "year": 2009,
            "venue": "PLoS Comput. Biol.",
            "volume": "5",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF6": {
            "title": "A method for testing the correlated evolution of two binary characters: are gains or losses concentrated on certain branches of a phylogenetic tree?",
            "authors": [],
            "year": 1990,
            "venue": "Evolution",
            "volume": "44",
            "issn": "",
            "pages": "539-557",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF7": {
            "title": "MacClade",
            "authors": [],
            "year": 2003,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF8": {
            "title": "Cartographer module for Mesquite",
            "authors": [],
            "year": 2009,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF9": {
            "title": "The genome sequence of the SARS\u2010associated coronavirus",
            "authors": [],
            "year": 2003,
            "venue": "Science",
            "volume": "300",
            "issn": "",
            "pages": "1399-1404",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF10": {
            "title": "TreeView",
            "authors": [],
            "year": 2001,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF11": {
            "title": "Phylogenies and the comparative method",
            "authors": [],
            "year": 1985,
            "venue": "Am. Nat.",
            "volume": "125",
            "issn": "",
            "pages": "1-15",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF12": {
            "title": "GenGIS: a geospatial information system for genomic data",
            "authors": [],
            "year": 2009,
            "venue": "Genome Res.",
            "volume": "19",
            "issn": "",
            "pages": "1896-1904",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF13": {
            "title": "Experimental Google Earth Phylogenetic Tree Server",
            "authors": [],
            "year": 2007,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF14": {
            "title": "",
            "authors": [],
            "year": 2007,
            "venue": "Data Integration in the Life Sciences",
            "volume": "",
            "issn": "",
            "pages": "48-58",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF15": {
            "title": "Characterization of a novel coronavirus associated with severe acute respiratory syndrome",
            "authors": [],
            "year": 2003,
            "venue": "Science",
            "volume": "300",
            "issn": "",
            "pages": "1394-1399",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF16": {
            "title": "A rapid bootstrap algorithm for the RAxML web servers",
            "authors": [],
            "year": 2008,
            "venue": "Syst. Biol.",
            "volume": "57",
            "issn": "",
            "pages": "758-771",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF17": {
            "title": "A single amino acid in the PB2 gene of influenza A virus is a determinant of host range",
            "authors": [],
            "year": 1993,
            "venue": "J. Virol.",
            "volume": "67",
            "issn": "",
            "pages": "1761-1764",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF18": {
            "title": "Host determinant residue lysine 627 lies on the surface of a discrete, folded domain of influenza virus polymerase PB2 subunit",
            "authors": [],
            "year": 2008,
            "venue": "PLoS Pathog.",
            "volume": "4",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF19": {
            "title": "POY version 4: phylogenetic analysis using dynamic homologies",
            "authors": [],
            "year": 2009,
            "venue": "Cladistics",
            "volume": "26",
            "issn": "",
            "pages": "72-85",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF20": {
            "title": "Implied alignment: a synapomorphy\u2010based multiple\u2010sequence alignment method and its use in cladogram search",
            "authors": [],
            "year": 2005,
            "venue": "Cladistics",
            "volume": "19",
            "issn": "",
            "pages": "261-268",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF21": {
            "title": "",
            "authors": [],
            "year": 2006,
            "venue": "Dynamic Homology and Phylogenetic Systematics: a Unified Approach Using POY",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF22": {
            "title": "Detecting influenza epidemics using search engine query data",
            "authors": [],
            "year": 2008,
            "venue": "Nature",
            "volume": "457",
            "issn": "",
            "pages": "1012-1014",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF23": {
            "title": "TNT, a free program for phylogenetic analysis",
            "authors": [],
            "year": 2008,
            "venue": "Cladistics",
            "volume": "24",
            "issn": "",
            "pages": "774-786",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF24": {
            "title": "In silico mapping of complex disease\u2010related traits in mice",
            "authors": [],
            "year": 2001,
            "venue": "Science",
            "volume": "292",
            "issn": "",
            "pages": "1915-1918",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF25": {
            "title": "Isolation and characterization of viruses related to the SARS coronavirus from animals in southern China",
            "authors": [],
            "year": 2003,
            "venue": "Science",
            "volume": "302",
            "issn": "",
            "pages": "276-278",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF26": {
            "title": "Evolution of drug resistance in multiple distinct lineages of H5N1 avian influenza",
            "authors": [],
            "year": 2009,
            "venue": "Infect. Genet. Evol.",
            "volume": "9",
            "issn": "",
            "pages": "169-178",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF27": {
            "title": "MigraPhyla: statistical analysis of migration events through a phylogeny. Version 1.0b",
            "authors": [],
            "year": 2007,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF28": {
            "title": "Tracking the geographic spread of avian influenza (H5N1) with multiple phylogenetic trees",
            "authors": [],
            "year": 2010,
            "venue": "Cladistics",
            "volume": "26",
            "issn": "",
            "pages": "1-13",
            "other_ids": {
                "DOI": []
            }
        }
    }
}