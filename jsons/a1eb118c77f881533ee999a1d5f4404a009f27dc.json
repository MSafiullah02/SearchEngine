{
    "paper_id": "a1eb118c77f881533ee999a1d5f4404a009f27dc",
    "metadata": {
        "title": "Attribute-Driven Capsule Network for Entity Relation Prediction",
        "authors": [
            {
                "first": "Jiayin",
                "middle": [],
                "last": "Chen",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Peking University",
                    "location": {
                        "settlement": "Hangzhou",
                        "country": "China"
                    }
                },
                "email": "jychen@aiit.org.cn"
            },
            {
                "first": "Xiaolong",
                "middle": [],
                "last": "Gong",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Peking University",
                    "location": {
                        "settlement": "Hangzhou",
                        "country": "China"
                    }
                },
                "email": "xlgong@aiit.org.cn"
            },
            {
                "first": "Xi",
                "middle": [],
                "last": "Chen",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Peking University",
                    "location": {
                        "settlement": "Hangzhou",
                        "country": "China"
                    }
                },
                "email": "xchen@aiit.org.cn"
            },
            {
                "first": "Zhiyi",
                "middle": [],
                "last": "Ma",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Peking University",
                    "location": {
                        "settlement": "Hangzhou",
                        "country": "China"
                    }
                },
                "email": "mazhiyi@aiit.org.cn"
            }
        ]
    },
    "abstract": [
        {
            "text": "Multi-attribute entity relation prediction is a novel data mining application about designing an intelligent system that supports inferencing across attributes information. However, most existing deep learning methods capture the inner structural information between different attributes are far more limited. In this paper, we propose an attributedriven approach for entity relation prediction task based on capsule networks that have been shown to demonstrate good performance on relation mining. We develop a self-attention routing method to encapsulate multiple attributes semantic representation into relational semantic capsules and using dynamic routing method to generate class capsules for predicting relations. Due to the lack of multi-attribute entity relation data is a major obstacle in this task, we construct a new real-world multi-attribute entity relation dataset in this work. Experimental results show significant superiority of our model, as compared with other baselines.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Learning to predict relationship between the entities plays a vital role in recommendation system, knowledge base population and question answering system, etc. In the big data era, we aim to know the relation between two homogeneous or heterogeneous entities through the latent knowledge behind the data. Take an example in business mining field, we attempt to predict what the relationship between the two companies is, which can help an enterprise to search his potential customers or providers. The relation prediction (RP) task is different from relation extraction (RE) task, the entity pairs in RP task does not appear in the same semantic sentence and sometimes they may consist of many common attributes. For instance, there exists many common multiple attributes information in a pair of companies such as company name, company address, company profile, business scope, etc. Hence, a demanding requirement for promoting RP is to develop a novel model that can support the entity relation for those multi-attribute data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "On RP task, most traditional methods are kernel-based method [1] [2] [3] [4] that they need to do complicated feature engineering. Moreover, those methods limit to capture latent semantic information and they cannot extract some new effective features from relation examples easily. In recent years, a variety of neural network models [5] [6] [7] [8] [9] [10] [11] [12] [13] [14] [15] have been widely applied to relation prediction and achieved remarkable success. Those models are mainly based on an architecture of distributed representation, which learns a scalar-output to represent entity relation. All these methods can be divided into three categories: the CNN-based method [10, 11] , the RNN-based method [12, 13] and the Transformer-based method [14, 15] . Although above methods can capture latent semantic information due to the deep learning way, some disadvantages remain: 1) they heavily rely on the quality of entity semantic representation. Using one scalar-output to represent entity relation is limited because attribute information is abundant and diverse. 2) Above methods fail to retain the precise spatial relationships between high-level parts. The structural relationships such as the homogeneous information in all attributes are valuable. To address above problems, the capsule network methods have been proposed [16] [17] [18] , which encapsulate multiple attributes into groups of neurons and replaces the scalar-output feature detectors with vector-output capsules to preserve additional information such as position and correlation [19] . Recently, capsule networks have achieved competitive results in classification tasks [18, 20, 21] , relation extraction [22] , especially for those structural information learning tasks [19, 23] . In RP task, the entity relationship is usually correlate with their multiple attributes information. The capsule networks could represent those multiple attributes of entities as individual capsules, preserving the structural, correlation, relationship information between multiple attributes to drive entity relation prediction.",
            "cite_spans": [
                {
                    "start": 61,
                    "end": 64,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 65,
                    "end": 68,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 69,
                    "end": 72,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 73,
                    "end": 76,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 335,
                    "end": 338,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 339,
                    "end": 342,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 343,
                    "end": 346,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 347,
                    "end": 350,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 351,
                    "end": 354,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 355,
                    "end": 359,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 360,
                    "end": 364,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 365,
                    "end": 369,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 370,
                    "end": 374,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 375,
                    "end": 379,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 380,
                    "end": 384,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 682,
                    "end": 686,
                    "text": "[10,",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 687,
                    "end": 690,
                    "text": "11]",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 714,
                    "end": 718,
                    "text": "[12,",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 719,
                    "end": 722,
                    "text": "13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 756,
                    "end": 760,
                    "text": "[14,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 761,
                    "end": 764,
                    "text": "15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1340,
                    "end": 1344,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 1345,
                    "end": 1349,
                    "text": "[17]",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 1350,
                    "end": 1354,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1563,
                    "end": 1567,
                    "text": "[19]",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 1655,
                    "end": 1659,
                    "text": "[18,",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1660,
                    "end": 1663,
                    "text": "20,",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 1664,
                    "end": 1667,
                    "text": "21]",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 1690,
                    "end": 1694,
                    "text": "[22]",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 1756,
                    "end": 1760,
                    "text": "[19,",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 1761,
                    "end": 1764,
                    "text": "23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In this paper, we propose a novel Attribute-driven Capsule Network (ACNet) for entity relation prediction task, which retains the structural and correlation information by using capsule networks. Our ACNet makes attribute capsules generate relation capsules by developing a self-attention routing method, which assign weights to different attribute capsules and improve relation prediction performance. Furthermore, we adopt k-max pooling method to improve robust representation and training efficiency. The major contributions of this paper are briefly summarized as follows.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "1. We propose a novel entity relation prediction approach based on capsule networks with self-attention routing method for those multi-attribute entity datasets. To the best of our knowledge, this is the first work that capsule network has been empirically apply on multi-attribute entity relation prediction. 2. We devise self-attention routing method between the attribute capsule layer and the relation capsule layer to improve the ability to capture relational semantic information. We conduct extensive experiments on a new real-world scenario CompanyRelationCollection (CRC) dataset that we constructed from web and one public BlurbGenreCollection (BGC) dataset. The results demonstrate our ACNet consistently outperforms the state-of-the-art baselines.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The rest of the paper is organized as follows: Sect. 2 describes the proposed our model; Sect. 3 evaluates the approach; Sect. 4 concludes the paper. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The whole framework of our method is shown in Fig. 1 . The purpose of the attribute embedding layer is to turn each common attribute into two separate embedding vectors. Let M E \u2208 R dw\u00d7|V | represent attribute information embedding matrix, where d w is the dimension of word vectors and |V | is the vocabulary size. Here, the embedding for information of j-th attribute can be separated into two vectors, using E kj \u2208 R 1\u00d7dw to represent attribute-key embedding vector and E vj = {x 1 , ... , x i , ... , x L } \u2208 R L\u00d7dw to represent attribute-value embedding vector, where x i is the i-th word in the attribute-value sentence and L is the sentence length. For a relation pair <e s , e o >, due to the relationship is strongly related to their common attributes information, we concatenate their attribute-value vectors for each attribute and they can be formulated as <e s , e o > = {E k1 :",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 46,
                    "end": 52,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Attribute Embedding Layer"
        },
        {
            "text": "This layer aims to use multiple convolution operations to extract n-gram features from the attribute-value embedding, which contain local semantic information about the attribute-key in a fixed window. In general, let x i:i+j refers to the concatenation of words x i , x i+1 , ... , x i+j . Multiple convolution operations involves a kernel group F \u2208 R dp\u00d7(dw\u00d7h) , which is applied to a window with h words to generate multiple h-gram features. d w \u00d7 h is the size of one convolutional kernel, h is the n-gram size and d p is the dimension of one attribute capsule. For a j-th attribute, a feature c i is produced from a window of words x i:i+h\u22121 by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Attribute Capsule Layer"
        },
        {
            "text": "where denotes the component-wise multiplication and b \u2208 R is a bias term. Thus, we can get a set of attribute capsules c \u2208 R dp\u00d7(L\u2212h+1) , which encapsulates n-gram features and extracts from the whole textual information of an attributevalue.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Attribute Capsule Layer"
        },
        {
            "text": "In fact, different kernel groups F can capture different categories of semantic meaning. We repeat the above procedure B times with different kernel groups, and get multiple channels of features to represent B categories of semantic meaning. The final output of this layer is arranged as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Attribute Capsule Layer"
        },
        {
            "text": "Self-Attention Routing Approach. For a common attribute, different ngram features are extracted from the attribute-value and they have different effects on the attribute-key. What's more, n-gram features contain different semantic information of entity relation. To alleviate aforementioned problem, and following self-attention mechanism [24, 25] , we propose a novel attention routing approach to compute the weight for the n-gram features of h-size window in E vj .",
            "cite_spans": [
                {
                    "start": 339,
                    "end": 343,
                    "text": "[24,",
                    "ref_id": "BIBREF23"
                },
                {
                    "start": 344,
                    "end": 347,
                    "text": "25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "First, we apply a fusing convolution operation to the embedding E vj with a kernel V s \u2208 R dw\u00d7h , and getting a set of feature vectors F s \u2208 R 1\u00d7(L\u2212h+1) . Second, we let E kj as our query input, a simple linear projection is used to construct the query Q = E kj W q , and the key K = F s W k . Then, we use the query Q to perform a scaled dot-product attention over K. The returned scalars can be put through a softmax function to produce a set of weights.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "where a i \u2208 R 1\u00d7(L\u2212h+1) , W q \u2208 R dw\u00d7u and W k \u2208 R (L\u2212h+1)\u00d7u represent weighted parameter matrices. The generate attention weight a i \u2208 [0, 1] contains information with respect to attribute-value. It controls how much information in current n-gram feature can be transmitted to the next layer. If a i is zero, the feature capsule would be totally blocked. Since produced B different channels of attribute capsules in above layer, we repeat the above computational process B times to get the whole attention routing weights A \u2208 R B\u00d71\u00d7(L\u2212h+1) , where A = [a 1 , a 2 , ... , a B ]. Finally, the attribute capsules are routed using these weights:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "where S \u2208 R B\u00d7dp\u00d7(L\u2212h+1) is the attribute-customized feature capsules, and denotes element-wise multiplication.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "Relation Capsule Generation. The above generated S is transformed from attribute capsules. Though encoding key-related information, there are still many unrelated capsules in S. Moreover, the large number of capsules in S may prevent the next layer from learning robust representations. If using a method similar to the max pooling, it will lead to lose some capsules about the structural or position information. Hence, we adopt a compromise method, k-max method in S to aggregate all attribute capsules in the third channel horizontally.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "where P \u2208 R B\u00d7k\u00d7dp , k is a constant that meaning to preserve top k capsules and max is a descending sort operation. Through Eq. 4, the network can filter out many unimportant capsules and obtain more relation capsules. From Eq. 1 to Eq. 4, a attribute can generate a set of capsules P and we loop N attributes in the same way to get a set of all attributes capsules u. Then we combine all attributes capsules together to produce relation capsules:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "where u \u2208 R (B\u00d7K\u00d7N )\u00d7dp . Then, we use the non-linear \"squash\" function [16] , using the length of each relation feature capsule u i to represent the probability that u i 's feature meaning is present in the current input. ",
            "cite_spans": [
                {
                    "start": 72,
                    "end": 76,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Relation Capsule Layer"
        },
        {
            "text": "In the capsule network, it uses class capsules to represent entity relation categories that means the number of relation capsules to be consistent with categories of entity relations. Let the number of relation categories be m, and there are m relation capsules learned in this layer. Each relation capsule is used for calculating the classification probability of each relation in entity prediction task. Hence each class capsule should have its own routing weights to adaptively aggregate relation capsules from the previous layer.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Class Capsules Layer"
        },
        {
            "text": "A capsule's prediction vector\u0169 j|i is generated by multiplying the output u i by a weight matrix W ij , where W ij \u2208 R dr\u00d7dp is a weight matrix, d r and d p are the dimensions of class capsule j and relation capsule i, u i is the vector representation of relation capsule i.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Class Capsules Layer"
        },
        {
            "text": "Then all prediction vectors generated by relation capsules are summed up with weights c ij to obtain the vector representation s j of class capsule j:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Class Capsules Layer"
        },
        {
            "text": "where c ij is a coupling coefficient that determine the contribution of each relation capsule's output to a class capsule are calculated using a dynamic routing heuristic [16] and defined by a \"routing softmax\":",
            "cite_spans": [
                {
                    "start": 171,
                    "end": 175,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Class Capsules Layer"
        },
        {
            "text": "where each b ij is the log prior probability that a relation capsule i should pass to a class capsule j. It is computed using a dynamic routing approach which is written in Algorithm 1 [16] . After that, we apply the non-linear \"squash\" function again to s j in Eq. 6 to get a final representation v j for class capsule j.",
            "cite_spans": [
                {
                    "start": 185,
                    "end": 189,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Class Capsules Layer"
        },
        {
            "text": "We use the length of a class vector to represent the probability of the relationship between entities. The capsule length of the active relation should be larger than others. We adopt a separate margin loss L j for each class capsule j in our task:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Margin Loss"
        },
        {
            "text": "where T j = 1 if the entity relation is present in class capsule j. We set m + =0.9, and m \u2212 = 0.1, \u03bb = 0.5 following in the research [16] . The total loss is simply the sum of the losses of all class capsules, L T = J j=1 L j .",
            "cite_spans": [
                {
                    "start": 134,
                    "end": 138,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                }
            ],
            "ref_spans": [],
            "section": "Margin Loss"
        },
        {
            "text": "We evaluate our model on two datasets 1 : CompanyRelationCollection (CRC) refers to company entities and BlurbGenreCollection (BGC) refers to book entities. The CRC is a Chinese company entity dataset that collected from the Internet. It consists of 58,013 company entities and there are 6 common attributes for each company entity, which includes company name, company address, company type, industry category, business scope and abstract. For a pair of company entities, there exists three major links content, which includes customer (C), provider (P), rival (R). Figure 2 gives an example of a relationship in CRC dataset, which demonstrates Entity O is a customer of Entity S. In our task, we retain only one relationship between two company entities. The BGC is an English public dataset [23] . It includes 91,892 book entities and each entity has 3 common attributes. We define three kinds of link according to book categories, which includes similar(S), presumably-similar(P), dissimilar(D). Table 1 lists some important quantitative characteristics of both datasets. ",
            "cite_spans": [
                {
                    "start": 794,
                    "end": 798,
                    "text": "[23]",
                    "ref_id": "BIBREF22"
                }
            ],
            "ref_spans": [
                {
                    "start": 567,
                    "end": 575,
                    "text": "Figure 2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 1000,
                    "end": 1007,
                    "text": "Table 1",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Datasets"
        },
        {
            "text": "Due to different text lengths of attribute-values, we fix text length of all attributevalues equals to 200. We train words embedding [26] in two dataset respectively. For all the experiments below, we set some parameters: d w = 200 for word embedding dimensionality, d p = 16 and d r = 24 for the dimension of a relation capsule and a class capsule, respectively. We tune some parameters of our models by grid searching on the validation dataset and grid search is utilized to select optimal learning rate \u03bb for Adam optimizer, we final set our \u03bb equal to 0.001 and filters number B equals to 64. The significant parameter k with 12 different values in our experiment and detailed discussion is presented in Sect. 3.5. Table 2 shows that hyper-parameters of the optimum model were selected by the evaluation results on the validation dataset. For other parameters, we use empirical settings because they make few influence on performance of our model. Three widespread used evaluation metrics are applied in the experiments, which includes the precision, recall and F1. We select F1 as our final main evaluation indicator.",
            "cite_spans": [
                {
                    "start": 133,
                    "end": 137,
                    "text": "[26]",
                    "ref_id": "BIBREF25"
                }
            ],
            "ref_spans": [
                {
                    "start": 719,
                    "end": 726,
                    "text": "Table 2",
                    "ref_id": "TABREF3"
                }
            ],
            "section": "Experimental Setting"
        },
        {
            "text": "To demonstrate the superiority of ACNet on relation prediction task between multi-attribute entities, we compare it with following six baselines: CNN proposes a convolutional deep neural network model for entity relation mining. PCNN puts forward a piecewise CNN model for distant supervision for relation mining. BLSTM proposes a bidirectional LSTM model for relation mining. ATT-BLSTM is a bidirectional LSTM model with attention mechanism. BERT is a pre-training bidirectional transformer model for relation mining. All above methods are based on the idea of classification and they are suitable for our relation prediction tasks. Basic-Caps is the original capsule network model without self-attention routing mechanism. Learning rate (\u03bb) 0.001 ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Baselines"
        },
        {
            "text": "We conduct experiments on the seven methods mentioned above. The comparison results of all models are shown in Table 3 . It is clear that our attribute-driven capsule network achieves the highest F1 scores, outperforming the other deep network-based methods, simultaneously in terms of recall. Our ACNnet has the smallest fluctuation between precision and recall on two datasets. Both situations demonstrate that our method is superior to other models on relation prediction between multi-attribute entities and RP task learning is more robust. The results of ACNet significantly outperform the Basic-Caps and others on the F1 indicator show that the self-attention routing approach is effective, which indicates that our approach could capture more relational semantic information and enhance the ability to represent class capsules by self-attention mechanism. Moreover, capsule networks have shown to identify and combine relational information with common attributes more accurately than the baselines.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 111,
                    "end": 118,
                    "text": "Table 3",
                    "ref_id": "TABREF4"
                }
            ],
            "section": "Main Results"
        },
        {
            "text": "BERT performs the best result on precision indicator among all baselines except our model, which demonstrates that the powerful pre-training model can achieve richful representation information. We also can observe that the selfattention routing approach beneficial to improve relation prediction between multi-attribute entity. Among CNN-based methods, PCNN achieves higher performance than CNN since it uses dynamic max pooling method and preserves some level of information about attributes. However, BLSTM is better than ATT-BLSTM beyond our expectations. ATT-BLSTM performs the worst among all others, as maybe its based attention model can not extract more effective attribute features.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Main Results"
        },
        {
            "text": "Stability of Training. In order to investigate the difference between our model and other models in training process, we conduct a statistical analysis on training loss where we set epochs equal to 10 and select the lowest training loss at each epoch for comparison. The results are shown in Fig. 3 . We can observe that the capsule networks convergence much faster than other methods, getting a stable training process and achieve less fluctuation. The reason behind this situation should be that capsule network discard pooling and retain all the feature information. To explore whether the capsule networks discard many features by the pooling way will have an impact on the prediction results, we use kmax pooling method in ACNnet to test it. We set 12 different k values and k = 0 means without using pooling. The results are shown in Fig. 4 . The test results show that k-max pooling method does not decrease the precision of entity relationship prediction. Conversely, using a smaller k can greatly reduce training time and increase training efficiency. This also illustrates that it is effective to retain the main attribute capsules and filter out many unimportant capsules.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 292,
                    "end": 298,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 840,
                    "end": 846,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Parameter Analysis"
        },
        {
            "text": "We present attribute-driven capsule network model for relation prediction between multi-attribute entities in this work. In order to capture relational information from common attributes and improve relation prediction, we develop self-attention routing method based on capsule networks to generate relational capsules and link with class capsules. The experimental results demonstrate the effectiveness of our model on RP task. Our future work includes: (i) to enrich the representation of the capsule network with more attributes, (ii) to consider entity relation prediction with different attributes, (iii) to apply some methods of the recommended domain on entity relation prediction.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Subsequence kernels for relation extraction",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "J"
                    ],
                    "last": "Mooney",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Bunescu",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "A shortest path dependency kernel for relation extraction",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "C"
                    ],
                    "last": "Bunescu",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "J"
                    ],
                    "last": "Mooney",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Stochastic relational models for discriminative link prediction",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Yu",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Chu",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Yu",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Tresp",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Xu",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Advances in Neural Information Processing Systems 19, Proceedings of the Twentieth Annual Conference on Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "4--7",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Kernel-based learning for biomedical relation extraction",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "J. Am. Soc. Inf. Sci. Technol",
            "volume": "59",
            "issn": "5",
            "pages": "756--769",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Relation extraction: perspective from convolutional neural networks",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "H"
                    ],
                    "last": "Nguyen",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Grishman",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Proceedings of the 1st Workshop on Vector Space Modeling for Natural Language Processing",
            "volume": "",
            "issn": "",
            "pages": "39--48",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Chinese relation extraction with multi-grained information and external linguistic knowledge",
            "authors": [
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Ding",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Zheng",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Shen",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics",
            "volume": "",
            "issn": "",
            "pages": "4377--4386",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Inter-sentence relation extraction with document-level graph convolutional neural network",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "K"
                    ],
                    "last": "Sahu",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Christopoulou",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Miwa",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Ananiadou",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1906.04684"
                ]
            }
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "End-to-end relation extraction using LSTMs on sequences and tree structures",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Miwa",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Bansal",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1601.00770"
                ]
            }
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Neural relation extraction with selective attention over instances",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Lin",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Shen",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Luan",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics",
            "volume": "1",
            "issn": "",
            "pages": "2124--2133",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Relation classification via convolutional deep neural network",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zeng",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Lai",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Zhou",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Distant supervision for relation extraction via piecewise convolutional neural networks",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zeng",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Liu",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Proceedings of the 2015 Conference on Empirical Methods in Natural Language Processing",
            "volume": "",
            "issn": "",
            "pages": "1753--1762",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Relation classification via recurrent neural network",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1508.01006"
                ]
            }
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Attention-based bidirectional long short-term memory networks for relation classification",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Zhou",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Proceedings of the 54th Annual Meeting of the Association for Computational Linguistics",
            "volume": "2",
            "issn": "",
            "pages": "207--212",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Deep bidirectional transformers for relation extraction without supervision",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Papanikolaou",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Roberts",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Pierleoni",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1911.00313"
                ]
            }
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Extracting multiple-relations in one-pass with pre-trained transformers",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Wang",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1902.01030"
                ]
            }
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "Dynamic routing between capsules",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Sabour",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Frosst",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "E"
                    ],
                    "last": "Hinton",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "3856--3866",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Matrix capsules with EM routing",
            "authors": [
                {
                    "first": "G",
                    "middle": [
                        "E"
                    ],
                    "last": "Hinton",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Sabour",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Frosst",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Investigating capsule networks with dynamic routing for text classification",
            "authors": [
                {
                    "first": "W",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Ye",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Lei",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Zhao",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1804.00538"
                ]
            }
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "Transfer capsule network for aspect level sentiment classification",
            "authors": [
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Qian",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics",
            "volume": "",
            "issn": "",
            "pages": "547--556",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Capsule network performance on complex data",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Xi",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Bing",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Jin",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1712.03480"
                ]
            }
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Text classification using capsules",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Jang",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [],
                    "last": "Park",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Choi",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Neurocomputing",
            "volume": "376",
            "issn": "",
            "pages": "214--221",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "Attention-based capsule networks with dynamic routing for relation extraction",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Deng",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Sun",
                    "suffix": ""
                },
                {
                    "first": "X",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "W",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1812.11321"
                ]
            }
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Hierarchical multi-label classification of text with capsule networks",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Aly",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Remus",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Biemann",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "Proceedings of the 57th Annual Meeting of the Association for Computational Linguistics: Student Research Workshop",
            "volume": "",
            "issn": "",
            "pages": "323--330",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "Attention is all you need",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vaswani",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "5998--6008",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Relational recurrent neural networks",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Santoro",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "7299--7310",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "Distributed representations of words and phrases and their compositionality",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Mikolov",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Sutskever",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "S"
                    ],
                    "last": "Corrado",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Dean",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "3111--3119",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "BERT: pre-training of deep bidirectional transformers for language understanding",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Devlin",
                    "suffix": ""
                },
                {
                    "first": "M.-W",
                    "middle": [],
                    "last": "Chang",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Lee",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Toutanova",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:1810.04805"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "The whole framework of ACNet method. It consists of four layers: 1) Attribute Embedding Layer converts each of common attributes into attribute-key and attribute-value vectors; 2) Attribute Capsule extracts feature from attributevalue vector and generates attribute capsules; 3) Relation Capsule uses self-attention routing method to aggregate attribute capsules and attribute-key vectors into a set of relation feature capsules; 4) Class Capsule produces classification capsules to represent each relation category.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "An example of one relationship in CRC dataset.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "The result of training loss from all models on two datasets.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Training results under different k values k-max Pooling.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "). Let D={e 1 , e 2 , ... e n } represent a set of entities, where |D| = n. The ordered pair <e s , e o > in D denotes two entities has a relevant link represented by r<e s , e o >, which is called relation. The learning task is to improve the target predictive function for relation f r <e s , e o >. attribute entity information, where |e s | = N means that there exists N attributes for each entity. And multi-attribute in the form of key-value (k : v) pairs to indicate their information. We utilize E k (attribute-key) and E v (attribute-value) to represent the key and value information of one attribute, respectively.",
            "latex": null,
            "type": "table"
        },
        "TABREF1": {
            "text": "Algorithm 1. Dynamic Routing Algorithm",
            "latex": null,
            "type": "table"
        },
        "TABREF2": {
            "text": "",
            "latex": null,
            "type": "table"
        },
        "TABREF3": {
            "text": "List of hyper-parameters",
            "latex": null,
            "type": "table"
        },
        "TABREF4": {
            "text": "The results of Comparison of different methods. Best scores are in bold.",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "Acknowledgments. This work is supported by the National Natural Science Foundation of China (No. 61672046). We thank all the anonymous reviewers for their insightful comments.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "acknowledgement"
        }
    ]
}