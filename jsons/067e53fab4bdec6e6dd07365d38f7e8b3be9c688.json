{
    "paper_id": "067e53fab4bdec6e6dd07365d38f7e8b3be9c688",
    "metadata": {
        "title": "Using generalized logistics regression to forecast population infected by Covid-19",
        "authors": [
            {
                "first": "Villalobos",
                "middle": [],
                "last": "Arias",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Mario",
                "middle": [],
                "last": "Alberto",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "In this work, a proposal to forecast the populations using generalized logistics regression curve fitting is presented. This type of curve is used to study population growth, in this case population of people infected with the Covid-19 virus; and it can also be used to approximate the survival curve used in actuarial and similar studies.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Population growth curves follow the well-known logistic behavior as shown in the figure 1. A model that is used to fit population curves is the Logistic one, which uses the following equation P (t) = 1 1 + e \u2212at+b (1.1)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "As you can see this model has several problems among them that the data is in [0, 1], and it is not flexible, the advantage is that this model is that an approximation of the optimal solution can be obtained by transforming the data and use linear regression. As seen in the graph 2 applying logistic regression and dividing all the data by the maximum value (66818) a curve that fits well is obtained, with a R 2 = 0.99955, which is very good , from the statistical point of view, but as seen in the figure there are many values that do not fit very well in the curves and it is not good for prediction, as we will see later. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The classic version for the study of epidemics is the SIR model in which the population is divided into three groups: the susceptible, the infected and the recovered (SIR), this in the simplest case and that the population is changing from susceptible infected and then recovered. The decrease in susceptibles is assumed to be proportional to the number of infected multiplied by the same number of susceptibles. The change in the recovered is equal to a certain percentage of the infected and finally the number of infected is going to change increasing by the susceptibles that are infected and then we take away the amount of the infected that is recovered. In this way the following equations are obtained:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model"
        },
        {
            "text": "The problem with the SIR model is that, as we see, the three parameters that are in the differential equations are needed, but with few data or with a few days it is very difficult to determine those parameters.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model"
        },
        {
            "text": "Therefore, the use of a slightly more complex model to the logistic regression and that is easier to determine the parameters than the SIR are proposed. A first version is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "In this one more parameter is added, to be determined, which is the population limit M , since with this modification it cannot be solved by transformation and linear regression. To solve this problem, nonlinear optimization techniques must be used, it also has the stiffness problem, that is, it does not fit sufficiently to certain parts of the curve, this model can NOT be used for prediction, but from the point of adjustment it does not it is as accurate as we will see later.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "To make the curve more flexible, an extra parameter \u03b1 is added as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "This parameter \u03b1 adds flexibility in fitting the curve, remember the graphs of y = x 1/3 ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "For this function the inflection point is obtained when P (t) = a 2 ce at+b (e at+b + 1) \u2212c\u22122 (ce at+b \u2212 1) = 0 so the inflection point is obtained for",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "This is the same model known as the Richards curve that is used to model population growth.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "Note that with some calculations and A = 0 equality with generalized logistics is given The case:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "which is a solution of the differential equation:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Generalized Logistic Regression"
        },
        {
            "text": "It owes its name to Benjamin Gompertz, the first to work in this type of function is a particular case of Richards, and has the following equation:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Gompertz Function"
        },
        {
            "text": "Furthermore, its second derivative is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Gompertz Function"
        },
        {
            "text": "which gives us the tipping point is reached in t = \u2212log(\u2212b))/c what in the case of epidemics tells us at what point the growth of daily cases will start to decrease. This is a simpler function since it only has 3 parameters instead of the LG, which has 4, and therefore it will have less local optimums.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Gompertz Function"
        },
        {
            "text": "Other more complex versions are:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Other versions"
        },
        {
            "text": "At the time of this writing, the South Korea covid-19 data has to be fitted with a curve like this.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Other versions"
        },
        {
            "text": "And the next one that was used to adjust the survival curves",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Other versions"
        },
        {
            "text": "The proposal of this work is, first, to use the generalized logistic curve or the Gompertz curve to make an adjustment of the data in which the curve is almost complete, for example data from China or South Korea, (March, 30) On the other hand, when all the data are available, there is a generalized logistic regression or Gompertz type curve that fits the data. So the hypothesis here is: If we have the lower part of the curve, that is, the first values of the curve, we can obtain the parameters of the curve, and obtain the complete curve. And with this it can be used to predict population growth, in this case, for example, the total number of cases by covid-19 in a country or region and when the inflection point is reached, that is, when that the number of daily cases begins to decrease. More specifically, if you have the data for about 20, 30 or 35 days, the question is: Can we determine the curve parameters that fit the complete data? If this will be achieved as we see, we would have a way of predicting the behavior of population growth with just having a few days, that is, we can determine the parameters of the curve with a few days, which is very difficult with the SIR model to determine the parameters of the differential equations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Hypothesis and proposal"
        },
        {
            "text": "For this work, the data provided by the \"European Centre for Disease Prevention and Control\" are being used, on the website to download the daily data, see [1] . The first thing that is presented is to verify, as is known, that the LG curve fits the data from covid-19 very well. In the case of China and South Korea, which are the ones that have the almost complete curve. Using a nonlinear optimization algorithm, the following results are obtained.",
            "cite_spans": [
                {
                    "start": 156,
                    "end": 159,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Curve Fitting"
        },
        {
            "text": "For the China data, the following parameters are obtained, and the graph in figure 3 . Con R 2 = 0.998878. As it is observed, a very good approximation is obtained, but as we know and it is seen in the figure ref ChinaOri, there is a jump in those data, so it was decided to correct that jump by putting the data of the day 02/13/2020 equal to the previous day and that of 02/14/2020 equal to the following day. With these corrections, the following data and the graph in figure 4 are obtained. In this case, a R 2 = 0.999885 is obtained, which is better than the data without correction. Note that the latest data shows that there is a linear trend, this can be improved as seen in the case of South Korea, as seen in the following subsection. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 76,
                    "end": 84,
                    "text": "figure 3",
                    "ref_id": "FIGREF4"
                },
                {
                    "start": 472,
                    "end": 480,
                    "text": "figure 4",
                    "ref_id": "FIGREF6"
                }
            ],
            "section": "China: original data"
        },
        {
            "text": "Applying the method to the data for South Korea gives the following data and the graph in figure 5 . And we get a R 2 = 0.99875, which is \"not very good\" as seen in figure 5 that the fit is \"not very good\". To improve this fit we propose to use the fit curve (3.4), that is: As seen, the fit with this type of generalized logistic curves is very good, obtaining R 2 greater than 0.9999.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 90,
                    "end": 98,
                    "text": "figure 5",
                    "ref_id": null
                },
                {
                    "start": 165,
                    "end": 173,
                    "text": "figure 5",
                    "ref_id": null
                }
            ],
            "section": "South Korea: original data"
        },
        {
            "text": "As we saw in the previous section, the logistic curves approximate very well, as has been shown in previous works (for example [2, 4] ). In this section we will try to measure the relative error percentage that is made when using the proposed curves, a test curve will be used and the data from China and South Korea",
            "cite_spans": [
                {
                    "start": 127,
                    "end": 130,
                    "text": "[2,",
                    "ref_id": null
                },
                {
                    "start": 131,
                    "end": 133,
                    "text": "4]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Prediction tests"
        },
        {
            "text": "To try to validate the hypothesis we are going to generate a curve with values M a b \u03b1 2000 \u22120.05 \u22122 10 and when using the optimization algorithm, the following upper bounds are obtained for the relative error When using the LG function, with the indicated number of days: As seen with the Gompertz function, it seems that better predictions can be guaranteed.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Test curve"
        },
        {
            "text": "Let us now look at the case of China, where the curve is almost complete.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "China Data"
        },
        {
            "text": "As we see when using the days from 16 to 45 (20 days), note that the first 16 days there were almost no changes in the data, so that data was not used, with these data with GLR we obtain:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "China Data"
        },
        {
            "text": "When using the days from 16 to 45 (20 days) a maximum error of 9.91 % is obtained (average of 3 runs, basically gives the same value) When using the days from 15 to 55 (30 days), the graph of figure 7 is obtained. When measuring the relative errors, a maximum value of 4.49 % (average of 3 runs) is obtained, in the prediction of the data until 03/31/2020.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Gompertz"
        },
        {
            "text": "Relative error percentage prediction China using Gompertz number of days max rel. error 20 9.91% 25 4.49% ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Gompertz"
        },
        {
            "text": "For South Korea we will use the data from day 28, since the first case (16/02/202), in this case remember that this data has a linear trend in last days, see figure 8 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 158,
                    "end": 166,
                    "text": "figure 8",
                    "ref_id": "FIGREF10"
                }
            ],
            "section": "South Korea Data"
        },
        {
            "text": "Relative error percentage in South Korea prediction using Gompertz number of days m\u00e1x error rel. 20 17.83% 25 6.49% ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "South Korea Data"
        },
        {
            "text": "As results of this work and as we have seen, this method will be used to give a prediction for the data of some countries starting with Costa Rica and then the data for Italy, Spain will be presented, and with the adjustments that we have, we already have that of China. and South Korea.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "In the case of China and South Korea, the results obtained in the subsections 5.1 and 5.2 can be used. It should be noted that the results of using these 2 functions have been approximating each other as the days go by and the maximum value between them is presented in the following table for the sample. Furthermore, it can be seen that as the days go by, the limit value of M decreases, possibly due to the measures taken by the country's Government. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "China and South Korea"
        },
        {
            "text": "There are the results of other countries that will be incorporated later",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Other countries"
        },
        {
            "text": "This work shows how population growth curves can be adjusted, using the LG and Gompertz functions, even in the most general case, such as the data for South Korea. section 5.2, where logistics is being carried out with a straight line. It is seen that these methods could be used to predict the growth of populations, in this case of people infected with Covid-19, and could help pandemic experts to take the necessary measures.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions and future work"
        },
        {
            "text": "More studies are needed to refine the results of this work. See the possibility of using similar curves to approximate other types of data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Future work"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Download today's data on the geographic distribution of COVID-19 cases worldwide\u00b4\u00b4",
            "authors": [],
            "year": null,
            "venue": "European Centre for Disease Prevention and Control",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Parameter Estimation of Nonlinear Growth Models in Forestry\u00b4\u00b4(PDF)",
            "authors": [
                {
                    "first": "Jim",
                    "middle": [
                        "J"
                    ],
                    "last": "Colbert",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "Silva Fennica",
            "volume": "33",
            "issn": "4",
            "pages": "2011--2020",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Optimization by simulated annealing\u00b4\u00b4",
            "authors": [
                {
                    "first": "S",
                    "middle": [],
                    "last": "Kirckpatrick",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Gelatt",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Vecchi",
                    "suffix": ""
                }
            ],
            "year": 1983,
            "venue": "Revista Science",
            "volume": "220",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "A Generalised Stock-Production Model\u00b4\u00b4",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "S"
                    ],
                    "last": "Pella",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "K"
                    ],
                    "last": "Tomlinson",
                    "suffix": ""
                }
            ],
            "year": 1969,
            "venue": "Bull. Inter-Am. Trop. Tuna Comm",
            "volume": "13",
            "issn": "",
            "pages": "421--496",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "A Flexible Growth Function for Empirical Use\u00b4\u00b4",
            "authors": [
                {
                    "first": "F",
                    "middle": [
                        "J"
                    ],
                    "last": "Richards",
                    "suffix": ""
                }
            ],
            "year": 1959,
            "venue": "Journal of Experimental Botany",
            "volume": "10",
            "issn": "2",
            "pages": "290--300",
            "other_ids": {
                "DOI": [
                    "10.1093/jxb/10.2.290"
                ]
            }
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "casos totales de contagiados en China * Universidad de Costa Rica, CIMPA y Escuela de Matem\u00e1tica, San Jos\u00e9, Costa Rica, mario.villalobos@ucr.ac.cr Instituto tecnologico de Costa Rica, Escuela de Matem\u00e1tica, Cartago, Costa Rica, marvillalobos@itcr.ac.cr",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "fit with logistic regression, total of infected in China",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "03/2020 66871 \u22120.15032863 4.21103499 4.436336",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "fiting with logistic regression, total of infected in China",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "Fit with generalized logistic regression, China corrected data",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Fit with GLR, South Korea dataThis curve improves the fit by obtaining the following data: the R 2 = 0.99988 which is better than the previous result and as seen in the graph infigure 6. fit with GLR, infected in South Korea with linear final trend.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "30 day forecast with Gompertz, China",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "25 days forecast with Gompertz, South Korea,",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "Forecast has a R 2 = 0.99853504, in the figure 10 you can see the resulting graph.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF12": {
            "text": "Forecast Costa has a R 2 = 0.99968, in the figure 12 you can see the resulting graph. Italyhas a R 2 = 0.999410067, in the figure 13 you can see the resulting graph.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF13": {
            "text": "Spainhas a R 2 = 0.999915, in the figure 14 you can see the resulting graph.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF14": {
            "text": "USA, Forecast with Gompertz.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "When executing the method the following relative error percentages are obtained",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "For Costa Rica, the following data is available from March 6, when the first case was detected. This curve fit has a R 2 = 0.99858343. In the graph in figure 9 you can see the prediction of cases, you can see the number of daily cases in the upper box and the adjustment of the real data in the lower box. Upper and lower bounds are included for the forecast, with an error of 7 % in the data, base on the results in the section 6. It is also seen that if the situations are as they are today there will be a limit of approximately 1000 cases, that is, from the mathematical point of view or curve fitting.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 151,
                    "end": 159,
                    "text": "figure 9",
                    "ref_id": null
                }
            ],
            "section": "annex"
        },
        {
            "text": "With the Gompertz curve, basically the same result is obtained as seen in the following: Furthermore, it can be seen that as the days go by, the limit value of M decreases, possibly due to the measures taken by the country's Government, in the figure 11 this is show.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Gompertz"
        }
    ]
}