{
    "paper_id": "deb5090e35e7f6eeeba9fccb0b1aefd80802dc39",
    "metadata": {
        "title": "FCP Filter: A Dynamic Clustering-Prediction Framework for Customer Behavior",
        "authors": [
            {
                "first": "Yuanzhe",
                "middle": [],
                "last": "Zhang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "The University of Sydney",
                    "location": {
                        "postCode": "2006",
                        "settlement": "Sydney",
                        "region": "NSW",
                        "country": "Australia"
                    }
                },
                "email": ""
            },
            {
                "first": "Ling",
                "middle": [],
                "last": "Luo",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "The University of Melbourne",
                    "location": {
                        "postCode": "3010",
                        "settlement": "Melbourne",
                        "region": "VIC",
                        "country": "Australia"
                    }
                },
                "email": "ling.luo@unimelb.edu.au"
            },
            {
                "first": "Yang",
                "middle": [],
                "last": "Wang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Technology Sydney",
                    "location": {
                        "postCode": "2007",
                        "settlement": "Sydney",
                        "region": "NSW",
                        "country": "Australia"
                    }
                },
                "email": "yang.wang@uts.edu.au"
            },
            {
                "first": "Zhiyong",
                "middle": [],
                "last": "Wang",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "The University of Sydney",
                    "location": {
                        "postCode": "2006",
                        "settlement": "Sydney",
                        "region": "NSW",
                        "country": "Australia"
                    }
                },
                "email": "zhiyong.wang@sydney.edu.au"
            }
        ]
    },
    "abstract": [
        {
            "text": "Customer purchase behavior prediction plays an important role in modern retailing, but the performance of this task is often limited by the randomness of individual historic transaction data. In the meanwhile, Fragmentation and Coagulation Process (FCP), a stochastic partition model, has recently been proposed for identifying dynamic customer groups and modeling their purchase behavior. However, FCP is not able to forecast the purchase behavior because such a data-driven method requires transaction observations to conduct clustering. To tackle this challenge, we propose FCP filter, a clustering-prediction framework based on FCP, which can forecast purchase behavior and filter random noise of individual transaction data. In our model, FCP clusters customers into groups by their temporal interests to filter random noise of individual transaction data. Then a predictor is built on grouped data. The predicted results are also fed to FCP to adjust the parameter for prior knowledge at the next time step. Our model is superior in capturing temporal dynamics and having flexible number of groups. We conduct experiments on both synthetic and real-world datasets, demonstrating that our model is able to discover the latent group of individual customers and provides accurate predictions for dynamic purchase behavior.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "In modern retailing, accurate prediction on the quantity that customers are going to purchase over items helps retailers to design effective marketing and warehousing strategies. However, the purchase behavior of individual customer is often random, limiting the accuracy of prediction. For example, Tom normally purchases 1 bottle of milk in his weekly visit to supermarket, but may buy 2 bottles occasionally. The observation of purchase intensity on transaction data is 1 or 2 but the real purchase intensity could be 1.2, so the observational noise is 0.2 and 0.8 for those two observations. In the above example, we can see that the purchase behavior of individual customer is not stable. To address this problem, we propose to cluster customers into groups by their historic transaction data because the purchase intensity of customer group is more stable and can represent the real purchase intensity of individuals. The random purchase noise of a customer can be filtered if his latent group could be accurately found.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "For clustering customers into groups, a dynamic and flexible clustering model, Fragmentation and Coagulation Process (FCP) [7] , has been recently proposed. FCP is a data-driven clustering model, with scalable number of customer groups, which does not need to be predefined, and can evolve with the data. This property enables FCP to capture the dynamic purchase behavior of customers accurately. However, FCP clustering can only be conducted when customer purchase data is given, which makes it hard to forecast the behavior of customer groups in the future. The significance of FCP in real-world applications is limited by the unavailability of future transaction data. For retailers, forecasting the behavior of customer groups is more important than just grouping customers in the past time. In order to reduce the purchase random noise of individual customers as well as to enable FCP to forecast group purchase intensity, we propose our FCP filter based on FCP to predict purchase intensity at group level instead of individual customer. For example, as shown in Fig. 1 , there are 3 groups at t = 10. We aim to predict the purchase intensity of these 3 groups at t = 11 and use the predicted value of each group as the purchase intensity of its members. The purchase intensity of individual customer changes rapidly and randomly, but the group-based purchase intensity is more stable and easier to discover regular patterns. We can take the group-level purchase intensity as the actual state of its members, while taking the individual customer purchase intensity as the observation of group purchase intensity. By predicting over actual states instead of observations, the individual randomness can be filtered.",
            "cite_spans": [
                {
                    "start": 123,
                    "end": 126,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [
                {
                    "start": 1069,
                    "end": 1075,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "Also, in our model, not only the clustering results influence prediction but also the prediction results influence FCP clustering. In traditional FCP clustering, there is a hyperparameter to represent the prior knowledge of group purchase intensity. Since our FCP filter can get the prediction of group purchase intensity, we propose to update this parameter in a time-evolving manner instead of using a predefined value. This parameter can be calculated from prediction results and influence FCP clustering at the next time step. Theoretically, an accurate prediction leads to better clustering fitness than fixing the parameter.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "In summary, we construct a dynamical clustering-prediction framework for modeling customer behavior. The main contributions of our model are (1) from prediction perspective, this framework helps to filter individual random purchase noise, (2) from clustering perspective, we enable FCP, a data-driven clustering model, to forecast group purchase intensity. The flexibility and dynamics of our FCP filter are appropriate for modeling customer behavior. It is flexible that the number of groups do not need to be predefined but estimated from customer transaction data. It is dynamic that the customer membership and group number can change with time. The hyperparameter controlling the priori knowledge of group purchase intensity is also updated dynamically so that the group purchase intensity can be estimated more accurately.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Clustering on customers is also known as customer segmentation, which aims to identify the customers whose purchase behavior is in the same manner [10] . In order to identify customer groups, the data-driven approaches based on clustering analysis are formal and reliable solution [3] . Decision tree [5] was used to segment customers using their demographic information. Clustering models like K-means [4] for static clustering and mixture model based on Non-homogenous Poisson process [6] for tracking dynamic group interests were also proposed. However, the preferences and interests of customers may also change over time. In order to track the customers' temporal shifting across groups, a novel Bayesian non-parametric customer segmentation model FC-CSM [7] based on a random partition process, Fragmentation and Coagulation Process (FCP) [1] , was proposed. It achieves high accuracy in fitting individual purchase frequency. Besides modeling the dynamics of segmentation, another advantage of FC-CSM is the flexibility. There is no need to set the number of customer groups manually, which can be learned automatically from data directly. However, the FC-CSM relies on the observed transaction data, so that the clustering can only be conducted for the past time. It is more meaningful to forecast the purchase behavior of groups instead of only analyzing past data. In this way, we propose to build prediction on FCP. Due to the efficiency of FCP to identify latent groups and model purchase behavior, the prediction could be more accurate than individual prediction.",
            "cite_spans": [
                {
                    "start": 147,
                    "end": 151,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 281,
                    "end": 284,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 301,
                    "end": 304,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 403,
                    "end": 406,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 487,
                    "end": 490,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 760,
                    "end": 763,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 845,
                    "end": 848,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Related Works"
        },
        {
            "text": "Our problem can be formally described as follows. Given the transaction data of a product, a matrix X U \u00d7T is generated to record the transaction quantity, for U customers during T time steps. Each entry x it in X U \u00d7T refers to the purchase quantity of customer i at time step t. The task is to forecast the purchase quantities of customers at the next time step T + 1, i.e.\u039b U \u00d71",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Methodology"
        },
        {
            "text": "T +1 in which\u03bb i(T +1) means the predicted purchase quantity of customer i at time T + 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Methodology"
        },
        {
            "text": "Overall, our model has three main components: (1) customer segmentation based on FCP; (2) tracking model to track group purchase intensity trajectory and (3) predictor to forecast group purchase intensity at next time step.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Methodology"
        },
        {
            "text": "We adopt Fragmentation and Coagulation Process (FCP) [1, 7] , a dynamic random partition model, to segment customers and capture dynamic interests of customers. The schematic diagram of FCP from time step t to t + 1 is illustrated in Fig. 2 . FCP contains two procedures: fragmentation and coagulation. Given the initial customer partition \u03c0 t , at the fragmentation step, each customer group can remain the same or be split into several subgroups, forming the intermediate partition \u03c0 t . Then, at the following coagulation step, a group can remain the same or be merged with other groups, forming the new partition \u03c0 t+1 . In this way, FCP can capture the evolution of customer segmentation from t to t + 1. Theoretically, FCP is flexible to model any change of segmentation, which means that the new segmentation can be totally different from the previous one.",
            "cite_spans": [
                {
                    "start": 53,
                    "end": 56,
                    "text": "[1,",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 57,
                    "end": 59,
                    "text": "7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [
                {
                    "start": 234,
                    "end": 240,
                    "text": "Fig. 2",
                    "ref_id": null
                }
            ],
            "section": "Customer Segmentation"
        },
        {
            "text": "Priori Probability of Customer Segmentation. FCP defines the priori transition probability from partition \u03c0 t to \u03c0 t+1 . Formally, at t = 1, we adopt a random partition process Chinese Restaurant Process (CRP) [8] to model the initial partition of customers, and the probability of customer i in group g is:",
            "cite_spans": [
                {
                    "start": 210,
                    "end": 213,
                    "text": "[8]",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Fig. 2. Illustration of customer segmentation using FCP"
        },
        {
            "text": "where the hyperparameter \u03c1 is to control the probability that the customer starts a new group, and M g denotes the set of customer members in group g. \u03c0 \u2212i t is the partition of customers except for customer i at t, which assumes customer i is the last one who needs to allocate. In CRP model, the larger groups of a partition tends to attract more members and becomes larger.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fig. 2. Illustration of customer segmentation using FCP"
        },
        {
            "text": "Given partition and allocation at previous time step, for customer i, the transition probability from group g in the current partition to group g in fragmentation step is defined as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fig. 2. Illustration of customer segmentation using FCP"
        },
        {
            "text": "which refers to the groups splitting from M g . Equation (2) shows that a customer is more likely to join large groups splitting from M g . The hyperparameter \u03b4 controls the probability that customer i starts a new group not existing in the previous group \u03c0 t (i), which is also the temporal dependency of partitions between consecutive time steps.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fig. 2. Illustration of customer segmentation using FCP"
        },
        {
            "text": "Similarly, in the coagulation step, the transition probability of customer i joining group l from the intermediate group g is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fig. 2. Illustration of customer segmentation using FCP"
        },
        {
            "text": "where C t (M l ) = B|B \u2208 \u03c0 \u2212i t+1 , B \u2286 M l , B = \u03c6 denotes the set of subgroups merged into M l . The priori knowledge is that a customer is more likely to join the group that merged by more subgroups.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Fig. 2. Illustration of customer segmentation using FCP"
        },
        {
            "text": "The individual purchase quantity is modeled by Poisson distribution. Given the purchase quantity of customer i at time step t, x it , the likelihood of customer i belonging to group g at t is represented as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood of Observations."
        },
        {
            "text": "where the purchase intensity for customer group g is \u03bb g .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood of Observations."
        },
        {
            "text": "The purchase intensity has Gamma distribution as its prior, due to the conjugacy of Poisson and Gamma distributions. Therefore, we have the Maximum A Posteriori (MAP) of \u03bb g as follows:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood of Observations."
        },
        {
            "text": "where the purchase intensity of a group can be interpreted as the average purchase quantities of its members, and impacted by the hyperparameters of \u03b1 t (i.e. shape parameter) and \u03b2 (i.e. scale parameter) of the Gamma prior.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Likelihood of Observations."
        },
        {
            "text": "For each customer i, we need to determine the purchase intensity trajectory {\u03bb it } T 1 in order to predict for the future. An intuitive idea is to use the purchase intensity of the group that customer i belongs to along the time as the trajectory of purchase intensity, i.e. \u03bb it = \u03bb \u03c0t(i) for any t. However, the customer interests are evolving with time that the groups from the past may not fit the customers' current interests, and those \u03bb \u03c0T \u2212n(i) may demonstrate misleading trends for prediction.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "Therefore, we propose to predict their purchase intensity\u03bb i(T +1) only considering the current group membership, \u03c0 T (i) and backtrack the intensities of this group in the past time steps, instead of using the actual groups the customers belonged to. The difficulty for tracking the purchase intensity of group \u03c0 t (i) is that the group members could be totally different in consecutive time steps i.e. M \u03c0t(i) = M \u03c0t\u22121(i) . To address this problem, we build a backward tracking model to get the series of purchase intensities for the current group M \u03c0T (i) in partition \u03c0 T .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "Assume the group we are going to track is denoted as g tracking and the members of g tracking as M g tracking . The group g tracking is initialized as \u03c0 T (i) for current time step t = T . If there exists g \u2208 \u03c0 t\u22121 satisfying tracking rules (Eq. (6)), we update the group g as the new group to be tracked.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "In the tracking rules (Eq. (6)), we require that the majority of group g has shifted to group g tracking and the majority of group g tracking come from group g. The hyperparameter \u03b7 1 and \u03b7 2 are generally set as >0.5, so there could only be at most one or no tracked group. If there is no group g \u2208 \u03c0 t\u22121 satisfying the tracking rules, g tracking remains the same:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "As to the individual purchase intensity, it is defined as follows based on whether there is a group g found:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "If there is no tracked group g found, we use the average purchase intensity at t \u2212 1 of all members of group g tracking to represent tracked group intensity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "By computing backwards from t = T to t = 1, we can finally get the trajectory of group purchase intensity {\u03bb it } T 1 for customer i.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Tracking Purchase Intensity"
        },
        {
            "text": "Finally, the prediction model can be applied on the tracked purchase intensity",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Predicting Purchase Intensity"
        },
        {
            "text": "In traditional FCP, the priori distribution of group purchase intensity is modeled by Gamma distribution with static predefined hyperparameter \u03b1 t and \u03b2 in Eq. (5). Since our FCP filter can get the prediction of group purchase intensity, we propose to update this prior hyperparameter with the prediction results so that the priori knowledge of group purchase intensity could be more accurate. For Gamma distribution, we estimate the parameter \u03b1 T +1 by Maximum Likelihood Estimation (MLE), taking the predicted group purchase intensity\u03bb g at time step T + 1 as observations, and we have:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Predicting Purchase Intensity"
        },
        {
            "text": "where |\u03c0 T | is the total number of groups in the partition. Our framework does not restrict the prediction models to use, and we have tested the performance of using the framework with various models including linear regressions and Long Short Term Memory (LSTM) in our experiments.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Predicting Purchase Intensity"
        },
        {
            "text": "The generative graphical model of our FCP filter is shown in Fig. 3 . The initial partition \u03c0 1 is sampled based on CRP rules and the partitions in following time steps obey FCP rules as described in Sect. 3.1. Given customer i belonging to group \u03c0 t (i) at time t, the individual purchase intensity x it is drawn from Poisson distribution with parameter \u03bb \u03c0t(i) , which is the purchase intensity of the group he belongs to. The group purchase intensity \u03bb \u03c0t(i) at time t is drawn from Gamma distribution with hyperparameters \u03b1 t (i.e. shape parameter) and \u03b2 (i.e. scale parameter). It is worth noting that \u03b1 t is dynamic, which means that different \u03b1 t at different time step t, that is different from original FCP. The parameter \u03b1 t is computed by using MLE of Gamma distribution with the predicted group purchase intensity\u03bb t and the scale parameter \u03b2 as shown in Sect. 3.3. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 61,
                    "end": 67,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "Graphical Model of the Framework"
        },
        {
            "text": "The customer partition and allocation are inferred by sampling using the posterior transition probabilities, computed by Eqs. (11) and (12) based on the priori transition probabilities and the observation likelihood terms. For the customer segmentation component, we use Gibbs sampler to infer the group membership of each customer over time \u03c0 t (i). In more detail, since the FCP is exchangeable and projective [9] , we assume that customer i is the last customer to be sampled, which means that we can allocate customer i given the allocation of all the other customers. According to Bayesian theorem, the sampling posterior transition probabilities for split and merge steps are defined respectively as:",
            "cite_spans": [
                {
                    "start": 412,
                    "end": 415,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [],
            "section": "Inference"
        },
        {
            "text": "where the priori terms in the equations above can be calculated based on Eqs. (2) and (3) by forward and backward algorithm as used in Hidden Markov Model [2] , with the likelihood terms given in Eq. (4).",
            "cite_spans": [
                {
                    "start": 78,
                    "end": 81,
                    "text": "(2)",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 155,
                    "end": 158,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "Inference"
        },
        {
            "text": "In summary, the dynamic customer segmentation is firstly modeled by FCP. Then we build tracking model to get intensity trajectory of each latent group. After that, predictor can be used to predict the purchase intensity of tracked groups. Finally, the predicted results also influence FCP clustering at the next time step by updating \u03b1 t .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Inference"
        },
        {
            "text": "We conducted experiments on synthetic and real-world datasets to illustrate that our model can (1) identify dynamic customer groups based on purchase behavior, (2) achieve more accurate prediction results by filtering individual random noise. The hyperparameters are empirically set using validation dataset as follows: \u03c1 = 0.8, \u03b4 = 0.4, \u03b7 1 = \u03b7 2 = 0.65, \u03b1 1 = 2 and \u03b2 = 0.5. The evaluation metrics in our study is the Mean Absolute Error (MAE). The MAE measures the average error between predicted purchase intensity and the ground truth.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimental Results"
        },
        {
            "text": "We generate a synthetic dataset to demonstrate our model's capability to identify the latent group and customer shifting over groups. There are 40 products in the synthetic dataset. For each product, we generate purchase quantity X 100 \u00d7 10 of 100 customers from 3 latent groups with 10 time steps.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Synthetic Dataset"
        },
        {
            "text": "Specifically, we firstly generate the group purchase intensity of those 3 groups at the first 5 time steps randomly \u039b 3 \u00d7 5 . At each time step, we sort the grouplevel purchase intensities from large to small values, so that those 3 groups can show relevant purchase patterns continuously. To fill in the intensity matrix \u039b 3 \u00d7 10 of 10 time steps, \u03bb gt from t = 6 to t = 10 is generated by linear regression of 3 orders: \u03bb gt = 3 n=1 a n * \u03bb g(t\u2212n) + b. Then all customers are allocated into those 3 groups randomly at t = 1. We assume that a customer changes group membership over time with probability of 0.1, which means that the customers have 10% of chance shifting into another group. Finally, we generate customer purchase quantities using Poisson distribution with parameter \u03bb = \u03bb \u03c0t(i) based on their allocation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Synthetic Dataset"
        },
        {
            "text": "We test the predicting performance using FCP filter model and using individual records. As the purchase intensity of each group in our synthetic data evolves according to the rule of linear regression of 3 orders, the same regression predictor is used for both cases. Accurate prediction results could demonstrate the capability of our model to identify latent groups for customers. The results are shown in Fig. 4 comparing these two models. We can see that our FCP filter achieves lower MAE on almost all products. The average MAE over 40 products of individual prediction and our FCP filter are 5.58 and 3.34, respectively. This means that FCP filter successfully tracked the evolving purchase intensity of latent groups in this dynamic dataset and predicted accurately.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 408,
                    "end": 414,
                    "text": "Fig. 4",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Synthetic Dataset"
        },
        {
            "text": "To illustrate the flexibility of FCP filter, we also compared the average MAE using prediction models built on static K-means clustering with different number Our model outperformed static K-means clustering with K = 3 or 5, even when the ground truth for the number of clusters is 3. It shows that the importance of dynamics and flexibility of FCP filter in capturing the evolution of the purchase intensities. Moreover, there is no need to pre-define the number of clusters in our model.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Synthetic Dataset"
        },
        {
            "text": "In this section, we use a real-world supermarket dataset 1 to illustrate our model's capability of filtering random purchase noise of individuals to get accurate prediction and usage of various predictors. The dataset contains 2,595,732 transaction records of 2,500 frequent customers on 2,383 products in 711 days (about two years). The transaction data is sparse in the first several months, so that we use the transaction data from 141 days to 420 days (40 weeks) for experiments. We divide 40 weeks into 10 time steps with 4 weeks in each time step. We select 24 popular products, which had the largest number of records and common in our daily life for experiments such as milk, cereal, eggs and so on. For each product, we discard customers who never bought that product and who ranked at the top 5 % based on purchase quantities as outliers. We randomly sample 100 customers for computational convenience and the purchase frequency is defined as the quantity purchased by a customer at one time step (4 weeks).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Real-World Dataset"
        },
        {
            "text": "Several predictors are applied in our experiments to show FCP filter can generally achieve better prediction accuracy. They are LSTM network, 1-order and 3-order linear regressions, and a last-step predictor which takes the value at last time step as predicted value \u03bb i(T +1) = \u03bb \u03c0T (i) . The average MAE is shown in Table 1 . Similar to the results on the synthetic data, our FCP filter achieves the best prediction accuracy with all the predictors. It is mainly because our dynamic model is suitable for modeling customers' dynamic interests and identifies the latent groups covered by random individual purchase behavior. We notice that the 3-order regression is not accurate and stable, and the possible reason could be that it is sensitive to the input purchase intensity series data. Specially, Fig. 5 shows the prediction results of our model and individual model with the simple last-step predictor on all products. Our FCP filter gets higher prediction accuracy than individual prediction for every product. Since the predictor is quite simple, this result implies that the evolving customer purchase intensity is closer to group purchase intensity than individual one, and our FCP filter is able to find the latent group of customers and filter the noise in the individual records to produce accurate prediction results.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 318,
                    "end": 325,
                    "text": "Table 1",
                    "ref_id": "TABREF0"
                },
                {
                    "start": 802,
                    "end": 808,
                    "text": "Fig. 5",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Real-World Dataset"
        },
        {
            "text": "We build a dynamic and flexible clustering-prediction framework FCP filter to predict customer purchase intensity regardless of the random noise of individual customer behavior. Our model segments customers by FCP and then predict customer purchase intensity on the tracked group purchase intensity. After that, the prediction result adjusts priori knowledge of clustering at next time step. We conduct experiments on both synthetic and real-world datasets, and show that FCP filter model is able to (1) identify the latent group and track purchase intensity evolving trends of groups; (2) improve the accuracy of customer purchase intensity prediction. Our framework is scalable with the datasets, without the needs of defining the number of clusters and is flexible to work with different predictors. Generally, our proposed model is not restricted to the domain of customer behavior modeling. It is also useful for other sequential data containing subjects that shifting among latent groups. In our future work, our model will be built on other domains with sequential data to improve prediction accuracy.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Random Fragmentation and Coagulation Processes",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Bertoin",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "",
            "volume": "102",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Pattern Recognition and Machine Learning",
            "authors": [
                {
                    "first": "C",
                    "middle": [
                        "M"
                    ],
                    "last": "Bishop",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Customer segmentation based on transactional data using stream clustering",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Carnein",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Trautmann",
                    "suffix": ""
                },
                {
                    "first": "Q",
                    "middle": [],
                    "last": "Yang",
                    "suffix": ""
                },
                {
                    "first": "Z.-H",
                    "middle": [],
                    "last": "Zhou",
                    "suffix": ""
                },
                {
                    "first": "Z",
                    "middle": [],
                    "last": "Gong",
                    "suffix": ""
                },
                {
                    "first": "M.-L",
                    "middle": [],
                    "last": "Zhang",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "PAKDD 2019",
            "volume": "11439",
            "issn": "",
            "pages": "280--292",
            "other_ids": {
                "DOI": [
                    "10.1007/978-3-030-16148-4_22"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Data mining for shopping centres-customer knowledge-management framework",
            "authors": [
                {
                    "first": "C",
                    "middle": [],
                    "last": "Dennis",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Marsland",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Cockett",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "J. Knowl. Manage",
            "volume": "5",
            "issn": "4",
            "pages": "368--374",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Customer segmentation and strategy development based on customer lifetime value: a case study",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "Y"
                    ],
                    "last": "Kim",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "S"
                    ],
                    "last": "Jung",
                    "suffix": ""
                },
                {
                    "first": "E",
                    "middle": [
                        "H"
                    ],
                    "last": "Suh",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "S"
                    ],
                    "last": "Hwang",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Exp. Syst. Appl",
            "volume": "31",
            "issn": "1",
            "pages": "101--107",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Discovering temporal purchase patterns with different responses to promotions",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Luo",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Koprinska",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Berkovsky",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "International on Conference on Information and Knowledge Management",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Tracking the evolution of customer purchase behavior segmentation via a fragmentation-coagulation process",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Luo",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Koprinska",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Berkovsky",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Chen",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "International Joint Conference on Artificial Intelligence",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Combinatorial stochastic processes",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Pitman",
                    "suffix": ""
                }
            ],
            "year": 2002,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Modelling genetic variations with fragmentation-coagulation processes",
            "authors": [
                {
                    "first": "Y",
                    "middle": [
                        "W"
                    ],
                    "last": "Teh",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Blundell",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Elliott",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Gatsby",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Advances in Neural Information Processing Systems",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "A survey of the challenges and pifalls of cluster analysis application in market segmentation",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "N"
                    ],
                    "last": "Tuma",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Decker",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "W"
                    ],
                    "last": "Scholz",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Int. J. Mark. Res",
            "volume": "53",
            "issn": "3",
            "pages": "391--414",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "The purchase intensities of customer groups evolve with time. Each bubble implies a customer group and the size of bubbles implies the size of groups. The line connecting two bubbles represents customers shifting between groups.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "The generative graphical model of our FCP filter",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Comparison of prediction results (MAE) using FCP filter and individual records on 40 synthetic products of clusters (k). The average MAE results of K-means are 3.93 and 4.76 for K = 3 and K = 5, respectively, which are higher than FCP filter result (3.34 ).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Comparison of MAE for FCP filter and individual model with the last-step predictor on all products",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "Average MAE for FCP filter, individual and static K-means with different predictors",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}