{
    "paper_id": "4100e3bac23fa7d126b819d0b1d5f81f7d4ffec4",
    "metadata": {
        "title": "Digitizable therapeutics for decentralized mitigation of global pandemics Supplementary Material",
        "authors": [
            {
                "first": "Adar",
                "middle": [],
                "last": "Hacohen",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Reuven",
                "middle": [],
                "last": "Cohen",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Sol",
                "middle": [],
                "last": "Efroni",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Baruch",
                "middle": [],
                "last": "Barzel",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "Ido",
                "middle": [],
                "last": "Bachelet",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "M 2 =4 M 3 =2 M 4 =8 M 7 =6 M 5 =3 M 6 =7 M 9 =1",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "1 Modeling epidemic spread 1 ",
            "cite_spans": [
                {
                    "start": 27,
                    "end": 28,
                    "text": "1",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "To model epidemic spreading via air travel [1] we used a local susceptible-infectedrecovered (SIR) model with diffusive coupling, following Ref. [2] . In this framework each node n (n = 1, . . . , N ) represents a local population of M n individuals, of which S n (t) are in the susceptible state S, I n (t) are infected (I) and R n (t) are recovered (R), hence S n (t) + I n (t) + R n (t) = M n for all t. Within each node, we assume a well-mixed population that locally follows SIR dynamics [3] [4] [5] [6] , namely",
            "cite_spans": [
                {
                    "start": 43,
                    "end": 46,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 145,
                    "end": 148,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 493,
                    "end": 496,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 497,
                    "end": 500,
                    "text": "[4]",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 501,
                    "end": 504,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 505,
                    "end": 508,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [],
            "section": ".1 SIR model"
        },
        {
            "text": "where \u03b1 and \u03b2 are the infection and recovery rates, respectively. The coupling between two populations n and m is mediated by the flux of incoming/outgoing travelers via air-traffic F nm , quantifying the number of individuals flying from m to n per day. This form of epidemic spreading gives rise to the following dynamic equations [2, 7] dS n dt = \u2212\u03b1 S n (t)I n (t)",
            "cite_spans": [
                {
                    "start": 333,
                    "end": 336,
                    "text": "[2,",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 337,
                    "end": 339,
                    "text": "7]",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": ".1 SIR model"
        },
        {
            "text": "dR n dt = \u03b2I n (t) + N m=1 w nm R m (t) \u2212 w mn R n (t) .",
            "cite_spans": [],
            "ref_spans": [],
            "section": ".1 SIR model"
        },
        {
            "text": "(1.4)",
            "cite_spans": [],
            "ref_spans": [],
            "section": ".1 SIR model"
        },
        {
            "text": "The first term/s on the r.h.s. capture the processes of infection, proportional to the product of susceptible and infected individuals, and recovery, proportional to I n (t). The summation terms describe the diffusion of S, I or R individuals between local populations, where",
            "cite_spans": [],
            "ref_spans": [],
            "section": ".1 SIR model"
        },
        {
            "text": "is the per-capita flux from m to n, hence, e.g., w nm S m (t) is the volume of susceptible passengers leaving m and entering n per day. Finally, we introduce an invasion threshold \u03b5, which activates the local SIR dynamics only if the infected population rises above an \u03b5 fraction of the local population. We apply this by adding a sigmoidal function [2] \u03c3(x) = (x/\u03b5) h 1 + (x/\u03b5) h (1.6) to the relevant equation terms, providing dS n dt = \u2212\u03b1 S n (t)I n (t) M n \u03c3 I n (t) M n + N m=1 w nm S m (t) \u2212 w mn S n (t) (1.7) dI n dt = \u03b1 S n (t)I n (t) M n \u03c3 I n (t) M n \u2212 \u03b2I n (t) + N m=1 w nm I m (t) \u2212 w mn I n (t) (1.8) dR n dt = \u03b2I n (t) + N m=1 w nm R m (t) \u2212 w mn R n (t) , (1.9) hence infection is locally initiated only when I n (t)/M n exceeds \u03b5, an invasion of n.",
            "cite_spans": [
                {
                    "start": 350,
                    "end": 353,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 381,
                    "end": 386,
                    "text": "(1.6)",
                    "ref_id": null
                },
                {
                    "start": 609,
                    "end": 614,
                    "text": "(1.8)",
                    "ref_id": null
                },
                {
                    "start": 672,
                    "end": 677,
                    "text": "(1.9)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": ".1 SIR model"
        },
        {
            "text": "We now consider drug distribution, which divides the population into two separate groups, the treated population, who received the drug Q, and the untreated population who have not yet acquired it. This leads to six distinct states, characterizing each node's population: ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "where \u03c1 is the drug consumption rate, \u03b2 is the recovery rate from the untreated disease, as appears in (1.1), and \u03b6 > \u03b2 is the recovery rate under treatment. The drug efficacy is 0 \u2264 \u03b3 \u2264 1, capturing the probability of recovery (at rate \u03b6) following drug consumption, hence for each consumed dose, at a rate \u03c1, a fraction \u03b3 of the consumers transitions to the treated state, while a 1 \u2212 \u03b3 fraction remains untreated. In other words, the first four reactions represent the process of treatment, in which a single dose Q is consumed and an untreated individual transitions with probability \u03b3 to the treated state. For a fatal disease, the untreated population perishes, hence R U n (t), the number of individuals at the R U state in n represents n's deceased population, while R T n (t), counting individuals in the R T state, represents the number of saved individuals, who would, in the absence of the therapeutic, also perish. In (1.12) we assume preemptive drug dissemination, in which once the therapeutics become available, they are provided to the entire populationsusceptible or infected -such that a susceptible individual can undergo treatment directly upon infection, without the additional lag for acquiring the therapeutic.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "We arrive at the following six equations",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "is the total infected population -treated and untreated -in n. Note that we have now eliminated the diffusion of the R U population in (1.17), as this state represents the individuals who have died from the disease, and are thus redacted from the traveling population.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "The consumption rate \u03c1 depends on the drug availability in n, being zero in the limit of extreme shortage and approaching unity if there is sufficient availability to meet the demand. Hence we denote the total number of available drug doses in n by Q n (t), and its per-capita availability by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": ", (1.20) in which the denominator represents the time-dependent demand in n. We then define the rate \u03c1 as \u03c1(\u03d5 n ) = \uf8f1 \uf8f2 \uf8f3 \u03d5 n for \u03d5 n < 1 1 for \u03d5 n \u2265 1 = min{\u03d5 n , 1}, (1.21) which in Eqs. (1.13) -(1.16) ensures that drug doses are consumed as long as there is local demand, while avoiding excess consumption when Q n (t) > S U n (t) + I U n (t), in which case n has more available doses than required for its current untreated population.",
            "cite_spans": [
                {
                    "start": 2,
                    "end": 8,
                    "text": "(1.20)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "To close the set of equations (1.13) -(1.18) we track the drug availability Q n (t) in each location n. Under centralized mitigation drug doses are manufactured and shipped from a single source node s at a rate C s (doses/day), providing",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "where \u03b4 ns = 1 if n = s and \u03b4 ns = 0 otherwise. The delay function \u03b8 is the Heavyside step-function",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "initiating drug production only at t \u2265 t R , incorporating the response time required before beginning drug distribution. The diffusion rates B nm represent the fraction of drug-doses in m that ship daily to n; see Sec. 2.2. Under decentralized mitigation drugs are synthesized locally, with each node characterized by its individual production rate C n , providing",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "Hence, Eqs. (1.13) -(1.18) with \u03c1 taken from (1.21) capture the spread of the epidemic and its competition with the distributed therapy. The distinction between centralized and decentralized mitigation is provided by the Q n (t) equations, taken from (1.22) or (1.24), respectively.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "SIR model with treatment"
        },
        {
            "text": "Next we rewrite Eqs. (1.13) -(1.18) for the normalized populations s U n (t) = S U n (t)/M n , s T n (t) = S T n (t)/M n , j U n (t) = I U n (t)/M n , j T n (t) = I T n (t)/M n , r U n (t) = R U n (t)/M n and r T n (t) = R T n (t)/M n , obtaining",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "where j n = j U n (t) + j T n (t). Assuming a negligible fraction of one-directional trips, i.e. that immigration accounts for a marginal part of the overall international mobility, we can write F nm = F mn , stating that, on average, the number of passengers flying daily from m to n is the same as those flying from n to m (see Supplementary Section 2). This enables us, using (1.5) to write ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "is the normalized human flux matrix.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "Next we normalize Eqs. (1.22) and (1.24) by tracking the per-capita drug availability q n (t) = Q n (t)/M n , which approaches unity when in n there is sufficient dosage for the entire local population. For centralized mitigation we obtain (1.22)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "where \u03c1 is taken from (1.21) and",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "in (1.20) remains unchanged under the normalization. The matrix",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "represents the incoming flux of therapeutics from m to n. We define the normalized central production rate as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "which approaches C s = 1 when s has the capacity to produce and ship enough doses for the entire global population each day. Under common conditions we expect C s < 1.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "Using this normalization Eq. (1.39) becomes",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "where",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "is the global population. Note that we used the \u03b4-function in the second term to substitute M n in the denominator of (1.39) by M s in (1.43). Our normalization introduces the prefactor \u2126/M s , which quantifies the global population in units of s's local population. This factor arises because under centralized mitigation, to meet the global demand, the source s must export doses in quantities that are of order \u2126/M s greater than its local population. Therefore, a normalized capacity of C s = 1 translates to a per-capita in s production of \u2126/M s doses per day. Such level of production, which does not scale with M s , but rather with \u2126 is, in the majority of cases, significantly higher than practically attainable, hence we expect, in real scenarios, that C s < 1. Under decentralized mitigation, Eq. (1.24) provides",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "where c n = C n /M n is the per-capita local synthesis rate. Here c n = 1 translates to a production and local distribution capacity of M n doses per day, namely n can provide therapy to its entire local population. As opposed to C s , this normalization scales with the local, rather than global, population, hence C s = 1 in the single source node s and c n = 1 over all n = 1, . . . , N , both capture the case where the global demand can be met within one day -in the former in a centralized fashion and in the latter, decentralized across all N nodes.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Normalized equations"
        },
        {
            "text": "To construct A nm from data we denote the mobility rate by [2] ",
            "cite_spans": [
                {
                    "start": 59,
                    "end": 62,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [],
            "section": "The human flux matrix"
        },
        {
            "text": "in which the numerator quantifies the number of individuals flying per day and the denominator equals to the total population, therefore providing the daily fraction of individuals who seek air travel. This allows us to estimate a local population M n by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The human flux matrix"
        },
        {
            "text": "assuming that all people departing from n, i.e. N k=1 F kn , represent a \u00b5 fraction of n's total population, M n . We can now write",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The human flux matrix"
        },
        {
            "text": "which allows us to extract A nm directly from mobility data (F nm , \u00b5). A similar derivation, using Eq. (1.47), helps us express the ratio \u2126/M s in (1.43) as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The human flux matrix"
        },
        {
            "text": "The parameter \u03ba s captures s's fraction of the global population. For a typical source node s, it scales as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The human flux matrix"
        },
        {
            "text": "the number of nodes in the air-traffic network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The human flux matrix"
        },
        {
            "text": "Normalized equations for epidemic spreading with treatment:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Summary"
        },
        {
            "text": "Centralized mitigation:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Summary"
        },
        {
            "text": "Decentralized mitigation:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Summary"
        },
        {
            "text": "Taking \u03c1(\u03d5 n ) from (1.21) and \u03ba s from (1.51).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Summary"
        },
        {
            "text": "We used the Global Mobility Network dataset [8] to extract the empirical fluxes F nm . The dataset lists the daily travel of \u223c 8.91 \u00d7 10 6 passengers per day over the course of 365 days, i.e. i = 1, . . . , 365, between N = 1, 292 airports, linked through 38, 377 directional air-routes. The mean flux from m to n is thus captured by",
            "cite_spans": [
                {
                    "start": 44,
                    "end": 47,
                    "text": "[8]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Human mobility network and epidemic parameters"
        },
        {
            "text": "where F {i} n\u2190m is the number of passengers flying from m to n in day i. In our analysis we assume an almost symmetric flux matrix, as expressed in Eq. (1.31). Indeed we find that practically all links are bi-directional, and that in the vast majority of existing links we have F n\u2190m \u2248 F n\u2192m , a similar passenger flux in both directions. Therefore, to construct F nm we used the symmetrized",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Human mobility network and epidemic parameters"
        },
        {
            "text": "a network comprising 19, 614 bi-directional links, that represents a symmetric approximation of the empirical fluxes. Evaluating the local populations M n as in (1.47) we obtained A nm via (1.50). Following Ref. [2] , we used \u00b5 = 1.7 \u00d7 10 \u22123 day \u22121 for the mobility rate. The disease parameters in (1.53) -(1.58) were set to \u03b1 = 2 day \u22121 and \u03b2 = 0.2 day \u22121 , providing a reproduction rate of R 0 = \u03b1/\u03b2 = 10, and hence ensuring a highly contagious pandemic, which, untreated, will be guaranteed to spread globally [3] . Other, less extreme scenarios, are examined in Sec. 4. The treated population recovery rate is set to \u03b6 = 1 day \u22121 , and the efficacy is set to \u03b3 = 1. For the penetration threshold in \u03c3(j n ) we used \u03b5 = 10 \u22126 and h = 8 in (1.6). The term \u2126/M s = \u03ba s in (1.59) was evaluated using (1.51). Finally, the response time t R was set to be at the onset of the pandemic spread, evaluated as the time t when the infection levels have reached 10% of the projected peak infection (Fig. S1 ). For the parameters listed above, this provides t R = 12 days. As our source node we selected s=ITM (Itami International Airport, Osaka, Japan), testing the effect under other sources in Section 4.",
            "cite_spans": [
                {
                    "start": 212,
                    "end": 215,
                    "text": "[2]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 513,
                    "end": 516,
                    "text": "[3]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [
                {
                    "start": 989,
                    "end": 997,
                    "text": "(Fig. S1",
                    "ref_id": null
                }
            ],
            "section": "Human mobility network and epidemic parameters"
        },
        {
            "text": "The capacities C s and c n were set variably to test the performance of each method, centralized vs. decentralized with varying global/local capacities. In the case of decentralized mitigation the capacities are distributed, potentially taking different values in different locations n. Therefore, if e.g., we set the mean capacities to C s = c n = C, then C s = C, but c n \u223c N (C, \u03c3 2 ) is a random variable extracted from a normal distribution with mean C and standard deviation \u03c3 = 0.1C.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Human mobility network and epidemic parameters"
        },
        {
            "text": "The above represents our default parameters, used, e.g., to produce Fig. 1 of the main text; in Figs. 2 -3 we consistently vary some of these parameters, such as t R or \u03b3 as reported in the main text. Excluding the varied parameter in each panel, e.g., t R in Fig. 2a , the remaining parameters continue to be fixed at the above default values. The setting used to produce Fig. 4 of the main text are explicated in Sec. 3. In Sec. 4 we examine the behavior of our system under different disease parameter sets, varying the reproduction rate R 0 = \u03b1/\u03b2. Figure S1 : Selecting the response time. To select t R we tracked the global level of infection, I(t) = N n=1 I n (t), vs. t, and set t R to be the time where I(t) has reached an \u03b7 fraction of its peak value, namely I(t R ) = \u03b7I(T Peak ). Here we set \u03b7 = 0.1.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 68,
                    "end": 74,
                    "text": "Fig. 1",
                    "ref_id": null
                },
                {
                    "start": 260,
                    "end": 267,
                    "text": "Fig. 2a",
                    "ref_id": null
                },
                {
                    "start": 373,
                    "end": 379,
                    "text": "Fig. 4",
                    "ref_id": null
                },
                {
                    "start": 552,
                    "end": 561,
                    "text": "Figure S1",
                    "ref_id": null
                }
            ],
            "section": "Human mobility network and epidemic parameters"
        },
        {
            "text": "In our simulations we track the epidemic spread using a 4th order Runge-Kutta stepper to iteratively solve Eqs. (1.53) -(1.60), with the relevant parameters as described above.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Human mobility network and epidemic parameters"
        },
        {
            "text": "The networks Z nm and B mn in (1.59) represent the fluxes of therapeutic doses to and from n respectively. These fluxes depend on the distribution strategy, which in turn impacts the efficiency of the drug dissemination. We consider three different constructions of these networks -two that build on the existing air-routes, and a third that achieves the highest efficiency by exerting extensive control over the international aviation network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "Diffusive distribution (Network 1). The results presented in the main text were obtained by setting",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "This represents diffusive distribution, in which the drug spreads along similar routes as the human travelers. The rationale is that in each node m the q m (t) available doses are split among each of m's outgoing destinations. The fraction of these doses to reach n is equal to the fraction of passengers departing from m whose destination is n, namely we calculate the flux from m to n (numerator) as a fraction of the total flux outgoing from m (denominator). This natural distribution scheme requires no intervention in the aviation networks, as the busy routes, mobilizing many human travelers, also naturally ship a larger fraction of commodities, in this case -drug doses. It also leads, on average, to a fair distribution, as airports with large incoming fluxes, which are typically highly exposed to the spreading pathogens, also receive increased fractions of the therapy. Under this construction, the networks Z nm = B mn are symmetric, as they can both be expressed, using Eq. (1.50), as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "capturing an effective travel network in which 100% of passengers, in this case the available drug doses, travel each day (equivalent to setting \u00b5 = 1 in (1.50), i.e. a mobility rate of 100%).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "Directed distribution (Network 2). As an alternative to the above network we consider a direct flight network, in which the therapeutic is shipped in directed routes from s to all destinations. First we consider the binary air-route network G nm , which satisfies",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "capturing all existing air-routes, regardless of their volume of traffic. As the therapeutic is shipped from s to all destinations it relies on the existing routes G nm , but avoids cyclic pathways that may bring it back closer to s. This resembles pre-planned routes, which, on the one hand, must rely on existing lines, but on the other hand seek the most efficient routing from source to destination, avoiding cyclic pathways. To construct this directed network, we first used the depth first search (DFS) algorithm [9] starting from the therapeutic source node s. At the first step one traverses along all existing G mn links from s to its nearest neighbors, i.e. s's first generation descendants. One then continues to advance along the edges from each of these descendants, seeking additional new second generation descendants, then third generation and so on. In this process the G nm links traversed in each step may be in one of four groups (Fig. S2a) : Tree links -linking igeneration nodes to i + 1-generation nodes; Forward links -linking i-generation nodes to i + k-generation nodes (k > 1); Back links -linking i-generation nodes to i \u2212 k-generation nodes (k \u2265 1); Cross links -all remaining links, connecting separated branches of the spanning tree. Once we have covered the entire network we eliminate all Back links to obtain the s-dependent directed air-routes network G {s} nm , in which only the routes leading away from s remain. Applying this algorithm to the air-traffic network, starting from s=ITM we arrive at a directed G {s} nm with 19, 605 directed links, out of the original G nm , which comprised 38, 377 links, of which the vast majority were bi-directional, i.e. G nm = G mn .",
            "cite_spans": [
                {
                    "start": 519,
                    "end": 522,
                    "text": "[9]",
                    "ref_id": "BIBREF8"
                }
            ],
            "ref_spans": [
                {
                    "start": 950,
                    "end": 960,
                    "text": "(Fig. S2a)",
                    "ref_id": null
                }
            ],
            "section": "Drug distribution networks"
        },
        {
            "text": "To obtain the relative fluxes along the directed links of G {s} nm we use the empirical fluxes of F nm to construct the acyclic",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "capturing the volume of (human) travel along each directed route. The available therapeutic at each node m is split among the existing outgoing routes, with flux proportional to F {s} nm . Indeed, the busiest routes, which carry the largest volume of human travelers are also the ones shipping the largest volume of commodities, in this case drug doses. This provides the outgoing fluxes from n to m as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "allowing us to construct Z nm from (1.41), expressing M n and M m via (1.47).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "Balanced distribution (Network 3). In the main text we have shown that the primary lacuna of commodity flow is that, relying on existing air-travel fluxes, it inevitably leads to an unbalanced distribution, in which few nodes receive the therapeutic in excess quantities, while others remain deprived. Hence we consider a balanced network, which calculates for each node, all the downstream destinations along its descending routes, and divides the therapeutics accordingly. This represents an improved, albeit not optimal, physical distribution scheme. Indeed, a fully optimal distribution scheme is extremely difficult to attain, and practically impossible to execute. In fact, even the currently proposed balanced scheme requires a level of control over the air-traffic network that is extremely unlikely to apply in realistic scenarios. Moreover, optimal schemes in general, and our balanced scheme in particular, require us to intervene in the natural flow of commodities, by enforcing external control over the volumes of shipments that travel between destinations, hence they potentially come at a tremendous economic price-tag. Still, we examine this best case scenario, assuming a fully controlled balanced distribution scheme, as a test case for centralized mitigation under a well-designed distribution network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "To construct the balanced network we repeated the process leading to Network 2, constructing G nm from (2.5) and using DFS from the source s. This time, however, we only kept Tree links, leading to an optimized network, in which all target nodes n = 1, . . . , N are linked to the source s via G nm 's shortest paths. Hence we arrive at G {s} nm , in which there is a single directed path \u03a0(s \u2192 n) from s to all target nodes n. This path includes a minimal number of flight transfers, as enabled by the existing routes in G nm , hence representing an efficient distribution network, which adheres to the bounds of our current overall aviation capacity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "Each node n is then assigned a branching index K n , quantifying the total population in all of the nodes that are downstream from n. To be specific, consider the path",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "providing the shortest sequence from s to the target node i. For some intermediate node m we define the group (Fig. S2b )",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 110,
                    "end": 119,
                    "text": "(Fig. S2b",
                    "ref_id": null
                }
            ],
            "section": "Drug distribution networks"
        },
        {
            "text": "which consists of all nodes i whose shortest path from s traverses m, namely nodes that are downstream from m. Note that m itself is also included in K m . Additionally, if m is a leaf node, namely a node with no outgoing links then K m = {m}, including only the node m itself. The corresponding branching index is defined as Figure S2 : Constructing the centralized distribution networks B mn . We constructed three distribution networks. (a) Diffusive (Network 1), comprising all links of the original air traffic network; Directed (Network 2), in which we eliminated Back links (green) to avoid cyclic pathways. Hence shipped doses avoid returning towards the source s (here represented by node number 1). Balanced (Network 3), in which we eliminated also Forward links (red) and Cross links (blue), providing a perfect tree network with a single directed route between s and all target nodes. (b) In Balanced (Network 3) each node n is assigned a branching index K n quantifying the total population downstream from n, i.e. sum of M i over all nodes i whose path from the source 1 traverses n. For example, the nodes downstream from 6 are 9, 10 and 6 itself, hence K 6 = M 6 + M 9 + M 10 = 10. To achieve a balanced spread of the therapeutic, each node must receive doses in quantities proportional to its branching index, to serve all its downstream target nodes. Therefore, in Network 3 the incoming link to n is proportional to K n (Eq. (2.11)).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 326,
                    "end": 335,
                    "text": "Figure S2",
                    "ref_id": null
                }
            ],
            "section": "Drug distribution networks"
        },
        {
            "text": "namely the total population in all nodes located downstream from m. Equation (2.10) captures the amount of doses that must be delivered from s to m if the entire population is to be served. The flux from n to m is then designed to be proportional to K m , namely",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "ensuring that of the available doses q n (t) at n, the share that reaches m is balanced with m's projected downstream shipments, amounting to K m . As before Z nm is constructed from (1.41).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Drug distribution networks"
        },
        {
            "text": "In Fig. S3a we present Res vs. C as obtained for Networks 1 -3 (orange, yellow, brown). For comparison we also show the results of decentralized mitigation (green). As expected decentralized mitigation achieves consistently better results compared to all three centralized distribution schemes. Among the centralized schemes the balanced Network 3 provides the best results, as expected by its egalitarian design. Interestingly Notwork 1, incorporating un-directed diffusive distribution is superior to the directed Network 2. The reason it that in the absence of cycles, a large volume of the available therapeutic is accumulated at the final destination nodes (leafs), becoming effectively lost. The diffusive Network 1 allows the drugs to continue cycling until reaching a destination where they are needed, and hence consumed. The Gini index is presented in Fig. S3b , showing a similar trend among the three centralized distribution strategies.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 3,
                    "end": 11,
                    "text": "Fig. S3a",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 862,
                    "end": 870,
                    "text": "Fig. S3b",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Drug distribution networks"
        },
        {
            "text": "Consider the spread of a therapeutic under centralized mitigation via Eq. (1.59), namely",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "To track the supply distribution across all nodes let us ignore the local consumption, i.e. first term on r.h.s., and, for simplicity, set t R = 0, and the normalized capacity to \u03ba s C s = 1. Using our diffusive spread of Eq. (2.3) we arrive at",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "in which one unit of the therapeutic is produced at s per unit time, then diffuses through the distribution network B mn to reach all other nodes. To asses the rate of the incoming therapeutic at some destination n consider a path \u03a0(s \u2192 n) = {s",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "\u2212 \u2212 \u2192 n}, comprising a sequence of nodes and links along the drug distribution network from s to n. Each link B ij in this pathway represents the fraction of doses present in j that will be routed to i, i.e. B ij = B i\u2190j . Hence a unit dosage exiting s that travels to n through \u03a0(s \u2192 n) will be diluted to",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "This represents the rate by which \u03a0(s \u2192 n) delivers the therapeutic to n. In case there are multiple paths between s and n, the total rate \u03be sn can be approximated by the sum over all routes as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "For routes of length l this can be expressed as a matrix product \u03be {l} sn = [B l ] sn , i.e. the s, n entry of B l . Therefore, the total rate of incoming therapeutics into a target node n is the sum over the contribution of all individual pathways, expressed by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "as appears in Eq. (6) of the main text. Taking B nm from the appropriate network (Net-works 1 -3) we obtain the rates \u03be sn , providing the amount of doses q n reaching destination n per each unit shipped from the source s. The density function P (\u03be) captures the fraction of nodes whose rate is \u03be sn \u2208 (\u03be, \u03be + d\u03be). In Fig. S3c -e we present P (\u03be) as obtained from Networks 1 -3, setting the source node to be s =ITM. We find that in our air-travel network the longest path has five legs, therefore we set L Max = 5 in (3.6). A node n is considered saved (S n = 1) if, under treatment, its mortality rate is reduced to at least half of that observed in the absence of treatment, namely",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 318,
                    "end": 326,
                    "text": "Fig. S3c",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "where r U n (t) is extracted from Eqs. (1.53) -(1.60) and r n (t) from the untreated (1.2) -(1.4). The probability of node n to be saved is strongly dependent on the availability of the therapeutic at n, and hence on its rate \u03be sn . To observe this we show in Fig. S3c e the probability P (S \u2229 \u03be) for a random node n to have \u03be sn \u2208 (\u03be, \u03be + d\u03be) and also have S n = 1. As predicted, we find that the uneven dilution strongly impacts the inequality in the S-probability, where nodes with large \u03be sn have a much higher probability of being saved than those with small \u03be sn . The effect is less pronounced in Network 3, which is specifically designed to balance the inequality in B nm .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 260,
                    "end": 268,
                    "text": "Fig. S3c",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "The rate matrix \u03be sn"
        },
        {
            "text": "Consider a random symmetric binary network G nm = G mn with an arbitrary degreedistribution P (K), and randomly selected symmetric weights W nm = W mn . Combining these two matrices we construct a model transportation network F nm = G nm W nm , resulting in a weighted network that is extracted from the configuration model ensemble [10] . We can now construct the consequent distribution network B mn , whose weights capture the volume of commodity flow from n to m, via Eq. (2.3) as",
            "cite_spans": [
                {
                    "start": 333,
                    "end": 337,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [
                {
                    "start": 476,
                    "end": 481,
                    "text": "(2.3)",
                    "ref_id": null
                }
            ],
            "section": "Network pathways"
        },
        {
            "text": "In (3.8) the weighted degrees S m = N n=1 B mn are normalized to unity, as in Network 1 of Sec. 2.2, capturing the fact that all incoming commodities must also flow (or be consumed) out to other destinations, hence the total out-flux amounts to unity.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "We define the un-weighted degree of m as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "counting the number of routes in/out of m, allowing us to express S m as 3. The effect of heterogeneity is most pronounced in Network 2, consistent with its lowest performance levels among the three networks. Note, that in Network 2 the power-law P (\u03be) is truncated for large \u03be. As expected, heterogeneity is least pronounced in Network 3, which is designed for balanced distribution.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "where B m is the average weight of m's K m outgoing links. Using the fact the S m = 1 we can extract the average weight as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "hence for a node with K m outgoing routes, we have each route carrying, on average, 1/K m of the available commodities for further shipping. Next we consider m's residual degree",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "capturing the average un-weighted degree of m's nearest neighbors. Averaging over all nodes (m = 1, . . . , N ) we obtain the network's mean residual degree",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "which expresses the average degree over all nearest neighbor nodes. This average neighbor degree is also commonly expressed as [10]",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "where K n represents the n-th moment of P (K). Equation (3.11) allows us to evaluate the average weight of a link associated with nearest neighbor nodes as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "The analysis above of the residual degree K helps us characterize the pathways in G nm , and hence, through (3.5), obtain the distribution of the rates \u03be sn . Indeed, the average node has K nearest neighbors, which, in turn, have, on average K neighbors of their own. Therefore, a node has, on average, K K next neighbors and K K 2 neighbors at distance l = 3, and so on. For a sufficiently large network, with N \u2192 \u221e, this predicts that the number of nodes at distance l from a randomly selected node grows as N (l) = K K l\u22121 , an exponential growth that we approximate by [10] ",
            "cite_spans": [
                {
                    "start": 573,
                    "end": 577,
                    "text": "[10]",
                    "ref_id": "BIBREF9"
                }
            ],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "where \u03bb = ln K . Equation (3.16) is valid as long as l \u03bb \u22121 ln N , capturing the network's average path length l , beyond which the shells N (l) cease to grow exponentially. It follows from this equation that starting from an arbitrary source node s, the probability of a randomly selected node n = 1, . . . , N to be at distance l sn = l is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "a valid approximation as long as l \u2264 l .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Network pathways"
        },
        {
            "text": "In a large random network, due to the local tree-like structure, there is often a single shortest path \u03a0(s \u2192 n) between a source s and its target n, whose length is l sn . The typical nodes along such path are, by definition, nearest neighbor nodes, and hence, on average their degree is K , and the l sn weights linking between them are B . Consequently, the rate \u03be sn in (3.5) can be approximated by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "Therefore, on average, we have rates decaying exponentially with network distance l, as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "where, as above (Eqs. (3.16) and (3.17)) \u03bb = ln K . Equation (3.19 ) predicts that the average node at distance l from s receives the therapeutic at a rate proportional to e \u2212\u03bbl , portraying an exponential dilution as the drugs propagate downstream from s. We can now use (3.19 ) to obtain the density function P (\u03be), by transforming from the random variable \u03be to the variable l, whose distribution is given by P (l) in (3.17). Hence we write",
            "cite_spans": [
                {
                    "start": 61,
                    "end": 66,
                    "text": "(3.19",
                    "ref_id": null
                },
                {
                    "start": 272,
                    "end": 277,
                    "text": "(3.19",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "Taking l from (3.19) we have l = \u2212\u03bb \u22121 ln \u03be and hence | dl/ d\u03be| \u223c \u03be \u22121 . Using (3.17) and (3.19) we can also write P (l) \u223c \u03be \u22121 , hence, together we arrive at",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "where \u03bd = 2, precisely the prediction of Eq. (7) in the main text. This result is obtained under the configuration model ensemble, i.e. random network/weights. More generally, e.g., in the presence of degree/weight correlations, the exponent \u03bd can take different values. However the power-law form of (3.21) is expected under almost any network construction. Indeed, as long as the network exhibits an exponential growth of the form (3.17), and the downstream dilution exhibits an exponential decay of the form (3.19), we expect a scale-free P (\u03be). To observe this, consider, for example that the two exponential functions exhibit different growth/decay rates, i.e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "Under these conditions we continue to have | dl/ d\u03be| \u223c \u03be \u22121 , however P (l) now follows P (l) \u223c \u03be \u2212\u03bb 1 /\u03bb 2 . Using these expressions in (3.20), we find that the scaling P (\u03be) \u223c \u03be \u2212\u03bd remains, only that now the scaling is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "which expectedly provides \u03bd = 2 in case \u03bb 1 = \u03bb 2 . Such generalized scaling (\u03bd = 1.4) was indeed observed in the empirical aviation network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Rate distribution P (\u03be)"
        },
        {
            "text": "Consider the probability density P (\u03be). For a finite system of N nodes it has a minimal rate, \u03be min , such that Denoting the normalization constant by Z, we express P (\u03be) as P (\u03be) \u223c Z\u03be \u2212\u03bd , and use (3.25) to obtain",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "The maximal rate for a system of N nodes can be obtained from P (\u03be \u2265 \u03be max ) = 1/N , namely, the probability to exceed \u03be max is 1/N , providing",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "and in turn At the same time, we can independently evaluate that \u03be max = \u03be ss , namely the rate at the source itself, which is by definition equal to unity, and therefore",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "For example, under \u03bd = 2, we find that \u03be min , which represents the rate at the majority of the nodes is approximately 1/N , an extremely low rate in case N \u2192 \u221e.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "Next we seek the critical capacity C \u03b7 to save an \u03b7-fraction of nodes. Consider a node n with rate \u03be sn . For each unit therapeutic produced at s, n receives a fraction \u03be sn , and hence under capacity C s , the supply rate at n is of the order of C n = \u03be sn C s . The meaning is that the therapeutic availability at n, ignoring local consumption and just focusing on the supply from s, is, roughly, q n (t) \u223c C n t. For n to be saved, i.e. S n = 1, we require C n \u223c 1, such that n is fully supplied (q n (t) = 1) within a finite time. Therefore, the critical \u03be sn for saving n is approximately",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "To save an \u03b7 fraction of all nodes we set C s in (3.31) to C s = C \u03b7 , namely a critical rate of \u03be Crit = 1/C \u03b7 , and require that all nodes with \u03be sn \u2265 \u03be Crit are saved. Therefore, we write",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "setting the fraction of nodes whose rate exceeds the saving threshold \u03be Crit to \u03b7. We obtain",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "which, using (3.26), provides",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "where in the last step we used (3.30) to obtain \u03be min 's scaling with N . Finally, we use (3.31) to convert \u03be Crit to the consequent critical capacity, yielding",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "where \u03c6 = 1/(\u03bd \u2212 1), as appears in Eq. (8) of the main text.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Critical capacity C \u03b7"
        },
        {
            "text": "As explained above, under a given capacity C s , node n, whose rate is \u03be sn receives a C n = C s \u03be sn fraction of its demand per unit time. Therefore its supply time T Supp,n to fill up its demand (i.e. q n (t) = 1), follows",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Mean supply time T"
        },
        {
            "text": "This allows us to transform from P (\u03be) to P (T ), capturing the probability density to observe T Supp,n \u2208 (T, T + dT ). We write P (T ) dT = P (\u03be) d\u03be dT dT, (3.37) and, using P (\u03be) \u223c \u03be \u2212\u03bd , \u03be \u223c 1/T , we arrive at P (T ) \u223c T \u03bd\u22122 . As before we seek the normalization factor Z T via",
            "cite_spans": [
                {
                    "start": 157,
                    "end": 163,
                    "text": "(3.37)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Mean supply time T"
        },
        {
            "text": "which provides",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Mean supply time T"
        },
        {
            "text": "The final approximation, relying on T max T min , is relevant as long as \u03bd > 1, a condition which is anyway necessary for P (\u03be) to be a valid (normalizable) density function. The mean supply time is given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Mean supply time T"
        },
        {
            "text": "once again -neglecting the T min limit. Taking Z T from (3.39) we arrive at T \u223c T max , indicating that the mean supply time is governed by the latest supplied nodes. Indeed, given the scale-free nature of P (\u03be), the low \u03be (and hence large T ) nodes represent the majority of the destinations, and therefore they are the ones that determine the average supply times of the therapeutic. To estimate T max we recall from (3.36) that it the inverse of \u03be min . This allows us to use the scaling relationship of (3.30) to write In centralized mitigation each outbreak is characterized by the disease origin at node o and by the therapeutic source from node s, where drugs are produced and shipped globally. In the main text we arbitrarily selected o to be the Bujumbura International Airport (BJM) in Burundi (Fig. S4a, red star) , and s to be the Osaka International Airport (ITM) in Japan. In Fig. S4c -k we show Res and the Gini index vs. C as obtained from centralized vs. decentralized distribution for a selection of alternative sources. As expected, the specific source has little impact on the therapeutic efficiency, with decentralized consistently outperforming centralized. Ideally, one expects the best outcome to be observed if s and o are close to each other. Indeed, at the early stages of the outbreak the nodes in the vicinity of o are most severely impacted, and hence if these neighbors of o are efficiently treated, by, e.g., setting s in close proximity, this may lead to a meaningful reduction in global mortality. This goal is best served if s is directly linked to o's neighborhood, in which case the local spread of the therapeutic is most efficient. To observe this we measured Res vs. \u03be os , providing an effective distance measure, along the paths from s to o. Setting C = 0.2, we find that, indeed, mortality is higher when \u03be os is small (Fig. S4b) , however the effect is marginal.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 804,
                    "end": 824,
                    "text": "(Fig. S4a, red star)",
                    "ref_id": "FIGREF7"
                },
                {
                    "start": 890,
                    "end": 898,
                    "text": "Fig. S4c",
                    "ref_id": "FIGREF7"
                },
                {
                    "start": 1862,
                    "end": 1872,
                    "text": "(Fig. S4b)",
                    "ref_id": "FIGREF7"
                }
            ],
            "section": "Mean supply time T"
        },
        {
            "text": "In the main text we examine the effect of centralized vs. decentralized distribution under the extreme conditions of a highly fatal epidemic, in which R 0 = \u03b1/\u03b2 = 10, conditions that, untreated, lead to an almost complete demise of the human population, i.e. r n (t \u2192 \u221e) \u2192 1 for all n. In Fig. S5 we examine the results under varying disease parameters, freezing the recovery rate at \u03b2 = 0.2 day \u22121 , and setting \u03b1 such that R 0 = 2, 3, . . . , 10.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 289,
                    "end": 296,
                    "text": "Fig. S5",
                    "ref_id": null
                }
            ],
            "section": "The effect of disease parameters"
        },
        {
            "text": "As expected, we find that in all cases, decentralized mitigation consistently outperforms the centralized alternative. Note, that the parameter R 0 not only impacts the level of contagion, but also affects the propagation times of the epidemic. This fact touches on the relevant selection of our response time t R , which must be adapted as R 0 is changed. Indeed, setting e.g., t R = 12 days, as we do for R 0 = 10, would represent an unrealistically early response under R 0 = 2, which, over the course of 12 days remains still in its early embryonic stage, likely not even detected as a potential threat. Therefore, to conduct a controlled examination of the impact of R 0 , we update our response time t R as we change the disease parameters. We consistently select t R to be the time t when the global infection level I(t) has reached an \u03b7 fraction of its peak value, setting \u03b7 = 0.1 (Fig. S1 ).",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 889,
                    "end": 897,
                    "text": "(Fig. S1",
                    "ref_id": null
                }
            ],
            "section": "The effect of disease parameters"
        },
        {
            "text": "To examine the potential efficiency of the therapuetic distribution under centralized mitigation we used the commodity flow framework [11] to design an optimal shipping strategy. We consider the air-traffic network as our underlying flow network, upon which the single source node s must ship the therapeutic in sufficient quantities, as given by the initial demands d n (0), to all target nodes n = 1, . . . , N . Each link is characterized by a nonnegative carrying capacity C nm , capturing the maximal volume of the therapeutic that can be transferred from m to n through that link per unit time (day). Our goal is to meet the demand of all nodes as efficiently as possible, i.e. in minimum time, within the shipping constraints provided by C nm . An important consideration that arises from our earlier discussion is that distribution inequality can severely impact the efficiency of a therapeutic in battling the epidemic. Therefore we wish to distribute the therapeutic to all destinations in parallel, avoiding serial strategies that first fill up selected destinations, then continue shipping to others. To ensure such strategies are avoided we implemented a day-by-day optimization strategy, in which we maximize the commodity flow in each day t = 1, . . . , T . Hence, at each day t we fill up as much of the current demand of all nodes as possible within that single day. We then update the remaining demand d n (t) \u2192 d n (t + 1) and reiterate the process at day t + 1, until all demands are satisfied at t = T max = max N n=1 (T Supp,n ). Figure S5 : The effect of disease parameters. We tested decentralized (green) vs. centralized (yellow) mitigation for a range of disease parameters R 0 = 2, . . . , 10, finding that under all conditions decentralized outperforms centralized mitigation.",
            "cite_spans": [
                {
                    "start": 134,
                    "end": 138,
                    "text": "[11]",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [
                {
                    "start": 1552,
                    "end": 1561,
                    "text": "Figure S5",
                    "ref_id": null
                }
            ],
            "section": "Overview"
        },
        {
            "text": "At t = 0 we select a source node s, and set the initial demands of all other nodes to d n (0) = M n , i.e. each node's demand is equal to its population size. In each day the therapeutic is distributed from s, aiming for maximum flow [12] [13] [14] , namely seeking to maximize the number of doses exiting s and spreading to all other nodes. Denoting the volume of doses shipped from m to n on day t by F nm (t), this optimization scheme translates to",
            "cite_spans": [
                {
                    "start": 234,
                    "end": 238,
                    "text": "[12]",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 239,
                    "end": 243,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 244,
                    "end": 248,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "Maximum flow optimization"
        },
        {
            "text": "Maximize F s (t) = N m=1 F ms (t) \u2212 F sm (t) .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Maximum flow optimization"
        },
        {
            "text": "(5.1)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Maximum flow optimization"
        },
        {
            "text": "Using this notation the net supply of doses entering a target node n throughout day t is \u2212F n (t) = N m=1 [F nm (t) \u2212 F mn (t)], and hence at the end of each day the demand is reduced by precisely that amount (note that the minus sign in \u2212F n (t) represents incoming flux to n, a counter-intuitive notation, which is motivated by the fact that F s (t) -positive flux -represents drugs exiting the source). Consequently, the n-demand at day t is given by d n (t) = M n + t\u22121 \u03c4 =0 F n (\u03c4 ), (5.2) starting at d n (0) = M n , and reducing the demand due to the cumulative therapeutic influx as time advances. The maximization of (5.1) is subject to two constraints that must be satisfied at all t: The first constraint (5.3) ensures that all daily shipments from m to n do not exceed the carrying capacity C nm ; the second constraint (5.4), with d n (t) taken from (5.2), restricts nodes from accumulating therapeutics in excess of their remaining demand, therefore bounding the total incoming doses at day t, i.e. \u2212F n (t), by the current demand d n (t).",
            "cite_spans": [
                {
                    "start": 489,
                    "end": 494,
                    "text": "(5.2)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Maximum flow optimization"
        },
        {
            "text": "To solve the maximum flow optimization problem of (5.1) -(5.4) we used an iterative approach (Fig. 4a , main text): at each time step t we use linear optimization to maximize F s (t) under the two constraints. This provides us with day t's optimized shipping strategy, detailing the daily fluxes F nm (t) through all routes C nm . With these fluxes we calculate the net influx into each node \u2212F n (t), and update the demands d n (t + 1) in (5.2) accordingly. We then use these updated demands to obtain the shipping strategy for the next day t + 1, repeating the process until all demands reach d n (T Supp,n ) = 0 at the final step t = T max . Note that in this process we disregard the flight times themselves, which, if accounted for, might incur additional delays. Instead we assume that the daily time unit accounts also for the lag of each route [15] .",
            "cite_spans": [
                {
                    "start": 852,
                    "end": 856,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [
                {
                    "start": 93,
                    "end": 101,
                    "text": "(Fig. 4a",
                    "ref_id": null
                }
            ],
            "section": "Maximum flow optimization"
        },
        {
            "text": "Implementation. To construct the carrying capacities C nm we used the passenger fluxes F nm , as obtained from the air travel data [8] . We assume that the daily volume of cargo shipped across the m \u2192 n route is proportional to the number of passengers F nm for that route. This allows us to write Figure S6 : The effect of the cargo carrying capacity. We constructed C nm in (5.5) using three different values for the passenger/cargo ratio \u03c9, and used the maximum flow optimization of (5.1) -(5.4) to obtain the supply rate distribution P (\u03be). As expected the average rate increases as \u03c9 is increased, however the fat-tailed (power-law) nature of P (\u03be) remains unaffected, indicating that distribution inequality continues to govern the therapeutic dissemination.",
            "cite_spans": [
                {
                    "start": 131,
                    "end": 134,
                    "text": "[8]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 298,
                    "end": 307,
                    "text": "Figure S6",
                    "ref_id": null
                }
            ],
            "section": "Maximum flow optimization"
        },
        {
            "text": "C nm = \u03c9F nm , (5.5) where \u03c9 is the number of doses that can be shipped as cargo per traveling passenger. Our results are not sensitive to the specific value of \u03c9, as any re-scaling of C nm (capturing doses/day) is equivalent to an arbitrary re-scaling of the time units, having no bearing on the essential findings of Fig. 5 (main text). To select a realistic value, we assume each dose to have a gross weight of \u223c 0.1 kg, which, taking the average passenger mass at \u223c 100 kg, provides a ratio of \u03c9 \u223c 10 3 . Therefore we selected \u03c9 in the range 10 2 \u2212 10 4 (Fig. S6) , with the results in the main text obtained for \u03c9 = 10 3 . The initial demands were set to d n (0) = M n , extracting M n from the data via (1.47).",
            "cite_spans": [
                {
                    "start": 15,
                    "end": 20,
                    "text": "(5.5)",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 319,
                    "end": 325,
                    "text": "Fig. 5",
                    "ref_id": null
                },
                {
                    "start": 558,
                    "end": 567,
                    "text": "(Fig. S6)",
                    "ref_id": null
                }
            ],
            "section": "Maximum flow optimization"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "The role of the airline transportation network in the prediction and predictability of global epidemics",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Colizza",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Barrat",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Barth\u00e9lemy",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vespignani",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "Proc. Natl. Acad. Sci. USA",
            "volume": "103",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "The hidden geometry of complex, network-driven contagion phenomena",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Brockmann",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Helbing",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Science",
            "volume": "342",
            "issn": "",
            "pages": "1337--1342",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Epidemic processes in complex networks",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Pastor-Satorras",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Castellano",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Van Mieghem",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vespignani",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Rev. Mod. Phys",
            "volume": "87",
            "issn": "",
            "pages": "925--958",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Dynamical Processes on Complex Networks",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Barrat",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Barth\u00e9lemy",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Vespignani",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "A generalized model of social and biological contagion",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "S"
                    ],
                    "last": "Dodds",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "J"
                    ],
                    "last": "Watts",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Journal of Theoretical Biology",
            "volume": "232",
            "issn": "",
            "pages": "587--604",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Forecast and control of epidemics in a globalized world",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Hufnagel",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Brockmann",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [],
                    "last": "Geisel",
                    "suffix": ""
                }
            ],
            "year": 2004,
            "venue": "Proc. Natl. Acad. Sci. USA",
            "volume": "101",
            "issn": "",
            "pages": "15124--15133",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "A structured epidemic model incorporating geographicmobility among regions",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Sattenspiel",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Dietz",
                    "suffix": ""
                }
            ],
            "year": 1995,
            "venue": "Mathematical Biosciences",
            "volume": "128",
            "issn": "",
            "pages": "71--91",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "Introduction to Algorithms, Second Edition",
            "authors": [
                {
                    "first": "T",
                    "middle": [
                        "H"
                    ],
                    "last": "Cormen",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "E"
                    ],
                    "last": "Leiserson",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "L"
                    ],
                    "last": "Rivest",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Stein",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "Networks -an introduction",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "E J"
                    ],
                    "last": "Newman",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Network flows: theory, algorithms and applications",
            "authors": [
                {
                    "first": "R",
                    "middle": [
                        "K"
                    ],
                    "last": "Ahuja",
                    "suffix": ""
                },
                {
                    "first": "T",
                    "middle": [
                        "L"
                    ],
                    "last": "Magnanti",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "B"
                    ],
                    "last": "Orlin",
                    "suffix": ""
                }
            ],
            "year": 1993,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "Maximal flow through a network",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "R"
                    ],
                    "last": "Ford",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "R"
                    ],
                    "last": "Fulkerson",
                    "suffix": ""
                }
            ],
            "year": 1956,
            "venue": "Canadian Journal of Mathematics",
            "volume": "8",
            "issn": "",
            "pages": "399--404",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Constructing maximal dynamic flows from static flows",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "R"
                    ],
                    "last": "Ford",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "R"
                    ],
                    "last": "Fulkerson",
                    "suffix": ""
                }
            ],
            "year": 1958,
            "venue": "Operations Research",
            "volume": "6",
            "issn": "",
            "pages": "419--433",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Efficient maximum flow algorithms",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "V"
                    ],
                    "last": "Goldberg",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "E"
                    ],
                    "last": "Tarjan",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Communications of the ACM",
            "volume": "57",
            "issn": "",
            "pages": "82--89",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "Faster algorithms for the quickest transshipment problem",
            "authors": [
                {
                    "first": "L",
                    "middle": [
                        "K"
                    ],
                    "last": "Fleischer",
                    "suffix": ""
                }
            ],
            "year": 2001,
            "venue": "SIAM Journal on Optimization",
            "volume": "12",
            "issn": "",
            "pages": "18--35",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "model . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 1 1.2 SIR model with treatment . . . . . . . . . . . . . . . . . . . . . . . . . . 2 1.3 Normalized equations . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 4 1.4 The human flux matrix . . . . . . . . . . . . . . . . . . . . . . . . . . . mobility network and epidemic parameters . . . . . . . . . . . . 9 2.2 Drug distribution networks . . . . . . . . . . . . . . . . . . . . . . . . . . 10 3 Heterogeneity in network-based distribution 14 3.1 The rate matrix \u03be sn . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 14 3.2 Supply patterns in random networks . . . . . . . . . . . . . . . . . . . . 15 3.2.1 Network pathways . . . . . . . . . . . . . . . . . . . . . . . . . . 15 3.2.2 Rate distribution P (\u03be) . . . . . . . . . . . . . . . . . . . . . . . . 18 3.2.3 Critical capacity C \u03b7 . . . . . . . . . . . . . . . . . . . . . . . . . .19 3.2.4 Mean supply time T . . . . . . . . . . . . . . . . . . . . . . . . 20 4 Extended testing 21 4.1 The effect of the therapeutic distribution source . . . . . . . . . . . . . . 21 4.2 The effect of disease parameters . . . . . . . . . . . . . . . . . . . . . . . 22 5 Optimized physical distribution 22 5.1 Overview . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . . 22 5.2 Maximum flow optimization . . . . . . . . . . . . . . . . . . . . . . . . . 25",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "10) the untreated individuals who are susceptible, infected or recovered, vs.S T , I T , R T (1.11)the treated individuals in each state. The possible transitions in each node are now driven by",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "The effect of the centralized distribution network B mn . We examined three constructions of B mn : Network 1 (Diffusive), Network 2 (Directed) and Network 3 (Balanced). (a) -(b) Res and the Gini coefficient vs. C for all networks. As expected Network 3 exhibits the highest efficiency and equality (brown) as it is specifically designed to generate an even spread of the therapeutic. Centralized mitigation (green), however, remains the optimal strategy. (c) -(e) P (\u03be) vs. \u03be for all three networks. We find that \u03be sn is a determining factor of efficiency, with the high rate nodes having the highest probability of being saved. Shades of blue represent increasing capacities: Network 1 -C = 0.01, 0.1, 0.3, 1.0, 3.0, 10; Network 2 -C = 0.002, 0.02, 0.2, 2.0, 20, 2000; Network 3 -C = 0.001, 0.01, 0.03, 0.06, 0.1, 0.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": "41) with \u03c6 = 1/(\u03bd \u2212 1), as before. Equation (3.41) is precisely the prediction of Eq. (10) in the main text. effect of the therapeutic distribution source",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "The effect of the therapeutic distribution source s. (a) Simulating an outbreak at o =BJM (red star) we selected 9 different sources s for the therapeutic distribution (blue dots). (b) The efficiency Res vs. the rate \u03be os between the outbreak and the therapeutic source nodes (C = 0.2). (c) -(k) For each of the 9 sources we tested Res and the Gini coefficient under centralized mitigation (yellow) and compared to decentralized mitigation (green).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "\u2264 F nm (t) \u2264 C nm For all n, m = 1, . . . , N (5.3) 0 \u2264 \u2212F n (t) \u2264 d n (t) For all n = 1, . . . , N, n = s. (5.4)",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": []
}