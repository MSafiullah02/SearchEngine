{
    "paper_id": "81c7ce2b4d434867bbec401c57a3438a06e609a6",
    "metadata": {
        "title": "A Poisson Kalman filter for disease surveillance",
        "authors": [
            {
                "first": "Donald",
                "middle": [],
                "last": "Ebeigbe",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "The Pennsylvania State Uni-versity",
                    "location": {
                        "settlement": "University Park",
                        "region": "PA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Tyrus",
                "middle": [],
                "last": "Berry",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "George Mason University",
                    "location": {
                        "settlement": "Fairfax",
                        "region": "VA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Steven",
                "middle": [
                    "J"
                ],
                "last": "Schiff",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "The Pennsylvania State Uni-versity",
                    "location": {
                        "settlement": "University Park",
                        "region": "PA",
                        "country": "USA"
                    }
                },
                "email": ""
            },
            {
                "first": "Timothy",
                "middle": [],
                "last": "Sauer",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "George Mason University",
                    "location": {
                        "settlement": "Fairfax",
                        "region": "VA",
                        "country": "USA"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "An optimal filter for Poisson observations is developed as a variant of the traditional Kalman filter. Poisson distributions are characteristic of infectious diseases, which model the number of patients recorded as presenting each day to a health care system. We develop both a linear and nonlinear (extended) filter. The methods are applied to a case study of neonatal sepsis and postinfectious hydrocephalus in Africa, using parameters estimated from publicly available data. Our approach is applicable to a broad range of disease dynamics, including both noncommunicable and the inherent nonlinearities of communicable infectious diseases and epidemics such as from COVID-19. * Contributed equally.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "There has been significant recent interest in the model-based control of disease, specifically using prevention and treatment as methods of control [1] [2] [3] [4] [5] . Such model-based frameworks have been instrumental in our understanding of the dynamics and control of infectious diseases [6] , and strategies for global public health policies [7] . Successful applications of mathematical modeling and control depend on accurate determination of system states, where data assimilation methods such as Kalman filters [8] play a crucial role in constraining the model with available data.",
            "cite_spans": [
                {
                    "start": 148,
                    "end": 151,
                    "text": "[1]",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 152,
                    "end": 155,
                    "text": "[2]",
                    "ref_id": null
                },
                {
                    "start": 156,
                    "end": 159,
                    "text": "[3]",
                    "ref_id": null
                },
                {
                    "start": 160,
                    "end": 163,
                    "text": "[4]",
                    "ref_id": null
                },
                {
                    "start": 164,
                    "end": 167,
                    "text": "[5]",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 293,
                    "end": 296,
                    "text": "[6]",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 348,
                    "end": 351,
                    "text": "[7]",
                    "ref_id": "BIBREF6"
                },
                {
                    "start": 521,
                    "end": 524,
                    "text": "[8]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "Although Kalman filters typically assume Gaussian distributed observations that have direct functional relationships to the state variables, this is unlikely to be suitable for diseases with low rates of occurrence, as is the case in the early or late stages of the spread of most infectious diseases. While a Poisson distribution with a large rate constant can be well approximated by a Gaussian of the same mean and variance, the approximation breaks down when the rates of occurrences are much smaller [9] . Even more importantly, the variance of a Poisson observation changes along with its mean, whereas the mean and variance of a Gaussian are decoupled, and often the variance is assumed to be constant (or at least unrelated to the mean) in the Kalman filtering context.",
            "cite_spans": [
                {
                    "start": 505,
                    "end": 508,
                    "text": "[9]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "In this article, we argue that the standard application of Kalman filtering methods is poorly matched to data available during disease surveillance. In particular, the assumption of Gaussian noise-perturbed observations is a clear source of inaccuracy when used to model the arrival of patients at medical facilities. We develop a variant of the Kalman filter that assumes Poisson observations, and show how to modify the traditional Kalman equations to produce an optimal filter.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "For one-dimensional systems, an optimal filter has been previously designed for Poisson observations [10] , but has not been generalized to multivariate systems. Moreover, in order to summarize the true distribution of the state x k at time step k given the Poisson observations in [10] , a very large number of variables needed to be stored and recalculated at each step. In fact, the number of variables needed also grows very quickly with k (compared to the Kalman filter where the number of variables tracked is constant in k). Instead, we propose a filter which is very similar to the Kalman filter, but is adapted to the unique statistics of the Poisson observations. A related linear filter called the Generalized Kalman Filter (GKF) was introduced in [11] , which employed a fixed observation noise covariance matrix that is optimal among all linear filters that are fixed in time. In contrast, we will derive the optimal time-varying linear filter, and we will use the state estimate to update the observation noise covariance matrix dynamically.",
            "cite_spans": [
                {
                    "start": 101,
                    "end": 105,
                    "text": "[10]",
                    "ref_id": null
                },
                {
                    "start": 282,
                    "end": 286,
                    "text": "[10]",
                    "ref_id": null
                },
                {
                    "start": 759,
                    "end": 763,
                    "text": "[11]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "In Section II, we first show that by choosing an appropriate observation map, the standard Kalman filter gives an unbiased estimator for Poisson observations. This justifies using a Kalman filter in the disease modeling context, as long as the observation map is well chosen. We then show how to modify the Kalman equations to produce an optimal linear filter in the sense of minimizing the expected squared errors. We prove the optimality of this choice in Appendix A. While the optimal filter nominally requires knowledge of the true state, we show empirically that using the filter estimate of the state gives near-optimal performance. We call this approach the Poisson Kalman Filter (PKF).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "Recently, Li et al. [12] assimilate Poisson observations to carry out modeling of the coronavirus (COVID-19) epidemic. Their modifications to the traditional Kalman filter are in the same spirit to those proposed here, in that the observation noise covariance matrix V is designed to vary with the data. In this article, we derive the Kalman equations that lead to the optimal linear filter, and prove that the optimal choice for linear dynamics is to set V k to vary proportionally to the number of predicted cases. Nonlinear extensions of the Kalman filter follow standard strategies of generalizing the linear formulas (e.g. the Extended and Ensemble Kalman filters [13] ). We develop a nonlinear Extended PKF (EPKF) in Section V suitable for contagious infectious disease.",
            "cite_spans": [
                {
                    "start": 20,
                    "end": 24,
                    "text": "[12]",
                    "ref_id": null
                },
                {
                    "start": 669,
                    "end": 673,
                    "text": "[13]",
                    "ref_id": "BIBREF12"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "These studies start from compartmental models which are built on the standard SIR model and its variants. The SIR model tracks three variables which represent three populations, susceptible (S), infected (I), and recovered (R).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "A key feature for communicable disease is that the rate of increase of the infected is proportional to the product of the susceptible and infected populations, SI, a nonlinear interaction term that is motivated by the contagious nature of the diseases being modeled.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "In Section III below, we introduce an SIR model for noncommunicable diseases and show how to apply the Poisson Kalman filter to track the model from example data from two endemic diseases affecting childhood health in Africa -neonatal sepsis (NS) and postinfectious hydrocephalus (PIH) -in Sections III and IV. Although many of these infections are noncommunicable, acquired during birth or from the environment afterwards, there is new evidence supporting a role for communicable viruses [14] . To our knowledge, there is no existing computational framework that embodies the interdependent dynamics of NS and PIH. We show how the use of the PKF and EPKF can fill this need.",
            "cite_spans": [
                {
                    "start": 489,
                    "end": 493,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "We discuss future directions both for more detailed study of NS and PIH, and for further extensions of the filtering for infectious disease epidemics, in Section VI.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "I. INTRODUCTION"
        },
        {
            "text": "Estimating the current state of a dynamical system is a critical challenge when applying compartmental modeling to disease forecasting and control. Data assimilation is a method of estimating the state from a time series of noisy observations. In particular, for a linear system x k+1 = f ( x k ), the Kalman filter [15] gives the optimal state estimate (minimal variance) and also quantifies the uncertainty in the estimate. However, the Kalman filter was designed for engineering applications where the observations are assumed to have a direct functional relationship to the state variables, except perturbed by Gaussian noise.",
            "cite_spans": [
                {
                    "start": 316,
                    "end": 320,
                    "text": "[15]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "There are at least three reasons why this assumption fails for typical disease surveillance. First, counts of individuals with a disease are by definition nonnegative, contradicting the Gaussian model for uncertainty. Second, the size of the Gaussian noise is decoupled from the population count, being the same magnitude for low populations as for large populations. Finally, in order for the population to be the observed variable, one would have to make a survey, at each time step k, of the entire population to directly observe I k , the number of infected at time k. Since this is an unrealistic proposal, the filtering method needs to be adapted to the type of observations that are practical for disease surveillance. We will refer to this modification of the Kalman filter by the name Poisson Kalman Filter (PKF), which we show to be unbiased and optimal among all linear filters.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "We operate under that assumption that the disease population cannot be measured directly. In fact, a reasonable model for observations of disease cases, for example those presenting at a hospital, is a Poisson process, whose rate is proportional to the infected population. Assume that at time step k, the number of new infected patients I k will be approximated by a Poisson random variable with rate \u03bb k,I = c I I k , where c I is a proportionality constant.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "In a typical filtering problem we would assume that we are given direct observations, y k , of the form B x k + \u03bd k where \u03bd k are random variables representing observation noise. However, in the Poisson observation context, we instead observe a pair of independent Poisson random variables with rates given by the components of B x k . We will denote this type of observation by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "To be more precise we assume that, conditional to B x k , the components ( y k ) i are independent Poisson random variables with density function,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "The above conditional density makes it clear that y k and x k are not independent.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "In the case of direct observations, one typically assumes that y k splits into a sum of two terms, the first of which has deterministic dependence on x k and the second of which is independent of x k . However, for Poisson observations this splitting is not possible. Despite this irreconcilable dependence between y and x the following Lemma shows that if we appropriately center y, namely y \u2212 E[ y | x], the result is not correlated with x.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "Lemma II.1. Let \u03bb be an arbitrary random variable and let z be a Poisson random variable with rate \u03bb so that the conditional density of z is P",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "We first apply the law of total expectation to compute",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "since \u03bb is the expected value of a Poisson random variable with known rate \u03bb. We then apply the law of total expectation,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "where the second equality follows from the inner expectation being conditioned on \u03bb and the third follows from the linearity of the expectation.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "Lemma II.1 turns out to be the key to deriving an optimal linear filter for Poisson observations. While Poisson observations are a more realistic model for the type of data available in disease modeling, we now must design a filter which can assimilate this data and produce estimates of the state variable x k .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "II. DATA ASSIMILATION FROM POISSON OBSERVATIONS"
        },
        {
            "text": "A linear filter produces an estimatex k of the true state x k of the form,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "where A 1 , A 2 are matrices. This is a more restricted class of filters, but we will be able to show that our filter is unbiased, meaning E[x k ] = x k , and is the optimal linear filter in the sense of giving the minimal squared error.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "The PKF assumes a model of the form,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "where b k is a known deterministic forcing term, and \u03c9 k is dynamical noise with mean zero (E[ \u03c9 k ] = 0) and known covariance matrix, E[ \u03c9 k \u03c9 \u22a4 k ] = W . We also assume that the \u03c9 k are independent of x k , y k , and all other \u03c9 \u2113 for \u2113 = k. The PKF also assumes that model, F , and observation matrices, B, are known. We note that the dynamics F and observation matrix B can also be allowed to change at each step (nonautonomous), but to simplify the notation we assume they are constant.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "Like the standard Kalman filter, the PKF is a two-step filter, meaning that it breaks down the estimation ofx + k fromx + k\u22121 into a forecast step and an assimilation step. In the forecast step we apply the model to our current estimatex + k\u22121 to produce the forecast,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "and in the assimilation step we assimilate the new observation by,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "It is easy to see that this is a linear filter with A 1 = (I \u2212 K k B)F and A 2 = K k . The filter is defined by the choice of the matrix K k which is called the gain matrix. Our first result is that any filter of the form (4) is unbiased.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "Theorem II.2. Assume that E[x + 0 ] = x 0 , then for any choice of gain matrices K k the two step filter defined by (3) and (4) is unbiased, meaning E[x + k ] = x k . The proof of Theorem II.2 is straightforward and can be found in Appendix A.1. The gain matrix is determined by a secondary set of computations which track the covariance matrix, P + k for the estimatex + k . The covariance matrix is also evolved according to a two step evolution starting with a forecast step,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "which allows us to calculate the optimal gain matrix,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "and then we can complete the assimilation step",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "While it may seem that P k is only really necessary in order to compute the gain matrix K k , the matrix P k also gives an error estimate for the state estimate. The final component that is required is the V k matrix in the formula for the optimal gain. In the standard Kalman filter, V k is the covariance matrix for the observation noise. However, in the PKF the variance of the observations is equal to B x k (meaning var(( y k ) i ) = (B x k ) i ). So intuitively, we would expect to use V k = diag(B x k ). The next theorem states that this yields the optimal linear filter.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "Theorem II.3. Among all linear filters, the filter given by (3) and (4) with gain matrix K k given by (5) where V k = diag(Bx k ) is optimal in the sense of minimal sum of squared errors. In other words,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "The proof of Theorem II.3 is closely related to Lemma II.1 and can be found in A.2. Unfortunately, the optimal filter is not accessible since it requires access to the true state x k in order to define the optimal gain matrix. Instead, sincex k is an unbiased estimator (for any gain matrix) we approximate the optimal filter by using V k = diag(Bx \u2212 k ). We call this approximation the Poisson Kalman Filter (PKF).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. The Poisson Kalman Filter (PKF)"
        },
        {
            "text": "The discrete-time Poisson Kalman filter (PKF) algorithm is given below. In order to connect with the potential optimal control applications we include the control term G k\u22121 u k\u22121 . If there is no control this term can be dropped. We also allow all the matrices to vary with time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. PKF Equations"
        },
        {
            "text": "1 Dynamical system",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. PKF Equations"
        },
        {
            "text": "where \u03b4 k\u2212j is the Kronecker delta function, such that \u03b4 k\u2212j = 1 if k = j, and \u03b4 k\u2212j = 0 if k = j. When the state is close to zero the Gaussian noise may move the system into negative values, so at each step we take the maximum of each component and zero. Note that diag(B k x k ) is the true variance of the Poisson observation y k . However, in the filter below we set V k = diag(B kx \u2212 k ) since this is the best available estimate. We now summarize the steps required to obtain the PKF estimates.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. PKF Equations"
        },
        {
            "text": "3 Prior estimation (forecast step)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Initializationx"
        },
        {
            "text": "4 Posterior estimation (assimilation step)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Initializationx"
        },
        {
            "text": "Notice that before the diagonal matrix V k is formed, we first take the maximum of the diagonal entries and a constant \u03b4. This is necessary because when the diagonal entries of V k are too close to zero the filter can become numerically unstable. The constant \u03b4 should be chosen to be small relative to the average value of the B k x k , and in all our numerical experiments we set \u03b4 = 0.1. Finally, we note that in practice the initial estimates x + 0 and P + 0 are often not available. However, the effect of these initial estimates on the accuracy of the state estimates decays to zero exponentially as k \u2192 \u221e, and often P + 0 is simply chosen to be a multiple of the identity matrix.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Initializationx"
        },
        {
            "text": "Severe systemic bacterial infection in the neonatal period, neonatal sepsis (NS), accounts for an estimated 680,000 -750,000 neonatal deaths per year worldwide [16] -more than childhood deaths from malaria and HIV combined [17] . The most common brain disorder in childhood is hydrocephalus, and the largest single cause of hydrocephalus in the world is as a sequelae of NS [18] , accounting for an estimated 160,000 yearly cases of postinfectious hydrocephalus (PIH) in infancy [19] . The microbial agents responsible for this enormous loss of human life have been poorly characterized [20] , although next-generation molecular methods show promise to improve the identification of causal agents [14] . Both NS and PIH occur disproportionately in the developing world, and most of the PIH cases will die in childhood without adequate treatment, substantially compounding the effective mortality due to NS and its tremendous burdens on societies [21, 22] .",
            "cite_spans": [
                {
                    "start": 160,
                    "end": 164,
                    "text": "[16]",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 223,
                    "end": 227,
                    "text": "[17]",
                    "ref_id": null
                },
                {
                    "start": 374,
                    "end": 378,
                    "text": "[18]",
                    "ref_id": null
                },
                {
                    "start": 479,
                    "end": 483,
                    "text": "[19]",
                    "ref_id": null
                },
                {
                    "start": 587,
                    "end": 591,
                    "text": "[20]",
                    "ref_id": null
                },
                {
                    "start": 697,
                    "end": 701,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 946,
                    "end": 950,
                    "text": "[21,",
                    "ref_id": null
                },
                {
                    "start": 951,
                    "end": 954,
                    "text": "22]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "III. AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION"
        },
        {
            "text": "We expect a natural application of the PKF will be to SIR modeling. Consider a discrete-time SIR model for neonatal sepsis with three classes: S k is the susceptible population at time k, I k the infected population, and R k the recovered population. (Later, in Section IV, the model will be expanded to include a postinfectious hydrocephalic class.) Since there are many unmodeled factors which affect the adult population, and the feedback of neonatal infection into the birth rate takes place on a relatively long time scale, we do not include the adult population in the model. Thus, S k , I k , R k represent neonatal and infant populations. Since we are modeling neonatal infections, the susceptible and infected classes are neonatal and, S k + I k represents the neonatal population. The recovered class, R k , will track those that recover from sepsis for a period of time that can be chosen by the modeler as will be described below.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION"
        },
        {
            "text": "Modeling only the neonatal/infant populations requires several deviations from the standard SIR model. First, the birth rate is not proportional to any of the model populations, and is instead a forcing, b k , which introduces new population into the susceptible class at each time step. Moreover, there are now three ways to leave the susceptible class: (1) a neonatal mortality rate d, due to factors other than infection (this will affect the two neonatal classes, S k and I k ), (2) an infection rate a, which feeds into the infected class, and (3) a 'grow-up' rate g S , which signifies no longer being susceptible to neonatal infection. The model is:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION"
        },
        {
            "text": "Notice that the g S rate removes neonates from the model entirely, so effectively the grow-up rate g S will control the length of time that we consider to be 'neonatal'. Given a time period T S for susceptibility, we set g S = 1/T S , which makes the simplifying assumption that the susceptible population is always equally distributed across different ages. The grow-up rate g R controls the length of time that infants in the recovered class are tracked, so that g R = 1/T R where T R is the amount of time we track the recovered class. The two parameters g S , g R control the two time scales for susceptibility and recovery (which will become more significant later when we consider the longer time-scale possibility of developing hydrocephalus), and c is the rate of recovery from infection. With the state variable x k = (S k , I k , R k ) \u22a4 , the matrix form of the evolution is",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION"
        },
        {
            "text": "If the birth rate is assumed to be constant b k \u2261 b, the steady state populations can be explicitly solved. Setting S \u221e \u2261 S k+1 = S k in susceptible population in (14) we can solve for S \u221e = b d+a+gS . Substituting this for S \u221e = S k in (15) and setting I \u221e \u2261 I k+1 = I k in (15) we can solve for I \u221e and similarly we can solve for R \u221e giving steady state solutions,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION"
        },
        {
            "text": "These steady state solutions have important public health implications on the time scale where the birth rate is approximately constant. First, S \u221e determines the scale of public health improvement if susceptibility can be reduced (prevention). Second, I \u221e determines the resources needed to meet the average infection burden.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "III. AN SIR MODEL FOR NONCONTAGIOUS DISEASE IN A RESTRICTED POPULATION"
        },
        {
            "text": "Publicly available statistics can be used to approximate parameters for NS in Uganda during the time frame 2014-2015. We consider a discrete time step (the time between steps k and k + 1) of one day and a neonatal period of T S = 28 days. From [23] we find a 2015 birth rate of 1665000 per year for Uganda, which for a daily model yields b \u2248 4562. Using 2014 statistics for neonatal sepsis in sub-Saharan Africa, we find a neonatal mortality rate of 29 per 1000 with 17%-29% attributable to sepsis [22] . For simplicity we assume that the neonatal mortality rate of 29 per 1000 can be divided into 7 attributable to sepsis (\u2248 23% of neonatal mortality, the midpoint of the 17%-29% range) and 22 attributable to other causes.",
            "cite_spans": [
                {
                    "start": 244,
                    "end": 248,
                    "text": "[23]",
                    "ref_id": null
                },
                {
                    "start": 498,
                    "end": 502,
                    "text": "[22]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "A. Case Study: Neonatal sepsis in Uganda"
        },
        {
            "text": "Since we assume the neonatal period is T S days, we convert the neonatal mortality rate due to factors other than sepsis into a daily rate by setting d = 22/1000/T S . The daily neonatal mortality rate due to sepsis is then 7/1000/T S , however this is not d I because the d I variable applies only to the infected class (whereas d applies to both the susceptible and infected classes, and thus is a rate for the entire neonatal population). That is, d I represents the daily rate of mortality due to sepsis as a percentage of the population that has sepsis (rather than 7/1000/T S which is the daily rate as a percentage of the entire population). So before we can determine d I , we first must determine the infection rate a. Infection rate estimates can vary widely based on methodology ( [22] quotes a range of 5.5 -170 per 1000 live births). Based on the estimate of one of the authors (SJS) who is a physician conducting medical research on these infants in Uganda, there is a range of 30 -60 per 1000 live births in that nation. Conservatively assuming 30 per 1000, we take a = 30/1000/T S as a daily rate of infection. Now the constant d I can be determined. We stated above that 7 of the 1000 will die from sepsis, meaning that 7 of the 30 who get sepsis will die from it. Thus, we find that d I = 7/30/T S is the daily rate of death due to sepsis among those that already have sepsis. This immediately gives us the recovery rate: 7 of the 30 who get sepsis will die from sepsis, and 30(22/1000) will die from non-sepsis causes. The remaining 30 \u2212 7 \u2212 30(22/1000) = 22.34 will recover, establishing the recovery rate c = 22.34/30/T S . Note that",
            "cite_spans": [
                {
                    "start": 792,
                    "end": 796,
                    "text": "[22]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "A. Case Study: Neonatal sepsis in Uganda"
        },
        {
            "text": "so in fact c is chosen to insure that all of the infected classes leave within the neonatal day period.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Case Study: Neonatal sepsis in Uganda"
        },
        {
            "text": "The infant mortality rate m 2 , which covers mortality of the first year after birth, infancy or T i , can also be derived from data. Consider a tracking time for the recovered population of this first year minus the neonatal period, T R = T i \u2212 T S (we assume that the recovered population is entirely outside the 28 day neonatal period). For the death rate in the recovered class we start with the infant mortality rate of 77 per 1000 (in the first year [22] ) and subtract the 29 per 1000 neonatal mortality rate to find d R = 48/1000/T R . We summarize the inputs to the model in Fig. 1 then compute the parameters d, d I , d R , c, T R , g S , g R by",
            "cite_spans": [
                {
                    "start": 456,
                    "end": 460,
                    "text": "[22]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 584,
                    "end": 590,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "A. Case Study: Neonatal sepsis in Uganda"
        },
        {
            "text": "where s is the fraction of neonatal mortality due to sepsis. The steady state values for the model with these parameters are S \u221e = 121422, I \u221e = 3643, and R \u221e = 31152. We note that the steady state number of infected shows consistency with reported values [23] . The recovered class is now susceptible to developing PIH.",
            "cite_spans": [
                {
                    "start": 256,
                    "end": 260,
                    "text": "[23]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "A. Case Study: Neonatal sepsis in Uganda"
        },
        {
            "text": "We now turn to a model that specifically links neonatal infection and postinfectious hydrocephalus (PIH). The essential idea is that those that have recovered from sepsis are now susceptible to developing hydrocephalus. The constant h represents the rate at which recovered infants move from the recovered class R k to a new hydrocephalic class H k , leading to the equations",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. SIRH: MODELING THE HYDROCEPHALIC POPULATION"
        },
        {
            "text": "The hydrocephalic class is subject to an additional mortality rate due to hydrocephalus, d H , which requires recalibrating the recovered rate, d R , so that it does not include deaths due to hydrocephalus. We set d R = (m 2 \u2212m 1 \u2212pd H T R )/T R where m 2 is the infant mortality rate, m 1 is the neonatal mortality rate, p is the rate of PIH in the total population under consideration (discussed in Section IV A below), and d H T R is the rate of death of those who develop PIH during infancy (d H is the daily rate and T R is the remainder of the infancy period). Finally, we note that the steady state value of the recovered class changes from the SIR model due to the rate h, and the new steady state along with the hydrocephalic steady state are given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. SIRH: MODELING THE HYDROCEPHALIC POPULATION"
        },
        {
            "text": "We now return to our case study of modeling PIH in Uganda. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "IV. SIRH: MODELING THE HYDROCEPHALIC POPULATION"
        },
        {
            "text": "The first parameter to consider is h, the rate of developing postinfectious hydrocephalus (PIH). In [22] it is reported that the incidence of PIH is 3-5 per 1000 live births. We will take the low estimate of 3 per 1000 setting p = 3/1000, since it will be shown to be more consistent with other statistics below. Recall that above we estimated that for 1000 live births there are 30 cases of sepsis, and 22.34 of those recover. Since only recovered sepsis cases can develop PIH, this implies a rate of developing hydrocephalus of h = 3/22.34/T R .",
            "cite_spans": [
                {
                    "start": 100,
                    "end": 104,
                    "text": "[22]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "A. Case Study: Infant hydrocephalus in Uganda"
        },
        {
            "text": "The death rate due to hydrocephalus is highly dependent upon treatment. The untreated death rate is estimated at 50%, while treatment can reduce this to 25%. We assume an overall death rate of 33% [24] and we set",
            "cite_spans": [
                {
                    "start": 197,
                    "end": 201,
                    "text": "[24]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "A. Case Study: Infant hydrocephalus in Uganda"
        },
        {
            "text": "Finally, we recalibrate the death rate for those recovering from sepsis by removing the deaths due to hydrocephalus (since those are accounted for in the H k variable). So we set",
            "cite_spans": [],
            "ref_spans": [],
            "section": "A. Case Study: Infant hydrocephalus in Uganda"
        },
        {
            "text": "The results shown in Fig. 2 predict a steady state of approximately 10000 ongoing cases of PIH with an annual PIH incidence of approximately 4000 per year (365 * h * R \u221e ), and annual deaths due to PIH of approximately 3300, consistent with existing estimates [21] .",
            "cite_spans": [
                {
                    "start": 260,
                    "end": 264,
                    "text": "[21]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 21,
                    "end": 27,
                    "text": "Fig. 2",
                    "ref_id": "FIGREF1"
                }
            ],
            "section": "A. Case Study: Infant hydrocephalus in Uganda"
        },
        {
            "text": "Using the SIRH model described in Section IV, we evaluate the performance of the PKF when the observations follow a random Poisson distribution with known rates \u03bb k,I = c I I k and \u03bb k,H = c H H k , which represent the number of infants with sepsis and the number of infants with hydrocephalus that show up at the hospital. Our observations can be written as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. PKF Simulations"
        },
        {
            "text": "and we start the system at the equilibrium values. The simulation in Fig. 3 was run with system noise W = diag(144, 1, 1, 10) \u00d7 10 7 and the constant daily birth rate b = 4562, while setting the sepsis and hydrocephalus proportionality constants as c I = 0.2/T S and c H = 0.6/T R respectively. The idea behind these values is that if 20% of total sepsis cases seek care over the entire T S period of sepsis susceptibility, then the daily rate of arrivals would be 0.2/T S multiplied by the number of true sepsis case (20% was chosen purely for purposes of simulation). In Fig. 3 we see that the PKF (red, dashed curves) gave good estimates of the true susceptible, infected, recovered, and hydrocephalic populations using only random Poisson distributed observations of the sepsis and hydrocephalic populations. Fig. 3 also compares the PKF to a Kalman filter (blue, dotted curves) which was given the optimal fixed observation noise covariance matrix, V const = diag(Bx) where x is the time average of the state variables. The disadvantage of the fixed gain is that when the number of infected or hydrocephalic is large the variance of the observations will be larger than the average value. This means that the Kalman filter will underestimate the observation variance and use an oversized gain. This is shown in Fig. 3 where the Kalman filter estimates closely follows the observations when the number of infected or hydrocephalic are large. The PKF dynamically adjusts the observation covariance matrix based on the state estimate in order to prevent this. This is further shown in Fig. 5 which compares the root mean squared error (RMSE) for the PKF and the Kalman filter for various levels of system noise. Fig. 5 also compares the PKF, which uses the filter estimate to determine V k , to an oracle PKF which uses the true state for V k and we see that their performance is almost identical even at high noise levels.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 69,
                    "end": 75,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 573,
                    "end": 579,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 813,
                    "end": 819,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1316,
                    "end": 1322,
                    "text": "Fig. 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 1587,
                    "end": 1593,
                    "text": "Fig. 5",
                    "ref_id": null
                },
                {
                    "start": 1714,
                    "end": 1720,
                    "text": "Fig. 5",
                    "ref_id": null
                }
            ],
            "section": "B. PKF Simulations"
        },
        {
            "text": "Finally, we note that the PKF has the largest advantage at high noise levels. This is because the SIRH system is a stable linear system, so that noise is the only unstable component of the dynamics. In the absence of noise, no filter would be necessary since all trajectories would converge to the equilibrium regardless of observations. This suggests that a generalized PKF (such as the Extended PKF considered below) would have an advantage for nonlinear dynamics with unstable directions even in the absence of system noise.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "B. PKF Simulations"
        },
        {
            "text": "So far we have considered a linear model for NS, which is sufficient for noncontagious infections. However, contagious disease models typically contain an nonlinearity that models the contagious spread. In order to broaden the applicability of the PKF we now show that it also offers improvements for these nonlinear models by using a standard approach to extend the Kalman equations to nonlinear dynamics. Moreover, because there are potential mechanisms for contagious infections contributing to NS [14] , modeling these infections requires a nonlinear system. As in the classical SIR model we assume that the contagious spread will be simultaneously proportional to the both the number of susceptibles and the number of infected and so we model the number of contagious cases at time k as \u03b2S k I k , where Comparison of the RMSE of the PKF (red, optimal variable gain) and the Kalman filter (blue, optimal fixed gain) as function of the system noise. We also compare to an oracle PKF (black, dashed) which is given the optimal choice of V k = diag(B x k ). System noise is quantified as a multiple of the base noise level W . The RMSE is averaged over 10 6 filter steps.",
            "cite_spans": [
                {
                    "start": 501,
                    "end": 505,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "\u03b2 is infectivity. Introducing this term to the SIRH model we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "The state of the nonlinear model is x k+1 = f k ( x k ) where x k = (S k , I k , R k , H k ). When the birth rate is constant b k = b we can write f k = f and the system can be considered autonomous, but we also allow nonautonomous dynamics as long as each f k is known. This model is of significant interest since estimating the a and \u03b2 parameters from data would help determine the role of contagious spread in NS.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "A standard method for lifting the Kalman filter to the nonlinear setting is the Extended Kalman Filter (EKF) [25] . The EKF uses the nonlinear dynamics to produce the forecast x \u2212 k+1 = f k (x + k ), and a linear approximation to the dynamics is used for forecasting the covariance matrix P \u2212 k+1 = F k P + k F \u22a4 k + W . To define F k the EKF linearizes the dynamics around the current state estimate, setting F k = Df k (x + k ). This approximates the nonlinear dynamics as a nonautonomous linear system for the purposes of forecasting the covariance estimates. In the example below we apply the EKF using",
            "cite_spans": [
                {
                    "start": 109,
                    "end": 113,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "Since the PKF is also based on the Kalman equations, we can use this same idea to extend the PKF to nonlinear systems which we call the Extended PKF (EPFK). In Fig. 6 we simulate the system (23) with \u03b2 = 10 \u22126 initialized at the noncontagious equilibrium found in Section IV (all other parameters are the same as in Section IV). This simulates the introduction of a contagious source of disease to a system that had stabilized at the noncontagious equilibrium. To demonstrate the advantage of the EPKF over the non-Poisson version, we assume that the EKF is given the optimal fixed gain for the noncontagious equilibrium. Fig. 6 shows that as the number of infected and hydrocephalic cases increase the EKF estimate becomes very noisy, since it is underestimating the observation variance and as a result follows the observations too closely. This shows how the EPKF is able to automatically adapt to the new equilibrium.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 160,
                    "end": 166,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 622,
                    "end": 628,
                    "text": "Fig. 6",
                    "ref_id": "FIGREF5"
                }
            ],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "We also compare the EPKF to the standard EKF using the optimal fixed gain for the contagious equilibrium, starting from the contagious equilibrium. Fig. 7 shows that the EPKF has the largest advantage at high system noise levels (as in Fig. 5 ) due to the absence of unstable directions in the deterministic dynamics near equilibrium. This suggests that the EPKF would have an even more significant advantage for chaotic systems. Also, as in Fig. 5 , we compare the empirical EPKF, which uses the state estimate to determine the observation variance, to an oracle version of the EPKF that uses the true state to determine the observation variance, and again the performance is very similar.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 148,
                    "end": 154,
                    "text": "Fig. 7",
                    "ref_id": null
                },
                {
                    "start": 236,
                    "end": 242,
                    "text": "Fig. 5",
                    "ref_id": null
                },
                {
                    "start": 442,
                    "end": 448,
                    "text": "Fig. 5",
                    "ref_id": null
                }
            ],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "Finally, we note that two closely related alternative approaches to applying the Kalman filter to nonlinear dynamics are the Ensemble Kalman Filter (EnKF) [25] and Ensemble Adjustment Kalman Filter [26] . Both of these methods use an ensemble forecast instead of linearizing the dynamics to estimate P \u2212 k+1 . Since the EnKF and EAKF are also based on the Kalman formulas the PKF method can be applied just as easily to these methods.",
            "cite_spans": [
                {
                    "start": 155,
                    "end": 159,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                },
                {
                    "start": 198,
                    "end": 202,
                    "text": "[26]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "This approach is closely related to the recent work of [12] applied to COVID-19 with Poisson observations. There, an EAKF was used with a heuristically chosen observation covariance V k which was proportional to the square of the observations. In fact, [12] also suggested an alternative of using V k proportional to the observations. Our analysis of the PKF shows that in fact the optimal choice for linear dynamics is to set V k equal to the predicted observations, as we propose in the EPKF. In fact, our analysis of a nonlinear contagious model in this section suggests that [12] were very close to the optimal approach. 7 . Comparison of the RMSE of the EPKF (red, optimal variable gain) and the EKF (blue, optimal fixed gain) as function of the system noise. We also compare to an oracle EPKF (black, dashed) which is given the optimal choice of V k = diag(B x k ). System noise is quantified as a multiple of the base noise level W . The RMSE is averaged over 10 6 filter steps.",
            "cite_spans": [
                {
                    "start": 55,
                    "end": 59,
                    "text": "[12]",
                    "ref_id": null
                },
                {
                    "start": 253,
                    "end": 257,
                    "text": "[12]",
                    "ref_id": null
                },
                {
                    "start": 579,
                    "end": 583,
                    "text": "[12]",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 625,
                    "end": 626,
                    "text": "7",
                    "ref_id": null
                }
            ],
            "section": "V. AN EXTENDED POISSON KALMAN FILTER FOR CONTAGIOUS DISEASE"
        },
        {
            "text": "The mathematical methods of filtering and control originated with linear models, direct observations, and Gaussian noise. However, these assumption may not be appropriate in the context of disease modeling, where the observation of cases of communicable and noncommunicable disease often present as Poisson processes. Unfortunately, the customary Kalman filter is not well suited to assimilate such Poisson occurrences and estimate the true number of underlying cases. The Poisson Kalman Filter (PKF) is an optimal filter for such surveillance.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        },
        {
            "text": "The linear PKF is a very general filter suitable for a broad range of noncommunicable disease observations where the nonlinear interaction of susceptible and diseased individuals is not an inherent component of disease initiation (including noninfectious disease such as diabetes or stroke). We extended our findings to encompass the nonlinear interactions of susceptible and infected individuals typical of contagious disease through an extended PKF or EPKF.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        },
        {
            "text": "We also created, to our knowledge, the first SIRH compartmental model that can be used in the surveillance of neonatal sepsis and postinfectious hydrocephalus, endemic disease that causes tremendous numbers of yearly global deaths in the developing world. In particular, we incorporated both the noncommunicable and communicable dynamics that have been observed in these infant infections.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        },
        {
            "text": "Additionally, our case study of sepsis and hydrocephalus suggests many promising directions for future development. If a more careful tracking of cases is desired, the neonatal and infancy periods can be segmented in to multiple stages. For example, it is well known that the infections that are acquired perinatally from the mother, so called early onset sepsis, are manifest within the days of the first week of life. Infections during the subsequent weeks of the neonatal period (first 4 weeks) are environmentally acquired and are typically a very different spectrum of organisms. Therefore S (0i) could represent susceptible at (0 \u2212 i)-days after birth, and S (ij) could represent susceptibles from (i \u2212 j)-days after birth, with varying rates and risks from sepsis at different stages of development. Another critical factor in sepsis and hydrocephalus cases is environmental variables such as rainfall [27] , which suggests that a full spatiotemporal model will be necessary to more fully represent these dynamics. Recent findings [14] demonstrate that more than one infection (co-infection) can be found in some of these infants -perhaps even a mixture of noncommunicable bacteria and communicable viruses -demonstrating that a mixed linear and nonlinear model would be required to represent such co-infections. A spatiotemporal model would allow the optimal control to consider multiple methods of control and determine ideal locations and times to apply each.",
            "cite_spans": [
                {
                    "start": 909,
                    "end": 913,
                    "text": "[27]",
                    "ref_id": null
                },
                {
                    "start": 1038,
                    "end": 1042,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                }
            ],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        },
        {
            "text": "The recent coronavirus (COVID-19) epidemic is one where Poisson dynamics are required in the modeling and data assimilation [12] . In this article, we derive the Kalman equations that lead to the optimal linear filter, and propose that the optimal choice is to set the observed covariance equal to the predicted observations as proposed in the nonlinear EPKF.",
            "cite_spans": [
                {
                    "start": 124,
                    "end": 128,
                    "text": "[12]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "VI. CONCLUSION"
        },
        {
            "text": "The measurement equation of a linear stochastic discrete-time dynamic system with indirect measurements of the state is given as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "where x k \u2208 R n , y k \u2208 R m are the state vector and measurement vector respectively, and B \u2208 R m\u00d7n is a known deterministic matrix. The measurement variable z k \u2208 R m follows a random Poisson distribution",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "where the rate \u03bb k = Bx k \u2265 0. We note that the positive real rate \u03bb k equals the expected value E[z k ] and variance Var(z k ) such that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "In our case, we assume that the state x is non-negative. We also assume that each Poisson random variable (z k ) i has a rate that is only dependent on the corresponding state (x k ) i , such that E[(z k ) i ] = c i (x k ) i where c i \u2208 R + are known deterministic parameters. A linear recursive estimator can be written as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "where K k is the optimal gain matrix to be determined.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Theorem A.1. The estimator of (A4) is an unbiased estimator of x k ; that is,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Proof. Calculating the estimation error mean, we write",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "So since E[z k ] = Bx and inductively we assume E [\u01eb x,k\u22121 ] = 0, we have E[\u01eb x,k ] = 0. Therefore (A4) is an unbiased estimator. This property holds regardless of the value of the gain matrix K k . This implies that, on average, the state estimatex will be equal to the true state x, when measurements -that follow a Poisson distribution whose rate is dependent on the state -are taken.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Theorem A.2. Among all linear filters, the filter given by the linear estimator of A4 with gain matrix K k given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "is optimal in the sense of minimal sum of squared errors when V k = diag(Bx k ). In other words,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Proof. Using (A5), we solve for the estimation error covariance P k as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Since the estimation error at time k \u2212 1 given by \u01eb x,k\u22121 = x \u2212x k\u22121 is independent of the measurement z k at time k, we have",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "since the expected value E[\u01eb x,k\u22121 ] and E[z k \u2212 Bx] are both zero. More generally, when x is a random variable, \u01eb x,k\u22121 may not be independent of the measurement z k , however, the above expectation is still zero since,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "by the law of total expectation. Therefore, (A6) reduces to",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Using the fact that Bx = E[z k ], we rewrite (A7) as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Recall that for a random variable Y with mean E[Y ], the ith central moment of Y , which is written as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "equals its variance when i = 2 (see Chapter 2 of [25] ). Therefore,",
            "cite_spans": [
                {
                    "start": 49,
                    "end": 53,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "where V k \u2208 R m\u00d7m , which is written as V k = diag(Bx k ), is the covariance of z k . Substituting (A9) into (A8) gives",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "which is the recursive formula for determining the covariance of the least squares estimation error. We then minimize the sum of the estimation error variances at time k. From the cost function",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "we write",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Setting (A12) equal to zero to find the value of K k that minimizes J k ,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "This implies that the optimal gain matrix K k given by (A13) minimizes the sum of squared errors when V k = diag(Bx k ).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "We note that if all the states x are used to generate the output y, such that each state x i is used to generate its Poisson random measurement z i , then V k = diag([c 1 x 1 k , c 2 x 2 k , \u00b7 \u00b7 \u00b7 , c m x m k ]) where m = n. Since the true state x k is unavailable to the estimator, we replace x k withx k\u22121 . Therefore we have V k = diag([c 1x1 k\u22121 , c 2x2 k\u22121 , \u00b7 \u00b7 \u00b7 , c mxm k\u22121 ]) = diag(Bx k\u22121 ) which results in a suboptimal filter.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Recursive weighted least square estimator algorithm 1 Initializationx",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Recursive weighted least squares estimator with Poisson observations"
        },
        {
            "text": "Consider the linear stochastic discrete-time dynamic system with indirect measurements of the state given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Kalman filter based on WLS with Poisson observations"
        },
        {
            "text": "The expected value of both sides of (A17) is given as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Kalman filter based on WLS with Poisson observations"
        },
        {
            "text": "the covariance of x k is given as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Kalman filter based on WLS with Poisson observations"
        },
        {
            "text": "is uncorrelated with w k\u22121 . Therefore from (A21), (A14), (A15), and (A16), we replacex k\u22121 withx \u2212 k , we replace P k\u22121 with P \u2212 k , we replacex k withx + k , and we replace P k with P + k . We then get the Poisson Kalman filter equations for each time step k = 1, 2, \u00b7 \u00b7 \u00b7 :",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Kalman filter based on WLS with Poisson observations"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Proc. KSIAM",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Zaman",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [
                        "H"
                    ],
                    "last": "Kang",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [
                        "H"
                    ],
                    "last": "Jung",
                    "suffix": ""
                }
            ],
            "year": 2007,
            "venue": "",
            "volume": "3",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "2019 23rd International Conference on System Theory, Control and Computing (ICSTCC)",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                },
                {
                    "first": "Di",
                    "middle": [],
                    "last": "Giamberardino",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Iacoviello",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "733--738",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Modeling Infectious Diseases in Humans and Animals",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "J"
                    ],
                    "last": "Keeling",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Rohani",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Model-based geostatistics for global public health : methods and applications",
            "authors": [
                {
                    "first": "P",
                    "middle": [],
                    "last": "Diggle",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Neural Control Engineering: The Emerging Intersection Between Control Theory and Neuroscience",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "J"
                    ],
                    "last": "Schiff",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Computational neuroscience",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Submitted XX, XX",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "N"
                    ],
                    "last": "Paulson",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "The Lancet Infectious Diseases",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "C"
                    ],
                    "last": "Seale",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Blencowe",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "A"
                    ],
                    "last": "Manu",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Nair",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Bahl",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "A"
                    ],
                    "last": "Qazi",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "K"
                    ],
                    "last": "Zaidi",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "A"
                    ],
                    "last": "Berkley",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [
                        "N"
                    ],
                    "last": "Cousens",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "E"
                    ],
                    "last": "Lawn",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "",
            "volume": "14",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "10.1016/s1473-3099(14)70804-7"
                ]
            }
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "Optimal state estimation: Kalman, H infinity, and nonlinear approaches",
            "authors": [
                {
                    "first": "D",
                    "middle": [],
                    "last": "Simon",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "The neonatal time period, TS (28 days) \u2022 The infant time period, Ti (365 days) \u2022 Daily birth rate, b (4562) \u2022 Neonatal mortality rate, m1 (0.0029) \u2022 Percentage of neonatal mortality due to sepsis, s (0.23) \u2022 Infection rate, a (0.0030) \u2022 Infant mortality rate, m2 (0Left: Summary of the inputs to the model for infant sepsis. Right: Simulation of the model for infant sepsis in Uganda assuming constant birth rate and starting from the zero initial condition, (S0, I0, R0) = (0, 0, 0).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Left: Simulation of the SIRH model for Uganda starting from the zero initial condition. Right: Plot of the cumulative deaths from sepsis and hydrocephalus in the simulation. The horizontal lines are spaced so that their intersections with the curves are 365 days apart and indicated the cumulative deaths at times one year apart. The model predicts approximately 11000 annual deaths due to sepsis and approximately 3300 annual deaths due to PIH.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Comparison of the PKF (optimal variable gain) and the Kalman filter (optimal fixed gain) for the SIRH model with Poisson observations of the infected and hydrocephalic populations. The top and middle panels compare the true S, I, R and H values (black) to the PKF (red, dashed) and Kalman filter (blue, dotted) estimates. Infected and hydrocephalic also show the observations (green, circles) rescaled by dividing by the constants c1, c2 respectively. The bottom row of panels are expanded versions of the H plot in middle right panel, enlarged to show detail. When the number of cases is large, the KF estimate of H is very close to the observations, whereas the PKF adjusts to the larger observation variance and produces better estimates.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "The Poisson rates (black) of I and H and the observed case numbers (red, circles) from the Poisson distribution.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "FIG. 5. Comparison of the RMSE of the PKF (red, optimal variable gain) and the Kalman filter (blue, optimal fixed gain) as function of the system noise. We also compare to an oracle PKF (black, dashed) which is given the optimal choice of V k = diag(B x k ). System noise is quantified as a multiple of the base noise level W . The RMSE is averaged over 10 6 filter steps.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Comparison of the Extended PKF (optimal variable gain) and the Extended Kalman filter (optimal fixed gain for the noncontagious equilibrium) for the contagious SIRH model with Poisson observations of the infected and hydrocephalic populations. The top and middle panels compare the true S, I, R and H values (black) to the PKF (red, dashed) and Kalman filter (blue, dotted) estimates. Infected and hydrocephalic also show the observations (green, circles) rescaled by dividing by the constants c1, c2 respectively. The system is initialized at the noncontagious equilibrium and run forward with \u03b2 = 10 \u22126 simulating the introduction of a contagious source of infection which moves the system to a new equilibrium.",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": [
        {
            "text": "We are grateful to D. Simon, M. Ferrari and M. Norton for their helpful discussions. Funded by an NIH Director's Transformative Award 1R01AI145057.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "VII. ACKNOWLEDGEMENTS"
        },
        {
            "text": "We develop a recursive weighted least square (WLS) estimator by determining how to estimate a constant on the basis of several measurements that follow a Poisson distribution. We then use it as a basis for developing a discretetime Kalman filter that uses Poisson distributed measurements, which we accomplish by adapting the techniques used in developing a discrete-time Kalman filter [25] . We will remove the arrow symbols from vectors in this section to reduce the number of symbols in formulas.",
            "cite_spans": [
                {
                    "start": 386,
                    "end": 390,
                    "text": "[25]",
                    "ref_id": "BIBREF24"
                }
            ],
            "ref_spans": [],
            "section": "Appendix A: Optimal Linear Filter Derivation"
        }
    ]
}