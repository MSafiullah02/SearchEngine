{
    "paper_id": "51f587ecaa924f72dc7207c9790294284c21b338",
    "metadata": {
        "title": "MALVIRUS: an integrated web application for viral variant calling Associate Editor: XXXXXXX Received on XXXXX; revised on XXXXX; accepted on XXXXX",
        "authors": [
            {
                "first": "Simone",
                "middle": [],
                "last": "Ciccolella",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Milano-Bicocca",
                    "location": {
                        "postCode": "20126",
                        "settlement": "Milano",
                        "country": "Italy"
                    }
                },
                "email": ""
            },
            {
                "first": "Luca",
                "middle": [],
                "last": "Denti",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Milano-Bicocca",
                    "location": {
                        "postCode": "20126",
                        "settlement": "Milano",
                        "country": "Italy"
                    }
                },
                "email": ""
            },
            {
                "first": "Paola",
                "middle": [],
                "last": "Bonizzoni",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Milano-Bicocca",
                    "location": {
                        "postCode": "20126",
                        "settlement": "Milano",
                        "country": "Italy"
                    }
                },
                "email": ""
            },
            {
                "first": "Gianluca",
                "middle": [],
                "last": "Della Vedova",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Milano-Bicocca",
                    "location": {
                        "postCode": "20126",
                        "settlement": "Milano",
                        "country": "Italy"
                    }
                },
                "email": ""
            },
            {
                "first": "Yuri",
                "middle": [],
                "last": "Pirola",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Milano-Bicocca",
                    "location": {
                        "postCode": "20126",
                        "settlement": "Milano",
                        "country": "Italy"
                    }
                },
                "email": ""
            },
            {
                "first": "Marco",
                "middle": [],
                "last": "Previtali",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Milano-Bicocca",
                    "location": {
                        "postCode": "20126",
                        "settlement": "Milano",
                        "country": "Italy"
                    }
                },
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "Being able to efficiently call variants from the increasing amount of sequencing data daily produced from multiple viral strains is of the utmost importance, as demonstrated during the COVID-19 pandemic, in order to track the spread of the viral strains across the globe. Results: We present MALVIRUS, an easy-to-install and easy-to-use web application that assists users in (1) computing a variant catalog consisting in a set of population SNP loci from the population sequences and (2) efficiently calling variants of the catalog that are in the sample. Tests on Illumina and Nanopore samples prove the efficiency and the effectiveness of MALVIRUS in genotyping a SARS-CoV-2 strain sample with respect to GISAID data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "The SARS-CoV-2 pandemic has put the global health care services to the test and many researchers are racing to face its swift and rapid spread. Since the outbreak of the virus in China and in other European countries, several studies are using sequencing technologies to track the geographical origin of SARS-Cov-2 and to analyze the evolution of sequence variants (Gudbjartsson et al., 2020; B\u00f6hmer et al., 2020) . In this context, the availability of efficient approaches to analyze variations from the growing amount of sequencing data daily produced is of the utmost importance.",
            "cite_spans": [
                {
                    "start": 365,
                    "end": 392,
                    "text": "(Gudbjartsson et al., 2020;",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 393,
                    "end": 413,
                    "text": "B\u00f6hmer et al., 2020)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The typical pipelines for the analysis of variations within viral samples consists in aligning reads against a reference genome (Li, 2018) , then analyzing the alignments to discover the variants (McKenna et al., 2010; Wilm et al., 2012) . However, the increasing number of viral assemblies available in public databases such as GISAID (Shu and McCauley, 2017) , GenBank (Sayers et al., 2019) , and the COVID-19 Data Portal allows to build a complete catalog of variants of a viral population. Such a catalog can be used to reduce the complexity of comparative analysis of genetic variants of sequencing samples. Clearly, to this aim, it is crucial that users are assisted by an efficient and easy-to-use method for building and updating the catalog and for calling variants that are in this catalog. In this paper, we introduce MALVIRUS, a web application for quickly genotype newly sequenced viral strains, including but not limited to the SARS-CoV-2 strains. The application is distributed as a multi-platform Docker container and it can be easily accessed using any modern Internet browser. As use case, we show that MALVIRUS is accurate at genotyping a newly-sequenced SARS-CoV-2 strain on both short and long read data.",
            "cite_spans": [
                {
                    "start": 128,
                    "end": 138,
                    "text": "(Li, 2018)",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 196,
                    "end": 218,
                    "text": "(McKenna et al., 2010;",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 219,
                    "end": 237,
                    "text": "Wilm et al., 2012)",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 336,
                    "end": 360,
                    "text": "(Shu and McCauley, 2017)",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 371,
                    "end": 392,
                    "text": "(Sayers et al., 2019)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "To efficiently genotype a viral sample from an individual with respect to the current knowledge, we propose MALVIRUS a web application based on four state-of-the-art tools. The application is divided into two logically distinct modules: the creation of the catalog containing the SNP loci of the viral species under investigation and the variant calling from the read sample. Fig. 1 shows the MALVIRUS pipeline.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 376,
                    "end": 382,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Methods"
        },
        {
            "text": "The first module requires as input the reference genome of the species under investigation, the assemblies of a set of strains of that species, and, if available, the annotation of the genes. The output of this module is the set of population SNP loci in VCF format. MALVIRUS first builds the full-length sequence alignment of the input sequences to the input reference genome using MAFFT (Katoh and Standley, 2013) , then extracts the set of population SNP loci from the multiple alignment using snpsites (Page et al., 2016) . Since snp-sites is not able to output variants in positions with gaps, MALVIRUS fills the gaps in the alignment with the corresponding portions of the reference. Although this step might induce some artificial variants, it allows to preserve real ones that might be lost due to incomplete assemblies. If the population under investigation is well characterized and/or the user wants a finer control over the variant catalog, it is possible to upload a custom catalog of SNP loci in VCF format instead of relying on the automatic computation from a set of assemblies. The second module requires as input a sample of reads in FASTA/Q format and a catalog of population SNP loci along with the corresponding reference genome chosen among the ones computed or uploaded in the first module. The output of second module is a VCF containing the genotype information of the sample and their qualities. Additionally, if gene annotation is available, this module also annotates each variant with the corresponding gene. To call the genotype of each variant, this module counts the k-mers in the sample using KMC3 (Kokot et al., 2017) , then it genotypes the variants using MALVA (Denti et al., 2019) : an efficient and accurate mapping-free approach for genotyping a set of known SNPs and indels initially developed for human individuals. We extended MALVA to support haploid organisms and high-coverage samples. Finally, the results of each analysis can be visualized as a table (see Suppl. Fig. 1 for an example) or downloaded in VCF format or as a spreadsheet for further analysis. MALVIRUS is available as a self-hosted web application distributed as a Docker container image that can be installed and run on multiple platforms, from personal laptops to large cloud infrastructures. For user convenience, the application is distributed with a set of precomputed catalog of variants for SARS-CoV-2 based on the assemblies available on GenBank (Sayers et al., 2019) , therefore the user can immediately run MALVIRUS on a locally available (e.g., private) viral sample. The precomputed catalogs can be easily updated from the application itself with a single click.",
            "cite_spans": [
                {
                    "start": 389,
                    "end": 415,
                    "text": "(Katoh and Standley, 2013)",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 506,
                    "end": 525,
                    "text": "(Page et al., 2016)",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 1631,
                    "end": 1651,
                    "text": "(Kokot et al., 2017)",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 1697,
                    "end": 1717,
                    "text": "(Denti et al., 2019)",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 2464,
                    "end": 2485,
                    "text": "(Sayers et al., 2019)",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 2010,
                    "end": 2016,
                    "text": "Fig. 1",
                    "ref_id": "FIGREF0"
                }
            ],
            "section": "Methods"
        },
        {
            "text": "As a main test case of the effectiveness of MALVIRUS, we report here the results of an analysis performed on two different runs considering an Illumina sample (SRA accession number SRR11397721) and a Nanopore sample (SRA accession number SRR11397725) sequenced from an Australian SARS-CoV-2 strain (GISAID Accession ID: EPI_ISL_416412). We used as input the NC_045512.2 reference genome, its annotation, and the set of complete SARS-CoV-2 strains available on GISAID (Shu and McCauley, 2017) , accessed on April 28, 2020. More details on the assessment are in the supplementary material.",
            "cite_spans": [
                {
                    "start": 467,
                    "end": 491,
                    "text": "(Shu and McCauley, 2017)",
                    "ref_id": "BIBREF10"
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "To validate MALVIRUS we compared its genotype calling against the set of SNPs present in the selected strain obtained by aligning the assembly to the reference sequence using MAFFT and then extracting the SNPs with snp-sites from it, as result we found 9 variants that are also in this strain (Suppl. Sect. 2). Simulating a real case scenario, where the goal is to genotype a newly-sequenced strain, we removed the selected Australian strain from the list of assemblies downloaded from GISAID. From the remaining 9065 strains, MALVIRUS produced a VCF containing 7105 variants, where the same 8 variants, out of the 9 previously established, were called as non-reference for the two Australian samples. MALVIRUS could not genotype the last SNP since it is unique to this specific strain, making it impossible to call from the available knowledge base we created in our experimental settings.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "The analysis of each sample completed in 5 minutes requiring less than 3GB of RAM. Such amount of resources is nowadays available on any computer, making MALVIRUS easily usable even on lower end machines. Furthermore the first module of our application (catalog creation) needs to be run only when new strains are available and then reused multiple times.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "In this article, we presented MALVIRUS, a web application for quickly genotyping viral strains. As shown by our tests, MALVIRUS is able to efficiently and accurately genotype a newly-sequenced SARS-CoV-2 strain both from short (Illumina) and long (Oxford Nanopore) reads. Since MALVIRUS benefits from comprehensive variant catalogs, the constantly increasing number of available strains will broaden the completeness of the current variant knowledge, thus boosting the overall accuracy of our pipeline. Future steps will be devoted to replace snp-sites in order to allow MALVIRUS to genotype not only SNPs but also indels.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusion"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Outbreak of COVID-19 in Germany resulting from a single travel-associated primary case",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "M"
                    ],
                    "last": "B\u00f6hmer",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "MALVA: genotyping by Mapping-free ALlele detection of known VAriants. iScience",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Denti",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Previtali",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Bernardini",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Sch\u00f6nhuth",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Bonizzoni",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "18",
            "issn": "",
            "pages": "20--27",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Spread of SARS-CoV-2 in the icelandic population",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "F"
                    ],
                    "last": "Gudbjartsson",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "New England Journal of Medicine",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "MAFFT multiple sequence alignment software version 7: improvements in performance and usability",
            "authors": [
                {
                    "first": "K",
                    "middle": [],
                    "last": "Katoh",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Standley",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Molecular biology and evolution",
            "volume": "30",
            "issn": "4",
            "pages": "772--780",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "KMC 3: counting and manipulating k-mer statistics",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kokot",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "D\u0142ugosz",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Deorowicz",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Bioinformatics",
            "volume": "33",
            "issn": "17",
            "pages": "2759--2761",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Minimap2: pairwise alignment for nucleotide sequences",
            "authors": [
                {
                    "first": "H",
                    "middle": [],
                    "last": "Li",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "The Genome Analysis Toolkit: a MapReduce framework for analyzing next-generation DNA sequencing data",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Mckenna",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Genome research",
            "volume": "20",
            "issn": "9",
            "pages": "1297--1303",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "SNP-sites: rapid efficient extraction of snps from multi-FASTA alignments",
            "authors": [
                {
                    "first": "A",
                    "middle": [
                        "J"
                    ],
                    "last": "Page",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Microbial genomics",
            "volume": "2",
            "issn": "4",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "GISAID: Global initiative on sharing all influenza data-from vision to reality",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Shu",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Mccauley",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "Eurosurveillance",
            "volume": "",
            "issn": "13",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "LoFreq: a sequence-quality aware, ultra-sensitive variant caller for uncovering cell-population heterogeneity from high-throughput sequencing datasets",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Wilm",
                    "suffix": ""
                }
            ],
            "year": 2012,
            "venue": "Nucleic acids research",
            "volume": "40",
            "issn": "22",
            "pages": "11189--11201",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Schematic representation of the pipeline integrated in MALVIRUS.",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": [
        {
            "text": "This project has received funding from the European Union's Horizon 2020 research and innovation programme under the Marie Sk\u0142odowska-Curie grant agreement No 872539.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "acknowledgement"
        }
    ]
}