{
    "paper_id": "PMC7162546",
    "metadata": {
        "title": "Nowcasting by Bayesian Smoothing: A flexible, generalizable model for real-time epidemic tracking",
        "authors": [
            {
                "first": "Sarah",
                "middle": [
                    "F."
                ],
                "last": "McGough",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Michael",
                "middle": [
                    "A."
                ],
                "last": "Johansson",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Marc",
                "middle": [],
                "last": "Lipsitch",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Nicolas",
                "middle": [
                    "A."
                ],
                "last": "Menzies",
                "suffix": "",
                "email": null,
                "affiliation": {}
            },
            {
                "first": "Bryan",
                "middle": [],
                "last": "Lewis",
                "suffix": "",
                "email": null,
                "affiliation": {}
            }
        ]
    },
    "body_text": [
        {
            "text": "Effective public health action relies on surveillance that is timely and accurate, especially in disease outbreaks[1,2]. Specifically, surveillance provides the information required to assess risks, prioritize and allocate resources to public health threats, deploy and discontinue interventions to interrupt transmission, and monitor the impact of those interventions. Ideally, disease surveillance systems should closely track the often fast-changing circumstances of outbreaks, distinguishing true changes in the dynamics from artifacts of reporting.",
            "cite_spans": [
                {
                    "start": 115,
                    "end": 116,
                    "mention": "1",
                    "ref_id": "BIBREF0"
                },
                {
                    "start": 117,
                    "end": 118,
                    "mention": "2",
                    "ref_id": "BIBREF1"
                }
            ],
            "section": "Introduction",
            "ref_spans": []
        },
        {
            "text": "Despite the importance of timely surveillance data, substantial challenges exist to collect and report case information in real time. Multiple features of the disease and surveillance system contribute to reporting delays, including: delays in symptoms onset after infection; delays in medical care-seeking after onset; delays in providers obtaining and reporting diagnostic information; level of awareness of disease activity influencing care-seeking and reporting; and system-level processing delays, a result of complex and multi-tiered disease reporting and communication systems interacting at multiple administrative levels[3]. Reporting delays can be further exacerbated in resource-constrained settings. As a consequence, surveillance data are typically not complete until weeks or months after infections have actually occurred, providing an incomplete picture of current disease activity.",
            "cite_spans": [
                {
                    "start": 630,
                    "end": 631,
                    "mention": "3",
                    "ref_id": "BIBREF2"
                }
            ],
            "section": "Introduction",
            "ref_spans": []
        },
        {
            "text": "Nowcasting, or \u201cpredicting the present,\u201d is an approach to mitigate the impact of reporting delays. With origins in the insurance claims and actuarial literature[4,5], nowcast models aim to estimate the number of occurred-but-not-yet-reported events (e.g. insurance claims, disease cases) at any given time based on an incomplete set of reports. In public health settings, nowcasting approaches have been explored for AIDS in the 1980s and 1990s[6\u20138] as a consequence of the long incubation period from HIV infection until development of AIDS. More recently, nowcasting has been applied to infectious disease outbreaks such as foodborne illness outbreaks[9,10]. These studies draw principally on survival analysis and actuarial techniques to model the reporting delay and draw inferences based on historical patterns. A majority of studies have strictly focused on modeling the reporting delay distribution\u2014a legacy of the actuarial techniques giving rise to many of these approaches\u2014and generally neglect a key feature of outbreaks: that future cases are intrinsically linked to past reported cases, a fact that creates potentially strong autocorrelation in the true number of cases over short time intervals. In other words, the infectious disease transmission process provides an additional signal of the number of cases to be expected in the near future that has not been included in common methods such as the reverse-time hazard model[11,12] and the chain ladder method[13], which model the probability of delays in case reporting and consider the number of cases at successive time points as independent. However, proposals to extend the chain ladder approach to state-space models that account for temporal relationships in reporting have existed in the literature since the development of these techniques[13\u201315] and have been applied in at least one infectious disease context[16].",
            "cite_spans": [
                {
                    "start": 162,
                    "end": 163,
                    "mention": "4",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 164,
                    "end": 165,
                    "mention": "5",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 446,
                    "end": 447,
                    "mention": "6",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 448,
                    "end": 449,
                    "mention": "8",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 655,
                    "end": 656,
                    "mention": "9",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 657,
                    "end": 659,
                    "mention": "10",
                    "ref_id": "BIBREF9"
                },
                {
                    "start": 1441,
                    "end": 1443,
                    "mention": "11",
                    "ref_id": "BIBREF10"
                },
                {
                    "start": 1444,
                    "end": 1446,
                    "mention": "12",
                    "ref_id": "BIBREF11"
                },
                {
                    "start": 1476,
                    "end": 1478,
                    "mention": "13",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 1815,
                    "end": 1817,
                    "mention": "13",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 1818,
                    "end": 1820,
                    "mention": "15",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1887,
                    "end": 1889,
                    "mention": "16",
                    "ref_id": "BIBREF15"
                }
            ],
            "section": "Introduction",
            "ref_spans": []
        },
        {
            "text": "The development of nowcast models is promising for disease surveillance, but equally important is the need to identify and scrutinize the mechanisms by which these approaches are successful in accurately predicting true case reports and, on the other hand, underperform. For example, it is critical to demonstrate performance in a diversity of settings as a majority of disease nowcast models to date have largely focused on performance in specific applications, but not the common challenges that exist across many different diseases. To wit, in this investigation we find that nowcasting is especially challenging when the proportion of cases reported the week they occur (delay 0) is low and reporting delays are highly variable; we know of no investigations that specifically identify models that perform well in these commonly occurring circumstances. As a result, the characteristics of robust and broadly-applicable models are difficult to identify. Additionally, several previous models have largely focused on providing point estimates of the number of cases. Point estimates may be helpful, but quantifying the uncertainty in those estimates is even more important in the context of infectious disease outbreaks because uncertainty is intrinsic, and accounting for plausible outcomes apart from the point prediction is critical.",
            "cite_spans": [],
            "section": "Introduction",
            "ref_spans": []
        },
        {
            "text": "Here, we implement a relatively disease-agnostic nowcast method in multiple real-world and simulated disease reporting settings, and unpack the features of model structure and implementation that contribute to its performance. We introduce Nowcasting by Bayesian Smoothing (NobBS), a simple and flexible generalized Bayesian model and associated software package for nowcasting infectious diseases. We demonstrate the robustness of this approach in two very different disease surveillance contexts and identify the conditions that favor its application, especially when the reporting delay distribution is time-varying. Specifically, NobBS allows for both uncertainty in the delay distribution and the time evolution of the epidemic curve, producing smooth, time-correlated estimates of cases. We demonstrate that NobBS performs well for weekly nowcasts of (1) dengue cases in Puerto Rico and (2) influenza-like illness (ILI) cases in the United States, requiring no disease-specific parameterization despite the two pathogens being very different (vector-borne vs. directly transmitted) and exhibiting substantially different reporting delays. Lastly, we test NobBS against a previously developed Bayesian nowcast method for surveillance data[9] and find that NobBS outperforms this established method for both diseases and multiple time periods. In particular, we show that while point estimates of the models are similar when time-to-report distributions are relatively fixed over time, NobBS improves the estimation of uncertainty and accommodates temporal variation in delay probabilities. Our investigation aims to provide deeper insights into these different nowcast approaches and describe the practical implementation of NobBS. We present an R package, \u201cNobBS,\u201d as a tool to complement both routine public health surveillance as well as forecasting efforts.",
            "cite_spans": [
                {
                    "start": 1244,
                    "end": 1245,
                    "mention": "9",
                    "ref_id": "BIBREF8"
                }
            ],
            "section": "Introduction",
            "ref_spans": []
        },
        {
            "text": "Figs 1 and 2 show weekly dengue and ILI nowcasts for NobBS and the HH approach over multiple seasons for both diseases. Table 1 summarizes the point and probability-based accuracy metrics for each, where higher accuracy is indicated by higher average scores, lower MAE, RMSE, and rRMSE, and lower distance from 0.95 for the 95% PI coverage. Because the NobBS model accounts for both under-reporting and the autocorrelated progression of transmission across successive weeks, it makes predictions even in weeks when there are no cases reported for the week. Conversely, the HH model does not make nowcasts for weeks in which there are no initial case reports (common in the dengue Puerto Rico data), hence the nowcasts in Figs 1C and 2C appear as discontinuous lines. To compare models despite these differences, we report accuracy metrics between NobBS and the HH approach for both (1) the full time series of the data and (2) weeks when at least one case was reported in the first week, i.e. the subset of weeks for which both models could make predictions (Table 1). We also computed error metrics for the HH model for the full time series by assigning point estimates of 0 cases for nowcasts in weeks without predictions.",
            "cite_spans": [],
            "section": "Performance in forecasting weekly dengue and influenza incidence ::: Results",
            "ref_spans": [
                {
                    "start": 5,
                    "end": 6,
                    "mention": "1",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 11,
                    "end": 12,
                    "mention": "2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 726,
                    "end": 728,
                    "mention": "1C",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 733,
                    "end": 735,
                    "mention": "2C",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 120,
                    "end": 127,
                    "mention": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 1059,
                    "end": 1066,
                    "mention": "Table 1",
                    "ref_id": null
                }
            ]
        },
        {
            "text": "The HH approach made predictions in only 55% of weeks in the dengue time series (Table 1). In this subset of weeks, the NobBS approach achieved relatively smooth and accurate tracking of the dengue time series (rRMSE = 0.464, average score = 0.274) despite low proportions of cases reported on the week of onset (Fig 1A and 1B). The 95% PI coverage was 0.85, indicating that the 95% PI included the true number of cases for 85% of the nowcasts. In comparison, the HH approach produced substantially less accurate point estimates and slightly broader uncertainty intervals (rRMSE = 1.24, average score = 0.161, 95% PI coverage = 0.90) with greater fluctuation in nowcasts from week-to-week (Fig 1C and 1D). On average, the HH approach led to more biased estimates and systematically overpredicted the number of cases for both ILI and dengue compared to NobBS. Because many weeks in the dengue data were low incidence, assigning a prediction of 0 to the HH approach\u2019s missing nowcasts improved its rRMSE to 1.14 in the full time series compared to 1.24 for the subset over which nowcasts were generated from the model, though NobBS still surpassed the HH model\u2019s accuracy on this and all other metrics (Table 1).",
            "cite_spans": [],
            "section": "Performance in forecasting weekly dengue and influenza incidence ::: Results",
            "ref_spans": [
                {
                    "start": 313,
                    "end": 326,
                    "mention": "Fig 1A and 1B",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 690,
                    "end": 703,
                    "mention": "Fig 1C and 1D",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 81,
                    "end": 88,
                    "mention": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 1201,
                    "end": 1208,
                    "mention": "Table 1",
                    "ref_id": null
                }
            ]
        },
        {
            "text": "Nowcast point estimates tracked the ILI time series well for both approaches, though point estimates had greater error by all measures for the NobBS approach (NobBS rRMSE = 0.074 vs. HH rRMSE = 0.062; Table 1). However, the NobBS approach produced considerably wider prediction intervals (Figs 1C and 2C) resulting in both higher scores (NobBS average score = 0.218 vs. HH average score = 0.017) and 100% coverage by the 95% prediction intervals compared to 0% coverage for the HH (Table 1). We observed that at multiple deciles of the prediction interval, the interval provided conservative coverage, but that the calibration of narrower intervals was better (S1 Fig).",
            "cite_spans": [],
            "section": "Performance in forecasting weekly dengue and influenza incidence ::: Results",
            "ref_spans": [
                {
                    "start": 294,
                    "end": 296,
                    "mention": "1C",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 301,
                    "end": 303,
                    "mention": "2C",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 201,
                    "end": 208,
                    "mention": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 482,
                    "end": 489,
                    "mention": "Table 1",
                    "ref_id": null
                }
            ]
        },
        {
            "text": "To assess the degree of autocorrelation and related smoothness in the NobBS predictions, we calculated the 1-week lagged autocorrelation of predictions (\u03c1a) and compared this to the 1-week lagged autocorrelation of cases (\u03c1c). In addition, we computed metrics reflecting the accuracy of the approaches in capturing the change in cases from week-to-week: the mean absolute error of the change (MAE\u0394) and the RMSE of the change (RMSE\u0394) (Table 2). The magnitude of change was much larger for the ILI data than dengue data, with average absolute value change of 1,312.6 cases/week versus 9.8 cases/week, yet both showed high autocorrelation (\u03c1c = 0.958 for dengue and \u03c1c = 0.972 for ILI). Comparing the full time series, the nowcasts produced by NobBS exhibited high autocorrelation for both diseases (\u03c1a = 0.876 for dengue, 0.973 for ILI) while the HH approach yielded lower autocorrelation for dengue nowcasts, comparatively (\u03c1a = 0.631 for dengue, 0.970 for ILI). For dengue, over the weeks in which at least 1 case was initially reported, the NobBS approach achieved both lower mean absolute difference between predicted and observed changes in cases (NobBS MAE\u0394 = 23 vs. HH MAE\u0394 = 50) and lower RMSE of the change (NobBS RMSE\u0394 = 35.8 vs. HH RMSE\u0394 = 64.6). In addition, NobBS outperformed the HH approach over the full time series of dengue cases (Table 2). For ILI, however, the metrics for the weekly change were similar for the two approaches (Table 2).",
            "cite_spans": [],
            "section": "Performance in forecasting weekly dengue and influenza incidence ::: Results",
            "ref_spans": [
                {
                    "start": 435,
                    "end": 442,
                    "mention": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 1348,
                    "end": 1355,
                    "mention": "Table 2",
                    "ref_id": null
                },
                {
                    "start": 1447,
                    "end": 1454,
                    "mention": "Table 2",
                    "ref_id": null
                }
            ]
        },
        {
            "text": "The delay distributions between the reporting systems are strikingly different (Figs 1 and 2, S2 Fig). In the case of the dengue surveillance system, which includes specimen collection and laboratory testing, only approximately 4% of cases were processed during the week of onset, on average. In contrast, the U.S. Outpatient Influenza-like Illness (ILI) Surveillance Network (ILINet) captures only syndromic data reported electronically, with over 80% of ILI cases reported, on average, the same week they present (i.e. with no delay). Overall, we observed that the accuracy of nowcast point estimates (rRMSE) was higher for the ILI data compared to dengue, which may be related to the high proportion of cases reported with 0-weeks delay in these data. Large weekly absolute changes in the number of initial case reports also appeared to be related to increased error, particularly for dengue, which had high fluctuations in the number of initial reports over time (S1 Table, S3 Fig). Note that because of the difference in predictive distribution bin widths based on the number of cases that accrue for influenza vs. dengue (Materials & Methods), average scores are not comparable across diseases.",
            "cite_spans": [],
            "section": "Reporting delays impact nowcast performance ::: Results",
            "ref_spans": [
                {
                    "start": 85,
                    "end": 86,
                    "mention": "1",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 91,
                    "end": 92,
                    "mention": "2",
                    "ref_id": "FIGREF1"
                }
            ]
        },
        {
            "text": "Dengue and ILI also exhibit differences in the trends of reporting delay probabilities over time, and we observed strikingly different comparative performance of the two nowcast approaches in these disease settings, namely that the HH approach performed comparably to NobBS for ILI but not for dengue. In the dengue data, we observe a noisier, more time-varying probability of reporting for cases, with more extreme fluctuations in the proportion of initial reports compared to ILI cases, which show more constant (tighter ranges of) reporting probabilities from week-to-week (S4 Fig). Independent of the initial proportion of cases reported (high vs. low), we hypothesized that these trends (relatively constant vs. time-varying) are particularly impactful on the performance of the nowcast, and that relatively constant reporting probabilities, as seen in the ILI data, may be linked to the higher accuracy of these predictions.",
            "cite_spans": [],
            "section": "NobBS improves nowcasting with varying reporting delays ::: Results",
            "ref_spans": []
        },
        {
            "text": "To test the robustness of the model, we simulated ILI data using the final counts from the true dataset, but imposing a time-varying delay distribution; specifically, with faster initial reporting during weeks of high incidence to reflect heightened awareness of an outbreak and increased urgency of reporting (described in Materials and Methods). Using these simulated data, we found that NobBS was relatively robust to changes in reporting delays (S5 Fig, S2 Table). In the context of stable reporting delays (original ILI data), NobBS performed comparably to the HH model (Fig 2, Table 1). However, in the presence of simulated time-varying reporting delays, NobBS outperformed the HH in terms of confidence (NobBS average score = 0.06 vs. HH average score \u2248 0), point estimates (NobBS rRMSE = 0.302 vs. HH rRMSE = 0.621), and accuracy of the predicted change (S3 Table). Such variations in the delay distribution are a reality in many epidemics[17].",
            "cite_spans": [
                {
                    "start": 949,
                    "end": 951,
                    "mention": "17",
                    "ref_id": "BIBREF16"
                }
            ],
            "section": "NobBS improves nowcasting with varying reporting delays ::: Results",
            "ref_spans": [
                {
                    "start": 576,
                    "end": 581,
                    "mention": "Fig 2",
                    "ref_id": "FIGREF1"
                },
                {
                    "start": 583,
                    "end": 590,
                    "mention": "Table 1",
                    "ref_id": null
                }
            ]
        },
        {
            "text": "Time-varying delays may be explicitly modeled in the HH approach, by pre-specifying the temporal change-points at which the delay distribution is expected to change\u2013information that is rarely known in real-time. We therefore compared NobBS to the HH approach without explicitly modeling a time-varying delay distribution in either method. In the case of ILI and dengue data, we had no reason to believe or anticipate a systematic change in reporting over the time period covered.",
            "cite_spans": [],
            "section": "NobBS improves nowcasting with varying reporting delays ::: Results",
            "ref_spans": []
        },
        {
            "text": "The performance of both approaches in nowcasting ILI was relatively consistent by year across accuracy measures, but there were fluctuations in the year-to-year performance of dengue nowcasts (Table 3). Average scores of the dengue nowcasts (from both approaches) tended to be high in years that experienced a very low number of dengue cases (e.g. 2000, 2002, 2004, 2006), and therefore the performance of both approaches declined during higher incidence years. For dengue, the NobBS model was particularly effective at identifying periods of low incidence, with high probabilities assigned to the lowest outcome bin (0\u201325 cases, details in Materials and Methods) when the number of cases eventually reported was low (S6 Fig). On the other hand, during periods of high dengue activity, lower probabilities were assigned to the correct bin, reflecting greater uncertainty. Looking specifically at higher incidence time periods (Epidemiologic Weeks 40 through 20 of the following year for ILI, and all weeks in which the number of cases exceeded 50 for dengue), both nowcast approaches were less accurate and more uncertain than during other time periods (S4 Table). Overall, NobBS outperformed the benchmark approach on all performance measures for each year and most higher incidence time periods (Table 3; S4 Table).",
            "cite_spans": [],
            "section": "Performance by year ::: Results",
            "ref_spans": [
                {
                    "start": 193,
                    "end": 200,
                    "mention": "Table 3",
                    "ref_id": "TABREF2"
                },
                {
                    "start": 1298,
                    "end": 1305,
                    "mention": "Table 3",
                    "ref_id": "TABREF2"
                }
            ]
        },
        {
            "text": "Both approaches had their lowest accuracy on three high incidence dengue seasons: 1994, 2007, and 2010 (Table 3; S4 Table; Fig 1). The average annual scores for these years range between 0.041 and 0.170 across the NobBS and benchmark approaches, and between 0.000 and 0.081 for the high-incidence time periods specifically (Table 3; S4 Table), falling clearly below the rest of the years and higher incidence time periods in performance. These scores not only reflect unusually poor point estimate predictions as judged by rRMSE, but also the finding that the predictive distribution for weeks in these years for both approaches rarely included the true value of interest (a consequence of dramatic over- or underestimates during times of high disease activity).",
            "cite_spans": [],
            "section": "Performance by year ::: Results",
            "ref_spans": [
                {
                    "start": 123,
                    "end": 128,
                    "mention": "Fig 1",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 104,
                    "end": 111,
                    "mention": "Table 3",
                    "ref_id": "TABREF2"
                },
                {
                    "start": 324,
                    "end": 331,
                    "mention": "Table 3",
                    "ref_id": "TABREF2"
                }
            ]
        },
        {
            "text": "We initially used moving windows of 104 weeks for dengue (a longer time series) and 27 weeks for ILI (a shorter time series) to leverage a large number of historical training weeks to train nowcast estimates. Moving windows allow for stable estimation of the recent delay distribution as information from very old and potentially less relevant weeks are forgotten. The size of the moving window reflects how quickly and smoothly changes in the data should be realized by the model: longer moving windows tend to produce smoother estimates, but the model may be less sensitive to abrupt changes in the data (e.g. changes in how quickly cases are reported during an outbreak) or shorter-interval secular trends, e.g. seasonality.",
            "cite_spans": [],
            "section": "Moving window sizes ::: Results",
            "ref_spans": []
        },
        {
            "text": "While we chose long moving windows for both diseases to capitalize on data availability, these considerations may affect the choice of moving window size and nowcast performance, depending on the data. In light of this, we experimented with moving windows of different lengths on the dengue data to assess the impact on nowcast performance. We tested moving windows of 5, 12, and 27 weeks (approx. 6 months) on the dengue data and, for each moving window, generated a set of nowcasts for December 1991-November 2010 in order to compare performance measures across all moving window sizes (5, 12, 27, and 104 weeks). A 5-week moving window produced substantially lower accuracy nowcasts (rRMSE = 7.381) with several steep case overestimates in 2007\u201308 and 2010 (S7A Fig). However, accuracy metrics for moving windows of 12 weeks or longer were similar to those using the full 104 week window (range in rRMSE: 0.6\u20130.655; average score: 0.35\u20130.37) (S5 Table; S7 Fig). While shorter moving windows often produced more accurate estimates of the reporting delay probability (S8A Fig), the estimated variance of the random walk process varied dramatically from week-to-week (S8B Fig) resulting in more dramatic overestimates at certain periods of extreme time-varying delays, suggesting a trade-off between delay estimation accuracy and more stable estimates of weekly cases.",
            "cite_spans": [],
            "section": "Moving window sizes ::: Results",
            "ref_spans": []
        },
        {
            "text": "We introduce an approach for Bayesian nowcasting, NobBS, and demonstrate its application in two disease contexts with different reporting systems, investigating the conditions that contribute to successful implementation. We show that NobBS outperforms an existing method in terms of point estimate (reduced RMSE, lower bias) and probabilistic (higher logarithmic score) predictive performance. In particular, NobBS performs well even when the delays in case reporting change over time. We further demonstrate an important trade-off related to moving window sizes for delay distribution estimates; short windows improve the real-time characterization of the delay distribution but are susceptible to over-estimating that variability, potentially decreasing nowcast accuracy. Lacking any disease-specific parameterization, and relying only on historical trends of case reporting as input, this approach can be immediately adapted in a variety of disease settings.",
            "cite_spans": [],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "Across diseases, NobBS outperformed the HH approach on accuracy of uncertainty estimates, and produced comparable or better point estimates. For the subset of weeks in which both models could produce forecasts (weeks with at least one case initially reported), point estimates for NobBS were substantially more accurate than the HH model for dengue cases (rRMSE improved by 300%) and slightly less accurate for ILI cases (rRMSE decreased by 19%). However, analysis of the probability distributions of the nowcasts revealed a much more substantial difference; the average score for NobBS was approximately twice as high for dengue and more than 10 times as high for ILI cases (Table 1). This indicates that the NobBS approach assigned much higher probability to the actual outcome, even though point accuracy was somewhat lower for the ILI cases.",
            "cite_spans": [],
            "section": "Discussion",
            "ref_spans": [
                {
                    "start": 676,
                    "end": 683,
                    "mention": "Table 1",
                    "ref_id": null
                }
            ]
        },
        {
            "text": "While utilizing a similar modeling structure for case reporting delays as the HH model[9], NobBS introduces a simple dependency between case counts over time; that is, changes in case counts between weeks are assumed to be related via a first-order random walk process on the logarithmic scale. This feature is critical in the context of infectious disease transmission, where the number of true infections in a given week mechanistically depends in part on the number of true infections in previous weeks due to the infectious process, whether the pathogen is transmitted directly or by vectors[18]. Hence, variations of autoregressive models are common in disease forecasting[19,20]. Indeed, a recently published study describes a similar approach to NobBS [16], proposing the same model structure (an adaptation of the historic chain-ladder approach) and similar priors (namely, a first-order random walk on the underlying distribution of cases), finding that this approach performed well for two diseases. Two key differences in model structure are that NobBS parameterizes the delay distribution as a Dirichlet as opposed to a random walk, to model the underlying delay distribution as a probability vector, and omits a model intercept. We also aimed to identify and deconstruct the features that contribute to good performance, comparing to a benchmark approach and testing the robustness of NobBS to multiple delay distributions, different moving window sizes, and accuracy metrics. Our results suggest that this approach is robust across disease settings, and offers deeper insights into why: importantly, the temporal dependency between cases in the evolution of an outbreak.",
            "cite_spans": [
                {
                    "start": 87,
                    "end": 88,
                    "mention": "9",
                    "ref_id": "BIBREF8"
                },
                {
                    "start": 596,
                    "end": 598,
                    "mention": "18",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 678,
                    "end": 680,
                    "mention": "19",
                    "ref_id": "BIBREF18"
                },
                {
                    "start": 681,
                    "end": 683,
                    "mention": "20",
                    "ref_id": "BIBREF19"
                },
                {
                    "start": 760,
                    "end": 762,
                    "mention": "16",
                    "ref_id": "BIBREF15"
                }
            ],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "As a result, when reporting delays are time-varying, as is often the case in epidemics[17], we show that the NobBS approach is less accurate compared to its performance in a stable delay distribution, but still shows improvement over the HH approach likely because the NobBS approach is informed by the number of cases experienced in previous weeks, not just the delay distribution, making it more robust to larger fluctuations. As mentioned, the HH approach software includes the option to model a time-varying delay explicitly in the nowcast approach, but requires specifying the time at which the delay distribution is expected to change (the change-point), which is generally not known in real-time. In addition, the authors of the HH approach introduce a feature to model the epidemic curve smoothly, however the implementation is bundled with the change-point model, and is therefore not possible to implement without the change-point component. In the case of the ILI and dengue data, there was no reason to believe reporting changed systematically at any point during the years covered by the data used here, and S4 Fig illustrates that a change-point model would likely be inappropriate given the irregular fluctuations in the delay probabilities over time. However, both features may improve performance of the HH model depending on the context, in particular when facing time-varying delays.",
            "cite_spans": [
                {
                    "start": 87,
                    "end": 89,
                    "mention": "17",
                    "ref_id": "BIBREF16"
                }
            ],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "We also found that the accuracy of predictions is related at least in part to the number of cases reported to the surveillance system in week 0. When a larger proportion of cases were reported with no delay, as was the case for ILI compared to dengue, the point estimate accuracy was higher. This is not surprising, as a large fraction of true cases reported initially leaves fewer cases left to predict.",
            "cite_spans": [],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "Further, we observed greater volatility in the nowcasts when the initial number of cases reported increases suddenly from low values. Two weeks in the dengue time series highlight this: August 3, 1998 and August 16, 2010. In those weeks, the number of cases initially increased by 16 and 17, respectively, from the previous week after 10 week with an average absolute change of 2.6 and 1.8 cases, respectively. Because this increase is an outlier in the distribution of reporting delays, in particular for delay d = 0, the model substantially overestimated the true number of cases before correcting the following week. We observed that shorter moving windows either exacerbated this issue (e.g. in 2010) or produced a similar overestimate (e.g. in 1998) (S7 Fig), which appears to be a consequence of the volatility in estimating the variance of the random walk process, despite more accurate estimation of the reporting delay probability (S8 Fig). While the smooth, autocorrelated relationship fit in the NobBS model helps reduce the effect of week-to-week variability in early reporting, it remains a challenge. Users should keep in mind these trade-offs when seeking to apply NobBS to their data.",
            "cite_spans": [],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "While NobBS mitigates the effects of a time-varying delay distribution on case estimation, i.e. that the history of cases is leveraged to anchor case estimates to recent values, it does not explicitly model temporal changes in that delay; in other words, the estimated probability of a case occurring with delay = d is assumed to apply to all reporting weeks in the moving window. Shorter moving windows can improve estimation of the delay in the presence of changes, but explicitly estimating changes in that distribution may be explored for additional robustness in the presence of systemic changes in reporting. For example, authors in[21] propose a smooth estimate of the time-varying reporting delay distribution using p-spline smoothing. Specifying a time-specific change has also been proposed as mentioned previously [9], but empirical identification of a change point in real-time may be challenging or impossible in the context of nowcasting. The challenge that remains in all described approaches is the ability of the model to pick up on changes in the delay distribution that occur quickly, in other words that may otherwise be smoothed out by splines and long moving windows.",
            "cite_spans": [
                {
                    "start": 639,
                    "end": 641,
                    "mention": "21",
                    "ref_id": "BIBREF20"
                },
                {
                    "start": 826,
                    "end": 827,
                    "mention": "9",
                    "ref_id": "BIBREF8"
                }
            ],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "Lastly, the NobBS approach requires a trade-off between flexibility and precision when specifying the moving window size. With a shorter moving window the model will be more sensitive to recent reporting delay data, that could otherwise be \u201csmoothed out\u201d by the additional historical data considered by longer moving windows. While a narrower window allows more flexibility capture time-changes in the delay distribution, estimates of the parameters governing the random walk will be more volatile, with fewer data points from which to be estimated. In our experiments, the combination of shorter moving windows with rapid changes in cases reported produced large estimated variances, which often decreased the accuracy of nowcasts. We note that the moving window size is ultimately a choice by the modeler and should reflect consideration of available data and the desired smoothness of trends to be estimated; we discuss more in Materials and Methods.",
            "cite_spans": [],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "A strength of the NobBS approach is that it only requires historical data on case reporting, which makes it immediately adaptable in a variety of disease systems that may not have other real-time covariates to inform the nowcasting model (e.g. search engine queries, weather data). However, if these covariates are available, it would be possible to include them directly in the log-linear model (Materials and Methods) as additional predictors, as demonstrated by Bastos et al [16].",
            "cite_spans": [
                {
                    "start": 479,
                    "end": 481,
                    "mention": "16",
                    "ref_id": "BIBREF15"
                }
            ],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "Beyond supporting real-time disease tracking by public health officials, NobBS can complement existing disease forecast efforts by providing more accurate nowcasts to forecasting teams in the place of real-time reporting underestimates. For example, teams participating in the Centers for Disease Control and Prevention Epidemic Prediction Initiative (https://predict.cdc.gov) challenges (e.g. FluSight) use initial surveillance data for forecasting because it is the most up-to-date data available[22]. NobBS can help account for later revisions to these data and therefore improve prospective estimates as well, though we note for FluSight this would require nowcasting not only the total number of cases each week, but also the number of patient visits to achieve the ILI% required for forecasts. To provide guidance in the practical implementation of NobBS, we outline considerations for prior choice, window choice, and other features in Materials and Methods.",
            "cite_spans": [
                {
                    "start": 499,
                    "end": 501,
                    "mention": "22",
                    "ref_id": "BIBREF21"
                }
            ],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "We present an R package, \u201cNobBS,\u201d intended to provide easy and flexible implementation of this approach to a wide audience of public health officials and researchers. This package is available on CRAN (cran.r-project.org/web/packages/NobBS/index.html).",
            "cite_spans": [],
            "section": "Discussion",
            "ref_spans": []
        },
        {
            "text": "We collected data on approximately 53,000 cases of dengue in Puerto Rico and 2.77 million cases of ILI in the United States over a 21-year (1092 weeks) and 3.75-year (196 weeks) period, respectively. Time-stamped weekly dengue data for laboratory-confirmed cases of dengue in Puerto Rico were collected by the Puerto Rico Department of Health and Centers for Disease Control and Prevention. The times used for the analysis were the time of onset as reported by the reporting clinician and the time of laboratory report completion. ILI data originated from the U.S. Outpatient Influenza-like Illness Surveillance Network (ILINet), which consolidates information from over 2000 outpatient healthcare providers in the United States who report to the CDC on the number of patients with ILI. The times used for the analysis were the week of ILI-related care seeking and the week when those cases were posted online in FluView (https://gis.cdc.gov/grasp/fluview/fluportaldashboard.html) as collected in the DELPHI epidemiological data API (https://github.com/cmu-delphi/delphi-epidata). ILI data with delays of more than 6 months occasionally had irregularities, so we restricted the analyses to delays of up to 6 months.",
            "cite_spans": [],
            "section": "Surveillance data ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "Delays in reporting are often structurally decomposed into a (T x D) dimensional \u201creporting triangle,\u201d where T is the most recent week (\u201cnow\u201d) and D is the maximum reporting delay, in weeks, observed in the data. The data are right-truncated, since at any given week t, delays longer than T\u2013t cannot be observed. For example, at week t = T, only the cases reported with delay d = 0 are observable; cases reported with longer delays (i.e. 1- or 2-week delays, d = 1 or d = 2) will be known in future weeks. In S6 Table, we present an example of the reporting triangle using ILI data.",
            "cite_spans": [],
            "section": "Reporting triangle ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "For each week t, the goal of nowcasting is to produce estimates for the total number of cases eventually reported, Nt, based on an incomplete set of observed cases with delay d, nt,d. Since not every nt,d is observed for a delay d, but will be observed at some unknown time point in the future, Nt = sum(nt,d).",
            "cite_spans": [],
            "section": "Reporting triangle ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "Our approach is motivated by modeling the marginal cell counts of the reporting triangle, nt,d in an adaptation of the loglinear chain ladder method developed in actuarial literature[13,14].",
            "cite_spans": [
                {
                    "start": 183,
                    "end": 185,
                    "mention": "13",
                    "ref_id": "BIBREF12"
                },
                {
                    "start": 186,
                    "end": 188,
                    "mention": "14",
                    "ref_id": "BIBREF13"
                }
            ],
            "section": "Reporting triangle ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "Let nt,d be the number of cases reported for week t with delay d. We assume that the underlying cases occur in a Poisson process such that\nnt,d\u223cPois(\u03bbt,d).",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We apply this default assumption in the case of the dengue fever data.",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We also allow for extra-Poisson variation, that is, when the variance is larger than the mean and a negative binomial process (of which the Poisson is a special case) is more appropriate. We apply this in the case of the influenza (ILI) data:\nnt,d\u223cNB(r,pt,d)where\npt,d=r/(r+\u03bbt,d),\nand p(t,d) is the failure probability at week t and delay d, and (r) is the number of failures before stopping.",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We then model the mean, \u03bbt,d, as a simple log-linear equation\nlog(\u03bbt,d)=\u03b1t+log(\u03b2d),\nwhere \u03b1t represents the true epidemiologic signal for week t and \u03b2d as the probability of reporting with delay = d. In other words, NobBS contains random effects for week t and the reporting delay d. Exponentiating both sides of the equation, \u03bbt,d=e\u03b1t*\u03b2d. This model is an adaptation of the general chain ladder model, proposed in the actuarial literature as an approach to nowcast the number of claims at time t with delay d with the form log (\u03bbt,d) = \u03bc+\u03b1t+\u03b2d [15].",
            "cite_spans": [
                {
                    "start": 546,
                    "end": 548,
                    "mention": "15",
                    "ref_id": "BIBREF14"
                }
            ],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We place prior distributions on \u03b1t and \u03b2d reflecting properties of each parameter. Since \u03b2d represents a probability vector containing delays = 0, \u2026, D, we place on it a Dirichlet prior of length D:\n\u03b2d\u223cDir(\u03b8)\n\u03b8=(\u03b80,\u2026,\u03b8D)",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "The maximum delay D can be identified as the maximum observable delay in the data, which may change as the time series extends, or can be fixed at some value D thought to represent a very long delay. In the latter case, \u03b8D can be modeled as the probability of delay \u2265 D. For dengue, we choose to fix D at 10 weeks, since over 99% of the cases observed in the first two years (prior to producing out-of-sample nowcasts) were reported within 10 weeks. For influenza, we chose D to be the longest possible delay within the 27-week moving window, or D = 26. The implications of choosing a maximum delay D within a moving window of W weeks means that the nowcast will include all cases arising with delays greater than or equal to D but less than or equal to W, thus excluding all cases with delays greater than W (see the reporting triangle in S6 Table).",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We place weakly informative priors on \u03b8 representing a small number of hypothetical total cases (n = 10) distributed across delay bins, loosely representing the empirical probability of reporting delays for each delay d observed in the first two years of data for dengue and the first 6 months of data for ILI (training periods). As a sensitivity, we also placed weak priors on \u03b8 treating all delays with equal probability, but there was no material difference in the results.",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We allow a dependency between successive \u03b1t\u2019s to capture the time evolution and autocorrelation of cases from week-to-week, commonly exhibited by epidemic curves. We therefore model \u03b1t as a first-order random walk:\n\u03b1t=1=N(0,0.001)\n\u03b1t>1\u223cN(\u03b1t\u22121,\u03c4\u03b12)",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "Because \u03b1t is in natural log form, this constitutes a geometric random walk.",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We place weakly informative priors on the precisions of the Normal distribution, \u03c4\u03b12\u223cGa(0.01,0.01). For the negative binomial stopping-time parameter, r, we place an informative Ga(60,20) prior to reflect belief that the process deviates moderately from the Poisson.",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "Models were compiled in JAGS on R (v 3.3.2) producing 10,000 posterior samples. Trace plots were visually reviewed for convergence.",
            "cite_spans": [],
            "section": "Bayesian nowcast model ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "In the R package \u201cNobBS\u201d (cran.r-project.org/web/packages/NobBS/index.html), the nowcast model may be implemented automatically by specifying a data frame with one record (row) per case, with a variable specifying the date of case onset and a variable specifying the date of case report. Dates are assumed to be in a sequence of weeks or months, with no gaps in reporting (i.e. no weeks for which reporting did not happen). By default, the model runs a Poisson log-linear model with no moving window (i.e. all historical data is taken into account), a maximum delay D equal to 1 minus the length of the reporting time series (i.e. if 12 consecutive weeks of report data are provided, the longest possible delay is equal to 11 weeks), and ignoring any delays longer than D (because they are unobserved in the default implementation). By default, a weakly informative Ga(0.01,0.01) prior is placed on the precision of the first-order random walk, \u03c4\u03b12, indicating equal weight to a standard deviation of 1 as to a standard deviation of 10,000: in other words, little knowledge about the extent to which the number of cases in the present week differ from the previous week. A weakly informative Dirichlet(\u03b8d\u2026D = 0.1) prior is placed on the vector of delay probabilities, \u03b2d, indicating the weak prior belief that the probability of delay d is equal at all delays.",
            "cite_spans": [],
            "section": "NobBS R package implementation and recommendations ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "However, in \u201cNobBS\u201d all of these features are customizable and it is possible to leverage existing knowledge or historical information to impose more informative priors on the data. For example, it may be already known in the surveillance field that cases of dengue fever are rarely reported the same week they occur (i.e. that the probability of delay d = 0 is very low), but that most cases are reported within 4 weeks. In this example, it would be possible to design a stronger prior on \u03b2d such that \u03b8 = (3,30,50,10,4,3), indicating that out of 100 cases distributed across delays, 3% of cases are expected to be reported with no delay, 30% of cases with a 1-week delay, 50% of cases with a 2-week delay, 10% of cases with a 3-week delay, 4% of cases with a 4-week delay, and 3% of cases with a 5-week delay. In other words, the user may directly parameterize the Dirichlet prior using knowledge of the delay distribution, and the sum of \u03b8d\u2026D is related to the strength of the prior. Historical information (e.g. reporting data from the last several months or years) may also be used to inform the Dirichlet prior, such as through plotting the empirical distribution of delays in case reports. In the present study, for example, the observed delay distribution over the initial model training period was used to inform weakly informative Dirichlet priors for dengue and ILI, with the sum of \u03b8d\u2026D being small.",
            "cite_spans": [],
            "section": "NobBS R package implementation and recommendations ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "The shape and rate hyperpriors of the Gamma(shape, rate) prior on \u03c4\u03b12 may also be modified to reflect stronger prior knowledge of the relationship between cases from week-to-week, which controls the smoothness of the epidemic curve. Increasing the shape parameter with a more informative prior, e.g. Gamma(10,0.1), can force the differences in cases from week-to-week to be small, resulting in a smoother epidemic curve and mitigating large fluctuations in estimates.",
            "cite_spans": [],
            "section": "NobBS R package implementation and recommendations ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "In all cases, keep in mind that the posterior is a compromise between the prior and the likelihood, so with enough weeks of reporting, the observed data can dominate over the prior.",
            "cite_spans": [],
            "section": "NobBS R package implementation and recommendations ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "Specifying a moving window size (e.g. a moving window of 27 weeks) may be leveraged for computational advantage (faster runtime) or to reflect the belief that the delay distribution of very old reports is no longer relevant to inform current reports. Alternatively, the user may prefer to let the moving window expand each week, especially to leverage as much prior data as possible to inform the nowcasts in the absence of available historical information. As discussed in Results, the estimation of the parameters is sensitive to how much historical data is used to fit the model, and this decision is up to the user and could depend on the relevant disease reporting system. The moving window acts to consider (or \u201cweight\u201d) all past observations equally, and shortening the moving window reflects the extent to which the user wishes to consider only more recent data as informative\u2013noting also that shorter moving windows produce more volatile estimates of delay probabilities (which generally increases the accuracy of) as well as more volatile estimates of the variance of the random walk (which generally decreases the accuracy of). Still, these parameters may be constrained through their priors as discussed above.",
            "cite_spans": [],
            "section": "NobBS R package implementation and recommendations ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We produced weekly nowcasts beginning with the 27th week (influenza) and 104th week (dengue) and through the final week of the series. This resulted in 989 weekly out-of-sample estimates of dengue cases and 170 weekly out-of-sample estimates of ILI. The time series of nowcast estimates for both diseases are shown in Figs 1 and 2.",
            "cite_spans": [],
            "section": "Nowcast estimates ::: Materials and methods",
            "ref_spans": [
                {
                    "start": 323,
                    "end": 324,
                    "mention": "1",
                    "ref_id": "FIGREF0"
                },
                {
                    "start": 329,
                    "end": 330,
                    "mention": "2",
                    "ref_id": "FIGREF1"
                }
            ]
        },
        {
            "text": "We used a two-year moving window to estimate a stable delay distribution within the window. As a sensitivity, and to gauge the minimum amount of historical information required to produce accurate nowcasts, we also applied moving windows of 5, 12, and 27 weeks (approximately 6 months).",
            "cite_spans": [],
            "section": "Nowcast estimates ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "We used as a benchmark for comparison the \u201cnowcast\u201d function of the R package \u201csurveillance\u201d by H\u00f6hle and colleagues (described in ref.[9]) designed to produce Bayesian nowcasts for epidemics using a hierarchical model for nt, d \u2264 T-t | nt,d, or the observed cases conditional on the expected total number of cases. We applied the function assuming a time-homogenous delay distribution and recommended parameterization described by the authors in\nhttp://staff.math.su.se/hoehle/blog/2016/07/19/nowCast.html, and for comparability, used the same moving window sizes (27 and 104 weeks) to produce nowcasts over the same time periods.",
            "cite_spans": [
                {
                    "start": 136,
                    "end": 137,
                    "mention": "9",
                    "ref_id": "BIBREF8"
                }
            ],
            "section": "Nowcast estimates ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "The mean absolute error (MAE), root mean square error (RMSE) and relative root mean square error (rRMSE) are defined, respectively, as:\nMAE=1n\u2211i=1nabs(yi\u2212xi)\nRMSE=1n\u2211i=1n(yi\u2212xi)2\nrRMSE=1n\u2211i=1n(yi\u2212xiyi)2\nand were used to quantify the accuracy of point estimates, xi, compared to true case numbers, yi, across the different models at each week i.",
            "cite_spans": [],
            "section": "Model performance metrics ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "To quantify the accuracy of the point estimates in capturing the change in cases from week i-1 to week i, we computed the mean absolute error of the change (MAE\u0394) and the RMSE of the change (RMSE\u0394):\nMAE\u0394=1n\u22121\u2211i=2nabs((xi\u2212xi\u22121)\u2212(yi\u2212yi\u22121))\nRMSE\u0394=1n\u22121\u2211i=2n((yi\u2212yi\u22121)\u2212(xi\u2212xi\u22121))2",
            "cite_spans": [],
            "section": "Model performance metrics ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "To capture smoothness in predictions from week-to-week, we also calculated the lag-1 autocorrelation of predictions (\u03c1a) and cases (\u03c1c) between week i and week i-1.\n\u03c1=\u2211i=2n(xi\u2212x\u00af)(xi\u22121\u2212x\u00af)\u2211i=2n(xi\u2212x\u00af)2\nwhere x = the predicted or true cases at each week i.",
            "cite_spans": [],
            "section": "Model performance metrics ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "The logarithmic scoring rule was used to quantify the accuracy of the posterior predictive distribution of the nowcast. Predictive distributions were assigned to a series of bins categorized across possible values of true case counts. We used bin widths of 25 cases for dengue and 1000 cases for influenza, allowing for a larger number of bins for ILI cases based on case ranges of approx. 0\u2013400 for dengue and 4,000\u201340,000 for ILI. For a predictive distribution with binned probability pi for a given nowcast target, the logarithmic score was calculated as ln(pi). For example, there were 115 cases eventually observed for the week of January 20, 1992. The NobBS nowcast for this week, which assigned a probability of 0.4 to the bin [100,125), thus received a log score of ln(0.4) = -0.92. As in[22,23], a very low log score of -10 was assigned for weeks in which the predictive distribution did not include the true case value, for weeks in which the bin probability \u2264 e-10. This rule provides a lower limit (-10) to the score of highly inaccurate predictions.",
            "cite_spans": [
                {
                    "start": 797,
                    "end": 799,
                    "mention": "22",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 800,
                    "end": 802,
                    "mention": "23",
                    "ref_id": "BIBREF22"
                }
            ],
            "section": "Model performance metrics ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "The average log score across all prediction weeks was computed for all models to assess nowcast performance. The exponentiated average log score yields a nowcast score that can be interpreted as the average probability assigned to the bin corresponding to the true number of cases, and is a metric for model comparison purposes used in several other forecast contexts[22,23]. In this paper, we present the exponentiated average log score and refer to this as the average score.",
            "cite_spans": [
                {
                    "start": 368,
                    "end": 370,
                    "mention": "22",
                    "ref_id": "BIBREF21"
                },
                {
                    "start": 371,
                    "end": 373,
                    "mention": "23",
                    "ref_id": "BIBREF22"
                }
            ],
            "section": "Model performance metrics ::: Materials and methods",
            "ref_spans": []
        },
        {
            "text": "To simulate ILI data with a time-varying probability of reporting delay d = 0, we drew, for each week, Pr(d = 0) from Unif(0.2, 0.9) for all weeks in which the total number of eventually-observed cases exceeded the mean of the ILI series (14,000 cases), and from Unif(0, 0.65) for all weeks in which the total observed case count was less than or equal to 14,000. This probability was used to calculate the simulated number of cases that would be observed with d = 0, out of the total number of cases that would be eventually observed for that week. The remaining cases were distributed to other delays ranging from 1\u201352 weeks using NB(0.9,0.4). This produced a rough approximation for a hypothetical scenario in which cases are reported faster (higher probability of d = 0) during weeks with higher disease activity (more cases), representing heightened awareness of an outbreak and increased urgency of reporting. However, it would also be possible to simulate the reverse scenario (slower reporting at weeks of higher incidence, to demonstrate the problem of reporting backfill during an outbreak) by swapping the two uniform priors.",
            "cite_spans": [],
            "section": "Simulated ILI data ::: Materials and methods",
            "ref_spans": []
        }
    ],
    "ref_entries": {
        "TABREF2": {
            "text": "Table 3: All predicted weeks for each model are compared.\n",
            "type": "table"
        },
        "FIGREF0": {
            "text": "Fig 1: (A) Weekly NobBS nowcasts along with (B) point estimate and uncertainty accuracy, as measured by the score and the prediction error, are compared to (C) weekly nowcasts by the HH approach with (D) corresponding scores and prediction errors. For nowcasting, the number of newly-reported cases each week (blue line) are the only data available in real-time for that week, and help inform the estimate of the total number of cases that will be eventually reported (red line), shown with 95% prediction intervals (pink bands). The true number of cases eventually reported (black line) is known only in hindsight and is the nowcast target. Historical information on reporting is available within a 104-week moving window (grey shade) and used to make nowcasts. The score (brown line) and the difference between the true and mean estimated number of cases (grey line) are shown as a function of time.",
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Fig 2: (A) Weekly NobBS nowcasts along with (B) point estimate and uncertainty accuracy, as measured by the score and the prediction error, are compared to (C) weekly nowcasts by the HH approach with (D) corresponding scores and prediction errors. For nowcasting, the number of newly-reported cases each week (blue line) are the only data available in real-time for that week, and help inform the estimate of the total number of cases that will be eventually reported (red line), shown with 95% prediction intervals (pink bands). For the HH approach, the 95% prediction intervals are very narrow and are thus difficult to see. The true number of cases eventually reported (black line) is known only in hindsight and is the nowcast target. Historical information on reporting is available within a 27-week moving window (grey shade) and used to make nowcasts. The score (brown line) and the difference between the true and mean estimated number of cases (grey line) are shown as a function of time.",
            "type": "figure"
        }
    },
    "back_matter": [],
    "bib_entries": {
        "BIBREF0": {
            "title": "Improving the evidence base for decision making during a pandemic: the example of 2009 influenza A/H1N1",
            "authors": [],
            "year": 2011,
            "venue": "Biosecur Bioterror",
            "volume": "9",
            "issn": "",
            "pages": "89-115",
            "other_ids": {
                "DOI": [
                    "10.1089/bsp.2011.0007"
                ]
            }
        },
        "BIBREF1": {
            "title": "The Science of Public Health Surveillance",
            "authors": [],
            "year": 1989,
            "venue": "J Public Health Policy",
            "volume": "10",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF2": {
            "title": "Prevalence, and associated risk factors, of self-reported diabetes mellitus in a sample of adult urban population in Greece: MEDICAL Exit Poll Research in Salamis (MEDICAL EXPRESS 2002)",
            "authors": [],
            "year": 2004,
            "venue": "BMC Public Health",
            "volume": "4",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": [
                    "10.1186/1471-2458-4-2"
                ]
            }
        },
        "BIBREF3": {
            "title": "Prediction of IBNR claim counts by modelling the distribution of report lags",
            "authors": [],
            "year": 1987,
            "venue": "Insur Math Econ",
            "volume": "6",
            "issn": "",
            "pages": "151-159",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF4": {
            "title": "Adjustments for reporting delays and the prediction of occurred but not reported events",
            "authors": [],
            "year": 1994,
            "venue": "Can J Stat",
            "volume": "22",
            "issn": "",
            "pages": "15-31",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF5": {
            "title": "Regression Analysis of Censored and Truncated Data: Estimating Reporting- Delay Distributions and AIDS Incidence from Surveillance Data [Internet]",
            "authors": [],
            "year": 1994,
            "venue": "Biometrics",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": [
                    "10.2307/2533459"
                ]
            }
        },
        "BIBREF6": {
            "title": "AIDS in Ireland: the reporting delay distribution and the implementation of integral equation models",
            "authors": [],
            "year": 1992,
            "venue": "Comput Appl Biosci",
            "volume": "8",
            "issn": "",
            "pages": "579-581",
            "other_ids": {
                "DOI": [
                    "10.1093/bioinformatics/8.6.579"
                ]
            }
        },
        "BIBREF7": {
            "title": "Changing pattern of delays in reporting AIDS diagnoses in Australia",
            "authors": [],
            "year": 1998,
            "venue": "Aust N Z J Public Health",
            "volume": "22",
            "issn": "",
            "pages": "432-435",
            "other_ids": {
                "DOI": [
                    "10.1111/j.1467-842x.1998.tb01409.x"
                ]
            }
        },
        "BIBREF8": {
            "title": "Bayesian nowcasting during the STEC O104:H4 outbreak in Germany, 2011",
            "authors": [],
            "year": 2014,
            "venue": "Biometrics",
            "volume": "70",
            "issn": "",
            "pages": "993-1002",
            "other_ids": {
                "DOI": [
                    "10.1111/biom.12194"
                ]
            }
        },
        "BIBREF9": {
            "title": "Bayesian outbreak detection in the presence of reporting delays",
            "authors": [],
            "year": 2015,
            "venue": "Biom J",
            "volume": "57",
            "issn": "",
            "pages": "1051-1067",
            "other_ids": {
                "DOI": [
                    "10.1002/bimj.201400159"
                ]
            }
        },
        "BIBREF10": {
            "title": "Adjustments for reporting delays and the prediction of occurred but not reported events",
            "authors": [],
            "year": 1994,
            "venue": "Canadian Journal of Statistics",
            "volume": "",
            "issn": "",
            "pages": "15-31",
            "other_ids": {
                "DOI": [
                    "10.2307/3315826.n1"
                ]
            }
        },
        "BIBREF11": {
            "title": "Regression Models for Right Truncated Data with Applications to AIDS incubation Times and Reporting Lags",
            "authors": [],
            "year": 1991,
            "venue": "Stat Sin",
            "volume": "1",
            "issn": "",
            "pages": "19-32",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF12": {
            "title": "IBNR-claims and the two-way model of ANOVA",
            "authors": [],
            "year": 1982,
            "venue": "Scandinavian Actuarial Journal",
            "volume": "",
            "issn": "",
            "pages": "47-55",
            "other_ids": {
                "DOI": [
                    "10.1080/03461238.1982.10405432"
                ]
            }
        },
        "BIBREF13": {
            "title": "A state space representation of the chain ladder linear model",
            "authors": [],
            "year": 1989,
            "venue": "Journal of the Institute of Actuaries",
            "volume": "",
            "issn": "",
            "pages": "589-609",
            "other_ids": {
                "DOI": [
                    "10.1017/s0020268100036714"
                ]
            }
        },
        "BIBREF14": {
            "title": "Statistical methods for the chain ladder technique",
            "authors": [],
            "year": 1994,
            "venue": "Insurance: Mathematics and Economics",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": [
                    "10.1016/0167-6687(94)90725-0"
                ]
            }
        },
        "BIBREF15": {
            "title": "Modelling reporting delays for disease surveillance data",
            "authors": [],
            "year": 2017,
            "venue": "arXiv:170909150",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF16": {
            "title": "Modelling reporting delays for outbreak detection in infectious disease data",
            "authors": [],
            "year": 2015,
            "venue": "J R Stat Soc A",
            "volume": "178",
            "issn": "",
            "pages": "205-222",
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF17": {
            "title": "Different epidemic curves for severe acute respiratory syndrome reveal similar impacts of control measures",
            "authors": [],
            "year": 2004,
            "venue": "Am J Epidemiol",
            "volume": "160",
            "issn": "",
            "pages": "509-516",
            "other_ids": {
                "DOI": [
                    "10.1093/aje/kwh255"
                ]
            }
        },
        "BIBREF18": {
            "title": "Evaluating the performance of infectious disease forecasts: A comparison of climate-driven and seasonal dengue forecasts for Mexico",
            "authors": [],
            "year": 2016,
            "venue": "Sci Rep",
            "volume": "6",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": [
                    "10.1038/srep33707"
                ]
            }
        },
        "BIBREF19": {
            "title": "Accurate estimation of influenza epidemics using Google search data via ARGO",
            "authors": [],
            "year": 2015,
            "venue": "Proc Natl Acad Sci U S A",
            "volume": "112",
            "issn": "",
            "pages": "14473-14478",
            "other_ids": {
                "DOI": [
                    "10.1073/pnas.1515373112"
                ]
            }
        },
        "BIBREF20": {
            "title": "Nowcasting the number of new symptomatic cases during infectious disease outbreaks using constrained P\u2010spline smoothing",
            "authors": [],
            "year": 2019,
            "venue": "Epidemiology",
            "volume": "",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": []
            }
        },
        "BIBREF21": {
            "title": "A collaborative multiyear, multimodel assessment of seasonal influenza forecasting in the United States",
            "authors": [],
            "year": 2019,
            "venue": "Proc Natl Acad Sci U S A",
            "volume": "116",
            "issn": "",
            "pages": "3146-3154",
            "other_ids": {
                "DOI": [
                    "10.1073/pnas.1812594116"
                ]
            }
        },
        "BIBREF22": {
            "title": "Collaborative efforts to forecast seasonal influenza in the United States, 2015\u20132016",
            "authors": [],
            "year": 2019,
            "venue": "Sci Rep",
            "volume": "9",
            "issn": "",
            "pages": null,
            "other_ids": {
                "DOI": [
                    "10.1038/s41598-018-36361-9"
                ]
            }
        }
    }
}