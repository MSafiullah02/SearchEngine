{
    "paper_id": "c61478892ccb9189d59940741f6c011ca86e3c80",
    "metadata": {
        "title": "Predictive data assimilation through Reduced Order Modeling for epidemics with data uncertainty",
        "authors": [
            {
                "first": "T",
                "middle": [
                    "Chac\u00f3n"
                ],
                "last": "Rebollo",
                "suffix": "",
                "affiliation": {},
                "email": ""
            },
            {
                "first": "D",
                "middle": [],
                "last": "Franco Coronil",
                "suffix": "",
                "affiliation": {},
                "email": ""
            }
        ]
    },
    "abstract": [
        {
            "text": "In this article, we develop a data assimilation procedure to predict the evolution of epidemics with data uncertainty, with application to the Covid-19 pandemic. We construct a vademecum of solutions by solving the SIR epidemic model for a set of data neighboring the estimated real (or official) ones. A reduced basis is constructed from this vademecum through Proper Orthogonal Decomposition (POD). The reduced POD base is then applied to assimilate the pandemic data (infected, recovered, deceased) during the period in which data are known, by a least squares procedure. The fitted curves are then used to predict the evolution of the pandemic in the next days. Validation tests for Andalusia region (Spain), Italy and Spain show accurate predictions for 7 days that improve as the number of assimilated data increases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "One of the largest difficulties when dealing with predictive estimates of the evolution of the Covid-19 pandemic is the lack of reliable data on real number of infected people, as well as infection, recovery and death rates. There are, however, reference data that present some variability from a country or region to another. Moreover these parameters in each actual country or region may vary in time due to the relaxation of the population in the respect of the lockdown measures or changes in the availability of health care resources, among other factors. Moreover, there is a number of reliable data, essentially the recovered and deceased populations.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The use of standard mathematical models of the epidemic thus faces important incertitudes. These may be afforded with statistical techniques, that should be based upon medical tests, and are scarce in some countries. Also with least squares techniques, that allow to recover estimates for the lacking parameters.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We afford here the use of Reduced Order Modeling (ROM) to approximate the evolution of the pandemic and predict its future evolution. ROM allows to extract the dominant patterns of parametric systems, providing approximating spaces of very low dimension and excellent accuracy properties.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Our approach is based upon the construction of a vademecum of solutions if the SIR model, for values of the parameters neighboring the reference ones and long time periods of evolution of the pandemic. A reduced basis is then constructed by the Proper Orthogonal Decompostion (POD), that approximates with good accuracy all the solutions in the vademecum. Least squares is then used to approximate on this reduced space the reliable data for a time period in which these are known. This circumvents the need of accurate values for the parameters to obtain evolution curves of the pandemic. The fitted curves are then used to estimate the future evolution of the pandemic.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We perform some validation tests with data of the evolution of the pandemic with analytic functions and solutions of the SIR model, that show that the procedure provides quite accurate fitting if the number of data is large enough. Also that assimilating data in a small time interval to a very small number of POD modes provides a qualitative good approximation of the evolution of the epidemic with relatively few elements in the vademecum. This approximation becomes fairly accurate if the vademecum is conveniently enriched. We apply the procedure to predict the evolution of the Covid-19 pandemic in Andalusia region, Spain and Italy. In despite of the fact that the official data on active infected people are well known to be far from the real ones, we obtain good accuracy in the prediction of the pandemic evolution in the next 7 days, with relative errors in infected, recovered and deceased populations typically below 4%, that are smaller for larger numbers of assimilated data increase.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The paper is organized as follows. The construction of the vademecum of solution is described in Section 2, the assimilation method is described in Section 3 and the least squares procedure in Section 4. Section 5 deals with the validation of the procedure, while finally Section 6 presents some conclusions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "We start form the basic SIR model, with variable infection rate, that we assume to correctly describe the pandemic:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "(1)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "Here S, I, and R respectively are the number of susceptible, infected and recovered individuals; S \u221e is the total population, \u03b1 is the transmission rate, that we assume variable in time, and \u03b2 is the recovery rate. The function \u03b1(t) and the parameter \u03b2 respectively are the inverse of the characteristic infection T i (t) and recovery times T r . If we consider the basic reproduction rate",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "we write the model as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "(2)",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "This model should be complemented with initial conditions",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "In practice we shall approximate r 0 by piecewise constant functions, taking into consideration the relaxation of the lockdown restriction as times goes on.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "We know reference values for r 0 for the Covid-19 epidemic, ranging from 0.5 when the lockdown measures take place for time enough, and up to 3 if no protection measures are taken. Also, a reference values for the recovery time T r is 15 (cf. Guti\u00e9rrez and Varona [5] , Jiwei et al. [6] ).",
            "cite_spans": [
                {
                    "start": 264,
                    "end": 267,
                    "text": "[5]",
                    "ref_id": "BIBREF1"
                },
                {
                    "start": 283,
                    "end": 286,
                    "text": "[6]",
                    "ref_id": "BIBREF2"
                }
            ],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "The real amount of infected people I 0 is far from being known, there are several estimates that give factors of around 15 times the official values. For instance in France the value of initially infected possibly is nearly 14 times the official one (cf. Roque et al. [8] ). However we shall take as reference values for I 0 , and for R 0 , the official number of infected and recovered people, respectively, at the initial time of our computation. As we shall see it will not be necessary to provide accurate approximations of the initial values of infected population to obtain good approximations of the recovered and deceased populations, which are the ones that affect the health care systems.",
            "cite_spans": [
                {
                    "start": 268,
                    "end": 271,
                    "text": "[8]",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "To construct our vademecum of solutions we define r 0 as We do not consider the initial phase of the epidemic in which no protection measures are taken, this period can be skipped as the data during the time interval [0, T ] are known. Our purpose is to use these data to predict the evolution of the epidemic in times later than T .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "We build the vademecum of solutions by solving the SIR model (2) for a set of discrete values of the parameters r ref,1 , r ref,2 , T r , I 0 and R 0 neighboring the reference values. We typically take 4 for both the initial conditions and for the parameters, equally spaced. The computation time T is large enough to let the epidemic reach its steady state for all set of parameters considered. We use the ODE45 Mathlab solver to perform the computations, with a time step of 0.01 days.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "We denote the vademecum of solutions as {I p } P p=1 , {R p } P p=1 , where P is the total number of runs generated by combining the different discrete values of the parameters. We assume that we know I p and R p at discrete times t n = n \u2206t, n = 0, 1, \u00b7 \u00b7 \u00b7 , M , so that T = M \u2206t, and denote I n p = I p (t n ) and similarly R n p . In practice we take \u2206t = 1 day.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Vademecum of model solutions"
        },
        {
            "text": "To build the reduced basis we apply the Proper Orthogonal Decomposition (POD) to the vademecum of solutions computed as described in the preceding section. Our claim is that if the true parameters that govern the epidemic lie within the range of parameters that we consider to build the vademecum, then the essential patterns of the epidemic will be well approximated by the linear space spanned by the vademecum solutions. Indeed, the solution of the initial value problem (2)-(3) depends continuously on the initial data, parameter \u03b2 and reproduction rate r 0 (t). If we denote its solution by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Construction of Reduced Basis"
        },
        {
            "text": "Lemma 3.1. Assume that S 0 \u2265 0, I 0 \u2265 0, R 0 \u2265 0, that \u03b2, \u03b2 lie in a bounded set B \u2282 R and that r 0 , r 0 lie in a bounded set R \u2282 L \u221e (0, T ). Then",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "Proof: The proof is standard by Gronwall's Lemma, using that S, I and R are non-negative and bounded by S \u221e .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": ". Then if our discretization of the parameters space is fine enough, we will obtain a good approximation of the epidemic evolution in the space spanned by the solution of the SIR model.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "As a consequence, in principle a least-squares fitting of the true epidemic data on the space spanned by the parametric solutions of the SIR model could give a good approximation of the evolution of the epidemic. However the grassmaniann matrices associated to the vademecum are singular up to computer precision.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "Instead we consider a reduced order approximation of the parametric solutions space. The POD allows to construct a reduced basis that retains the dominant patterns in the vademecum, and generate a space that provides a good approximation of the one spanned by the vademecum functions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "The Proper Orthogonal (or Karhunen-Lo\u00e8ve) decomposition provides a technique to obtain low-dimensional approximations of parametric functions. To describe it in our framework (cf. Aza\u00efez et al. [4] ), let us consider a Hilbert space H of finite dimension, endowed with a scalar product (\u00b7, \u00b7) H , and a parameter measure space G endowed with a measure \u00b5. In our case H = R K (for some K that we shall specify in the sequel) endowed with the discrete l 2 (0, t K ) inner product,",
            "cite_spans": [
                {
                    "start": 194,
                    "end": 197,
                    "text": "[4]",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "and G = {1, 2, \u00b7 \u00b7 \u00b7 , P } endowed with the discrete measure given by",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "where card(S) denotes the cardinal of the set S. Let us consider a function f \u2208 L 2 (G, H; d\u00b5), and introduce the POD operator",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "where we denote",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "The POD operator is trivially linear and bounded. Moreover it is self-adjoint and non-negative, as A = B * B, where B : H \u2192 L 2 (G; d\u00b5) and its adjoint operator B * : L 2 (G; d\u00b5) \u2192 H are given by (cf. Muller [7] , Chapter 2)",
            "cite_spans": [
                {
                    "start": 208,
                    "end": 211,
                    "text": "[7]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "Consequently, there exists an orthonormal basis of H formed by eigenvectors {v m } m\u22650 of A, associated to non-negative eigenvalues {\u03bb m } m\u22650 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "The main interest of the POD is the following best-approximation property (cf. [7] , Chapter 2):",
            "cite_spans": [
                {
                    "start": 79,
                    "end": 82,
                    "text": "[7]",
                    "ref_id": "BIBREF3"
                }
            ],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "In other words, the space spanned by the first l eigenfunctions of the POD operator provides the best approximation to f in parametric mean distance, among all subspaces of H of dimension l (or smaller).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "From a practical standpoint, to construct the POD of the vademecum (for instance for infected people) it turns out that the correlation matrix C \u2208 R N \u00d7N relative to the euclidean product in the parameter space,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "is the representation matrix of the POD operator A with respect to the canonical basis of H = R K . Therefore, if we consider the diagonalization of matrix C,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "-where D \u2208 R N \u00d7N is a diagonal matrix and V \u2208 R N \u00d7N is an orthogonal matrix-, then the diagonal elements of D are the eigenvalues of the POD operator A (that we assume to be ordered in decreasing value), and the columns of V are the associated eigenvectors. Then we extract as reduced basis the set {v 1 , \u00b7 \u00b7 \u00b7 , v N } with N such that \u03bb N < \u03b5 for a preset threshold \u03b5. Typically we take \u03b5 = 10 \u22126 . This amounts to N ranging from 2 to 13, the reduced basis really has a very small dimension if we consider that typically the vademecum contains several thousand functions.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "then it holds"
        },
        {
            "text": "The last step of the procedure to obtain a prediction of the evolution of the epidemic is to approximate the real epidemic data by least squares fitting on the reduced space",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data assimilation by least squares fitting"
        },
        {
            "text": "If the data are known in the discrete times t 1 , \u00b7 \u00b7 \u00b7 , t k (with t k < T ), we use the discrete L 2 (0, t k ) norm to assimilate the data:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data assimilation by least squares fitting"
        },
        {
            "text": "We thus search for I N \u2208 S N such that",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data assimilation by least squares fitting"
        },
        {
            "text": "where I D \u2208 R k+1 are the data for infected people at times t 0 , \u00b7 \u00b7 \u00b7 , t k . The same procedure is used to assimilate the data R D of recovered people.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data assimilation by least squares fitting"
        },
        {
            "text": "As the solution I N is defined for all times t k for k = 0, \u00b7 \u00b7 \u00b7 , N , the values I i N for i > k are used to estimate the values of infected people at later times. Similarly the values R i N for i > k are used to estimate the future values of recovered people.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data assimilation by least squares fitting"
        },
        {
            "text": "The length of the time period during which these estimates will be accurate will depend on the time smoothness of the function to fit (either I or R), on the accuracy of the approximation of the parametric solutions of the SIR model provided by our discretization of the parameter set, on wether our parameter set contains the parameters governing the epidemic evolution, and finally on how accurately the SIR model approximates the evolution of the pandemic.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data assimilation by least squares fitting"
        },
        {
            "text": "Test 1: Validation with analytic functions",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Validation"
        },
        {
            "text": "We have initially considered some analytic functions to validate the data assimilation procedure, and determine the range of time in which it may provide a good approximation, beyond the time interval used to assimilate the data. These are a trigonometric and a Gaussian function,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Validation"
        },
        {
            "text": "We have respectively used the following vademecums to fit them:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Validation"
        },
        {
            "text": "for l = \u2212m, \u00b7 \u00b7 \u00b7 , m, k = 5, \u00b7 \u00b7 \u00b7 , m + 5,",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Validation"
        },
        {
            "text": "for a given integer m \u2265 1. We present in Figures 1 and 2 the results for the first case. We intend to approximate function f T in [0, 2 \u03c0]. As f T belongs to the vademecum, it should be exactly approximated when we provide data enough. We set m = 5, then the vademecum contains P = 10 functions, and provide the values of these functions at equally spaced discrete times t k with step 2 \u03c0/100. We provide data to assimilate for k = 1, \u00b7 \u00b7 \u00b7 , 16. We observe that for N = 10 eigenvectors the fitting is quite accurate in the whole interval [0, 2 \u03c0], while for N = 9 there is a large error. Providing data for larger times (k \u2265 17) for N = 10 yields a perfect fitting in the interval [0, 2 \u03c0], but it only slightly improves the fitting for N \u2264 9. However if the data grid is refined, this behavior improves: Figure 2 displays the fitting with 9 eigenfunctions with a grid of half step, using data in the interval [0, 6 \u03c0/5].",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 41,
                    "end": 56,
                    "text": "Figures 1 and 2",
                    "ref_id": null
                },
                {
                    "start": 806,
                    "end": 814,
                    "text": "Figure 2",
                    "ref_id": null
                }
            ],
            "section": "Validation"
        },
        {
            "text": "In all cases the fitting in the time interval were data are provided is quite accurate. Figures 3 and 4 display the results for the second analytic test (7)- (9) . We intend to approximate the function f G in the interval [0, 120]. We set t 0 = 55 and m = 3, what yields P = 28 vademecum functions. We provide the values of the vademecum functions at equally spaced discrete times t k with step 120/100. We provide t k for relatively small intervals [0, 57] and [0, 60]. We observe that the fitting improves as the interval where data are provided increases, and a large gain in accuracy can be obtained with few more data (Figure 3 ). However if this interval is not large enough ( Figure 4 ) the fitting does not improve as the number of eigenmodes increases. For a relatively reduced interval where data are provided, the best fit is provided by a moderate number of eigenmodes. Furthermore, large oscillations of the fitting appear when the number of eigenmodes is excessive. This possibly occurs because the large frequencies are not well fitted. In both tests we have observed that large oscillations of the fitting function, beyond the interval in which data are given, appear when the number of assimilated data is not large enough for a given amount of eigenfunctions.",
            "cite_spans": [
                {
                    "start": 158,
                    "end": 161,
                    "text": "(9)",
                    "ref_id": "BIBREF5"
                }
            ],
            "ref_spans": [
                {
                    "start": 88,
                    "end": 103,
                    "text": "Figures 3 and 4",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 623,
                    "end": 632,
                    "text": "(Figure 3",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 683,
                    "end": 691,
                    "text": "Figure 4",
                    "ref_id": "FIGREF3"
                }
            ],
            "section": "Validation"
        },
        {
            "text": "This test is intended to analyze the ability of the ROM assimilation procedure to accurately predict the solution of the SIR model.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Test 2: SIR model solution"
        },
        {
            "text": "With this purpose we have constructed the vademecum by solving model (2) in the time interval [0, 1100] and time step 1 day, with data S \u221e = 47.100.396 (official Spanish population in 2020), and I 0 , R 0 , r 0 and T r respectively ranging in the sets {800, 900, 1000}, {50, 60, 70}, {0.6, 0.8, 1.1, 1.3}, and {5, 10, 20 , 25}. We have tested the length of the time interval in which data must be feed to the assimilation algorithm, as well as the number of modes needed to obtain accurate results. Figure 4 shows the assimilation to N = 1 (dominant mode) and N = 4 modes, of the data for infected people with different intervals of data assimilation. The qualitative behavior of the pandemic is roughly well approximated when N = 1, with estimated number of maximum number of infected people between 70% and 130% of those given by the SIR model. In addition, the estimation of the time at which the number of infected people reach its maximum is well approximated when N = 4, with increasing global accuracy as the time data interval increases. Assimilating data with as few data as t 1 to t 4 (and not less) allows to reproduce the overall features of the pandemic. This provides data to be assimilated for 4 discrete times, right the number of parameters on which depends problem (2). However gaining in accuracy for this vademecum requires a large amount of data, at least for [0, 550], which is almost half of the time interval in which the epidemic experiences appreciable changes (see Table 1 ). single time interval of data, and for N = 4 modes with different data assimilation intervals. We observe that in all cases the accuracy is improved with respect to the fitting with 1 mode for a number of modes between 1 and 4. However a number of modes above 4 produce less accurate approximations, in some cases with negative values. This is likely due to the high frequency components that are not well fitted unless the data are provided in a large enough interval, similarly to what happened in Test 1. The best result correspond to a relatively reduced number of modes (N = 4). Increasing the fitting data interval progressively decreases the error, that also is smaller for larger number of modes, decaying to values below 2%. This may also be observed in Table 1 . Note that the error for N = 12 modes is larger than the one for N = 11 modes until the time interval is nearly the full computation time interval. An alternative, and feasible, way to increase the accuracy is to enrich the vademecum with additional solutions of the SIR model, for finer grids of data. We have assimilated the SIR solution data obtained for I 0 = 850, R 0 = 55, r 0 = 1.2 and T r = 15, as before, but now on the reduced POD space constructed with the vademecum corresponding to the data I 0 = 850, R 0 = 55 and r 0 and T r respectively ranging in the sets {0.6, 0.65, \u00b7 \u00b7 \u00b7 , 1.15} \u222a {1.25, 1.30}, and {5, 5.5, \u00b7 \u00b7 \u00b7 , 14.5} \u222a {15.5, 16, \u00b7 \u00b7 \u00b7 , 24.5, 25}. Figure 6 displays the assimilation of just 4 data values, at times t 1 to t 4 . A good accuracy for the overall evolution of infected and recovered population is obtained, if the data are assimilated to as low as N = 3 POD eigenmodes. Figure  7 shows the 3 dominant eigenmodes, note that the shape of the first eigenmode retains the dominant pattern of the pandemic evolution.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 295,
                    "end": 320,
                    "text": "1.1, 1.3}, and {5, 10, 20",
                    "ref_id": "FIGREF2"
                },
                {
                    "start": 499,
                    "end": 507,
                    "text": "Figure 4",
                    "ref_id": "FIGREF3"
                },
                {
                    "start": 1492,
                    "end": 1499,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 2265,
                    "end": 2272,
                    "text": "Table 1",
                    "ref_id": null
                },
                {
                    "start": 2948,
                    "end": 2956,
                    "text": "Figure 6",
                    "ref_id": "FIGREF5"
                },
                {
                    "start": 3183,
                    "end": 3192,
                    "text": "Figure  7",
                    "ref_id": "FIGREF7"
                }
            ],
            "section": "Test 2: SIR model solution"
        },
        {
            "text": "In all tests performed up to now we have observed that large oscillations of the fitting function, beyond the interval in which data are given, appear when the number of data is not large enough for a given amount of eigenfunctions. This anomalous behavior will be used as an indicator to avoid un-accurate fitting.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data interval Numer of modes"
        },
        {
            "text": "We have applied the ROM data assimilation procedure to the Covid-19 pandemic with data from Italy, Spain and the Andalusia region in Spain.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Test 3: Covid-19 pandemic"
        },
        {
            "text": "As starting time we take the day when the lockdown took place in each area (March 9 2020 in Italy and March 16 in Andalusia and Spain). To construct the vademecum, as we mentioned in Section 2 we typically take 4 values for the initial conditions for the parameters, equally spaced, neighboring the reference values. We also assume the basic reproductive rate r 0 to take two values in different time intervals, as indicated in (4), to take into account the relaxation in meeting the lockdown measures. The reference times T 1 corresponds to the days in which the lockdown measures appeared to relax in each country or region: To validate the data we use a time period to assimilate the data, and compare the predicted values in a later time period with the official ones.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Test 3: Covid-19 pandemic"
        },
        {
            "text": "We have adapted the ROM data assimilation procedure to the prediction of the number of deceased people. We split the recovered R into true recovered P and deceased people D, and rewrite the SIR model as",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Test 3: Covid-19 pandemic"
        },
        {
            "text": "where \u03b2 r = \u03c1 \u03b2 and \u03b2 d = (1 \u2212 \u03c1) \u03b2, where \u03c1 \u2208 (0, 1) is a new parameter. Given the mortality of the pandemic, we have set \u03c1 = 0.9 as reference value for this parameter. To compute the vademecum, the parameter \u03c1 is also let to take 4 values equally spaced around the reference value, within the interval (0, 1). Figures 8 displays the results for Andalusia region, Italy and Spain, with official data respectively taken from [1],[3] and [2]. As data for Andalusia and Spain present large daily oscillations, we have instead used the moving time average over 3 days. We show the comparison of the fitting curve with the official reported values for the last 5 days. Among all possible number of modes, we select those for which the fitting function presents the smallest oscillations after the fitting data interval, without reaching negative values. We observe that the errors within the fitting interval are very small. Table 2 displays the relative errors for infected, recovered and deceased people in the three countries/regions for predictions to the next 5 and 7 days. Both predictions to 5 and 7 days are rather accurate, with errors typically below 4%, and in all cases below 9%. Errors for Italy and Spain are smaller, possibly because the populations are larger. The errors corresponding to predictions of infected and recovered populations to 7 days in Andalusia are smaller than to 5 days. This is not inconsistent as we are fitting the last either 5 or 7 days, and assimilating the data in all the preceding days. Some oscillations in a relatively small amount of data to assimilate possibly originate this behavior. ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 921,
                    "end": 928,
                    "text": "Table 2",
                    "ref_id": "TABREF2"
                }
            ],
            "section": "Test 3: Covid-19 pandemic"
        },
        {
            "text": "This paper introduces a data assimilation procedure for Covid-19 based upon Reduced Order Modelling (POD) of the solutions of the SIR epidemic model. It is based upon the hypothesis that although the actual model parameters that govern the epidemic are unknown, reference values are known. Thus the actual evolution of the pandemic may be well approximated by the vademecum generated by solving the SIR model with a number of parameters nearby the reference ones. This procedure has been tested with analytic functions and the solution of SIR model. We have concluded that:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "\u2022 The fitting error within the data assimilation interval is very small in all cases.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "\u2022 Assimilating data in a small time interval (at least as many days as parameters appear in the SIR model) to a very small number of modes provides a qualitative good approximation of the evolution of the epidemic: A rough approximation of the maximum number of infected persons and of the time at which the maximum takes place.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "\u2022 This assimilation of a very small number of data on a reduced space of very small dimension becomes fairly accurate if the vademecum formed with solutions of the SIR model is enriched by refining the parameters grids.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "\u2022 It is preferable to assimilate data to a moderate number of modes, that provides the best approximations unless the data fitting interval is very large. For larger number of modes the high frequencies are not well estimated, and generate large oscillations of the fitting function beyond the data assimilation time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "\u2022 To assimilate data for the true pandemic, a time adjustment of the basic reproductive rate appears to model the relaxation in the fulfillment of the lockdown measures.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        },
        {
            "text": "The application of the procedure to the evolution of the Covid-19 pandemic in Andalusia region, Italy and Spain shows accurate predictions for 5 days, that improve as the number of assimilated data increases. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Conclusions"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Faker Ben Belgacem, Tom\u00e1s Chac\u00f3n Rebollo, Recursive POD expansion for reaction-diffusion equation",
            "authors": [
                {
                    "first": "Mejdi",
                    "middle": [],
                    "last": "Aza\u00efez",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Eng. Sci",
            "volume": "3",
            "issn": "",
            "pages": "",
            "other_ids": {
                "DOI": [
                    "DOI10.1186/s40323-016-0060-1"
                ]
            }
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "An\u00e1lisis de la posible evoluci\u00f3n de la epidemia de coronavirus COVID-19 por medio de un modelo SEIR",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Jos\u00e9",
                    "suffix": ""
                },
                {
                    "first": "Juan",
                    "middle": [
                        "L"
                    ],
                    "last": "Guti\u00e9rrez",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Varona",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Zhang Ran, Modeling the Control of COVID-19: Impact of Policy Interventions and Meteorological Factors",
            "authors": [
                {
                    "first": "Jia",
                    "middle": [],
                    "last": "Jiwei",
                    "suffix": ""
                },
                {
                    "first": "Ding",
                    "middle": [],
                    "last": "Jian",
                    "suffix": ""
                },
                {
                    "first": "Liu",
                    "middle": [],
                    "last": "Siyu",
                    "suffix": ""
                },
                {
                    "first": "Liao",
                    "middle": [],
                    "last": "Guidong",
                    "suffix": ""
                },
                {
                    "first": "Li",
                    "middle": [],
                    "last": "Jingzhi",
                    "suffix": ""
                },
                {
                    "first": "Duan",
                    "middle": [],
                    "last": "Ben",
                    "suffix": ""
                },
                {
                    "first": "Wang",
                    "middle": [],
                    "last": "Guoqing",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2003.02985v1"
                ]
            }
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "On the POD Method. An Abstract Investigation with Applications to Reduced-Order Modeling and Suboptimal Control",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Muller",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Mod\u00e8le SIR m\u00e9canico-statistique pour l'estimation du nombre d'infect\u00e9s et du taux de mortalit\u00e9 par COVID-19",
            "authors": [
                {
                    "first": "Lionel",
                    "middle": [],
                    "last": "Roques",
                    "suffix": ""
                },
                {
                    "first": "Etienne",
                    "middle": [],
                    "last": "Klein",
                    "suffix": ""
                },
                {
                    "first": "Julien",
                    "middle": [],
                    "last": "Papa\u00efx",
                    "suffix": ""
                },
                {
                    "first": "Samuel",
                    "middle": [],
                    "last": "Soubeyrand",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {
                "arXiv": [
                    "arXiv:2003.10720v2"
                ]
            }
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "On the POD Method. An Abstract Investigation with Applications to Reduced-Order Modeling and Suboptimal Control",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "M\u00fcller",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "where r ref,1 and r ref,2 are reference values for r 0 in the time intervals [0, T 1 ] and [T 1 , T ]. The first time interval corresponds to the initial phase of the lockdown with strict fitting of protection measures by the people (21 days). The second one correspond to a second phase in which there is some relaxation of the lockdown measures. We have taken r ref,1 = 1.1 and r ref,2 = 0.8.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Test of trigonometric function with refined mesh, data provided in [0,6 pi/5] Test 1: Data assimilation for trigonometric function. Refined mesh data.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Test 1: Data assimilation for Gaussian function. Fitting with 5 eigenfunctions.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "Test 2: Data assimilation for SIR model solution to N = 1 (left) and N = 4 (right) POD modes.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF4": {
            "text": "Test 2: Data assimilation for SIR model solution to several number of POD modes on fixed data assimilation interval (left), and to a fixed number of modes on variable data assimilation intervals (right).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "Test 2: Data assimilation with vademecum constructed with refined data grid, for infected (left) and recovered (right) populations.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF6": {
            "text": ". Three first POD modes for recovered population,decreasing size of associated eigenvalues.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Test 2: Data assimilation with vademecum constructed with refined data grid. First three dominant eigenvalues for infected (left) and recovered (right) populations.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Test 3: Prediction of Covid-19 pandemic evolution in Andalusia region, Italy and Spain to 7 days. Red dots represent the assimilated data, blue dots the predicted ones, and the blue lines are the fitted curves. The peaks in these curves correspond to the change in the basic reproduction rate r 0 .",
            "latex": null,
            "type": "figure"
        },
        "TABREF2": {
            "text": "",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": []
}