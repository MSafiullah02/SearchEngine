{
    "paper_id": "25a214cd63f69f33402c6339146be0bc7ff0b7b9",
    "metadata": {
        "title": "Simple models for COVID-19 death and fatal infection profiles",
        "authors": [
            {
                "first": "Simon",
                "middle": [
                    "N"
                ],
                "last": "Wood",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "University of Bristol",
                    "location": {
                        "country": "UK"
                    }
                },
                "email": "simon.wood@bath.edu"
            }
        ]
    },
    "abstract": [
        {
            "text": "Simple smooth additive models for the observed death-with-COVID-19 series adequately capture the underlying death rate and strong weekly pattern in the data. Clear inference about peak timing is then possible. Further, inference about the earlier infection rate dynamics driving the death rate dynamics can be treated as a simple Bayesian inverse problem, which can be readily solved by imposing a smoothness assumption on the infection rate. This straightforward semi-parametric approach is substantially better founded than the running mean smoothers which generally form the basis for public debate. In the absence of direct statistically based measurement of infection rates, it also offers a usefully assumption-light approach to data analysis, for comparison with the results of the more assumption-rich process simulation models used to inform policy. An interesting result of the analysis is that it suggests that the number of new daily infections in the UK peaked some days before lock down was implemented, although it does not completely rule out a slightly later peak.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "At time of writing, it is five months into the COVID-19 pandemic. Despite millions of tests having been performed, there are still no results from statistically well founded sampling based testing programmes to establish basic epidemic quantities such as infection fatality rate and infection rates. In the absence of such direct data, epidemic management has to proceed on the basis of data produced largely as a side effect of the clinical response to the disease.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The purpose of this note is to point out that a very simple smooth additive model is able to satisfactorily represent country specific death rate data series, such as those shown in figure 1 and collated at https://www.worldometers.info/coronavirus/. Such a model allows resolution of inferential questions about the timing of the peak in the underlying death rate. Augmenting this model with information from Verity et al. (2020) on the distribution of times from symptom onset to death, a simple extension to the model also allows inference about the infection rate dynamics required to generate the deaths series. The advantage of such simple semi-parametric models is that, in contrast to detailed epidemic models, they make only modest assumptions about the data. They can therefore offer relatively clear insight into what the data are telling us, without the influence of strong modelling assumptions, thereby providing a useful complement to more heavily model based analyses.",
            "cite_spans": [
                {
                    "start": 410,
                    "end": 430,
                    "text": "Verity et al. (2020)",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "2 A smooth additive model for the death rate series Let y i denote the deaths reported on day i. Assume that y i follows a negative binomial distribution with mean \u00b5 i and variance \u00b5 i + \u00b5 2 i /\u03b8. Then let ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "w (7), where k = 0, 1 or 2 denotes order of derivative. g is a known link function, either log or identity in this case.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "f (t) and f w (d) are represented using appropriate intermediate rank spline basis expansions, with associated cubic spline penalties (see e.g. Wood, 2017) . f (t) represents the underlying death rate, while f w (d) accounts for the strong weekly cycle seen in the data, presumably as a result of reporting artefacts and the well known weekly signal in hospital admissions. The model treats the weekly variability issue descriptively rather than mechanistically.",
            "cite_spans": [
                {
                    "start": 144,
                    "end": 155,
                    "text": "Wood, 2017)",
                    "ref_id": "BIBREF6"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Model inference uses the empirical Bayes approach of Wood et al. (2016) in which the smooth functions are estimated by penalized likelihood maximisation (e.g. Green and Silverman, 1994) , with the smoothing parameters and \u03b8 estimated by Laplace approximate marginal likelihood maximization. Writing \u03b2 for the combined vector of basis coefficients for f and f w , the penalized log likelihood can be written",
            "cite_spans": [
                {
                    "start": 53,
                    "end": 71,
                    "text": "Wood et al. (2016)",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 159,
                    "end": 185,
                    "text": "Green and Silverman, 1994)",
                    "ref_id": "BIBREF0"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "where S \u03bb = \u03bb f S f + \u03bb w S w : S f and S w are known constant positive semi-definite matrices.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Smoothing parameters, \u03bb f and \u03bb w , control the smoothness of f and f w . Let\u03b2 be the maximizer of the penalized log likelihood, and H its negative Hessian at\u03b2. Viewing the penalty as being induced by an improper Gaussian prior, \u03b2 \u223c N (0, S \u2212 \u03bb ),\u03b2 is also the MAP estimate of \u03b2. Furthermore in the large sample limit",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Writing the density in (1) as \u03c0 g , and the joint density of y and \u03b2 as \u03c0(y, \u03b2), the Laplace approximation to the marginal likelihood for the smoothing parameters \u03bb and \u03b8 is \u03c0(\u03bb, \u03b8) = \u03c0(y, \u03b2)/\u03c0 g (\u03b2|y). Nested Newton iterations are used to find the values of log(\u03bb), \u03b8 maximizing \u03c0(\u03bb, \u03b8) and the corresponding\u03b2 (for details see Wood et al., 2016) .",
            "cite_spans": [
                {
                    "start": 328,
                    "end": 346,
                    "text": "Wood et al., 2016)",
                    "ref_id": "BIBREF7"
                }
            ],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "Given (1) credible intervals for f are readily computed, but it is also straightforward to make inferences about when the peak in f occurs. Simply simulate replicate coefficient vectors from (1) and find the day of occurrence of the peak for each corresponding underlying death rate function, f . This approach requires a few lines of R code to implement, which are provided in the supplementary material.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "The model fits to the reported deaths in the UK and Sweden are shown in figure 2 along with basic model checking plots. Figure 3 shows the posterior mode of the underlying death rates against day, with Sweden. e is the ACF of the deviance residuals for the UK, lag 1 is just significantly negative. f plots deviance residuals against day for the UK. g and h are the equivalent checking plots for Sweden.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 120,
                    "end": 128,
                    "text": "Figure 3",
                    "ref_id": null
                }
            ],
            "section": "Introduction"
        },
        {
            "text": "credible intervals, as well as illustrating the posterior distribution of the day of peak underlying death rate. The UK peak is around day 28, something which could have been confidently declared around day 40 with this modelling approach. For Sweden the peak is later and by the end of the plotted data it is not yet quite possible to rule out that the peak has not yet occurred, although the probability of this is < 3%.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Introduction"
        },
        {
            "text": "It is also of interest to infer the sequence of past (ultimately fatal) infections required to produce the observed sequence of deaths. This is not simply a matter of lagging the death sequence by the average infection to death time, because the distribution of time from symptom onset to death is broad and asymmetric. Verity et al. (2020) show that the distribution of time from onset of symptoms to death for fatal cases can be modelled by a gamma density with mean 17.8 and variance 71.2 (s.d. 8.44). Note that this mean is longer than that often quoted in clinical papers and the media, because it corrects for the bias associated with seeing short infections before long ones at the start of an epidemic. Let f c (t) be the function describing the variation in the number of eventually fatal cases over time. Let B be the square matrix such that B ij = \u03b3(i \u2212 j + 1) if i \u2265 j and 0 otherwise, where \u03b3 denotes the onset-to-death gamma density, given above.",
            "cite_spans": [
                {
                    "start": 320,
                    "end": 340,
                    "text": "Verity et al. (2020)",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Inferring the past fatal infection profile"
        },
        {
            "text": "is the expected number of deaths on day i. Now log f c (i) can be represented using an intermediate rank spline, again with a cubic spline penalty. We can then employ exactly the model of the previous section but setting f (i) = log \u03b4(i). The only difference is that we need to infer f c over a considerable period before the first death occurs. 40 days is clearly sufficient given the form of \u03b3. In fact it makes sense to reduce this interval, after inspecting a pilot run, to avoid a lengthy initial period of zero fatal cases, consequent lack of identifiability of log f c and poor MCMC mixing. For the UK data a 20 day initial period is more than sufficient. For stable inference it also makes sense to explicitly include in the death data the fact that no deaths were observed in this initial period. Note that B is rank deficient, so inferring f c can be viewed as an inverse problem, only soluble because of the smoothness assumption on log f c .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Inferring the past fatal infection profile"
        },
        {
            "text": "In principle this model could be estimated using the framework of Wood et al. (2016) , but some nontrivial work would be required to set it up. In the current context, in which results are needed rapidly, it is sensible to take the approach requiring the least amount of bespoke code. The most straightforward implementation is to use Gibbs sampling via JAGS (Plummer, 2003; Plummer et al., 2006) . Implementation is particularly straightforward if the automatic code template generation described in Wood (2016) is used, as implemented in mgcv function jagam. The JAGS code template can be generated for the model given in the previous section. A few lines of additional code are then sufficient to implement the modification described here. The only disadvantage of the approach is that stochastic simulation is slow. While the previous section's model took less than 1/20th of a second to compute, a couple of hours of computing was required for a mean effective sample size of 3.5 thousand for the coefficients of log f c (and even then the slowest mixing coefficient had an effective sample size of only 250). Figure 4 (left) shows the posterior median estimate of the fatal infection rate f c against day for the UK. Also shown are 80% and 95% credible intervals, and a scaled bar chart summarizing the posterior distribution of the day of peak fatal infection. The day of UK lock down is shown as a vertical grey line. The alignment with the time axis requires an allowance for the incubation period of the disease, i.e. the time from infection to onset of symptoms. This period is 2 to 11 days for 95% of people, with a median of 5 days (Lauer et al., 2020) . In the absence of more detailed information about the incubation distribution I simply shifted the inferred f c curve back 5 days. Figure 4 (right) shows a model checking comparison with the death rate models of section 2. 100 death rate profiles were simulated by taking the median number of fatal infections each day and, for each infection, randomly generating the corresponding death day from the onset-to-death gamma model. These profiles are shown in grey. Overlaid is the death rate estimate from the section 2 model. Clearly the models are consistent with each other, but at its end the median infection curve may be over-optimistic about how far the infection rate has declined.",
            "cite_spans": [
                {
                    "start": 66,
                    "end": 84,
                    "text": "Wood et al. (2016)",
                    "ref_id": "BIBREF7"
                },
                {
                    "start": 359,
                    "end": 374,
                    "text": "(Plummer, 2003;",
                    "ref_id": "BIBREF2"
                },
                {
                    "start": 375,
                    "end": 396,
                    "text": "Plummer et al., 2006)",
                    "ref_id": "BIBREF3"
                },
                {
                    "start": 501,
                    "end": 512,
                    "text": "Wood (2016)",
                    "ref_id": "BIBREF5"
                },
                {
                    "start": 1645,
                    "end": 1665,
                    "text": "(Lauer et al., 2020)",
                    "ref_id": "BIBREF1"
                }
            ],
            "ref_spans": [
                {
                    "start": 1115,
                    "end": 1123,
                    "text": "Figure 4",
                    "ref_id": null
                },
                {
                    "start": 1799,
                    "end": 1807,
                    "text": "Figure 4",
                    "ref_id": null
                }
            ],
            "section": "Inferring the past fatal infection profile"
        },
        {
            "text": "Given that the peak is estimated to occur before lock down, it is worth considering whether this could be an artefact resulting from a smooth model trying to accommodate a sudden drop in infections at lock down. There is obviously a question about how sudden this drop would be, given that lock down initially substantially increases contact with household members at the expense of everyone else, and in addition there had already been substantial social distancing before lock down. However sticking with checking the model itself, the inferred curve has strange properties if it contains artefacts from trying to match a very steep drop. The most notable is that the magnitude of the slope of the curve is actually lower on the first day of lock down, after the peak, than before the peak. The second is that the log scale squared second differences, which measure the contribution to the smoothing penalty, are low around lock down compared to earlier: again there is no indication of the model trying to smooth through a step.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Inferring the past fatal infection profile"
        },
        {
            "text": "A peak before lock down is consistent with the absence of a catastrophe in the data from Sweden, which did not lock down, and is not entirely implausible, given the level of social distancing already in place before UK lock down. Alternatively, it could be that the onset to death distribution from Verity et al. (2020) gives too long durations for the UK context. For example, this could happen if age strongly effects time from onset-to-death and the age structure of the UK cases differs substantially from the age structure of the cases used by Verity et al. (2020) . Similarly within hospital transmission to already very ill patients might lead to shorter disease duration, and in turn to the peak being estimated as earlier than it was, but the cross infection rate would have to be quite high for this to be a substantial factor.",
            "cite_spans": [
                {
                    "start": 299,
                    "end": 319,
                    "text": "Verity et al. (2020)",
                    "ref_id": "BIBREF4"
                },
                {
                    "start": 549,
                    "end": 569,
                    "text": "Verity et al. (2020)",
                    "ref_id": "BIBREF4"
                }
            ],
            "ref_spans": [],
            "section": "Inferring the past fatal infection profile"
        },
        {
            "text": "The very wide confidence interval at the end of the data period relates to the rank deficiency of the B matrix and the mild smoothing assumptions on log f c used to deal with this. Increase in f c at the end of the time period is biologically implausible, given earlier decline and the measures still in place at the end of the period. This implausibility is not built into the model, in keeping with the desire for the analysis to be as data driven as possible. However, the wide interval does emphasise the desirability of disease surveillance via a statistically sound randomized testing program in order to reduce uncertainty. Such testing would be inexpensive in the context of the \u00a35.5Billion per day UK economy being put on hold for weeks.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Inferring the past fatal infection profile"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "Nonparametric Regression and Generalized Linear Models",
            "authors": [
                {
                    "first": "P",
                    "middle": [
                        "J"
                    ],
                    "last": "Green",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [
                        "W"
                    ],
                    "last": "Silverman",
                    "suffix": ""
                }
            ],
            "year": 1994,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "The incubation period of coronavirus disease 2019 (covid-19) from publicly reported confirmed cases: estimation and application",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "A"
                    ],
                    "last": "Lauer",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [
                        "H"
                    ],
                    "last": "Grantz",
                    "suffix": ""
                },
                {
                    "first": "Q",
                    "middle": [],
                    "last": "Bi",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [
                        "K"
                    ],
                    "last": "Jones",
                    "suffix": ""
                },
                {
                    "first": "Q",
                    "middle": [],
                    "last": "Zheng",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [
                        "R"
                    ],
                    "last": "Meredith",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [
                        "S"
                    ],
                    "last": "Azman",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [
                        "G"
                    ],
                    "last": "Reich",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lessler",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Annals of internal medicine",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "JAGS: A program for analysis of Bayesian graphical models using Gibbs sampling",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Plummer",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Proceedings of the 3rd International Workshop on Distributed Statistical Computing",
            "volume": "",
            "issn": "",
            "pages": "20--22",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "coda: Convergence diagnosis and output analysis for",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Plummer",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Best",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Cowles",
                    "suffix": ""
                },
                {
                    "first": "K",
                    "middle": [],
                    "last": "Vines",
                    "suffix": ""
                }
            ],
            "year": 2006,
            "venue": "MCMC. R News",
            "volume": "6",
            "issn": "1",
            "pages": "7--11",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Estimates of the severity of coronavirus disease 2019: a model-based analysis. The Lancet Infectious Diseases",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Verity",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [
                        "C"
                    ],
                    "last": "Okell",
                    "suffix": ""
                },
                {
                    "first": "I",
                    "middle": [],
                    "last": "Dorigatti",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Winskill",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Whittaker",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Imai",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Cuomo-Dannenburg",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Thompson",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "G"
                    ],
                    "last": "Walker",
                    "suffix": ""
                },
                {
                    "first": "H",
                    "middle": [],
                    "last": "Fu",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Just another Gibbs additive modeller: Interfacing JAGS and mgcv",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "N"
                    ],
                    "last": "Wood",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Journal of Statistical Software",
            "volume": "75",
            "issn": "7",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Generalized Additive Models: An Introduction with R (2 ed.)",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "N"
                    ],
                    "last": "Wood",
                    "suffix": ""
                }
            ],
            "year": 2017,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "Smoothing parameter and model selection for general smooth models (with discussion)",
            "authors": [
                {
                    "first": "S",
                    "middle": [
                        "N"
                    ],
                    "last": "Wood",
                    "suffix": ""
                },
                {
                    "first": "N",
                    "middle": [],
                    "last": "Pya",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "S\u00e4fken",
                    "suffix": ""
                }
            ],
            "year": 2016,
            "venue": "Journal of the American Statistical Association",
            "volume": "111",
            "issn": "",
            "pages": "1548--1575",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "## Sweden model matrix, weekly removed if (ps) postscript(\"death-fits.eps",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Xs",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": ",cex=c1) plot(b,scale=0,select=2,xlab=\"day of week, d\",ylab=expression(f[w](d)),cex.lab=c2);text(6.4,-.465,\"b\",cex=c1) plot(bs,scale=0,select=1,xlab=\"day, t\",ylab=\"f(t)",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "if (ps) postscript(\"death-rates.eps",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Sweden death rate\") for (j in 1:2) { ## 1, UK; 2, Sweden if (j==1) { beta <-coef",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Yla &lt;-C",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Xj <-Xs } fv <-Xj% * %beta ## death rates -link scale se <-rowSums(Xj * (Xj% * %Vb",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "ll <-ilink(fv-2 * se)",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "ul <-ilink(fv+2 * se) ylim <-if (j==1) range(uk) else range(sweden) plot(mu,type=\"l\",xlab=\"day",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "function(x) which(x==max(x))) ## find peak location for each pt <-tabulate(peak) / if (j==1) 1 else 7 ## tabulate peak locations and scale for plotting for (i in 1:length(pt)) if",
            "authors": [],
            "year": null,
            "venue": "bp <-rmvn(n.rep,beta,Vb) ## simulate 1000 parameter vectors from posterior peak <-apply(Xj% * %t(bp)",
            "volume": "2",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "glm\") ## improved samplers for GLMs often worth loading setwd(\"foo/bar\") ## directory for plots and JAGS code uk1 <-c(rep(0,20),uk) ## append run in time before anyone dies nc <-length(uk1) day <-1:nc dow <-rep(1:7,100)[1:nc] jdat <-data.frame(deaths = uk1, day=day,dow=dow) d <-dgamma(1:nc",
            "authors": [],
            "year": null,
            "venue": "########################################## library(rjags);library(mgcv) load.module",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "B <-matrix(0,nc,nc) for (i in 1:nc) { ## map case rate day i-1 to death rate day i",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF23": {
            "ref_id": "b23",
            "title": "} ## following sets up a model template and associated data, suitable for editing ## into desired model",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "jad <-jagam(deaths\u02dcs(day,k=20)+s(dow,bs=\"cc\",k=7),family=poisson,data=jdat, knots=list(dow=c(0,7)),file=\"death.jags",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF25": {
            "ref_id": "b25",
            "title": "## adding in the forward mapping matrix jad$jags.data$Z <--6 ## a bit of extra regularization jm <-jags.model(\"death-cases1.jags",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Jad$jags.Data$b &lt;-B",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "## check chains",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "effectiveSize(as.mcmc.list(sam$theta))",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "mar=c(4,4,1,1)) for (i in 1:20) plot(sam$b[i",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "if (ps) postscript(\"infections.eps\",width=11,height=4.5) par(mfrow=c(1,2),mar=c",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "5",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF31": {
            "ref_id": "b31",
            "title": "975)) ## get profile CIs day <-1:length(uk1)-26 ## account for run in + 1 day shift deaths to onsets + 5 day incubation plot(day,fm,type=\"l\",ylim=c(0,max(fq)),ylab=\"UK fatal infections",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "1",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF32": {
            "ref_id": "b32",
            "title": "## Some smooth diagnostics -looking for high grad or curvature around lock down that could ## indicate model trying to match abrupt change",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF33": {
            "ref_id": "b33",
            "title": "(fm)) lines(1:length(df)+.5-26,df,col=\"grey",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF34": {
            "ref_id": "b34",
            "title": "))) ## locate the peak (ignore any wild boundary highs) pt <-tabulate(peak) ## tabulate and plot as bar chart",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF35": {
            "ref_id": "b35",
            "title": "),lwd=3) -matrix(0,n.rep,n) for (j in 1:n.rep) for (i in 1:n) { t <-round(rgamma(fi[i],shape=17.8/4,scale=4)) ## simulate death times for fi[i] fatal cases t <-t[i+t-1<=n] ## discard deaths beyond end of data dd <-tabulate(t) ii <-1:length(dd)+i-1 death[j,ii] <-death",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF36": {
            "ref_id": "b36",
            "title": "X <-model.matrix(b)",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF37": {
            "ref_id": "b37",
            "title": "21:25] <-0 ## UK model matrix, weekly removed beta <-coef(b)",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF39": {
            "ref_id": "b39",
            "title": "* %beta ## death rates -link scale se <-rowSums(Xj * (Xj% * %Vb))\u02c6.5 ## corresponding s.e. lines(1:length(fv),exp(fv)) lines(1:length(fv),exp(fv+2 * se),lty=2) lines(1:length(fv),exp(fv-2 * se",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Xj &lt;-X Fv &lt;-Xj%",
                    "suffix": ""
                }
            ],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF0": {
            "text": "Results of fitting the model of section 2 to the data in figure 1. a and b are posterior modes (solid) and 95% credible intervals for the model functions for the UK. c and d are the equivalent for",
            "latex": null,
            "type": "figure"
        },
        "FIGREF1": {
            "text": "Underlying death rates for the UK (left) and Sweden (right) with 95% credible intervals, excluding the weekly cycle. Day 0 is March 13th 2020. The scaled grey bar chart illustrates the distribution of the location of the peak of the death rate curve, obtained by simulation from the approximate posterior (1) for each model. The scales are chosen to be the same as figure 1, and the figures are therefore comparable on the deaths per million scale. Left: The inferred UK fatal infection profile over time (day 0 is March 13th 2020). The black curve is the posterior median, the dashed curves delimit an 80% credible interval and the dotted curves a 95% credible interval. The scaled bar chart shows the posterior distribution of the day of peak fatal infection. The full height vertical grey line shows the first day of UK lock down. The dashed grey curve is proportional to the squared second difference of the median infection profile on the log scale, which is proportional to the smoothing penalty. The grey curve is proportional to the absolute gradient of the infection profile. Right: Consistency checking. In grey are 100 replicate death profiles corresponding to the median infection profile shown left. Overlaid is the underlying death rate inferred in section 2.",
            "latex": null,
            "type": "figure"
        },
        "TABREF0": {
            "text": "of the relative populations of the two countries a 'deaths per million population' scale would be almost identical for the two plots. The UK lock down started on day 11. Sweden has no lock down.where f is a smooth function of time, t i , measured in days, and f w is a zero mean cyclic smooth function of day of the week, d i \u2208 {1, 2, . . . , 7}, set up so that f",
            "latex": null,
            "type": "table"
        }
    },
    "back_matter": [
        {
            "text": "The following is modified from the template produced by the jagam call in the R code. -c(18,12,22,16,34,43,36,56,35,74,149,186,183,284,294,214,374,382,670,652, 714,760,644,568,1038,1034,1103,1152,839,686,744,1044,842,1029,935,1115, 498,559,1172,837,727,1005,843,420,338,909,795,674,739,621) sweden <-c(0,0,4,1,2,1, 5, 4, 1, 6, 13, 22, 15, 28, 0, 5, 36, 34, 59, 69, 50, 15, 28, 76, 114, 96, 106, 77, 17, 12, 20, 114, 170, 130, 67, 111, 29, 40, 185, 172, 84, 131, 40, 2, 80, 81, 107, 124, 67, 16) ## plot the raw data... ps <-FALSE if (ps) postscript(\"covid-deaths.eps\",width=11,height=4.5) par(mfrow=c(1,2),mar=c(5,5,1,1)) ## note that cases per million axes almost identical for the 2 plots plot(uk,type=\"b\",xlab=\"Days since March 13\",ylab=\"Reported UK Deaths\") plot(sweden,type=\"b\",xlab=\"Days since March 13\",ylab=\"Reported Sweden Deaths\") if (ps) dev.off() day <-1:length(uk) dow <-rep(1:7,100)[1:length(uk)] dat <-data.frame(deaths = uk, day=day,dow=dow) ## UK data dats <-data.frame(deaths = sweden, day=day,dow=dow) ## Sweden data ## Fit the basic death profile models... library(mgcv) b <-gam(deaths\u02dcs(day,k=20)+s(dow,bs=\"cc\",k=7),family=nb(link=\"log\"),data=dat, method=\"REML\",knots=list(dow=c(0,7))) ## much lower AIC than identity link bs <-gam(deaths\u02dcs(day,k=20)+s(dow,bs=\"cc\",k=7),family=nb(link=\"log\"),data=dats, method=\"REML\",knots=list(dow=c(0,7))) ## Now plot the estimated effects and basic checking plots... X <-model.matrix(b);X[,21:25] <-0 ## UK model matrix, weekly removed",
            "cite_spans": [
                {
                    "start": 86,
                    "end": 290,
                    "text": "-c(18,12,22,16,34,43,36,56,35,74,149,186,183,284,294,214,374,382,670,652, 714,760,644,568,1038,1034,1103,1152,839,686,744,1044,842,1029,935,1115, 498,559,1172,837,727,1005,843,420,338,909,795,674,739,621)",
                    "ref_id": null
                },
                {
                    "start": 315,
                    "end": 317,
                    "text": "5,",
                    "ref_id": null
                },
                {
                    "start": 318,
                    "end": 320,
                    "text": "4,",
                    "ref_id": null
                },
                {
                    "start": 321,
                    "end": 323,
                    "text": "1,",
                    "ref_id": null
                },
                {
                    "start": 324,
                    "end": 326,
                    "text": "6,",
                    "ref_id": null
                },
                {
                    "start": 327,
                    "end": 330,
                    "text": "13,",
                    "ref_id": null
                },
                {
                    "start": 331,
                    "end": 334,
                    "text": "22,",
                    "ref_id": null
                },
                {
                    "start": 335,
                    "end": 338,
                    "text": "15,",
                    "ref_id": null
                },
                {
                    "start": 339,
                    "end": 342,
                    "text": "28,",
                    "ref_id": null
                },
                {
                    "start": 343,
                    "end": 345,
                    "text": "0,",
                    "ref_id": null
                },
                {
                    "start": 346,
                    "end": 348,
                    "text": "5,",
                    "ref_id": null
                },
                {
                    "start": 349,
                    "end": 352,
                    "text": "36,",
                    "ref_id": null
                },
                {
                    "start": 353,
                    "end": 356,
                    "text": "34,",
                    "ref_id": null
                },
                {
                    "start": 357,
                    "end": 360,
                    "text": "59,",
                    "ref_id": null
                },
                {
                    "start": 361,
                    "end": 364,
                    "text": "69,",
                    "ref_id": null
                },
                {
                    "start": 365,
                    "end": 368,
                    "text": "50,",
                    "ref_id": null
                },
                {
                    "start": 369,
                    "end": 372,
                    "text": "15,",
                    "ref_id": null
                },
                {
                    "start": 373,
                    "end": 376,
                    "text": "28,",
                    "ref_id": null
                },
                {
                    "start": 377,
                    "end": 380,
                    "text": "76,",
                    "ref_id": null
                },
                {
                    "start": 381,
                    "end": 385,
                    "text": "114,",
                    "ref_id": null
                },
                {
                    "start": 386,
                    "end": 389,
                    "text": "96,",
                    "ref_id": null
                },
                {
                    "start": 390,
                    "end": 394,
                    "text": "106,",
                    "ref_id": null
                },
                {
                    "start": 395,
                    "end": 398,
                    "text": "77,",
                    "ref_id": null
                },
                {
                    "start": 399,
                    "end": 402,
                    "text": "17,",
                    "ref_id": null
                },
                {
                    "start": 403,
                    "end": 406,
                    "text": "12,",
                    "ref_id": null
                },
                {
                    "start": 407,
                    "end": 410,
                    "text": "20,",
                    "ref_id": null
                },
                {
                    "start": 411,
                    "end": 415,
                    "text": "114,",
                    "ref_id": null
                },
                {
                    "start": 416,
                    "end": 420,
                    "text": "170,",
                    "ref_id": null
                },
                {
                    "start": 421,
                    "end": 425,
                    "text": "130,",
                    "ref_id": null
                },
                {
                    "start": 426,
                    "end": 429,
                    "text": "67,",
                    "ref_id": null
                },
                {
                    "start": 430,
                    "end": 434,
                    "text": "111,",
                    "ref_id": null
                },
                {
                    "start": 435,
                    "end": 438,
                    "text": "29,",
                    "ref_id": null
                },
                {
                    "start": 439,
                    "end": 442,
                    "text": "40,",
                    "ref_id": null
                },
                {
                    "start": 443,
                    "end": 447,
                    "text": "185,",
                    "ref_id": null
                },
                {
                    "start": 448,
                    "end": 452,
                    "text": "172,",
                    "ref_id": null
                },
                {
                    "start": 453,
                    "end": 456,
                    "text": "84,",
                    "ref_id": null
                },
                {
                    "start": 457,
                    "end": 461,
                    "text": "131,",
                    "ref_id": null
                },
                {
                    "start": 462,
                    "end": 465,
                    "text": "40,",
                    "ref_id": null
                },
                {
                    "start": 466,
                    "end": 468,
                    "text": "2,",
                    "ref_id": null
                },
                {
                    "start": 469,
                    "end": 472,
                    "text": "80,",
                    "ref_id": null
                },
                {
                    "start": 473,
                    "end": 476,
                    "text": "81,",
                    "ref_id": null
                },
                {
                    "start": 477,
                    "end": 481,
                    "text": "107,",
                    "ref_id": null
                },
                {
                    "start": 482,
                    "end": 486,
                    "text": "124,",
                    "ref_id": null
                },
                {
                    "start": 487,
                    "end": 490,
                    "text": "67,",
                    "ref_id": null
                },
                {
                    "start": 491,
                    "end": 494,
                    "text": "16)",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Supplementary material JAGS code"
        }
    ]
}