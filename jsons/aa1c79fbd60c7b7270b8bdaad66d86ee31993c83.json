{
    "paper_id": "aa1c79fbd60c7b7270b8bdaad66d86ee31993c83",
    "metadata": {
        "title": "Deep learning the atmospheric boundary layer height",
        "authors": [
            {
                "first": "David",
                "middle": [
                    "R"
                ],
                "last": "Vivas",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad del Valle",
                    "location": {
                        "addrLine": "Edificio E20 No. 1069",
                        "postCode": "760032",
                        "settlement": "Cali",
                        "country": "Colombia"
                    }
                },
                "email": ""
            },
            {
                "first": "Estiven",
                "middle": [],
                "last": "S\u00e1nchez",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad del Valle",
                    "location": {
                        "addrLine": "Edificio E20 No. 1069",
                        "postCode": "760032",
                        "settlement": "Cali",
                        "country": "Colombia"
                    }
                },
                "email": ""
            },
            {
                "first": "John",
                "middle": [
                    "H"
                ],
                "last": "Reina",
                "suffix": "",
                "affiliation": {
                    "laboratory": "",
                    "institution": "Universidad del Valle",
                    "location": {
                        "addrLine": "Edificio E20 No. 1069",
                        "postCode": "760032",
                        "settlement": "Cali",
                        "country": "Colombia"
                    }
                },
                "email": "john.reina@correounivalle.edu.co"
            }
        ]
    },
    "abstract": [
        {
            "text": "A question of global concern regarding the sustainable future of humankind stems from the effect due to aerosols on the global climate. The quantification of atmospheric aerosols and their relationship to climatic impacts are key to understanding the dynamics of climate forcing and to improve our knowledge about climate change. Due to its response to precipitation, temperature, topography and human activity, one of the most dynamical atmospheric regions is the atmospheric boundary layer (ABL): ABL aerosols have a sizable impact on the evolution of the radiative forcing of climate change, human health, food security, and, ultimately, on the local and global economy. The identification of ABL pattern behaviour requires constant monitoring and the application of instrumental and computational methods for its detection and analysis. Here, we show a new method for the retrieval of ABL top arising from light detection and ranging (LiDAR) signals, by training a convolutional neural network in a supervised manner; forcing it to learn how to retrieve such a dynamical parameter on real, non-ideal conditions and in a fully automated, unsupervised way. Our findings pave the way for a full integration of LiDAR elastic, inelastic, and depolarisation signal processing, and provide a novel approach for real-time quantitative sensing of aerosols.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Abstract"
        }
    ],
    "body_text": [
        {
            "text": "Atmospheric particulate matter (PM) stands for a mixture of microscopic solid particles and liquid droplets suspended in the air, which can be of varied chemical composition and size distribution 1 . These include coarse and fine particles such as PM 10 , PM 2.5 , including nitrates, sulfites, organic carbon and black carbon [2] [3] [4] [5] . Also referred to as atmospheric aerosols, they are a key indicator of air pollution, and their heterogeneity arises from the numerous sources and varying formation mechanisms, as they can be either directly emitted to the atmosphere or produced in the atmosphere from precursor gases [6] [7] [8] [9] [10] [11] [12] . Continuous high concentration levels of atmospheric pollution pose many crucial challenges and important adversarial effects, ranging from impact on global public health, mortality and morbidity due to increased cases of cardiovascular and cardio-respiratory diseases linked to long-term exposure to fine particles [13] [14] [15] , through to direct implications on climatic changes [2] [3] [4] [6] [7] [8] [9] [10] [11] [12] 16, 17 , and agriculture 14, [18] [19] [20] [21] . It has become a latent need to accurately monitor the atmospheric variables that allow for the prediction of air pollution behaviour, in order to issue early alarms for the protection of the population. One of the variables of greatest interest is the dynamical height of the atmospheric boundary layer (ABL), the lowest layer of the troposphere that is directly influenced by the Earth surface by means of both natural and anthropogenic emissions 22 .",
            "cite_spans": [
                {
                    "start": 196,
                    "end": 197,
                    "text": "1",
                    "ref_id": null
                },
                {
                    "start": 327,
                    "end": 330,
                    "text": "[2]",
                    "ref_id": null
                },
                {
                    "start": 331,
                    "end": 334,
                    "text": "[3]",
                    "ref_id": null
                },
                {
                    "start": 335,
                    "end": 338,
                    "text": "[4]",
                    "ref_id": null
                },
                {
                    "start": 339,
                    "end": 342,
                    "text": "[5]",
                    "ref_id": null
                },
                {
                    "start": 629,
                    "end": 632,
                    "text": "[6]",
                    "ref_id": null
                },
                {
                    "start": 633,
                    "end": 636,
                    "text": "[7]",
                    "ref_id": null
                },
                {
                    "start": 637,
                    "end": 640,
                    "text": "[8]",
                    "ref_id": null
                },
                {
                    "start": 641,
                    "end": 644,
                    "text": "[9]",
                    "ref_id": null
                },
                {
                    "start": 645,
                    "end": 649,
                    "text": "[10]",
                    "ref_id": null
                },
                {
                    "start": 650,
                    "end": 654,
                    "text": "[11]",
                    "ref_id": null
                },
                {
                    "start": 655,
                    "end": 659,
                    "text": "[12]",
                    "ref_id": null
                },
                {
                    "start": 977,
                    "end": 981,
                    "text": "[13]",
                    "ref_id": null
                },
                {
                    "start": 982,
                    "end": 986,
                    "text": "[14]",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 987,
                    "end": 991,
                    "text": "[15]",
                    "ref_id": "BIBREF14"
                },
                {
                    "start": 1045,
                    "end": 1048,
                    "text": "[2]",
                    "ref_id": null
                },
                {
                    "start": 1049,
                    "end": 1052,
                    "text": "[3]",
                    "ref_id": null
                },
                {
                    "start": 1053,
                    "end": 1056,
                    "text": "[4]",
                    "ref_id": null
                },
                {
                    "start": 1057,
                    "end": 1060,
                    "text": "[6]",
                    "ref_id": null
                },
                {
                    "start": 1061,
                    "end": 1064,
                    "text": "[7]",
                    "ref_id": null
                },
                {
                    "start": 1065,
                    "end": 1068,
                    "text": "[8]",
                    "ref_id": null
                },
                {
                    "start": 1069,
                    "end": 1072,
                    "text": "[9]",
                    "ref_id": null
                },
                {
                    "start": 1073,
                    "end": 1077,
                    "text": "[10]",
                    "ref_id": null
                },
                {
                    "start": 1078,
                    "end": 1082,
                    "text": "[11]",
                    "ref_id": null
                },
                {
                    "start": 1083,
                    "end": 1087,
                    "text": "[12]",
                    "ref_id": null
                },
                {
                    "start": 1088,
                    "end": 1091,
                    "text": "16,",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 1113,
                    "end": 1116,
                    "text": "14,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 1117,
                    "end": 1121,
                    "text": "[18]",
                    "ref_id": "BIBREF17"
                },
                {
                    "start": 1122,
                    "end": 1126,
                    "text": "[19]",
                    "ref_id": null
                },
                {
                    "start": 1127,
                    "end": 1131,
                    "text": "[20]",
                    "ref_id": null
                },
                {
                    "start": 1132,
                    "end": 1136,
                    "text": "[21]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "The ABL top (ABLT) is defined as the midpoint of the sharp transition zone between the ABL and the free troposphere 23 . In an ideal LiDAR signal, it is identifiable as the midpoint of the first sharp reduce of intensity, the so-called entrainment zone. In a real LiDAR signal, several intensity peaks can be detected before or after the actual ABLT, thus erroneously estimating its location. The fully automated and unsupervised detection of the ABLT has been a challenging topic for the LiDAR community during more than two decades, with the development of numerous contributions such as the gradient 24 and second derivative 25 methods, the wavelet Covariance transform (WCT) method [26] [27] [28] [29] , several fitting methods [30] [31] [32] , and some approaches based on the statistical analysis of the LiDAR signal, over the time evolution of successive signals 33, 34 . Of the aforementioned, the gradient, second derivative, and WCT have achieved big spread and acceptance 23,24,26-29 ; probably due to their simplicity and ease of implementation. However, these methods are heavily limited by the weather conditions that determine the shape of the signal, usually failing to retrieve plausible predictions under the presence of clouds, heavy noise and layer overlapping phenomena. In order to avoid these error sources, a search threshold can be defined for each specific case study, thus sacrificing automaticity in the process.",
            "cite_spans": [
                {
                    "start": 116,
                    "end": 118,
                    "text": "23",
                    "ref_id": null
                },
                {
                    "start": 686,
                    "end": 690,
                    "text": "[26]",
                    "ref_id": null
                },
                {
                    "start": 691,
                    "end": 695,
                    "text": "[27]",
                    "ref_id": null
                },
                {
                    "start": 696,
                    "end": 700,
                    "text": "[28]",
                    "ref_id": null
                },
                {
                    "start": 701,
                    "end": 705,
                    "text": "[29]",
                    "ref_id": null
                },
                {
                    "start": 732,
                    "end": 736,
                    "text": "[30]",
                    "ref_id": null
                },
                {
                    "start": 737,
                    "end": 741,
                    "text": "[31]",
                    "ref_id": null
                },
                {
                    "start": 742,
                    "end": 746,
                    "text": "[32]",
                    "ref_id": null
                },
                {
                    "start": 870,
                    "end": 873,
                    "text": "33,",
                    "ref_id": null
                },
                {
                    "start": 874,
                    "end": 876,
                    "text": "34",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Fitting methods attempt to circumvent these limitations via the automatic fitting of the experimental signal to an ideal one, from which an ABLT value 30 or a search threshold 32 can be extracted. Nonetheless, these methods are still limited by the shape of the signal, given that under non-ideal conditions, such shape can be substantially different from the ideal one. This translates into the retrieval of an invalid fitting and a consequent inaccurate ABLT value.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "The above-mentioned methods assume that the aerosol concentration inside the ABL is significantly higher than the one in the free troposphere 23 . These methods process each signal independently, and are computationally inexpensive (assuming an adequate implementation), allowing the possibility of realtime detection. Methods based on statistical analysis usually rely on information of the signal's time evolution over a set of measurements, so they are outside the scope of this work.",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "In this article, we present a new method for real-time, fully automated and unsupervised ABLT detection from atmospheric LiDAR signals. Our method uses a deep learning model, specifically a convolutional neural network (NN), trained to detect the atmospheric boundary layer top on real, non-ideal conditions. The results here reported have been obtained from data acquired from in-situ measurements performed at the LALINET network LiDAR-CIBioFi station (Cali, Colombia), which has been operational since 2018, and constitutes a regional strategy that Figure 1 . Neural Network Architecture. The input signal is fed to three convolutional layers, each one with five kernels that decompose the signal into low-levels features. This new representation of the signal is then fed to a three-layer multilayer perceptron (MLP), which defines a non-linear transformation that finally returns the detected ABLT. Initially only dense architectures (MLPs) were considered, but their inclination to overfitting lead to poor performance on validation and test data. Progressively increasing the number of convolutional layers at the start of the model significantly increased its generalisation capabilities.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 552,
                    "end": 560,
                    "text": "Figure 1",
                    "ref_id": "FIGREF10"
                }
            ],
            "section": ""
        },
        {
            "text": "contributes to the analysis and prediction of climate, weather and air quality 32 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": ""
        },
        {
            "text": "Extracting the atmospheric boundary layer height from Li-DAR retrievals: A deep learning approach.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Given a range-corrected LiDAR signal (RCS), an ABLT value is obtained by forward-propagating the signal over the layers of a convolutional network 35 . The architecture of the implemented neural network is illustrated (by means of PlotNeuralNet 36 ) in figure 1. The dataset used for the training and tuning of the model is conformed by 15000 signals labeled via WCT, as explained in Supplementary Material, with a custom search threshold for each individual one; this was done in order to ensure the quality of the labels and, consequently, the predictions of the neural network. WCT was chosen as the labeling method both for its ease of implementation, and well-known robustness and performance [27] [28] [29] 37 . Assuming the correct training of the model, it is then expected that it replicates the predictions of a signal-by-signal fine-tuned WCT, but in a completely automated and non-supervised manner.",
            "cite_spans": [
                {
                    "start": 698,
                    "end": 702,
                    "text": "[27]",
                    "ref_id": null
                },
                {
                    "start": 703,
                    "end": 707,
                    "text": "[28]",
                    "ref_id": null
                },
                {
                    "start": 708,
                    "end": 712,
                    "text": "[29]",
                    "ref_id": null
                },
                {
                    "start": 713,
                    "end": 715,
                    "text": "37",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "The convolutional neural network here proposed for ABLT detection is compared to WCT in a supervised variant (custom search threshold for all time evolution) and unsupervised WCT (full signal as input during all time evolution). WCT has been chosen as the baseline as for the past two decades it has been used to measure the ABLT in numerous case studies 27,29,37 with one of these being Wuhan 28 , a region of growing environmental interest during the 2020 SARS-CoV-2 virus pandemic outbreak 38 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Over the past six months, fires of unprecedented impact on people wellbeing, biodiversity, wildlife, and infrastructure have dramatically affected the australian continent (january 2020) 8, 16 and the Amazon rainforest (august 2019) 9, 39 . Their possible connection to climate changes 16, 17, 40 have raised serious alarms, and a recurrent need for global environmental policy and timely law reinforcement, as well as for more accurate climate dynamics and atmospheric predictions, all of which constitute a crucial challenge for both adaptation and mitigation 16, 17, 40 .",
            "cite_spans": [
                {
                    "start": 187,
                    "end": 189,
                    "text": "8,",
                    "ref_id": null
                },
                {
                    "start": 233,
                    "end": 235,
                    "text": "9,",
                    "ref_id": null
                },
                {
                    "start": 236,
                    "end": 238,
                    "text": "39",
                    "ref_id": null
                },
                {
                    "start": 286,
                    "end": 289,
                    "text": "16,",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 290,
                    "end": 293,
                    "text": "17,",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 294,
                    "end": 296,
                    "text": "40",
                    "ref_id": null
                },
                {
                    "start": 562,
                    "end": 565,
                    "text": "16,",
                    "ref_id": "BIBREF15"
                },
                {
                    "start": 566,
                    "end": 569,
                    "text": "17,",
                    "ref_id": "BIBREF16"
                },
                {
                    "start": 570,
                    "end": 572,
                    "text": "40",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "A detailed comparison of the results for ABLT prediction on different days (14, 15, 16 and 21) of august 2019, from data obtained at the LiDAR-CIBioFi station, is presented in figures 2 and 3. During such period, strong aerosol transport from the Amazon rain forest wildfires was reported by NASA's Atmospheric Infrared Sounder (AIRS) instrument aboard the Aqua satellite 41 , showing the aerosols propagation from the source (brazilian northwest Amazon region) through to the north of South America, during 8-22 august 2019, thus providing a challenging test bench for the above-described methods. The size of NASA's reported fires was so large that they could be spotted from space, and spread over several large Amazon states in northwest Brazil 9,39,40 . The results are depicted in graphs of temporal evolution (see figures 2 and 3) that exhibit very different LiDAR results throughout the day. The dynamics are presented in 2D graphs, with the signal intensity plotted in a colour scale; in figure 2a, each dashed vertical line corresponds to a single LiDAR measurement profile, which in turn are shown in figures 2b, and 2c.",
            "cite_spans": [
                {
                    "start": 75,
                    "end": 79,
                    "text": "(14,",
                    "ref_id": "BIBREF13"
                },
                {
                    "start": 80,
                    "end": 83,
                    "text": "15,",
                    "ref_id": "BIBREF14"
                }
            ],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "On August 14 (figure 2), clouds around 4 km height, with some formations around 2 km were detected, with the latter being very close to the height of the boundary layer, thus posing a challenge for accurate ABLT detection. In addition, some cases of turbulence were detected after 14 h. The first single LiDAR measure profile (figure 2b), taken at about 12:30 h, exhibits a stable and well-mixed layer, making it easy to discriminate between ABL and free troposphere, thus allowing a straightforward evaluation of the predictions: the NN gives very similar results to the supervised WCT (about 1.8 km), while the unsupervised WCT located the ABLT in a cloud formation above 4 km height. In contrast, the second profile (figure 2c), taken at 15:40 h, gives very different results for the supervised (sup.) WCT, the unsupervised (unsup.) WCT, and the NN. The sup. WCT located the ABLT at 500 m, below the expected result. The unsup. WCT placed the result at around 4 km, in a cloud formation pattern, while the NN located the ABLT about 2.6 km, following its actual behaviour. The temporal evolution of the LiDAR measurement profiles of figure 2 makes it clear that the unsup. WCT detection locates the position of the boundary layer at cloud formation height, erroneously placing the ABLT in most cases. The sup. WCT shows ABLT detection problems, severely underestimating ABLT, for cases of proximity to clouds (see e.g., around 12 h), and in cases of greater turbulence (e.g., after 14 h). Despite the drawbacks presented by sup. WCT and unsup. WCT, figure 2 clearly shows that our convolutional NN estimation of ABLT is resilient to turbulence and proximity of clouds, and correctly follows its evolution.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Aerosol transport and biomass-burning emissions identification: The case of 2019 Brazilian rainforest wildfires.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Following our analysis, we next introduce the results for the case study of the Amazon rain forest fires (august 2019), as plotted in figure 3 , for august 15, 16, and 21. August 15 (figure 3a) is a day of particular interest, since we detected ABLT levels around 0.5 km in the morning, well below the 1 km height-approximately the average value in the study region. This decrease in ABLT corresponds to an increase in the PM concentration, possibly due to a temperature decrease in the troposphere. This was corroborated by the local authority for air quality monitoring (DAGMA), and alerts due to local high PM concentration were issued on this date 42 . Similar concerns already pointed out for the ABLT detection methods were encountered in this case, for both supervised and unsupervised WCT. The supervised WCT, for example, registers ABLT values close to 400 m at about 14:00 h, which would imply a PM concentration higher than that reported during the morning, an incorrect prediction following the measurement results. This points out how critical is the requirement of a correct ABLT prediction in assessing the need for communicating early alarms due to high PM concentration, thus avoiding false positives.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 134,
                    "end": 142,
                    "text": "figure 3",
                    "ref_id": "FIGREF2"
                }
            ],
            "section": "Results"
        },
        {
            "text": "Figure 3b (August 16) exhibits a stable and well-mixed layer, which allows for a straightforward discrimination between ABL and free troposphere; in this case, the supervised WCT provides similar predictions to the NN. Unsupervised WCTs, as expected, are located in a layer of cloud formation around 4 km.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "On August 21 (figure 3c), an unusual local scenario was detected: ABLT levels about 4 km, well above the 1 km average, with small variations in the PM concentration during the day. A sharp ABLT increase of this kind is expected to be followed by a decrease in the PM concentration: if the latter is not observed, it is most likely that aerosol transport from a different source, say another region, may be occurring. This hypothesis is demonstrated in this case by analysing the wind and aerosol transport by means of the HYSPLIT backward trajectories model (figure 4), from which we were able to trace, on this date, the burning of biomass due to the 2019 Amazon rain forest fire 41 . In addition, and to corroborate this result, data reported by NASA's Atmospheric Infrared Sounder (AIRS) instrument aboard the Aqua Predictions for ABLT results arising from the three methods here considered are quite different from each other in the latter scenario (figure 3c). The unsupervised WCT is only able to locate values near the ABLT during an interrupted time window of about two hours, otherwise its forecasts are above 5 km in upper clouds (not shown). The supervised WCT shows ABLT values well below the actual ones, detecting most of them below 1 km height during extended time windows, which is an overly underestimation. In contrast to the previous results, the proposed NN-based method follows the appreciated ABLT evolution contour, during the full time-frame measured (9:30-19:00 h) and without difficulty. The results show that the high expressive power of the neural-network makes it possible to obtain physically plausible ABLT values, even in the presence of unusual atmospheric phenomena that are difficult to predict for traditional methods such as WCT. We stress that the propagation time through the NN is of the order of milliseconds on a CPU, and even faster on a GPU, thus allowing the possibility of real-time detection.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "Besides the prediction analysis of every particular case-study, we have performed a measurement of the standard deviation The standard deviation of the full time evolution can be used as a reliable metric of dispersion, but not of continuity. This is illustrated in figure 5a for August 21, where the full std. dev. of supervised WCT is smaller than the one of the NN, in stark contrast to what is shown in figure 3c. Given this, the mean distance between each point and its immediate neighbour was considered as a continuity metric, as it provides results that are consistent with those of figures 2 and 3. The mean standard deviation over blocks of 30 minutes acts as a middle ground metric between the aforementioned ones, as it quantifies dispersion on a small time window according to the high temporal variability exhibited by the ABL 43 .",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 266,
                    "end": 275,
                    "text": "figure 5a",
                    "ref_id": "FIGREF7"
                }
            ],
            "section": "Results"
        },
        {
            "text": "The results show that, for all the case studies here treated, the tested NN achieves the highest continuity of time evolution and least dispersion on its ABLT predictions, followed by sup. WCT. This coincides with the dynamical behaviour observed in figures 2 and 3.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Results"
        },
        {
            "text": "We conclude by summarising our findings and perspectives. A novel technique for active atmospheric remote sensing, and, in particular, for atmospheric boundary layer estimation has been presented using convolutional neural networks, having the data processed in real time, and without the need for supervision or postprocessing. A large set of LiDAR data were collected in-situ with instrumentation available at our station, and their corresponding boundary layer values labeled in a controlled manner with WCT. To validate and evaluate the performance of our model, we have analysed different scenarios, under very different atmospheric conditions. Compared to the WCT approaches, the proposed NN results were more robust and could readily be used as an ABLT estimator. We found that, to quantify ABLT during these experiments, the structure of NN provided better regression effects than those from WCT. Our network architecture easily adapts different ranges of behaviour of the mixing layer, differentiating turbulence and cloud proximity phenomena. As a test bed for our model, we have considered an example of important complexity: we have reported a several days scenario during August 2019, with well marked different behaviour and particularities. This time frame coincided with the northwest brazilian summer Amazon rain forest wildfires 9,39-41 . We have shown how the reported NN model allowed us to quantify the influence due to such wildfires on our local aerosol dynamics: despite turbulence in the mixture layer and close presence of clouds, we were able to successfully identify the ABLT by means of the proposed neural network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "Our model has been specifically trained with 532 nm LiDAR data in elastic configuration, but future work will consider its extension to additional information channels, such as other elastic wavelengths and inelastic scattering, as well as to the depolarisation channel 37 . As the neural networks excel at learning highly complex correlations between channels of data, the implementation of such extensions would lead to an improved accuracy, since this can be used both as an additional input for the neural network, and as a complementary method for refining the labels fed to the model during the training time.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Discussion"
        },
        {
            "text": "The experimental setup that provided the LiDAR retrievals used in this work is shown in figure 6 . It consists in a LiDAR system located at CIBioFi-Universidad del Valle (3.37N; 76.53W). The LiDAR configuration used operates in elastic mode to receive single-scattered signals at 532 nm of wavelength, with a coaxial static alignment. The emission component comprises a single frequency Nd:YAG pulsed laser (Q-smart 450 mJ, by Quantel) with a pulse width of \u2264 6 ns at 1064 nm, and a pulse repetition frequency of 10 Hz. A second harmonic generator (SHG) was implemented in order to double the central frequency resulting in a wavelength of 532 nm with an average energy \u2265 220 mJ. The output beam has a diameter of 6.5 mm which is expanded three times (3\u00d7) through a Galilean system.",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 88,
                    "end": 96,
                    "text": "figure 6",
                    "ref_id": "FIGREF8"
                }
            ],
            "section": "Experimental setup"
        },
        {
            "text": "A Newtonian telescope with a focal length of 1.0 m and a primary mirror with a diameter of 0.3 m constitutes the reception component. The telescope with a field view of 1.47 mrad collects the backscattered light by the atmosphere. The ocular is coupled to a diaphragm with variable aperture, then to an interferential filter at 532 nm, and finally to a photomultiplier tube (Hamamatsu, R9880U series) to guarantee the reception of the light elastically scattered with a quantum efficiency of 50% at 532 nm. The transient recorder system (Licel, TR20-160) comprises the configuration detection unit. The transient system allows the discrimination of signals of different altitude through the synchronisation with a periodic signal (the trigger), which generally comes from the Q-switch control of the laser system, achieving a spatial resolution of 3.75 m in the vertical atmospheric column.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimental setup"
        },
        {
            "text": "The acquisition protocol consists of routine observations on different days, storing LiDAR signals with at least 2000 pulses per data from 8:00 until 18:00, local time, on a weekly basis, since 2018 up to date.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Experimental setup"
        },
        {
            "text": "Hyperparameter tuning was achieved via importance sampling over progressively smaller hyperparameter grids. Logcosh was chosen as loss function and Adam 44 as optimizer, as they exhibited the fastest convergence for this particular problem. Batch normalisation 45 was used between layers for even faster convergence. No L2 regularisation or dropout were used (see Supplementary Material).",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computational method"
        },
        {
            "text": "Training was performed on 400 epochs with a linear learn rate decay from an initial value 0.1 to a final value of 0.001. 12000 signals were used as a training set, 3000 signals as cross-validation set, and another 2000 unlabeled signals as a qualitative test set, all normalised via standardisation. This computational method was implemented in the TensorFlow library 46 via its Python 3 API. Additional information about the ABLT neural network-ABLT-NN code can be found in Supplementary Code.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Computational method"
        },
        {
            "text": "The data reported in this article are available from the corresponding authors upon reasonable request. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Data availability"
        },
        {
            "text": "The Wavelet covariance Transform (WCT) method 1,2 is based on the convolution between the LiDAR rangecorrected signal B(z) and a Haar wavelet h, which is defined as 3 :",
            "cite_spans": [
                {
                    "start": 165,
                    "end": 166,
                    "text": "3",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Wavelet covariance transform method"
        },
        {
            "text": "where the parameter a is known as the amplitude or dilation of the wavelet. The convoluted WCT (z, a) signal is then:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wavelet covariance transform method"
        },
        {
            "text": "Convolving B(z) with h z a results in a new signal where each point indicates a degree of similarity between both. Given that h z a is, essentially, an abrupt gradient, each point z of the convoluted signal will quantify the gradients present on an interval of amplitude a around the point z of the original signal. Thus, the minimum of this convolution represents the point of higher similarity between B(z) and h z a , and its altitude z wct ABL is then, assuming that an adequate interval around the entrainment zone was chosen, taken as the atmospheric boundary layer top (ABLT):",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wavelet covariance transform method"
        },
        {
            "text": "where z res lidar denotes the vertical spatial resolution of the LiDAR setup (3.75 m in our configuration). The dilation a defines the width of each convolution window, so if such dilation matches the entrainment zone width, the convolution region corresponding to it will be maximised relative to gradients of smaller amplitude, such as the ones associated to instrumental noise 2,4 , thus providing an ABLT value close to the midpoint of the indicated entrainment zone (assuming an adequate search interval was chosen). Nevertheless, the presence of clouds represents a factor of failure for this method, given that the optical width of these can reflect as gradients higher than the one associated to the entrainment zone, even for dilations close to the entrainment zone width 2 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wavelet covariance transform method"
        },
        {
            "text": "The method regarded in this work as supervised WCT differs only in the fact that the search interval of the z wct ABL is limited to a threshold that encompasses the entrainment zone observed for the entire time evolution of each particular case study, in order to approximately avoid clouds or large gradients that can negatively affect the performance of the method, thus requiring supervision. In contrast, unsupervised WCT defines a search threshold that goes from the start of the LiDAR signal to an upper bound defined by the observed interpretable portion of the signal, which in our particular experimental setup corresponds to around 6 km of altitude.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wavelet covariance transform method"
        },
        {
            "text": "It is worth mentioning that the convolution operation involved in this method is treated in its traditional mathematical sense (similar to that of equation (4), but flipping the kernel on its dimensions before the operation), so it is not equivalent to the operation treated as a convolution in section 2.2 of this supplementary material. If the convolution were performed as a cross-correlation operation, the resulting signal would be flipped around the x-axis, so argmax should instead be used.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Wavelet covariance transform method"
        },
        {
            "text": "Artificial neural-networks (NNs) are computational systems partially inspired by the biological neuron. The main components of the architecture of a NN are computing units called Artificial Neurons (ANs), which are interconnected in such a way that allows the propagation of information through the structure of the NN. The branch of artificial intelligence that concerns the design, architecture and optimisation of NNs is known as deep learning 5,6 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Artificial neural networks 2.1 Multi-layer perceptron"
        },
        {
            "text": "The quintessence of deep learning is the perceptron. Its more general version, the multi-layer perceptron (MLP) 5, [7] [8] [9] , is a sequential model conformed by one or more layers of ANs. An MLP defines a transformation y = f (X, \u03b8) and is trained to learn the parameters \u03b8 = {W, b} that best approximate f to an objective function f * which is, in general, unknown explicitly, but con-tained in the inner structure of a set of data 6, 9 . MLPs are also called feedforward neural networks, because in these, information flows from an input layer to the hidden layers of ANs, and finally to an output layer ; there are no feedback connections in which the output of a layer returns to itself as input.",
            "cite_spans": [
                {
                    "start": 112,
                    "end": 114,
                    "text": "5,",
                    "ref_id": null
                },
                {
                    "start": 115,
                    "end": 118,
                    "text": "[7]",
                    "ref_id": null
                },
                {
                    "start": 119,
                    "end": 122,
                    "text": "[8]",
                    "ref_id": null
                },
                {
                    "start": 123,
                    "end": 126,
                    "text": "[9]",
                    "ref_id": null
                },
                {
                    "start": 436,
                    "end": 438,
                    "text": "6,",
                    "ref_id": null
                },
                {
                    "start": 439,
                    "end": 440,
                    "text": "9",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Artificial neural networks 2.1 Multi-layer perceptron"
        },
        {
            "text": "The propagation of information between two sequential layers, say the (l \u2212 1)-th and the l-th, of an MLP is done via the following expression:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Artificial neural networks 2.1 Multi-layer perceptron"
        },
        {
            "text": "where A [l] is the vector containing the artificial neurons of the l-th layer, W [l] is a dense weight matrix which defines the connections between the neurons of both layers, b [l] is a weight vector called bias and g [l] is a non-linear function that is applied element-wise to induce non-linearity in the transformation defined by the MLP. The initial layer A [0] of an MLP corresponds to the input layer X.",
            "cite_spans": [
                {
                    "start": 8,
                    "end": 11,
                    "text": "[l]",
                    "ref_id": null
                },
                {
                    "start": 219,
                    "end": 222,
                    "text": "[l]",
                    "ref_id": null
                },
                {
                    "start": 363,
                    "end": 366,
                    "text": "[0]",
                    "ref_id": null
                }
            ],
            "ref_spans": [],
            "section": "Artificial neural networks 2.1 Multi-layer perceptron"
        },
        {
            "text": "Given that W is a dense matrix, the computational cost of MLPs scales poorly with the dimensionality of data. To approach this problem, a new NN architecture inspired by the biological visual cortex was conceived, the so-called convolutional neural network.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Artificial neural networks 2.1 Multi-layer perceptron"
        },
        {
            "text": "In deep learning, convolution refers to the operation usually regarded as cross-correlation in mathematics. For the two-dimensional case, this operation involves a matrix M and a filter or kernel K, and returns the degree of similarity C between M and K, for each of the points of M on that convolution is possible. Mathematically, this operation is denoted by a star \" \" and is defined as:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "where (i, j) are the matrix indices of M and (m, n) those of K. For the one-dimensional case of a given signal S, the operation is reduced to:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "In deep learning, additional parameters are usually defined on the convolution operation, such that the dimensions m conv 1 \u00d7 m conv 2 of the two-dimensional convolution between an array of dimensions m1 \u00d7 m2 and a filter with dimensions k1 \u00d7 k2 are given by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "where the parameters (s1, s2) are known as stride, and indicate the number of elements to skip between consecutive filter applications. The (p1, p2) parameters are known as padding, and indicate the number of zeros that will be added around the edges of the input, in order to preserve their original dimensions after convolution.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "When a NN layer uses the MLP propagation function, equation (3), it is said to be a dense layer. In contrast, when a layer of a NN uses",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "as its propagation function, then it is said to be a convolutional layer. Here W [l] is a multidimensional array of filters that are convoluted in batch with the input of the layer. A Convolutional Neural Network (CNN, ConvNet or simply NN) is usually defined as a neural network with at least one convolutional layer 6,10,11 , although MLPs are sometimes regarded as CNNs.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "Unlike dense layers, convolutional layers operate by applying the same set of weights (filters) over each region of the input, and are said to be spatially regularized. It is the application of multiple low-dimensional filters that allows a convolutional layer to abstract features of a highdimensional input (such as high-resolution images) at a low computational cost 6,10,11 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Convolutional neural networks"
        },
        {
            "text": "The parameters of a NN architecture that can be only varied by the programmer (such as the number of hidden layers or the number of neurons per layer) are regarded as hyperparameters. The remaining parameters that can be varied by the machine (such as the weights and biases) are adjusted via a training process performed by means of an algorithm called backpropagation 9 .",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Training the neural network"
        },
        {
            "text": "Given that backpropagation is a delicate and challenging algorithm to implement, especially for deeper architectures, training of neural networks is usually performed via linear algebra and symbolic derivation libraries such as Tensorflow 12 that automatically implement and perform the backpropagation process for a given neural network architecture.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Training the neural network"
        },
        {
            "text": "Once trained, the neural network can be treated as a blackbox that receives a portion of a lidar signal B(z) as input (e.g., the first 2000 points of the signal exhibited a good performance in our experiments), and ouputs an approximate ABLT vector index NN (B(z)) value such that the ABLT altitude z NN ABL is given by:",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Neural-network for ABLT detection"
        },
        {
            "text": "where z res lidar denotes the vertical spatial resolution of the LiDAR setup.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Neural-network for ABLT detection"
        },
        {
            "text": "The ABLT detection was approached as a regression problem, as the NN outputs a single, continuous value on its final layer. A classification approach was also attempted, where the output layer of the NN consisted on a 2000 unit softmax layer, with each element indicating an ABLT occurrence probability at its corresponding altitude. Nevertheless, performance of this second approach was significantly poorer than the direct, regression treatment.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Neural-network for ABLT detection"
        },
        {
            "text": "During August 2019, one of the largest forest fires of recent times was recorded in the Brazilian Amazon forest. The transport of aerosols due to the burning of biomass was registered by satellite information, e.g., from Aqua 13 . This anomalous increase in the aerosol layer reached southwestern Colombia, and was detected at the LiDAR-CIBioFi on-site station, recording the most consistent behaviour on August 21, as reported in figure 2c of main paper. Data from NASA's Atmospheric Infrared Sounder (AIRS) instrument, aboard the Aqua satellite 13 , as shown in figure 1 of supplementary material (SM), serves as a guide to examine our results. Figure 1 -SM shows the transport of carbon monoxide during a 14, b 15, c 16, and d 21 of August, at a height of around 5.5 km being dragged towards the northwestern South American. Carbon monoxide is a pollutant that contributes to both air pollution and climate change; the concentrations depicted in colour in figure 1-SM range between green (100 parts per billion by volume-ppbv) and dark red (160 ppbv) 13 . In these plots, we can indeed appreciate the massive aerosol cloud distribution over a vast region of subcontinental South America, and, in particular, the impact on southwestern Colombia, the region where the measurements here reported were taken.",
            "cite_spans": [
                {
                    "start": 1054,
                    "end": 1056,
                    "text": "13",
                    "ref_id": null
                }
            ],
            "ref_spans": [
                {
                    "start": 564,
                    "end": 572,
                    "text": "figure 1",
                    "ref_id": "FIGREF10"
                },
                {
                    "start": 647,
                    "end": 655,
                    "text": "Figure 1",
                    "ref_id": "FIGREF10"
                }
            ],
            "section": "Aerosol transport during 2019 summer Amazon rainforest wildfires"
        },
        {
            "text": "The pollutant transport dynamics portrayed in figure 1 of supplementary material has been contrasted by means of the HYSPLIT model in order to account for wind transport profiles during five days previous to each of the dates plotted in figure 1 ",
            "cite_spans": [],
            "ref_spans": [
                {
                    "start": 46,
                    "end": 54,
                    "text": "figure 1",
                    "ref_id": "FIGREF10"
                },
                {
                    "start": 237,
                    "end": 245,
                    "text": "figure 1",
                    "ref_id": "FIGREF10"
                }
            ],
            "section": "Aerosol transport during 2019 summer Amazon rainforest wildfires"
        }
    ],
    "bib_entries": {
        "BIBREF0": {
            "ref_id": "b0",
            "title": "A European aerosol phenomenology-3: Physical and chemical characteristics of particulate matter from 60 rural, urban, and kerbside sites across Europe",
            "authors": [
                {
                    "first": "J",
                    "middle": [
                        "P"
                    ],
                    "last": "Putaud",
                    "suffix": ""
                }
            ],
            "year": 2010,
            "venue": "Atmospheric Environment",
            "volume": "44",
            "issn": "",
            "pages": "1308--1320",
            "other_ids": {}
        },
        "BIBREF1": {
            "ref_id": "b1",
            "title": "Atmospheric composition change: Climate-Chemistry interactions. Atmospheric Environment",
            "authors": [
                {
                    "first": "I",
                    "middle": [
                        "S A"
                    ],
                    "last": "Isaksen",
                    "suffix": ""
                }
            ],
            "year": 2009,
            "venue": "ACCENT Synthesis",
            "volume": "43",
            "issn": "",
            "pages": "5138--5192",
            "other_ids": {}
        },
        "BIBREF2": {
            "ref_id": "b2",
            "title": "Global and regional climate changes due to black carbon",
            "authors": [
                {
                    "first": "V",
                    "middle": [],
                    "last": "Ramanathan",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Carmichael",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Nature Geoscience",
            "volume": "1",
            "issn": "",
            "pages": "221--227",
            "other_ids": {}
        },
        "BIBREF3": {
            "ref_id": "b3",
            "title": "Climatology of aerosol radiative properties in the free troposphere",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Andrews",
                    "suffix": ""
                }
            ],
            "year": 2011,
            "venue": "Atmospheric Research",
            "volume": "102",
            "issn": "",
            "pages": "365--393",
            "other_ids": {}
        },
        "BIBREF4": {
            "ref_id": "b4",
            "title": "Climate Vulnerability",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Abayomi",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "125--143",
            "other_ids": {}
        },
        "BIBREF5": {
            "ref_id": "b5",
            "title": "Strong presentday aerosol cooling implies a hot future",
            "authors": [
                {
                    "first": "M",
                    "middle": [
                        "O"
                    ],
                    "last": "Andreae",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [
                        "D"
                    ],
                    "last": "Jones",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [
                        "M"
                    ],
                    "last": "Cox",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Nature",
            "volume": "435",
            "issn": "",
            "pages": "1187--1190",
            "other_ids": {}
        },
        "BIBREF6": {
            "ref_id": "b6",
            "title": "Decadal attribution of historic temperature and ocean heat content change to anthropogenic emissions",
            "authors": [
                {
                    "first": "E",
                    "middle": [
                        "J L"
                    ],
                    "last": "Larson",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "W"
                    ],
                    "last": "Portmann",
                    "suffix": ""
                },
                {
                    "first": "S",
                    "middle": [],
                    "last": "Solomon",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "M"
                    ],
                    "last": "Murphy",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Geophysical Research Letters",
            "volume": "47",
            "issn": "",
            "pages": "1--18",
            "other_ids": {}
        },
        "BIBREF7": {
            "ref_id": "b7",
            "title": "In the line of fire",
            "authors": [
                {
                    "first": "",
                    "middle": [],
                    "last": "Editorial",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nature Climate Change",
            "volume": "10",
            "issn": "",
            "pages": "169--169",
            "other_ids": {}
        },
        "BIBREF8": {
            "ref_id": "b8",
            "title": "When will the Amazon hit a tipping point",
            "authors": [
                {
                    "first": "I",
                    "middle": [],
                    "last": "Amigo",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nature",
            "volume": "578",
            "issn": "",
            "pages": "505--507",
            "other_ids": {}
        },
        "BIBREF9": {
            "ref_id": "b9",
            "title": "An overview of ACE-Asia: Strategies for quantifying the relationships between Asian aerosols and their climatic impacts",
            "authors": [
                {
                    "first": "B",
                    "middle": [
                        "J"
                    ],
                    "last": "Huebert",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Journal of Geophysical Research: Atmospheres",
            "volume": "108",
            "issn": "",
            "pages": "1--20",
            "other_ids": {}
        },
        "BIBREF10": {
            "ref_id": "b10",
            "title": "Organic aerosol and global climate modelling: a review",
            "authors": [
                {
                    "first": "M",
                    "middle": [],
                    "last": "Kanakidou",
                    "suffix": ""
                }
            ],
            "year": 2005,
            "venue": "Atmospheric Chemistry and Physics",
            "volume": "5",
            "issn": "",
            "pages": "1053--1123",
            "other_ids": {}
        },
        "BIBREF11": {
            "ref_id": "b11",
            "title": "The equilibrium sensitivity of the Earth's temperature to radiation changes",
            "authors": [
                {
                    "first": "R",
                    "middle": [],
                    "last": "Knutti",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "C"
                    ],
                    "last": "Hegerl",
                    "suffix": ""
                }
            ],
            "year": 2008,
            "venue": "Nature Geoscience",
            "volume": "1",
            "issn": "",
            "pages": "735--743",
            "other_ids": {}
        },
        "BIBREF12": {
            "ref_id": "b12",
            "title": "Long-term air pollution exposure and cardio-respiratory mortality: a review",
            "authors": [
                {
                    "first": "G",
                    "middle": [],
                    "last": "Hoek",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Environmental Health",
            "volume": "12",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF13": {
            "ref_id": "b13",
            "title": "Air quality co-benefits for human health and agriculture counterbalance costs to meet Paris Agreement pledges",
            "authors": [
                {
                    "first": "T",
                    "middle": [],
                    "last": "Vandyck",
                    "suffix": ""
                }
            ],
            "year": 2018,
            "venue": "Nature Communications",
            "volume": "9",
            "issn": "",
            "pages": "1--11",
            "other_ids": {}
        },
        "BIBREF14": {
            "ref_id": "b14",
            "title": "The contribution of outdoor air pollution sources to premature mortality on a global scale",
            "authors": [
                {
                    "first": "J",
                    "middle": [],
                    "last": "Lelieveld",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "S"
                    ],
                    "last": "Evans",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Fnais",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [],
                    "last": "Giannadaki",
                    "suffix": ""
                },
                {
                    "first": "A",
                    "middle": [],
                    "last": "Pozzer",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Nature",
            "volume": "525",
            "issn": "",
            "pages": "367--371",
            "other_ids": {}
        },
        "BIBREF15": {
            "ref_id": "b15",
            "title": "The race to decipher how climate change influenced Australia's record fires",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Phillips",
                    "suffix": ""
                },
                {
                    "first": "B",
                    "middle": [],
                    "last": "Nogrady",
                    "suffix": ""
                }
            ],
            "year": 2020,
            "venue": "Nature",
            "volume": "577",
            "issn": "",
            "pages": "610--612",
            "other_ids": {}
        },
        "BIBREF16": {
            "ref_id": "b16",
            "title": "Climate Change Data. (Consulted Mar. 2020). data.worldbank.org/topic/climate-change",
            "authors": [],
            "year": null,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF17": {
            "ref_id": "b17",
            "title": "Climate-smart agriculture for food security",
            "authors": [
                {
                    "first": "L",
                    "middle": [],
                    "last": "Lipper",
                    "suffix": ""
                }
            ],
            "year": 2014,
            "venue": "Nature Climate Change",
            "volume": "4",
            "issn": "",
            "pages": "1068--1072",
            "other_ids": {}
        },
        "BIBREF18": {
            "ref_id": "b18",
            "title": "Detection and analysis of microfronts and associated coherent events using localized transforms",
            "authors": [
                {
                    "first": "N",
                    "middle": [],
                    "last": "Gamage",
                    "suffix": ""
                },
                {
                    "first": "C",
                    "middle": [],
                    "last": "Hagelberg",
                    "suffix": ""
                }
            ],
            "year": 1993,
            "venue": "Journal of the Atmospheric Sciences",
            "volume": "50",
            "issn": "",
            "pages": "750--756",
            "other_ids": {}
        },
        "BIBREF19": {
            "ref_id": "b19",
            "title": "Finding boundary layer top: Application of a wavelet covariance transform to lidar backscatter profiles",
            "authors": [
                {
                    "first": "I",
                    "middle": [
                        "M"
                    ],
                    "last": "Brooks",
                    "suffix": ""
                }
            ],
            "year": 2003,
            "venue": "Journal of Atmospheric and Oceanic Technology",
            "volume": "20",
            "issn": "",
            "pages": "1092--1105",
            "other_ids": {}
        },
        "BIBREF20": {
            "ref_id": "b20",
            "title": "Wavelet correlation transform method and gradient method to determine aerosol layering from lidar returns: Some comments",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "Comer\u00f3n",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Sicard",
                    "suffix": ""
                },
                {
                    "first": "F",
                    "middle": [],
                    "last": "Rocadenbosch",
                    "suffix": ""
                }
            ],
            "year": 2013,
            "venue": "Journal of Atmospheric and Oceanic Technology",
            "volume": "30",
            "issn": "",
            "pages": "1189--1193",
            "other_ids": {}
        },
        "BIBREF21": {
            "ref_id": "b21",
            "title": "The detection of mixed layer depth and entrainment zone thickness from lidar backscatter profiles",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "G"
                    ],
                    "last": "Steyn",
                    "suffix": ""
                },
                {
                    "first": "M",
                    "middle": [],
                    "last": "Baldi",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "M"
                    ],
                    "last": "Hoff",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "Journal of Atmospheric and Oceanic Technology",
            "volume": "16",
            "issn": "",
            "pages": "953--959",
            "other_ids": {}
        },
        "BIBREF22": {
            "ref_id": "b22",
            "title": "Deep learning",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Lecun",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bengio",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [],
                    "last": "Hinton",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "Nature",
            "volume": "521",
            "issn": "",
            "pages": "436--444",
            "other_ids": {}
        },
        "BIBREF24": {
            "ref_id": "b24",
            "title": "The perceptron: A probabilistic model for information storage and organization in the brain",
            "authors": [
                {
                    "first": "F",
                    "middle": [],
                    "last": "Rosenblatt",
                    "suffix": ""
                }
            ],
            "year": 1958,
            "venue": "Psychological Review",
            "volume": "65",
            "issn": "",
            "pages": "386--408",
            "other_ids": {}
        },
        "BIBREF26": {
            "ref_id": "b26",
            "title": "Learning representations by back-propagating errors",
            "authors": [
                {
                    "first": "D",
                    "middle": [
                        "E"
                    ],
                    "last": "Rumelhart",
                    "suffix": ""
                },
                {
                    "first": "G",
                    "middle": [
                        "E"
                    ],
                    "last": "Hinton",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [
                        "J"
                    ],
                    "last": "Williams",
                    "suffix": ""
                }
            ],
            "year": 1986,
            "venue": "Nature",
            "volume": "323",
            "issn": "",
            "pages": "533--536",
            "other_ids": {}
        },
        "BIBREF27": {
            "ref_id": "b27",
            "title": "Contour and Grouping in Computer Vision",
            "authors": [
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Lecun",
                    "suffix": ""
                },
                {
                    "first": "P",
                    "middle": [],
                    "last": "Haffner",
                    "suffix": ""
                },
                {
                    "first": "L",
                    "middle": [],
                    "last": "Bottou",
                    "suffix": ""
                },
                {
                    "first": "Y",
                    "middle": [],
                    "last": "Bengio",
                    "suffix": ""
                },
                {
                    "first": "D",
                    "middle": [
                        "A"
                    ],
                    "last": "Forsyth",
                    "suffix": ""
                },
                {
                    "first": "J",
                    "middle": [
                        "L"
                    ],
                    "last": "Mundy",
                    "suffix": ""
                },
                {
                    "first": "V",
                    "middle": [],
                    "last": "Di Ges\u00fa",
                    "suffix": ""
                },
                {
                    "first": "R",
                    "middle": [],
                    "last": "Cipolla",
                    "suffix": ""
                }
            ],
            "year": 1999,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "319--345",
            "other_ids": {}
        },
        "BIBREF28": {
            "ref_id": "b28",
            "title": "Machine Learning with Scikit-Learn, Keras, and TensorFlow: Concepts, Tools, and Techniques to Build Intelligent Systems",
            "authors": [
                {
                    "first": "A",
                    "middle": [],
                    "last": "G\u00e9ron",
                    "suffix": ""
                },
                {
                    "first": "",
                    "middle": [],
                    "last": "Hands-On",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF29": {
            "ref_id": "b29",
            "title": "TensorFlow: Large-scale machine learning on heterogeneous systems. Software available from tensorflow.org",
            "authors": [
                {
                    "first": "Mart\u00edn",
                    "middle": [],
                    "last": "Abadi",
                    "suffix": ""
                }
            ],
            "year": 2015,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        },
        "BIBREF30": {
            "ref_id": "b30",
            "title": "NASA's AIRS maps carbon monoxide from Brazil fires. www.nasa.gov/feature/jpl/nasas-airs-mapscarbon-monoxide-from-brazil-fires",
            "authors": [
                {
                    "first": "E",
                    "middle": [],
                    "last": "Smith",
                    "suffix": ""
                }
            ],
            "year": 2019,
            "venue": "",
            "volume": "",
            "issn": "",
            "pages": "",
            "other_ids": {}
        }
    },
    "ref_entries": {
        "FIGREF1": {
            "text": "LiDAR retrievals for august 14, 2019. a, Temporal evolution of the ABL, and b, c, Two selected single LiDAR profiles. They point out different scenarios treated with our method: the measurements exhibit b, Profile 1 (12:30 h), a well-mixed layer where NN and sup. WCT values are very similar, and c, Profile 2 (15:40 h), unusual atmospheric conditions where the NN estimation differs from both sup. and unsup. WCT values; the latter profile exhibits a likely turbulence, with a height about 2.6 km for the NN prediction. The intensity of the signals is given in arbitrary units (a.u.).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF2": {
            "text": "Case study, august 2019 (Amazon rain forest fires). a, August 15, b, August 16, c, August 21, 2019. These measurements exhibit unusual atmospheric conditions, with ABLT values of up to four kilometers in height and dense cloud layers close to the ABL. Here the generalisation capabilities of the NN are proven, as the neural network provides ABLT predictions of continuous time evolution and low variance (figure 5), and within the region associated to the entrainment zone. satellite 41 show that indeed the results presented in figure 3c coincide with aerosols flow from the brazilian northwest Amazon wildfires 41 (see Supplementary Material for more details about aerosol transport during 2019 summer Amazon rainforest wildfires).",
            "latex": null,
            "type": "figure"
        },
        "FIGREF3": {
            "text": "NN vs WCT: Performance comparison.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF5": {
            "text": "NOAA HYSPLIT Backward trajectories run in ensemble mode. Five days records and trajectories finishing at 1 km, 2 km and 3 km AGL at 20:00 UTC, on 21/08/2019. The simulation shows the wind transport from the brazilian northwest amazon rainforest to the place marked with a star, where in-situ measurements were taken at the LiDAR station in Cali (Colombia). and mean distance between points (see figure 5), as a mean to quantify and compare the continuity of the ABLT time evolution provided by each method. The statistical results for the performance of supervised WCT, unsupervised WCT, and the proposed NN model are shown, for all the case studies, in the histograms,figure 5, that plot the following: a Standard deviation of the full ABLT time evolution, b Mean standard deviation over 30 minute intervals, and c Mean distance between points.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF7": {
            "text": "Statistical results for the performance of sup. WCT, unsup. WCT, and the proposed NN model. a, Standard deviation of the full ABLT time evolution, b, Mean standard deviation over 30 minute intervals, c, Mean distance between points for all the case studies. The NN achieves the lowest dispersion and the highest continuity, followed by sup. WCT.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF8": {
            "text": "Experimental setup. Instrumentation at the atmospheric LiDAR-CIBioFi station (3.37N; 76.53W) in Cali, northwestern South America. The LiDAR configuration operates in elastic mode at 532 nm; the Nd:YAG pulsed laser source features a pulse width of \u2264 6 ns at 1064 nm, and a pulse repetition frequency of 10 Hz.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF9": {
            "text": "Vermeulen, S. J. et al. Addressing uncertainty in adaptation planning for agriculture. Proceedings of the National Academy of Sciences 110, 8357-8362 (May 2013). 20. Wheeler, T. & Braun, J. v. Climate change impacts on global food security. Science 341, 508-513 (Aug. 2013). 21. Schmidhuber, J. & Tubiello, F. N. Global food security under climate change. Proceedings of the National Academy of Sciences 104, 19703-19708 (Dec. 2007). 22. Oke, T. Boundary Layer Climates (Routledge, 1987). 23. Toledo, D., C\u00f3rdoba-Jabonero, C., Adame, J. A., Morena, B. D. L. & Gil-Ojeda, M. Estimation of the atmospheric boundary layer height during different atmospheric conditions: a comparison on reliability of several methods applied to lidar measurements. International Journal of Remote Sensing 38, 3203-3218 (June 2017). 24. Comer\u00f3n, A., Sicard, M. & Rocadenbosch, F. Wavelet correlation transform method and gradient method to determine aerosol layering from lidar returns: Some comments. Journal of Atmospheric and Oceanic Technology 30, 1189-1193 (Jan. 2013). 25. Menut, L., Flamant, C., Pelon, J. & Flamant, P. H. Urban boundary-layer height determination from lidar measurements over the Paris area. Applied Optics 38, 945-954 (Feb. 1999). 26. Gamage, N. & Hagelberg, C. Detection and analysis of microfronts and associated coherent events using localized transforms. Journal of the Atmospheric Sciences 50, 750-756 (Mar. 1993). 27. Brooks, I. M. Finding boundary layer top: Application of a wavelet covariance transform to lidar backscatter profiles. Journal of Atmospheric and Oceanic Technology 20, 1092-1105 (Aug. 2003). 28. Mao, F., Gong, W., Song, S. & Zhu, Z. Determination of the boundary layer top from lidar backscatter profiles using a Haar wavelet method over Wuhan, China. Optics & Laser Technology 49, 343-349 (July 2013). 29. Baars, H., Ansmann, A., Engelmann, R. & Althausen, D. Continuous monitoring of the boundary-layer top with lidar. Atmospheric Chemistry and Physics 8, 7281-7296 (Dec. 2008). 30. Steyn, D. G., Baldi, M. & Hoff, R. M. The detection of mixed layer depth and entrainment zone thickness from lidar backscatter profiles. Journal of Atmospheric and Oceanic Technology 16, 953-959 (July 1999). 31. Lange, D., Tiana-Alsina, J., Saeed, U., Tom\u00e1s, S. & Rocadenbosch, F. Atmospheric boundary layer height monitoring using a Kalman filter and backscatter lidar returns. IEEE Transactions on Geoscience and Remote Sensing 52, 4717-4728 (Aug. 2014). 32. Cespedes, J., Melo, C. A. & Reina, J. H. A first measurement of the planetary boundary layer top in Cali-Colombia: elastic LiDAR application in Remote Sensing of Clouds and the Atmosphere XXIII (eds Comer\u00f3n, A., Kassianov, E. I., Sch\u00e4fer, K., Picard, R. H. & Weber, K.) (SPIE, Berlin, Germany, Oct. 2018), 21. 33. Melfi, S. H., Spinhirne, J. D., Chou, S.-H. & Palm, S. P. Lidar observations of vertically organized convection in the planetary boundary layer over the ocean. Journal of Climate and Applied Meteorology 24, 806-821 (Aug. 1985). 34. Toledo, D., C\u00f3rdoba-Jabonero, C. & Gil-Ojeda, M.",
            "latex": null,
            "type": "figure"
        },
        "FIGREF10": {
            "text": "-SM. The results are shown in figure 2-SM, for a August 14, b August 15, and c August 16, 2019; these dates have been chosen since they allow a further consideration of the results reported in figure 1 and figures 2a and 2b of main paper, respectively. From these, we conclude that the results of main paper for August 14, 15, and 16 are not directly linked to aerosols arising from the mentioned Amazon forest wildfires, as the wind transport profiles of figure 2-SM indicate that, during these days, the movement of winds mainly comes from regions far away from the Brazilian northwest Amazon region. Indeed, figures 2a and 2b-SM show winds and associated backward trajectories from the Amazon, but on days when the fire was just beginning in such regions. On the other hand, figure 2c-SM shows winds arising from regions completely outside the Brazilian fire area. Aerosol transport during the Amazon rainforest fires, August 2019. a, August 14, b, August 15, c, August 16, d, August 21. Adapted from NASA's Atmospheric Infrared Sounder (AIRS) instrument data, aboard the Aqua satellite. The colours indicate concentrations of carbon monoxide, as follows: Green, at approximately 100 ppbv, yellow at approximately 120 ppbv, and dark red at approximately 160 ppbv 13 .",
            "latex": null,
            "type": "figure"
        },
        "FIGREF11": {
            "text": "NOAA HYSPLIT backward trajectories run in ensemble mode. Five days records and trajectories finishing at 1 km, 2 km and 3 km AGL at 20:00 UTC, on a, 14/08/2019, b, 15/08/2019, c, 16/08/2019. The simulations show the wind transport arising from different regions, to the place marked with a star, where in-situ measurements were taken at the LiDAR station in Cali (Colombia).",
            "latex": null,
            "type": "figure"
        }
    },
    "back_matter": [
        {
            "text": "This work was funded by the Colombian Science, Technology and Innovation Fund-General Royalties System (Fondo CTeI-Sistema General de Regal\u00edas) and Gobernaci\u00f3n del Valle del Cauca (Grant BPIN 2013000100007), Fundaci\u00f3n para la Promoci\u00f3n de la Investigaci\u00f3n y la Tecnolog\u00eda (Grant 201921). We are grateful to the Laboratory for Atmospheric Physics (LAFA) and to the LiDAR station at the Centre for Bioinformatics and Photonics (CIBioFi) for the provided data.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Acknowledgements"
        },
        {
            "text": "D.R.V. wrote the convolutional neural network code, D.R.V. and E.S. ran the model simulations, collected data and prepared the figures. J.H.R. conceived the study and supervised the experiment and simulations. All authors contributed to the analysis and interpretation of the results, and to the writing of the manuscript.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Author contributions"
        },
        {
            "text": "Supplementary information is available in the online version of the paper. Correspondence and requests for materials should be addressed to J.H.R.",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Additional information"
        },
        {
            "text": "The authors declare no competing interests. ",
            "cite_spans": [],
            "ref_spans": [],
            "section": "Competing interests"
        }
    ]
}